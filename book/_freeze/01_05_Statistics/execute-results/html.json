{
  "hash": "39d3af5a28ea6ac6ea7e7903cdc8f433",
  "result": {
    "engine": "knitr",
    "markdown": "# Statistics\n***\n\nWe often summarize distributions with *statistics*: functions of data. The most basic way to do this is with `summary`, whose values can all be calculated individually. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A random sample (real data)\nX <- USArrests[,'Murder']\nsummary(X)\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##   0.800   4.075   7.250   7.788  11.250  17.400\n\n# A random sample (computer simulation)\nX <-  runif(1000)\nsummary(X)\n##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n## 0.002633 0.255018 0.487316 0.496300 0.743201 0.999606\n\n# Another random sample (computer simulation)\nX <- rnorm(1000) \nsummary(X)\n##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n## -3.44772 -0.66865  0.03276  0.02427  0.73256  2.66878\n```\n:::\n\n\nTogether, the mean and variance statistics summarize the central tendency and dispersion of a distribution. In some special cases, such as with the normal distribution, they completely describe the distribution. Other distributions are better described with other statistics, either as an alternative or in addition to the mean and variance. After discussing those other statistics, we will return to the two most basic statistics in theoretical detail.\n\n## Mean and Variance\n\nThe mean and variance are the two most basic statistics that summarize the center and how spread apart the values are. As before, we represent data as vector $\\hat{X}=(\\hat{X}_{1}, \\hat{X}_{2}, ....\\hat{X}_{n})$, where there are $n$ observations and $\\hat{X}_{i}$ is the value of the $i$th one.\n\n\n\n#### **Mean**. {-}\nPerhaps the most common statistic is the mean, which is the [sum of all values] divided by [number of values];\n\\begin{eqnarray}\n\\hat{M} &=& \\frac{\\sum_{i=1}^{n}\\hat{X}_{i}}{n},\n\\end{eqnarray}\nwhere $\\hat{X}_{i}$ denotes the value of the $i$th observation.\n\n:::{.callout-note icon=false collapse=\"true\"}\nFor example, a dataset of $\\{1,4,10\\}$ has a mean of $[1+4+10]/3=5$.\n\n::: {.cell}\n\n```{.r .cell-code}\nX <- c(1,4,10)\nsum(X)/length(X)\n## [1] 5\nmean(X)\n## [1] 5\n```\n:::\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# compute the mean of a random sample\nX1 <- USArrests[,'Murder']\nX1_mean <- mean(X1)\nX1_mean\n## [1] 7.788\n\n# visualize on a histogram\nhist(X1, border=NA, main=NA)\nabline(v=X1_mean, col=2, lwd=2)\ntitle(paste0('mean= ', round(X1_mean,2)), font.main=1)\n```\n\n::: {.cell-output-display}\n![](01_05_Statistics_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n#### **Variance**.{-}\nPerhaps the second most common statistic is the variance: the average squared deviation from the mean\n\\begin{eqnarray}\n\\hat{V} &=&\\frac{\\sum_{i=1}^{n} [\\hat{X}_{i} - \\hat{M}]^2}{n}.\n\\end{eqnarray}\nThe standard deviation is simply $\\hat{S} = \\sqrt{\\hat{V} }$, which can be interpreted as the average distance from the mean.\n\n:::{.callout-note icon=false collapse=\"true\"}\nFor example, a dataset of $\\{1,4,10\\}$ has a mean of $[1+4+10]/3=5$. The variance is $[(1-5)^2+(4-5)^2+(10-5)^2]/3=14$ and the standard deviation is $\\sqrt{14}$.\n\n::: {.cell}\n\n```{.r .cell-code}\nX <- c(1,4,10)\nX_mean <- mean(X)\nX_var <- mean( (X - X_mean)^2 )\nsqrt(X_var)\n## [1] 3.741657\n```\n:::\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nX1_s <- sd(X1) # sqrt(var(X))\nhist(X1, border=NA, main=NA, freq=F)\nX1_s_lh <- c(X1_mean - X1_s,  X1_mean + X1_s)\nabline(v=X1_s_lh, col=4)\ntext(X1_s_lh, -.02,\n    c( expression(bar(X)-s[X]), expression(bar(X)+s[X])),\n    col=4, adj=0)\ntitle(paste0('sd= ', round(X1_s,2)), font.main=1)\n```\n\n::: {.cell-output-display}\n![](01_05_Statistics_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n:::{.callout-tip icon=false collapse=\"true\"}\nNote that a \"corrected version\" is used by R and many statisticians: $\\hat{V}' =\\frac{\\sum_{i=1}^{n} [\\hat{X}_{i} - \\hat{M}]^2}{n-1}$ and $\\hat{S}' = \\sqrt{\\hat{V}'}$. In this class, we use the \"unocorrect version\" as defined previously. There is hardly any difference when $n$ is large: e.g., $\\frac{1}{n}\\approx \\frac{1}{n-1}$ for $n=100,000$.\n\n::: {.cell}\n\n```{.r .cell-code}\nX <- c(1,4,10)\n\nX_mean <- mean(X)\nX_var <- mean( (X - X_mean)^2 )\nX_var\n## [1] 14\n\n# Corrected Version\nn <- length(X)  \nX_var2 <- sum( (X - X_mean)^2 )/(n-1)\nX_var2\n## [1] 21\n\nvar(X) # R-Version\n## [1] 21\n```\n:::\n\n:::\n\n## Other Center/Spread Statistics\n\nA general rule of applied statistics is that there are multiple ways to measure something. Mean and Variance are measurements of Center and Spread, but there are others that have different theoretical properties and may be better suited for your dataset.\n\n#### **Medians and Absolute Deviations**. {-}\nWe can use the *Median* as a \"robust alternative\" to means that is especially useful for data with asymmetric distributions and extreme values. Recall that the $q$th quantile is the value where $q$ percent of the data are below and ($1-q$) percent are above. The median ($q=.5$) is the point where half of the data is lower values and the other half is higher. This means that median is not sensitive to extreme values (whereas the mean is).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nX <- rexp(50, 0.4)\nX\n##  [1] 0.1858263 0.4925077 4.0105685 2.2544121 1.0929213 3.3727677 2.3735416\n##  [8] 2.9560274 1.1632943 2.2727626 0.2011890 2.2360401 0.2418815 6.5093860\n## [15] 2.9135032 7.5950226 3.0240262 0.1374198 2.2603482 1.3142009 4.8390538\n## [22] 5.2859782 1.3125305 0.2525018 0.9031483 6.9153942 9.4027188 1.2827510\n## [29] 1.5130079 0.5748842 1.6048924 9.6675812 2.7603489 2.0129271 4.7455032\n## [36] 0.7385351 8.3850597 1.7109134 6.3005016 4.8760328 0.9125174 3.5454615\n## [43] 1.1138989 3.7620422 3.8992871 1.9106841 0.7012107 1.0049971 0.2786699\n## [50] 0.8822167\nhist(X, freq=F, breaks=seq(0,18),\n    border=NA, main='')\n```\n\n::: {.cell-output-display}\n![](01_05_Statistics_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\n\n# For discrete numbers\n# X <- rgeom(50, .4)\n#proportions <- table(X)/length(X)\n#plot(proportions, ylab='proportion')\n```\n:::\n\n\n:::{.callout-note icon=false collapse=\"true\"}\nExamine robustness to an extreme value\n\n::: {.cell}\n\n```{.r .cell-code}\n\nX_extreme <- c(X, 1000) # add one extreme value\n#par(mfrow=c(1,2)) # visualize side-by-side\n#hist(X)\n#hist(X_extreme)\n\n\n# Which measures of central tendency are robust\n# to a single extreme value?\nmean(X)\n## [1] 2.794058\nmean( X_extreme )\n## [1] 22.34712\n\nquantile(X, prob=0.5)\n##      50% \n## 2.124484\nquantile(X_extreme, prob=0.5)\n##     50% \n## 2.23604\n```\n:::\n\n:::\n\n\n\nWe can also use the *Interquartile Range* or *Median Absolute Deviation* as an alternative to variance. The difference between the first and third quartiles (quantiles $q=.25$ and $q=.75$) measure is range of the middle $50%$ of the data, which is how the boxplot measures \"spread\". The median absolute deviation is another statistic that also measures \"spread\".\n\\begin{eqnarray}\n\\tilde{M} &=& \\text{Med}( \\hat{X}_{i}) \\\\\n\\hat{MAD} &=& \\text{Med}\\left( | \\hat{X}_{i} - \\tilde{M} | \\right).\n\\end{eqnarray}\n\n:::{.callout-note icon=false collapse=\"true\"}\nCompute the $IQR$ statistic for the dataset $\\{-100,1,4,10,10\\}$. \n\n$IQR = $ Upper quartile $ - $ Lower quartile $ = 10 - 1 = 9$. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nX <- c(-100,1,4,10,10)\n# An intuitive alternative to sd(X), used in the boxplot\nquants <- quantile(X, probs=c(.25,.75))\nquants[2]-quants[1]\n## 75% \n##   9\nIQR(X)\n## [1] 9\n```\n:::\n\nCompute the $MAD$ statistic for the dataset $\\{1,4,10\\}$. First compute the median, Med$(1,4,10)=1$. Then compute Med$( |1-4|, |4-4|, |10-4| )=$Med$( 3,0,6 ) = 3$.\n\n::: {.cell}\n\n```{.r .cell-code}\nX <- c(1,4,10)\n#Another alternative to sd(X)\nmad(X, constant=1)\n## [1] 3\n\n# Computationally equivalent\n# x_med <- quantile(X, probs=.5)\n# x_absdev <- abs(X -x_med)\n# quantile(x_absdev, probs=.5)\n```\n:::\n\n:::\n\n:::{.callout-note icon=false collapse=\"true\"}\nCompare the robustness of various \"spread\" metrics to an extreme value\n\n::: {.cell}\n\n```{.r .cell-code}\nX <- rgeom(50, .4)\nX_extreme <- c(X, 1000) # add one extreme value\n\nsd(X)\n## [1] 1.989359\nsd(X_extreme)\n## [1] 139.7674\n\nmad(X, constant=1)\n## [1] 1.5\nmad(X_extreme, constant=1)\n## [1] 1\n\nIQR(X)\n## [1] 3\nIQR(X_extreme)\n## [1] 3\n```\n:::\n\n:::\n\n\n:::{.callout-tip icon=false collapse=\"true\"}\nNote that there other \"absolute deviation\" statistics\n\n::: {.cell}\n\n```{.r .cell-code}\n# sometimes seen elsewhere\nmean( abs(X - mean(X)) )\nmean( abs(X - median(X)) )\nmedian( abs(X - mean(X)) )\n```\n:::\n\n:::\n\n#### **Mode and Share Concentration**. {-}\nSometimes, none of the above work well. With categorical data, for example, distributions are easier to describe with other statistics. The *mode* is the most common observation: the value with the highest observed frequency. We can also measure the spread of the frequencies or concentration at the mode vs elsewhere.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Draw 3 Random Letters\nx <- LETTERS\nx_probs <- seq(1, length(x))\nx_probs <- x_probs/sum(x_probs) # probs must sum to 1\nX <- sample(x, 1, prob=x_probs, replace=T)\nX\n## [1] \"J\"\n\n# Draw Random Letters 100 Times\nX <- sample(x, 1000, prob=x_probs, replace=T)\nX <- factor(unlist(X), levels=LETTERS, ordered=F)\n\nproportions <- table(X)/length(X)\nplot(proportions, col=grey(0,0.5))\n```\n\n::: {.cell-output-display}\n![](01_05_Statistics_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\n\n# mode(s)\nmode_id <- which(proportions==max(proportions))\nnames(proportions)[ mode_id ]\n## [1] \"W\" \"X\"\n\n# freq. spreads\nsd(proportions)\n## [1] 0.02376928\nsum(proportions^2)\n## [1] 0.052586\n# freq. concentration at mode\nmax(proportions)/mean(proportions)\n## [1] 2.132\n```\n:::\n\n\n## Shape Statistics\n\nCentral tendency and dispersion are often insufficient to describe a distribution. To further describe shape, we can compute skew and kurtosis to measure asymmetry and extreme values. There are many other statistics we could compute on an ad-hoc basis.\n\n#### **Skewness**. {-}\nThe skew statistic captures how asymmetric the distribution is by measuring the average cubed deviation from the mean, normalized the standard deviation cubed\n\\begin{eqnarray}\n\\frac{\\sum_{i=1}^{n} [\\hat{X}_{i} - \\hat{M}]^3 / n}{ s^3 }\n\\end{eqnarray}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nX <- rweibull(1000, shape=1)\nhist(X, border=NA, main=NA, freq=F, breaks=20)\n```\n\n::: {.cell-output-display}\n![](01_05_Statistics_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\n\nskewness <-  function(X){\n X_mean <- mean(X)\n m3 <- mean((X - X_mean)^3)\n s3 <- sd(X)^3\n skew <- m3/s3\n return(skew)\n}\n\nskewness( rweibull(1000, shape=1))\n## [1] 2.175914\nskewness( rweibull(1000, shape=10) )\n## [1] -0.671398\n```\n:::\n\n\nWe can automatically compare against the normal distribution, which has a skew of 0.\n\n#### **Kurtosis**. {-}\nThis statistic captures how many \"outliers\" there are like skew but looking at quartic deviations instead of cubed ones.\n\\begin{eqnarray}\n\\frac{\\sum_{i=1}^{n} [\\hat{X}_{i} - \\hat{M}]^4 / n}{ s^4 }.\n\\end{eqnarray}\nSome authors further subtract $3$ to explicitly compare against the normal distribution (the normal distribution has a kurtosis of $3$).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nX <- rweibull(1000, shape=1)\nboxplot(X, main=NA)\n```\n\n::: {.cell-output-display}\n![](01_05_Statistics_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\n\nkurtosis <- function(X){  \n X_mean <- mean(X)\n m4 <- mean((X - X_mean)^4) \n s4 <- sd(X)^4\n kurt <- m4/s4\n excess_kurt <- kurt - 3 # compare against normal\n return(kurt)\n}\n\nkurtosis( rweibull(1000, shape=1) )\n## [1] 8.26544\nkurtosis( rweibull(1000, shape=10) )\n## [1] 3.424938\n```\n:::\n\n\n\n#### **Clusters/Gaps**. {-}\nYou can also describe distributions in terms of how clustered the values are, including the number of modes, bunching, and many other statistics. But remember that \"a picture is worth a thousand words\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Complicated Random Variable\nr_ugly0 <- function(n, populationMean=c(-2, 3), populationVar=c(1, 4), prob=c(.5,.5)){\n  # Which distribution is each observation coming from\n  di <- sample(c(1,2), size=n, replace=TRUE, prob=prob)\n  rnorm(n, mean=populationMean[di], sd=sqrt(populationVar)[di])\n}\n\nX <- r_ugly0(6000)\nhist(X, breaks=60,\n    freq=F, border=NA,\n    xlab=\"x\", main='')\n```\n\n::: {.cell-output-display}\n![](01_05_Statistics_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\n\n#hist( rbeta(1000, .6, .6), border=NA, main=NA, freq=F, breaks=20)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Another Complicated Random Variable\nr_ugly1 <- function(n, theta1=c(-8,-1), theta2=c(-2,2), rho=.25){\n    omega   <- rbinom(n, size=1, rho)\n    epsilon <- omega * runif(n, theta1[1], theta2[1]) +\n        (1-omega) * rnorm(n, theta1[2], theta2[2])\n    return(epsilon)\n}\n# Very Large Sample\nX <- r_ugly1(1000000)\nhist(X, breaks=1000,  freq=F, border=NA,\n    xlab=\"x\", main='')\n```\n\n::: {.cell-output-display}\n![](01_05_Statistics_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Show True Density\nd_ugly1 <- function(x, theta1=c(-8,-1), theta2=c(-2,2), rho=.25){\n    rho     * dunif(x, theta1[1], theta2[1]) +\n    (1-rho) * dnorm(x, theta1[2], theta2[2]) }\nx <- seq(-12,6,by=.001)\ndx <- d_ugly1(x)\nlines(x, dx, col=1)\n```\n:::\n\n\n\n\n## Probability Theory\n\nWe will now dig a little deeper theoretically into the statistics we compute. When we know how the data are generated theoretically, we can often compute the theoretical value of the two most basic and often-used statistics: the mean and variance. To see this, we separately analyze how they are computed for discrete and continuous random variables.\n\nHere, we denote $X_{i}$ as a random variable that can take on specific values $x$ from the sample space with known probabilities.\n\n#### **Discrete Random Variables**. {-} \nIf the sample space is discrete, we can compute the theoretical mean (or expected value) as\n\\begin{eqnarray}\n\\mathbb{E}[X_{i}] = \\sum_{x} x Prob(X_{i}=x),\n\\end{eqnarray}\nwhere $Prob(X_{i}=x)$ is the probability the random variable $X_{i}$ takes the particular value $x$. Similarly, we can compute the theoretical variance as\n\\begin{eqnarray}\n\\mathbb{V}[X_{i}] = \\sum_{x} \\left(x - \\mathbb{E}[X_{i}] \\right)^2 Prob(X_{i}=x).\n\\end{eqnarray}\nThe theoretical standard deviation is $\\mathbb{s}[X_{i}] = \\sqrt{\\mathbb{V}[X_{i}]}$.\n\n\nFor example, consider a five-sided die with equal probability of landing on each side. I.e., $X_{i}$ is a Discrete Uniform random variable with outcomes $x \\in \\{1,2,3,4,5\\}$. What is the theoretical mean? What is the variance and standard deviation?\n\\begin{eqnarray}\n\\mathbb{E}[X_{i}] &=& 1\\frac{1}{5} + 2\\frac{1}{5} + 3\\frac{1}{5} + 4\\frac{1}{5} + 5\\frac{1}{5} = 15/5 = 3\\\\\n\\mathbb{V}[X_{i}] &=& (1-3)^2\\frac{1}{5} +\n  (2 - 3)^2\\frac{1}{5} +\n  (3 - 3)^2\\frac{1}{5} +\n  (4 - 3)^2\\frac{1}{5} +\n  (5 - 3)^2\\frac{1}{5} \\\\\n  &=& 2^2 \\frac{1}{5} + 1^2\\frac{1}{5} + 0^2 \\frac{1}{5} + + 1^2\\frac{1}{5} +  2^2 \\frac{1}{5}\n  = (4 + 1 + 1 + 4)/5 = 10/5 = 2\\\\\n\\mathbb{s}[X_{i}] &=& \\sqrt{2}\n\\end{eqnarray}\n\n::: {.cell}\n\n```{.r .cell-code}\n# Computerized Way to Compute Mean\nx <- c(1,2,3,4,5)\nx_probs <- c(1/5, 1/5, 1/5, 1/5, 1/5)\nX_mean <- sum(x*x_probs)\nX_mean\n## [1] 3\n\n# Computerized Way to Compute SD\nXvar <- sum((x-X_mean)^2*x_probs)\nXvar\n## [1] 2\nXsd <- sqrt(Xvar)\nXsd\n## [1] 1.414214\n\n# Verified by simulation\nXsim <- sample(x, prob=x_probs,\n          size=10000, replace=T)\nmean(Xsim)\n## [1] 2.9864\nsd(Xsim)\n## [1] 1.416833\n```\n:::\n\n\n\n:::{.callout-note icon=false collapse=\"true\"}\nFor example, consider an unfair coin with a $3/4$ probability of heads ($x=1$) and a $1/4$ probability of tails ($x=0$) has a theoretical mean of \n\\begin{eqnarray}\n\\mathbb{E}[X_{i}] = 0\\frac{1}{4} + 1\\frac{3}{4} = \\frac{3}{4}\n\\end{eqnarray}\nand a theoretical variance of \n\\begin{eqnarray}\n\\mathbb{V}[X_{i}] = [0 - \\frac{3}{4}]^2 \\frac{1}{4} + [1 - \\frac{3}{4}]^2 \\frac{3}{4} \n= \\frac{9}{64} + \\frac{3}{64}\n= \\frac{12}{64} \n= \\frac{3}{16}. \n\\end{eqnarray}\nVerify both the mean and variance by simulation.\n\n::: {.cell}\n\n```{.r .cell-code}\n# A simulation of many coin flips\nx <- c(0,1)\nx_probs <- c(1/4, 3/4)\nX <- sample(x, 1000, prob=x_probs, replace=T)\n\nround( mean(X), 4)\n## [1] 0.737\n\nround( var(X), 4)\n## [1] 0.194\n```\n:::\n\n:::\n\n:::{.callout-note icon=false collapse=\"true\"}\nConsider a four-sided die with outcomes $\\{1,2,3,4 \\}$ and corresponding probabilities $\\{ 1/8, 2/8, 1/8, 4/8 \\}$ . What is the mean?\n\\begin{eqnarray}\n\\mathbb{E}[X_{i}] = 1 \\frac{1}{8} + 2 \\frac{2}{8} + 3 \\frac{1}{8} + 4 \\frac{4}{8} = 3\n\\end{eqnarray}\nWhat is the variance? Verify both the mean and variance by simulation.\n:::\n\n\n:::{.callout-tip icon=false collapse=\"true\"}\nConsider an unfair coin with a $p$ probability of heads ($x=1$) and a $1-p$ probability of tails ($x=0$), where $p$ is a parameter between $0$ and $1$. The theoretical mean is\n\\begin{eqnarray}\n\\mathbb{E}[X_{i}] = 1[p] + 0[1-p] = p\n\\end{eqnarray}\nand the theoretical variance is \n\\begin{eqnarray}\n\\mathbb{V}[X_{i}] \n= [1 - p]^2 p + [0 - p]^2 [1-p] = [1 - p]^2 p + p^2 [1-p] \n= [1-p]p\\left( [1-p] + p\\right) = [1-p] p.\n\\end{eqnarray}\nSo the theoretical standard deviation is $\\mathbb{s}[X_{i}]=\\sqrt{[1-p] p}$.\n:::\n\n\n\n\n:::{.callout-tip icon=false collapse=\"true\"}\nSuppose $X_{i}$ is a discrete random variable with this probability mass function: \n\\begin{eqnarray}\nX_{i} &=& \\begin{cases}\n-1 &  \\text{ with probability } \\frac{1}{2 \\lambda^2} \\\\\n0  & \\text{ with probability } 1-\\frac{1}{\\lambda^2} \\\\\n+1 & \\text{ with probability } \\frac{1}{2\\lambda^2} \n\\end{cases},\n\\end{eqnarray}\nwhere $\\lambda>0$ is a parameter. What is the theoretical standard deviation?\n:::\n\n\n:::{.callout-tip icon=false collapse=\"true\"}\nFor a discrete uniform random variable with th sample space $\\{1,2,3,4,5\\}$, calculate the theoretical median and IQR.\n:::\n\n\n#### **Weighted Data**. {-} \nSometimes, you may have a dataset of values and probability weights. Othertimes, you can calculate them yourself. In either case, you can explicitly do the computations for discrete data. Given data on unique outcome $x$ and their frequency $\\hat{p}_{x}=\\sum_{i=1}^{n}\\mathbf{1}\\left(X_{i}=x\\right)/n$, we compute \n\\begin{eqnarray}\n\\hat{M} &=& \\sum_{x} x \\hat{p}_{x}.\n\\end{eqnarray}\n\n\n:::{.callout-note icon=false collapse=\"true\"}\nSuppose we flipped a coin $100$ times and found that $76$ were heads and $23$ were tails. The estimated probabilities are $76/100$ for the outcome $X_{1}=1$ and $24/100$ for the outcome $X_{i}=0$. We compute the mean as $\\hat{M}=1\\times 0.76 + 0 \\times 0.24 = 0.76$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compute a sample estimate using probability weights\nP  <- table(X) #table of counts\np <- c(P)/length(X) #frequencies (must sum to 1)\nx <- as.numeric(names(p)) #unique values\ncbind(x,p)\n##   x     p\n## 0 0 0.263\n## 1 1 0.737\n\n# Sample Mean Estimate\nX_mean <- sum(x*p)\nX_mean\n## [1] 0.737\n```\n:::\n\n:::\n\n:::{.callout-tip icon=false collapse=\"true\"}\nTry estimating the sample mean the two different ways for another random sample\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- c(0,1,2)\nx_probs <- c(1/3,1/3,1/3)\nX  <-  sample(x, prob=x_probs, 1000, replace=T)\n\n# First Way (Computerized)\nmean(X)\n## [1] 1.018\n\n# Second Way (Explicit Calculations)\n# start with a table of counts like the previous example\n```\n:::\n\n:::\n\nThis idea generalizes the mean to a *weighted mean*: an average where different values contribute to the final result with varying levels of importance. For each outcome $x$ we have a weight $W_{x}$ and compute\n\\begin{eqnarray}\n\\hat{M} &=& \\frac{\\sum_{x} x W_{x}}{\\sum_{x} W_{x}} = \\sum_{x} x w_{x},\n\\end{eqnarray}\nwhere $w_{x}=\\frac{W_{x}}{\\sum_{x'} W_{x'}}$ is normalized version of $W_{x}$ that implies $\\sum_{x}w_{x}=1$.^[Note that if there are $K$ unique outcomes and $W_{x}=1$ then $\\sum_{x}W_{x}=K$ and $w_{x}=1/K$. This means $\\hat{M} = \\sum_{x} x w_{x} = \\sum_{x} x /K$, which is just a simple mean.]\n\n:::{.callout-note icon=false collapse=\"true\"}\nFor example, suppose a student has these scores\n\n::: {.cell}\n\n```{.r .cell-code}\nHomework1 <- c(score=88, weight=0.25)\nHomework2 <- c(score=92, weight=0.25)\nExam1 <- c(score=67, weight=0.2)\nExam2 <- c(score=90, weight=0.3)\n\nGrades <- rbind(Homework1, Homework2, Exam1, Exam2)\nGrades\n##           score weight\n## Homework1    88   0.25\n## Homework2    92   0.25\n## Exam1        67   0.20\n## Exam2        90   0.30\n```\n:::\n\n\nWe can compute the final grade as a weighted mean\n\n::: {.cell}\n\n```{.r .cell-code}\n# Manual Way\n88*0.25 + 92*0.25 + 67*0.2 + 90*0.3\n## [1] 85.4\n\n# Computerized Way\nValues <- Grades[,'score'] * Grades[,'weight']\nFinalGrade <- sum(Values)\nFinalGrade\n## [1] 85.4\n```\n:::\n\n:::\n\n\nThe weighting idea generalizes to other statistics. E.g., we can also computed a weighted variance or weighted quantile. \n\n:::{.callout-tip icon=false collapse=\"false\"}\nProvide an example of computing a weighted variance building on this code below\n\n::: {.cell}\n\n```{.r .cell-code}\nx_diff <- (x - x_mean)^2\np <- P/sum(P)\nx_var <- sum(p * x_diff)\n```\n:::\n\n\nSee that we can also compute weighted quantiles\n\n::: {.cell}\n\n```{.r .cell-code}\nweighted.quantile <- function(x, w, probs){\n    #See spatstat.univar::weighted.quantile\n    oo <- order(x)\n    x <- x[oo]\n    w <- w[oo]\n    Fx <- cumsum(w)/sum(w)\n    quantile_id <- max(which(Fx <= probs))+1\n    xq <- x[quantile_id] \n    return(xq)\n}\n\n## Unweighted\nquantile(X, probs=.5)\n## 50% \n##   1\nweights <- rep(1, length(X))\nweighted.quantile(x=X, w=weights, probs=.5)\n## [1] 1\n\n## Weighted\nweights <- seq(X)\nweights <- weights/sum(weights) # normalize\nweighted.quantile(x=X, w=weights, probs=.5)\n## [1] 1\n```\n:::\n\n:::\n\n\n\n#### **Continuous Random Variables**. {-}\n\nMany continuous random variables are parameterized by their means and variances. For example, the exponential distribution has parameter $\\lambda$, which corresponds to the theoretical mean $1/\\lambda$ and variance $1/\\lambda^2$. For another example, the two parameters of the normal distribution are $\\mu$ and $\\sigma$, which corresponds to the theoretical mean and variance. \n\n::: {.cell}\n\n```{.r .cell-code}\n# Exponential Random Variable\nX <- rexp(5000, 2)\nm <- mean(X)\nround(m, 2)\n## [1] 0.49\n\n# Normal Random Variable\nX <- rnorm(5000, 1, 2)\nround(mean(X), 2)\n## [1] 1\nround(var(X), 2)\n## [1] 3.95\n```\n:::\n\n\n<details>\n<summary> Advanced and Optional </summary>\n  <p>\nIf the sample space is continuous, we can compute the theoretical mean (or expected value) as\n\\begin{eqnarray}\n\\mathbb{E}[X] = \\int x f(x) d x,\n\\end{eqnarray}\nwhere $f(x)$ is the probability the random variable takes the particular value $x$. Similarly, we can compute the theoretical variance as\n\\begin{eqnarray}\n\\mathbb{V}[X_{i}]= \\int \\left(x - \\mathbb{E}[X_{i}] \\right)^2 f(x) d x,\n\\end{eqnarray}\n\nFor example, consider a random variable with a continuous uniform distribution over $[-1, 1]$. In this case, $f(x)=1/[1 - (-1)]=1/2$ for each $x \\in [-1, 1]$ and \n\\begin{eqnarray}\n\\mathbb{E}[X_{i}] = \\int_{-1}^{1} \\frac{x}{2} d x = \\int_{-1}^{0} \\frac{x}{2} d x + \\int_{0}^{1} \\frac{x}{2} d x = 0\n\\end{eqnarray}\nand \n\\begin{eqnarray}\n\\mathbb{V}[X_{i}]= \\int_{-1}^{1} x^2 \\frac{1}{2} d x = \\frac{1}{2} \\frac{x^3}{3}|_{-1}^{1} = \\frac{1}{6}[1 - (-1)] = 2/6 =1/3\n\\end{eqnarray}\n\n::: {.cell}\n\n```{.r .cell-code}\nX <- USArrests[,'Murder']\nround( mean(X), 4)\n## [1] 7.788\nround( var(X), 4)\n## [1] 18.9705\n```\n:::\n\n:::{.callout-tip icon=false collapse=\"false\"}\nYou can estimate means and variances for continuous random variables with weights, but here we have an additional approximation error\n\n::: {.cell}\n\n```{.r .cell-code}\n# values and probabilities\nh  <- hist(X, plot=F)\nwt <- h[['counts']]/length(X) \nxt <- h[['mids']]\n# Weighted mean\nX_mean <- sum(wt*xt)\nX_mean\n## [1] 7.8\n\n# Compare to \"mean(x)\"\n```\n:::\n\n\nTry it yourself with \n\n::: {.cell}\n\n```{.r .cell-code}\nX <- runif(2000, -1, 1)\n```\n:::\n\n:::\n\n  </p>\n</details>\n\n## Further Reading\n\nProbability Theory\n\n* [Refresher] <https://www.khanacademy.org/math/statistics-probability/probability-library/basic-theoretical-probability/a/probability-the-basics>\n* <https://book.stat420.org/probability-and-statistics-in-r.html>\n* <https://bookdown.org/speegled/foundations-of-statistics/>\n* <https://math.dartmouth.edu/~prob/prob/prob.pdf>\n* <https://bookdown.org/probability/beta/discrete-random-variables.html>\n* <https://www.econometrics-with-r.org/2.1-random-variables-and-probability-distributions.html>\n* <https://probability4datascience.com/ch02.html>\n* <https://statsthinking21.github.io/statsthinking21-R-site/probability-in-r-with-lucy-king.html>\n* <https://bookdown.org/probability/statistics/>\n* <https://www.atmos.albany.edu/facstaff/timm/ATM315spring14/R/IPSUR.pdf>\n* <https://rc2e.com/probability>\n* <https://bookdown.org/probability/beta/>\n* <https://bookdown.org/a_shaker/STM1001_Topic_3/>\n* <https://bookdown.org/fsancier/bookdown-demo/>\n* <https://bookdown.org/kevin_davisross/probsim-book/>\n* <https://bookdown.org/machar1991/ITER/2-pt.html>\n* <https://www.atmos.albany.edu/facstaff/timm/ATM315spring14/R/IPSUR.pdf>\n* <https://math.dartmouth.edu/~prob/prob/prob.pdf>\n\nFor weighted statistics, see\n\n* <https://seismo.berkeley.edu/~kirchner/Toolkits/Toolkit_12.pdf>\n* <https://www.bookdown.org/rwnahhas/RMPH/survey-desc.html>\n\n",
    "supporting": [
      "01_05_Statistics_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}