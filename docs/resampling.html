<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 6 (Re)Sampling | Introductory Economic Statistics: Data-Driven Analysis in R</title>
  <meta name="description" content=" 6 (Re)Sampling | Introductory Economic Statistics: Data-Driven Analysis in R" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content=" 6 (Re)Sampling | Introductory Economic Statistics: Data-Driven Analysis in R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 6 (Re)Sampling | Introductory Economic Statistics: Data-Driven Analysis in R" />
  
  
  

<meta name="author" content="Jordan Adamson" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistics.html"/>
<link rel="next" href="hypothesis-tests.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="libs/core-js-2.5.3/shim.min.js"></script>
<script src="libs/react-18.2.0/react.min.js"></script>
<script src="libs/react-18.2.0/react-dom.min.js"></script>
<script src="libs/reactwidget-2.0.0/react-tools.js"></script>
<link href="libs/reactable-0.4.4/reactable.css" rel="stylesheet" />
<script src="libs/reactable-binding-0.4.4/reactable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li> </li>
<li class="divider"></li>
<li><a href="index.html#index" id="toc-index"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Introduction to Data Analysis</b></span></li>
<li class="chapter" data-level="1" data-path="first-steps.html"><a href="first-steps.html"><i class="fa fa-check"></i><b>1</b> First Steps</a>
<ul>
<li class="chapter" data-level="1.1" data-path="first-steps.html"><a href="first-steps.html#why-program-in-r"><i class="fa fa-check"></i><b>1.1</b> Why Program in R?</a></li>
<li class="chapter" data-level="1.2" data-path="first-steps.html"><a href="first-steps.html#first-steps-1"><i class="fa fa-check"></i><b>1.2</b> First Steps</a></li>
<li class="chapter" data-level="1.3" data-path="first-steps.html"><a href="first-steps.html#further-reading"><i class="fa fa-check"></i><b>1.3</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>2</b> Mathematics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="mathematics.html"><a href="mathematics.html#objects"><i class="fa fa-check"></i><b>2.1</b> Objects</a></li>
<li class="chapter" data-level="2.2" data-path="mathematics.html"><a href="mathematics.html#functions"><i class="fa fa-check"></i><b>2.2</b> Functions</a></li>
<li class="chapter" data-level="2.3" data-path="mathematics.html"><a href="mathematics.html#arrays"><i class="fa fa-check"></i><b>2.3</b> Arrays</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#types"><i class="fa fa-check"></i><b>3.1</b> Types</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#densities-and-distributions"><i class="fa fa-check"></i><b>3.2</b> Densities and Distributions</a></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#joint-distributions"><i class="fa fa-check"></i><b>3.3</b> Joint Distributions</a></li>
<li class="chapter" data-level="3.4" data-path="data.html"><a href="data.html#conditional-distributions"><i class="fa fa-check"></i><b>3.4</b> Conditional Distributions</a></li>
<li class="chapter" data-level="3.5" data-path="data.html"><a href="data.html#further-reading-1"><i class="fa fa-check"></i><b>3.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="random-variables.html"><a href="random-variables.html"><i class="fa fa-check"></i><b>4</b> Random Variables</a>
<ul>
<li class="chapter" data-level="4.1" data-path="random-variables.html"><a href="random-variables.html#discrete"><i class="fa fa-check"></i><b>4.1</b> Discrete</a></li>
<li class="chapter" data-level="4.2" data-path="random-variables.html"><a href="random-variables.html#continuous"><i class="fa fa-check"></i><b>4.2</b> Continuous</a></li>
<li class="chapter" data-level="4.3" data-path="random-variables.html"><a href="random-variables.html#drawing-samples"><i class="fa fa-check"></i><b>4.3</b> Drawing Samples</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>5</b> Statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="statistics.html"><a href="statistics.html#mean-and-variance"><i class="fa fa-check"></i><b>5.1</b> Mean and Variance</a></li>
<li class="chapter" data-level="5.2" data-path="statistics.html"><a href="statistics.html#other-centerspread-statistics"><i class="fa fa-check"></i><b>5.2</b> Other Center/Spread Statistics</a></li>
<li class="chapter" data-level="5.3" data-path="statistics.html"><a href="statistics.html#shape-statistics"><i class="fa fa-check"></i><b>5.3</b> Shape Statistics</a></li>
<li class="chapter" data-level="5.4" data-path="statistics.html"><a href="statistics.html#probability-theory"><i class="fa fa-check"></i><b>5.4</b> Probability Theory</a></li>
<li class="chapter" data-level="5.5" data-path="statistics.html"><a href="statistics.html#further-reading-2"><i class="fa fa-check"></i><b>5.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="resampling.html"><a href="resampling.html"><i class="fa fa-check"></i><b>6</b> (Re)Sampling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="resampling.html"><a href="resampling.html#sample-distributions"><i class="fa fa-check"></i><b>6.1</b> Sample Distributions</a></li>
<li class="chapter" data-level="6.2" data-path="resampling.html"><a href="resampling.html#intervals"><i class="fa fa-check"></i><b>6.2</b> Intervals</a></li>
<li class="chapter" data-level="6.3" data-path="resampling.html"><a href="resampling.html#resampling-1"><i class="fa fa-check"></i><b>6.3</b> Resampling</a></li>
<li class="chapter" data-level="6.4" data-path="resampling.html"><a href="resampling.html#further-reading-3"><i class="fa fa-check"></i><b>6.4</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html"><i class="fa fa-check"></i><b>7</b> Hypothesis Tests</a>
<ul>
<li class="chapter" data-level="7.1" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#basic-ideas"><i class="fa fa-check"></i><b>7.1</b> Basic Ideas</a></li>
<li class="chapter" data-level="7.2" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#default-statistics"><i class="fa fa-check"></i><b>7.2</b> Default Statistics</a></li>
<li class="chapter" data-level="7.3" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#two-sample-differences"><i class="fa fa-check"></i><b>7.3</b> Two-Sample Differences</a></li>
<li class="chapter" data-level="7.4" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#further-reading-4"><i class="fa fa-check"></i><b>7.4</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>8</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-analysis.html"><a href="data-analysis.html#beyond-basics"><i class="fa fa-check"></i><b>8.1</b> Beyond Basics</a></li>
<li class="chapter" data-level="8.2" data-path="data-analysis.html"><a href="data-analysis.html#inputs"><i class="fa fa-check"></i><b>8.2</b> Inputs</a></li>
<li class="chapter" data-level="8.3" data-path="data-analysis.html"><a href="data-analysis.html#outputs"><i class="fa fa-check"></i><b>8.3</b> Outputs</a></li>
<li class="chapter" data-level="8.4" data-path="data-analysis.html"><a href="data-analysis.html#r-markdown-reports"><i class="fa fa-check"></i><b>8.4</b> R-Markdown Reports</a></li>
<li class="chapter" data-level="8.5" data-path="data-analysis.html"><a href="data-analysis.html#further-reading-5"><i class="fa fa-check"></i><b>8.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bivariate-data.html"><a href="bivariate-data.html"><i class="fa fa-check"></i><b>9</b> Bivariate Data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="bivariate-data.html"><a href="bivariate-data.html#statistics-1"><i class="fa fa-check"></i><b>9.1</b> Statistics</a></li>
<li class="chapter" data-level="9.2" data-path="bivariate-data.html"><a href="bivariate-data.html#probability-theory-1"><i class="fa fa-check"></i><b>9.2</b> Probability Theory</a></li>
<li class="chapter" data-level="9.3" data-path="bivariate-data.html"><a href="bivariate-data.html#further-reading-6"><i class="fa fa-check"></i><b>9.3</b> Further Reading</a></li>
</ul></li>
<li class="part"><span><b>II Introduction to Linear Regression</b></span></li>
<li class="chapter" data-level="10" data-path="basic-regression.html"><a href="basic-regression.html"><i class="fa fa-check"></i><b>10</b> Basic Regression</a>
<ul>
<li class="chapter" data-level="10.1" data-path="basic-regression.html"><a href="basic-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>10.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="10.2" data-path="basic-regression.html"><a href="basic-regression.html#variability-estimates"><i class="fa fa-check"></i><b>10.2</b> Variability Estimates</a></li>
<li class="chapter" data-level="10.3" data-path="basic-regression.html"><a href="basic-regression.html#hypothesis-tests-1"><i class="fa fa-check"></i><b>10.3</b> Hypothesis Tests</a></li>
<li class="chapter" data-level="10.4" data-path="basic-regression.html"><a href="basic-regression.html#local-linear-regression"><i class="fa fa-check"></i><b>10.4</b> Local Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="intermediate-regression.html"><a href="intermediate-regression.html"><i class="fa fa-check"></i><b>11</b> Intermediate Regression</a>
<ul>
<li class="chapter" data-level="11.1" data-path="intermediate-regression.html"><a href="intermediate-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>11.1</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="11.2" data-path="intermediate-regression.html"><a href="intermediate-regression.html#factor-variables"><i class="fa fa-check"></i><b>11.2</b> Factor Variables</a></li>
<li class="chapter" data-level="11.3" data-path="intermediate-regression.html"><a href="intermediate-regression.html#variability-estimates-1"><i class="fa fa-check"></i><b>11.3</b> Variability Estimates</a></li>
<li class="chapter" data-level="11.4" data-path="intermediate-regression.html"><a href="intermediate-regression.html#hypothesis-tests-2"><i class="fa fa-check"></i><b>11.4</b> Hypothesis Tests</a></li>
<li class="chapter" data-level="11.5" data-path="intermediate-regression.html"><a href="intermediate-regression.html#further-reading-7"><i class="fa fa-check"></i><b>11.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html"><i class="fa fa-check"></i><b>12</b> Intermediate Regression II</a>
<ul>
<li class="chapter" data-level="12.1" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html#coefficient-interpretation"><i class="fa fa-check"></i><b>12.1</b> Coefficient Interpretation</a></li>
<li class="chapter" data-level="12.2" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html#diagnostics"><i class="fa fa-check"></i><b>12.2</b> Diagnostics</a></li>
<li class="chapter" data-level="12.3" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html#transformations"><i class="fa fa-check"></i><b>12.3</b> Transformations</a></li>
<li class="chapter" data-level="12.4" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html#regressograms"><i class="fa fa-check"></i><b>12.4</b> Regressograms</a></li>
<li class="chapter" data-level="12.5" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html#more-literature"><i class="fa fa-check"></i><b>12.5</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="observational-data.html"><a href="observational-data.html"><i class="fa fa-check"></i><b>13</b> Observational Data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="observational-data.html"><a href="observational-data.html#temporal-interdependence"><i class="fa fa-check"></i><b>13.1</b> Temporal Interdependence</a></li>
<li class="chapter" data-level="13.2" data-path="observational-data.html"><a href="observational-data.html#spatial-interdependence"><i class="fa fa-check"></i><b>13.2</b> Spatial Interdependence</a></li>
<li class="chapter" data-level="13.3" data-path="observational-data.html"><a href="observational-data.html#variable-interdependence"><i class="fa fa-check"></i><b>13.3</b> Variable Interdependence</a></li>
<li class="chapter" data-level="13.4" data-path="observational-data.html"><a href="observational-data.html#further-reading-8"><i class="fa fa-check"></i><b>13.4</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="experimental-data.html"><a href="experimental-data.html"><i class="fa fa-check"></i><b>14</b> Experimental Data</a>
<ul>
<li class="chapter" data-level="14.1" data-path="experimental-data.html"><a href="experimental-data.html#design-basics"><i class="fa fa-check"></i><b>14.1</b> Design Basics</a></li>
<li class="chapter" data-level="14.2" data-path="experimental-data.html"><a href="experimental-data.html#comparisons-over-time"><i class="fa fa-check"></i><b>14.2</b> Comparisons Over Time</a></li>
<li class="chapter" data-level="14.3" data-path="experimental-data.html"><a href="experimental-data.html#natural-experiments"><i class="fa fa-check"></i><b>14.3</b> “Natural” Experiments</a></li>
<li class="chapter" data-level="14.4" data-path="experimental-data.html"><a href="experimental-data.html#further-reading-9"><i class="fa fa-check"></i><b>14.4</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="data-scientism.html"><a href="data-scientism.html"><i class="fa fa-check"></i><b>15</b> Data Scientism</a>
<ul>
<li class="chapter" data-level="15.1" data-path="data-scientism.html"><a href="data-scientism.html#false-positives"><i class="fa fa-check"></i><b>15.1</b> False Positives</a></li>
<li class="chapter" data-level="15.2" data-path="data-scientism.html"><a href="data-scientism.html#spurious-regression"><i class="fa fa-check"></i><b>15.2</b> Spurious Regression</a></li>
<li class="chapter" data-level="15.3" data-path="data-scientism.html"><a href="data-scientism.html#spurious-causal-impacts"><i class="fa fa-check"></i><b>15.3</b> Spurious Causal Impacts</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="misc.-topics.html"><a href="misc.-topics.html"><i class="fa fa-check"></i><b>16</b> Misc. Topics</a>
<ul>
<li class="chapter" data-level="16.1" data-path="misc.-topics.html"><a href="misc.-topics.html#locally-linear-multiple-regression"><i class="fa fa-check"></i><b>16.1</b> Locally Linear Multiple Regression</a></li>
<li class="chapter" data-level="16.2" data-path="misc.-topics.html"><a href="misc.-topics.html#nonparametric-tests"><i class="fa fa-check"></i><b>16.2</b> Nonparametric Tests</a></li>
<li class="chapter" data-level="16.3" data-path="misc.-topics.html"><a href="misc.-topics.html#prediction"><i class="fa fa-check"></i><b>16.3</b> Prediction</a></li>
<li class="chapter" data-level="16.4" data-path="misc.-topics.html"><a href="misc.-topics.html#decision-theory"><i class="fa fa-check"></i><b>16.4</b> Decision Theory</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://sites.google.com/view/jordan-adamson" target="blank">Jordan Adamson</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introductory Economic Statistics: Data-Driven Analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="resampling" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number"> 6</span> (Re)Sampling<a href="resampling.html#resampling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<hr />
<div id="sample-distributions" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Sample Distributions<a href="resampling.html#sample-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <em>sampling distribution</em> of a statistic shows us how much a statistic varies from sample to sample.</p>
<p>For example, see how the mean varies from sample to sample to sample.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="resampling.html#cb85-1" tabindex="-1"></a><span class="co"># Three Sample Example</span></span>
<span id="cb85-2"><a href="resampling.html#cb85-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb85-3"><a href="resampling.html#cb85-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb85-4"><a href="resampling.html#cb85-4" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>) </span>
<span id="cb85-5"><a href="resampling.html#cb85-5" tabindex="-1"></a>    m <span class="ot">&lt;-</span>  <span class="fu">mean</span>(x)</span>
<span id="cb85-6"><a href="resampling.html#cb85-6" tabindex="-1"></a>    <span class="fu">hist</span>(x,</span>
<span id="cb85-7"><a href="resampling.html#cb85-7" tabindex="-1"></a>        <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span>.<span class="dv">1</span>), <span class="co">#for comparability</span></span>
<span id="cb85-8"><a href="resampling.html#cb85-8" tabindex="-1"></a>        <span class="at">main=</span><span class="cn">NA</span>, <span class="at">border=</span><span class="cn">NA</span>)</span>
<span id="cb85-9"><a href="resampling.html#cb85-9" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v=</span>m, <span class="at">col=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb85-10"><a href="resampling.html#cb85-10" tabindex="-1"></a>    <span class="fu">title</span>(<span class="fu">paste0</span>(<span class="st">&#39;mean= &#39;</span>, <span class="fu">round</span>(m,<span class="dv">2</span>)),  <span class="at">font.main=</span><span class="dv">1</span>)</span>
<span id="cb85-11"><a href="resampling.html#cb85-11" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<p>Examine the sampling distribution of the mean</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="resampling.html#cb86-1" tabindex="-1"></a>sample_means <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="cf">function</span>(i){</span>
<span id="cb86-2"><a href="resampling.html#cb86-2" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">runif</span>(<span class="dv">100</span>))</span>
<span id="cb86-3"><a href="resampling.html#cb86-3" tabindex="-1"></a>    <span class="fu">return</span>(m)</span>
<span id="cb86-4"><a href="resampling.html#cb86-4" tabindex="-1"></a>})</span>
<span id="cb86-5"><a href="resampling.html#cb86-5" tabindex="-1"></a><span class="fu">hist</span>(sample_means, <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb86-6"><a href="resampling.html#cb86-6" tabindex="-1"></a>    <span class="at">col=</span><span class="dv">2</span>, <span class="at">font.main=</span><span class="dv">1</span>,</span>
<span id="cb86-7"><a href="resampling.html#cb86-7" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;Sampling Distribution of the mean&#39;</span>)</span></code></pre></div>
</details>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
<p>In this figure, you see two the most profound results known in statistics</p>
<ul>
<li><em>Law of Large Numbers</em>: the sample mean is centered around the true mean.</li>
<li><em>Central Limit Theorem</em>: the sampling distribution of the mean is approximately standard normal.</li>
</ul>
<div id="central-limit-theorem." class="section level4 unnumbered hasAnchor">
<h4><strong>Central Limit Theorem</strong>.<a href="resampling.html#central-limit-theorem." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are actually many different variants of the central limit theorem, as it applies more generally: the sampling distribution of many statistics are standard normal. For example, examine the sampling distribution of the standard deviation.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="resampling.html#cb87-1" tabindex="-1"></a>three_sds <span class="ot">&lt;-</span> <span class="fu">c</span>(  <span class="fu">sd</span>(<span class="fu">runif</span>(<span class="dv">100</span>)),  <span class="fu">sd</span>(<span class="fu">runif</span>(<span class="dv">100</span>)),  <span class="fu">sd</span>(<span class="fu">runif</span>(<span class="dv">100</span>))  )</span>
<span id="cb87-2"><a href="resampling.html#cb87-2" tabindex="-1"></a>three_sds</span>
<span id="cb87-3"><a href="resampling.html#cb87-3" tabindex="-1"></a><span class="do">## [1] 0.2914321 0.2884851 0.2791886</span></span>
<span id="cb87-4"><a href="resampling.html#cb87-4" tabindex="-1"></a></span>
<span id="cb87-5"><a href="resampling.html#cb87-5" tabindex="-1"></a>sample_sds <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="cf">function</span>(i){</span>
<span id="cb87-6"><a href="resampling.html#cb87-6" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">sd</span>(<span class="fu">runif</span>(<span class="dv">100</span>))</span>
<span id="cb87-7"><a href="resampling.html#cb87-7" tabindex="-1"></a>    <span class="fu">return</span>(s)</span>
<span id="cb87-8"><a href="resampling.html#cb87-8" tabindex="-1"></a>})</span>
<span id="cb87-9"><a href="resampling.html#cb87-9" tabindex="-1"></a><span class="fu">hist</span>(sample_sds, <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb87-10"><a href="resampling.html#cb87-10" tabindex="-1"></a>    <span class="at">col=</span><span class="dv">4</span>, <span class="at">font.main=</span><span class="dv">1</span>,</span>
<span id="cb87-11"><a href="resampling.html#cb87-11" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;Sampling Distribution of the sd&#39;</span>)</span></code></pre></div>
</details>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<p>It is beyond this class to prove this result, but you should know that not all sampling distributions are standard normal. For example, examine the sampling distribution of the three main “order statistics”</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="resampling.html#cb88-1" tabindex="-1"></a><span class="co"># Create 300 samples, each with 1000 random uniform variables</span></span>
<span id="cb88-2"><a href="resampling.html#cb88-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">300</span>, <span class="cf">function</span>(i) <span class="fu">runif</span>(<span class="dv">1000</span>) )</span>
<span id="cb88-3"><a href="resampling.html#cb88-3" tabindex="-1"></a><span class="co"># Each row is a new sample</span></span>
<span id="cb88-4"><a href="resampling.html#cb88-4" tabindex="-1"></a><span class="fu">length</span>(x[<span class="dv">1</span>,])</span>
<span id="cb88-5"><a href="resampling.html#cb88-5" tabindex="-1"></a><span class="do">## [1] 300</span></span>
<span id="cb88-6"><a href="resampling.html#cb88-6" tabindex="-1"></a></span>
<span id="cb88-7"><a href="resampling.html#cb88-7" tabindex="-1"></a><span class="co"># Median looks normal, Maximum and Minumum do not!</span></span>
<span id="cb88-8"><a href="resampling.html#cb88-8" tabindex="-1"></a>xmin <span class="ot">&lt;-</span> <span class="fu">apply</span>(x,<span class="dv">1</span>,quantile, <span class="at">probs=</span><span class="dv">0</span>)</span>
<span id="cb88-9"><a href="resampling.html#cb88-9" tabindex="-1"></a>xmed <span class="ot">&lt;-</span> <span class="fu">apply</span>(x,<span class="dv">1</span>,quantile, <span class="at">probs=</span>.<span class="dv">5</span>)</span>
<span id="cb88-10"><a href="resampling.html#cb88-10" tabindex="-1"></a>xmax <span class="ot">&lt;-</span> <span class="fu">apply</span>(x,<span class="dv">1</span>,quantile, <span class="at">probs=</span><span class="dv">1</span>)</span>
<span id="cb88-11"><a href="resampling.html#cb88-11" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb88-12"><a href="resampling.html#cb88-12" tabindex="-1"></a><span class="fu">hist</span>(xmin, <span class="at">breaks=</span><span class="dv">100</span>, <span class="at">border=</span><span class="cn">NA</span>, <span class="at">main=</span><span class="st">&#39;Min&#39;</span>, <span class="at">font.main=</span><span class="dv">1</span>)</span>
<span id="cb88-13"><a href="resampling.html#cb88-13" tabindex="-1"></a><span class="fu">hist</span>(xmed, <span class="at">breaks=</span><span class="dv">100</span>, <span class="at">border=</span><span class="cn">NA</span>, <span class="at">main=</span><span class="st">&#39;Med&#39;</span>, <span class="at">font.main=</span><span class="dv">1</span>)</span>
<span id="cb88-14"><a href="resampling.html#cb88-14" tabindex="-1"></a><span class="fu">hist</span>(xmax, <span class="at">breaks=</span><span class="dv">100</span>, <span class="at">border=</span><span class="cn">NA</span>, <span class="at">main=</span><span class="st">&#39;Max&#39;</span>, <span class="at">font.main=</span><span class="dv">1</span>)</span>
<span id="cb88-15"><a href="resampling.html#cb88-15" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&#39;Sampling Distributions&#39;</span>, <span class="at">outer=</span>T, <span class="at">line=</span><span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
</details>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="resampling.html#cb89-1" tabindex="-1"></a><span class="co"># To explore, try any function!</span></span>
<span id="cb89-2"><a href="resampling.html#cb89-2" tabindex="-1"></a>fun_of_rv <span class="ot">&lt;-</span> <span class="cf">function</span>(f, <span class="at">n=</span><span class="dv">100</span>){</span>
<span id="cb89-3"><a href="resampling.html#cb89-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb89-4"><a href="resampling.html#cb89-4" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">f</span>(x)</span>
<span id="cb89-5"><a href="resampling.html#cb89-5" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb89-6"><a href="resampling.html#cb89-6" tabindex="-1"></a>}</span>
<span id="cb89-7"><a href="resampling.html#cb89-7" tabindex="-1"></a></span>
<span id="cb89-8"><a href="resampling.html#cb89-8" tabindex="-1"></a><span class="fu">fun_of_rv</span>( <span class="at">f=</span>mean )</span>
<span id="cb89-9"><a href="resampling.html#cb89-9" tabindex="-1"></a><span class="do">## [1] 0.4476911</span></span>
<span id="cb89-10"><a href="resampling.html#cb89-10" tabindex="-1"></a></span>
<span id="cb89-11"><a href="resampling.html#cb89-11" tabindex="-1"></a><span class="fu">fun_of_rv</span>( <span class="at">f=</span><span class="cf">function</span>(i){ <span class="fu">diff</span>(<span class="fu">range</span>(<span class="fu">exp</span>(i))) } )</span>
<span id="cb89-12"><a href="resampling.html#cb89-12" tabindex="-1"></a><span class="do">## [1] 1.685819</span></span></code></pre></div>
</details>
</div>
</div>
<div id="intervals" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Intervals<a href="resampling.html#intervals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Using either the bootstrap or jackknife distribution, we can calculate</p>
<ul>
<li><em>confidence interval:</em> range your statistic varies across different samples.</li>
<li><em>standard error</em>: variance of your statistic across different samples.</li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="resampling.html#cb90-1" tabindex="-1"></a>sample_means <span class="ot">&lt;-</span> <span class="fu">apply</span>(x,<span class="dv">1</span>,mean)</span>
<span id="cb90-2"><a href="resampling.html#cb90-2" tabindex="-1"></a><span class="co"># standard error</span></span>
<span id="cb90-3"><a href="resampling.html#cb90-3" tabindex="-1"></a><span class="fu">sd</span>(sample_means)</span>
<span id="cb90-4"><a href="resampling.html#cb90-4" tabindex="-1"></a><span class="do">## [1] 0.01673167</span></span></code></pre></div>
</details>
<p>Note that in some cases, you can estimate the standard error to get a confidence interval.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="resampling.html#cb91-1" tabindex="-1"></a>x00 <span class="ot">&lt;-</span> x[<span class="dv">1</span>,]</span>
<span id="cb91-2"><a href="resampling.html#cb91-2" tabindex="-1"></a><span class="co"># standard error</span></span>
<span id="cb91-3"><a href="resampling.html#cb91-3" tabindex="-1"></a>s00 <span class="ot">&lt;-</span> <span class="fu">sd</span>(x00)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(x00))</span>
<span id="cb91-4"><a href="resampling.html#cb91-4" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">mean</span>(x00) <span class="sc">+</span> <span class="fu">c</span>(<span class="fl">1.96</span>, <span class="sc">-</span><span class="fl">1.96</span>)<span class="sc">*</span>s00</span></code></pre></div>
</details>
<div id="confidence-interval." class="section level4 unnumbered hasAnchor">
<h4><strong>Confidence Interval</strong>.<a href="resampling.html#confidence-interval." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Compute the upper and lower quantiles of the sampling distribution.</p>
<p><em>Sample Mean</em>. We simulate the sampling distribution of the sample mean and construct a 90% confidence interval by taking the 5th and 95th percentiles of the simulated means. This gives an empirical estimate of the interval within which the true mean is expected to lie with 90% confidence, assuming repeated sampling.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="resampling.html#cb92-1" tabindex="-1"></a><span class="co"># Middle 90%</span></span>
<span id="cb92-2"><a href="resampling.html#cb92-2" tabindex="-1"></a>mq <span class="ot">&lt;-</span> <span class="fu">quantile</span>(sample_means, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">95</span>))</span>
<span id="cb92-3"><a href="resampling.html#cb92-3" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&#39;we are 90% confident that the mean is between &#39;</span>, </span>
<span id="cb92-4"><a href="resampling.html#cb92-4" tabindex="-1"></a>    <span class="fu">round</span>(mq[<span class="dv">1</span>],<span class="dv">2</span>), <span class="st">&#39; and &#39;</span>, <span class="fu">round</span>(mq[<span class="dv">2</span>],<span class="dv">2</span>) )</span>
<span id="cb92-5"><a href="resampling.html#cb92-5" tabindex="-1"></a><span class="do">## [1] &quot;we are 90% confident that the mean is between 0.47 and 0.53&quot;</span></span>
<span id="cb92-6"><a href="resampling.html#cb92-6" tabindex="-1"></a></span>
<span id="cb92-7"><a href="resampling.html#cb92-7" tabindex="-1"></a>bks <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">4</span>,.<span class="dv">6</span>,<span class="at">by=</span>.<span class="dv">001</span>)</span>
<span id="cb92-8"><a href="resampling.html#cb92-8" tabindex="-1"></a><span class="fu">hist</span>(sample_means, <span class="at">breaks=</span>bks, <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb92-9"><a href="resampling.html#cb92-9" tabindex="-1"></a>    <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">25</span>), <span class="at">font.main=</span><span class="dv">1</span>,</span>
<span id="cb92-10"><a href="resampling.html#cb92-10" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;Confidence Interval for the mean&#39;</span>)</span>
<span id="cb92-11"><a href="resampling.html#cb92-11" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>mq)</span></code></pre></div>
</details>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<p><em>Sample Percentile</em>. We repeat the process to estimate the 99th percentile for each sample. We then construct a 95% confidence interval for the 99th percentile estimator, using the 2.5th and 97.5th quantiles of these estimates.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="resampling.html#cb93-1" tabindex="-1"></a><span class="do">## Upper Percentile</span></span>
<span id="cb93-2"><a href="resampling.html#cb93-2" tabindex="-1"></a>sample_quants <span class="ot">&lt;-</span> <span class="fu">apply</span>(x,<span class="dv">1</span>,quantile, <span class="at">probs=</span>.<span class="dv">99</span>)</span>
<span id="cb93-3"><a href="resampling.html#cb93-3" tabindex="-1"></a></span>
<span id="cb93-4"><a href="resampling.html#cb93-4" tabindex="-1"></a><span class="co"># Middle 95% of estimates</span></span>
<span id="cb93-5"><a href="resampling.html#cb93-5" tabindex="-1"></a>mq <span class="ot">&lt;-</span> <span class="fu">quantile</span>(sample_quants, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>))</span>
<span id="cb93-6"><a href="resampling.html#cb93-6" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&#39;we are 95% confident that the upper percentile is between &#39;</span>, </span>
<span id="cb93-7"><a href="resampling.html#cb93-7" tabindex="-1"></a>    <span class="fu">round</span>(mq[<span class="dv">1</span>],<span class="dv">2</span>), <span class="st">&#39; and &#39;</span>, <span class="fu">round</span>(mq[<span class="dv">2</span>],<span class="dv">2</span>) )</span>
<span id="cb93-8"><a href="resampling.html#cb93-8" tabindex="-1"></a><span class="do">## [1] &quot;we are 95% confident that the upper percentile is between 0.97 and 1&quot;</span></span>
<span id="cb93-9"><a href="resampling.html#cb93-9" tabindex="-1"></a></span>
<span id="cb93-10"><a href="resampling.html#cb93-10" tabindex="-1"></a>bks <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">92</span>,<span class="dv">1</span>,<span class="at">by=</span>.<span class="dv">001</span>)</span>
<span id="cb93-11"><a href="resampling.html#cb93-11" tabindex="-1"></a><span class="fu">hist</span>(sample_quants, <span class="at">breaks=</span>bks, <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb93-12"><a href="resampling.html#cb93-12" tabindex="-1"></a>    <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">25</span>), <span class="at">font.main=</span><span class="dv">1</span>,</span>
<span id="cb93-13"><a href="resampling.html#cb93-13" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;95% Confidence Interval for the 99% percentile&#39;</span>)</span>
<span id="cb93-14"><a href="resampling.html#cb93-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>mq)</span></code></pre></div>
</details>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<p>Note that X% confidence intervals do not generally cover X% of the data. Those intervals are a type of prediction interval that is covered later. See also <a href="https://online.stat.psu.edu/stat200/lesson/4/4.4/4.4.2" class="uri">https://online.stat.psu.edu/stat200/lesson/4/4.4/4.4.2</a></p>
</div>
<div id="advanced-intervals." class="section level4 unnumbered hasAnchor">
<h4><strong>Advanced Intervals</strong>.<a href="resampling.html#advanced-intervals." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In many cases, we want a X% interval to mean that X% of the intervals we generate will contain the true mean. E.g., in repeated sampling, 50% of constructed confidence intervals are expected to contain the true population mean.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="resampling.html#cb94-1" tabindex="-1"></a><span class="co"># Theoretically: [-1 sd, +1 sd] has 2/3 coverage</span></span>
<span id="cb94-2"><a href="resampling.html#cb94-2" tabindex="-1"></a></span>
<span id="cb94-3"><a href="resampling.html#cb94-3" tabindex="-1"></a><span class="co"># Confidence Interval for each sample</span></span>
<span id="cb94-4"><a href="resampling.html#cb94-4" tabindex="-1"></a>xq <span class="ot">&lt;-</span> <span class="fu">apply</span>(x,<span class="dv">1</span>, <span class="cf">function</span>(r){ <span class="co">#theoretical se&#39;s </span></span>
<span id="cb94-5"><a href="resampling.html#cb94-5" tabindex="-1"></a>    <span class="fu">mean</span>(r) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">*</span><span class="fu">sd</span>(r)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(r))</span>
<span id="cb94-6"><a href="resampling.html#cb94-6" tabindex="-1"></a>})</span>
<span id="cb94-7"><a href="resampling.html#cb94-7" tabindex="-1"></a><span class="co"># First 4 interval estimates</span></span>
<span id="cb94-8"><a href="resampling.html#cb94-8" tabindex="-1"></a>xq[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb94-9"><a href="resampling.html#cb94-9" tabindex="-1"></a><span class="do">##           [,1]      [,2]      [,3]     [,4]</span></span>
<span id="cb94-10"><a href="resampling.html#cb94-10" tabindex="-1"></a><span class="do">## [1,] 0.4636191 0.4807875 0.5048761 0.489175</span></span>
<span id="cb94-11"><a href="resampling.html#cb94-11" tabindex="-1"></a><span class="do">## [2,] 0.4958163 0.5140642 0.5378481 0.522204</span></span>
<span id="cb94-12"><a href="resampling.html#cb94-12" tabindex="-1"></a></span>
<span id="cb94-13"><a href="resampling.html#cb94-13" tabindex="-1"></a><span class="co"># Explicit calculation</span></span>
<span id="cb94-14"><a href="resampling.html#cb94-14" tabindex="-1"></a>mu_true <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb94-15"><a href="resampling.html#cb94-15" tabindex="-1"></a><span class="co"># Logical vector: whether the true mean is in each CI</span></span>
<span id="cb94-16"><a href="resampling.html#cb94-16" tabindex="-1"></a>covered <span class="ot">&lt;-</span> mu_true <span class="sc">&gt;=</span> xq[<span class="dv">1</span>, ] <span class="sc">&amp;</span> mu_true <span class="sc">&lt;=</span> xq[<span class="dv">2</span>, ]</span>
<span id="cb94-17"><a href="resampling.html#cb94-17" tabindex="-1"></a><span class="co"># Empirical coverage rate</span></span>
<span id="cb94-18"><a href="resampling.html#cb94-18" tabindex="-1"></a>coverage_rate <span class="ot">&lt;-</span> <span class="fu">mean</span>(covered)</span>
<span id="cb94-19"><a href="resampling.html#cb94-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Estimated coverage probability: %.2f%%</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="dv">100</span> <span class="sc">*</span> coverage_rate))</span>
<span id="cb94-20"><a href="resampling.html#cb94-20" tabindex="-1"></a><span class="do">## Estimated coverage probability: 67.30%</span></span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="resampling.html#cb95-1" tabindex="-1"></a><span class="co"># Visualize first N confidence intervals</span></span>
<span id="cb95-2"><a href="resampling.html#cb95-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb95-3"><a href="resampling.html#cb95-3" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb95-4"><a href="resampling.html#cb95-4" tabindex="-1"></a><span class="fu">plot.window</span>(<span class="at">xlim =</span> <span class="fu">range</span>(xq), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, N))</span>
<span id="cb95-5"><a href="resampling.html#cb95-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb95-6"><a href="resampling.html#cb95-6" tabindex="-1"></a>  col_i <span class="ot">&lt;-</span> <span class="cf">if</span> (covered[i]) <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>) <span class="cf">else</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb95-7"><a href="resampling.html#cb95-7" tabindex="-1"></a>  <span class="fu">segments</span>(xq[<span class="dv">1</span>, i], i, xq[<span class="dv">2</span>, i], i, <span class="at">col =</span> col_i, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb95-8"><a href="resampling.html#cb95-8" tabindex="-1"></a>}</span>
<span id="cb95-9"><a href="resampling.html#cb95-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> mu_true, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb95-10"><a href="resampling.html#cb95-10" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>)</span>
<span id="cb95-11"><a href="resampling.html#cb95-11" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Visualizing CI Coverage (Red = Missed)&quot;</span>)</span></code></pre></div>
</details>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
<p>This differs from a <strong>pointwise inclusion frequency interval</strong></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="resampling.html#cb96-1" tabindex="-1"></a><span class="co"># Frequency each point was in an interval</span></span>
<span id="cb96-2"><a href="resampling.html#cb96-2" tabindex="-1"></a>bks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span>.<span class="dv">01</span>)</span>
<span id="cb96-3"><a href="resampling.html#cb96-3" tabindex="-1"></a>xcovr <span class="ot">&lt;-</span> <span class="fu">sapply</span>(bks, <span class="cf">function</span>(b){</span>
<span id="cb96-4"><a href="resampling.html#cb96-4" tabindex="-1"></a>    bl <span class="ot">&lt;-</span> b <span class="sc">&gt;=</span> xq[<span class="dv">1</span>,]</span>
<span id="cb96-5"><a href="resampling.html#cb96-5" tabindex="-1"></a>    bu <span class="ot">&lt;-</span> b <span class="sc">&lt;=</span> xq[<span class="dv">2</span>,]</span>
<span id="cb96-6"><a href="resampling.html#cb96-6" tabindex="-1"></a>    <span class="fu">mean</span>( bl <span class="sc">&amp;</span> bu )</span>
<span id="cb96-7"><a href="resampling.html#cb96-7" tabindex="-1"></a>})</span>
<span id="cb96-8"><a href="resampling.html#cb96-8" tabindex="-1"></a><span class="co"># 50\% Coverage</span></span>
<span id="cb96-9"><a href="resampling.html#cb96-9" tabindex="-1"></a>c_ul <span class="ot">&lt;-</span> <span class="fu">range</span>(bks[xcovr<span class="sc">&gt;=</span>.<span class="dv">5</span>])</span>
<span id="cb96-10"><a href="resampling.html#cb96-10" tabindex="-1"></a>c_ul <span class="co"># 50% confidence interval</span></span>
<span id="cb96-11"><a href="resampling.html#cb96-11" tabindex="-1"></a><span class="do">## [1] 0.49 0.51</span></span>
<span id="cb96-12"><a href="resampling.html#cb96-12" tabindex="-1"></a></span>
<span id="cb96-13"><a href="resampling.html#cb96-13" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb96-14"><a href="resampling.html#cb96-14" tabindex="-1"></a><span class="fu">plot.window</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb96-15"><a href="resampling.html#cb96-15" tabindex="-1"></a><span class="fu">polygon</span>( <span class="fu">c</span>(bks, <span class="fu">rev</span>(bks)), <span class="fu">c</span>(xcovr, xcovr<span class="sc">*</span><span class="dv">0</span>), <span class="at">col=</span><span class="fu">grey</span>(.<span class="dv">5</span>,.<span class="dv">5</span>), <span class="at">border=</span><span class="cn">NA</span>)</span>
<span id="cb96-16"><a href="resampling.html#cb96-16" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;Frequency each value was in an interval&#39;</span>,<span class="dv">2</span>, <span class="at">line=</span><span class="fl">2.5</span>)</span>
<span id="cb96-17"><a href="resampling.html#cb96-17" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>)</span>
<span id="cb96-18"><a href="resampling.html#cb96-18" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb96-19"><a href="resampling.html#cb96-19" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>.<span class="dv">5</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb96-20"><a href="resampling.html#cb96-20" tabindex="-1"></a><span class="fu">segments</span>(c_ul,<span class="dv">0</span>,c_ul,.<span class="dv">5</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
</details>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>
</div>
</div>
<div id="resampling-1" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Resampling<a href="resampling.html#resampling-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Often, we only have one sample. How then can we estimate the sampling distribution of a statistic?</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="resampling.html#cb97-1" tabindex="-1"></a>sample_dat <span class="ot">&lt;-</span> USArrests<span class="sc">$</span>Murder</span>
<span id="cb97-2"><a href="resampling.html#cb97-2" tabindex="-1"></a><span class="fu">mean</span>(sample_dat)</span>
<span id="cb97-3"><a href="resampling.html#cb97-3" tabindex="-1"></a><span class="do">## [1] 7.788</span></span></code></pre></div>
</details>
<p>We can “resample” our data. <em>Hesterberg (2015)</em> provides a nice illustration of the idea. The two most basic versions are the jackknife and the bootstrap, which are discussed below.</p>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<div id="jackknife-distribution." class="section level4 unnumbered hasAnchor">
<h4><strong>Jackknife Distribution</strong>.<a href="resampling.html#jackknife-distribution." class="anchor-section" aria-label="Anchor link to header"></a></h4>
Here, we compute all “leave-one-out” estimates. Specifically, for a dataset with <span class="math inline">\(n\)</span> observations, the jackknife uses <span class="math inline">\(n-1\)</span> observations other than <span class="math inline">\(i\)</span> for each unique subsample. Taking the mean, for example, we have
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="resampling.html#cb98-1" tabindex="-1"></a>sample_dat <span class="ot">&lt;-</span> USArrests<span class="sc">$</span>Murder</span>
<span id="cb98-2"><a href="resampling.html#cb98-2" tabindex="-1"></a>sample_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample_dat)</span>
<span id="cb98-3"><a href="resampling.html#cb98-3" tabindex="-1"></a></span>
<span id="cb98-4"><a href="resampling.html#cb98-4" tabindex="-1"></a><span class="co"># Jackknife Estimates</span></span>
<span id="cb98-5"><a href="resampling.html#cb98-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(sample_dat)</span>
<span id="cb98-6"><a href="resampling.html#cb98-6" tabindex="-1"></a>Jmeans <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="cb98-7"><a href="resampling.html#cb98-7" tabindex="-1"></a>    dati <span class="ot">&lt;-</span> sample_dat[<span class="sc">-</span>i]</span>
<span id="cb98-8"><a href="resampling.html#cb98-8" tabindex="-1"></a>    <span class="fu">mean</span>(dati)</span>
<span id="cb98-9"><a href="resampling.html#cb98-9" tabindex="-1"></a>})</span>
<span id="cb98-10"><a href="resampling.html#cb98-10" tabindex="-1"></a><span class="fu">hist</span>(Jmeans, <span class="at">breaks=</span><span class="dv">25</span>, <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb98-11"><a href="resampling.html#cb98-11" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;&#39;</span>, <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">bar</span>(X)[<span class="sc">-</span>i]))</span>
<span id="cb98-12"><a href="resampling.html#cb98-12" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>sample_mean, <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
</details>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
</div>
<div id="bootstrap-distribution." class="section level4 unnumbered hasAnchor">
<h4><strong>Bootstrap Distribution</strong>.<a href="resampling.html#bootstrap-distribution." class="anchor-section" aria-label="Anchor link to header"></a></h4>
Here, we draw <span class="math inline">\(n\)</span> observations with replacement from the original data to create a bootstrap sample and calculate a statistic. Each bootstrap sample <span class="math inline">\(b=1...B\)</span> uses a random set of observations (denoted <span class="math inline">\(N_{b}\)</span>) to compute a statistic. We repeat that many times, say <span class="math inline">\(B=9999\)</span>, to estimate the sampling distribution. Consider the sample mean as an example;
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="resampling.html#cb99-1" tabindex="-1"></a><span class="co"># Bootstrap estimates</span></span>
<span id="cb99-2"><a href="resampling.html#cb99-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb99-3"><a href="resampling.html#cb99-3" tabindex="-1"></a>Bmeans <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="cf">function</span>(i) {</span>
<span id="cb99-4"><a href="resampling.html#cb99-4" tabindex="-1"></a>    dat_b <span class="ot">&lt;-</span> <span class="fu">sample</span>(sample_dat, <span class="at">replace=</span>T) <span class="co"># c.f. jackknife</span></span>
<span id="cb99-5"><a href="resampling.html#cb99-5" tabindex="-1"></a>    <span class="fu">mean</span>(dat_b)</span>
<span id="cb99-6"><a href="resampling.html#cb99-6" tabindex="-1"></a>})</span>
<span id="cb99-7"><a href="resampling.html#cb99-7" tabindex="-1"></a></span>
<span id="cb99-8"><a href="resampling.html#cb99-8" tabindex="-1"></a><span class="fu">hist</span>(Bmeans, <span class="at">breaks=</span><span class="dv">25</span>, <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb99-9"><a href="resampling.html#cb99-9" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;&#39;</span>, <span class="at">xlab=</span><span class="fu">expression</span>(<span class="fu">bar</span>(X)[b]))</span>
<span id="cb99-10"><a href="resampling.html#cb99-10" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>sample_mean, <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
</details>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<p><strong>Caveat</strong>. Note that we do not use the mean of the bootstrap or jackknife statistics as a replacement for the original estimate. This is because the bootstrap and jackknife distributions are centered at the observed statistic, not the population parameter. (The bootstrapped mean is centered at the sample mean, not the population mean.) This means that we cannot use the bootstrap to improve on <span class="math inline">\(\overline{x}\)</span>; no matter how many bootstrap samples we take. We can, however, use the jackknife and bootstrap to estimate sampling variability.</p>
</div>
<div id="intervals." class="section level4 unnumbered hasAnchor">
<h4><strong>Intervals</strong>.<a href="resampling.html#intervals." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Note that both methods provide imperfect estimates, and can give different numbers. Percentiles of jackknife resamples are systematically less variable than they should be. Until you know more, a conservative approach is to take the larger estimate.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="resampling.html#cb100-1" tabindex="-1"></a><span class="co"># Boot CI</span></span>
<span id="cb100-2"><a href="resampling.html#cb100-2" tabindex="-1"></a>boot_ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Bmeans, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span>
<span id="cb100-3"><a href="resampling.html#cb100-3" tabindex="-1"></a>boot_ci</span>
<span id="cb100-4"><a href="resampling.html#cb100-4" tabindex="-1"></a><span class="do">##    2.5%   97.5% </span></span>
<span id="cb100-5"><a href="resampling.html#cb100-5" tabindex="-1"></a><span class="do">## 6.58200 8.97005</span></span>
<span id="cb100-6"><a href="resampling.html#cb100-6" tabindex="-1"></a></span>
<span id="cb100-7"><a href="resampling.html#cb100-7" tabindex="-1"></a><span class="co"># Jack CI</span></span>
<span id="cb100-8"><a href="resampling.html#cb100-8" tabindex="-1"></a>jack_ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Jmeans, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span>
<span id="cb100-9"><a href="resampling.html#cb100-9" tabindex="-1"></a>jack_ci</span>
<span id="cb100-10"><a href="resampling.html#cb100-10" tabindex="-1"></a><span class="do">##     2.5%    97.5% </span></span>
<span id="cb100-11"><a href="resampling.html#cb100-11" tabindex="-1"></a><span class="do">## 7.621582 7.904082</span></span>
<span id="cb100-12"><a href="resampling.html#cb100-12" tabindex="-1"></a></span>
<span id="cb100-13"><a href="resampling.html#cb100-13" tabindex="-1"></a><span class="co"># more conservative estimate</span></span>
<span id="cb100-14"><a href="resampling.html#cb100-14" tabindex="-1"></a>ci_est <span class="ot">&lt;-</span> boot_ci</span></code></pre></div>
</details>
<p>Also note that the <em>standard deviation</em> refers to variance within a single sample, and is hence different from the standard error. Nonetheless, they can both be used to estimate the variability of a statistic.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="resampling.html#cb101-1" tabindex="-1"></a>boot_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(Bmeans)</span>
<span id="cb101-2"><a href="resampling.html#cb101-2" tabindex="-1"></a></span>
<span id="cb101-3"><a href="resampling.html#cb101-3" tabindex="-1"></a>sample_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(sample_dat)</span>
<span id="cb101-4"><a href="resampling.html#cb101-4" tabindex="-1"></a></span>
<span id="cb101-5"><a href="resampling.html#cb101-5" tabindex="-1"></a><span class="fu">c</span>(boot_se, sample_sd<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb101-6"><a href="resampling.html#cb101-6" tabindex="-1"></a><span class="do">## [1] 0.6056902 0.6159621</span></span></code></pre></div>
</details>
</div>
<div id="value-of-more-data." class="section level4 unnumbered hasAnchor">
<h4><strong>Value of More Data</strong>.<a href="resampling.html#value-of-more-data." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Each additional data point you have provides more information, which ultimately decreases the standard error of your estimates. However, it does so at a decreasing rate (known in economics as diminishing returns).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="resampling.html#cb102-1" tabindex="-1"></a>Nseq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>, <span class="at">by=</span><span class="dv">1</span>) <span class="co"># Sample sizes</span></span>
<span id="cb102-2"><a href="resampling.html#cb102-2" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># Number of draws per sample</span></span>
<span id="cb102-3"><a href="resampling.html#cb102-3" tabindex="-1"></a></span>
<span id="cb102-4"><a href="resampling.html#cb102-4" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Nseq, <span class="cf">function</span>(n){</span>
<span id="cb102-5"><a href="resampling.html#cb102-5" tabindex="-1"></a>    sample_statistics <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>B, <span class="cf">function</span>(b){</span>
<span id="cb102-6"><a href="resampling.html#cb102-6" tabindex="-1"></a>        x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n) <span class="co"># Sample of size N</span></span>
<span id="cb102-7"><a href="resampling.html#cb102-7" tabindex="-1"></a>        <span class="fu">quantile</span>(x,<span class="at">probs=</span>.<span class="dv">4</span>) <span class="co"># Statistic</span></span>
<span id="cb102-8"><a href="resampling.html#cb102-8" tabindex="-1"></a>    })</span>
<span id="cb102-9"><a href="resampling.html#cb102-9" tabindex="-1"></a>    <span class="fu">sd</span>(sample_statistics)</span>
<span id="cb102-10"><a href="resampling.html#cb102-10" tabindex="-1"></a>})</span>
<span id="cb102-11"><a href="resampling.html#cb102-11" tabindex="-1"></a></span>
<span id="cb102-12"><a href="resampling.html#cb102-12" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb102-13"><a href="resampling.html#cb102-13" tabindex="-1"></a><span class="fu">plot</span>(Nseq, SE, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">5</span>),</span>
<span id="cb102-14"><a href="resampling.html#cb102-14" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;Absolute Gain&#39;</span>, <span class="at">font.main=</span><span class="dv">1</span>,</span>
<span id="cb102-15"><a href="resampling.html#cb102-15" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&#39;standard error&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;sample size&#39;</span>)</span>
<span id="cb102-16"><a href="resampling.html#cb102-16" tabindex="-1"></a><span class="fu">plot</span>(Nseq[<span class="sc">-</span><span class="dv">1</span>], <span class="fu">abs</span>(<span class="fu">diff</span>(SE)), <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">5</span>),</span>
<span id="cb102-17"><a href="resampling.html#cb102-17" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;Marginal Gain&#39;</span>, <span class="at">font.main=</span><span class="dv">1</span>,</span>
<span id="cb102-18"><a href="resampling.html#cb102-18" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">&#39;decrease in standard error&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;sample size&#39;</span>)</span></code></pre></div>
</details>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
</div>
</div>
<div id="further-reading-3" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Further Reading<a href="resampling.html#further-reading-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>See</p>
<ul>
<li><a href="https://www.r-bloggers.com/2025/02/bootstrap-vs-standard-error-confidence-intervals/" class="uri">https://www.r-bloggers.com/2025/02/bootstrap-vs-standard-error-confidence-intervals/</a></li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hypothesis-tests.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["index.pdf", "index.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
