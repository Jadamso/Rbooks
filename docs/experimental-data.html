<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 14 Experimental Data | Introductory Economic Statistics: Data-Driven Analysis in R</title>
  <meta name="description" content=" 14 Experimental Data | Introductory Economic Statistics: Data-Driven Analysis in R" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content=" 14 Experimental Data | Introductory Economic Statistics: Data-Driven Analysis in R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 14 Experimental Data | Introductory Economic Statistics: Data-Driven Analysis in R" />
  
  
  

<meta name="author" content="Jordan Adamson" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="observational-data.html"/>
<link rel="next" href="data-scientism.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="libs/core-js-2.5.3/shim.min.js"></script>
<script src="libs/react-18.2.0/react.min.js"></script>
<script src="libs/react-18.2.0/react-dom.min.js"></script>
<script src="libs/reactwidget-2.0.0/react-tools.js"></script>
<link href="libs/reactable-0.4.4/reactable.css" rel="stylesheet" />
<script src="libs/reactable-binding-0.4.4/reactable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li> </li>
<li class="divider"></li>
<li><a href="index.html#index" id="toc-index"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Introduction to Data Analysis</b></span></li>
<li class="chapter" data-level="1" data-path="first-steps.html"><a href="first-steps.html"><i class="fa fa-check"></i><b>1</b> First Steps</a>
<ul>
<li class="chapter" data-level="1.1" data-path="first-steps.html"><a href="first-steps.html#why-program-in-r"><i class="fa fa-check"></i><b>1.1</b> Why Program in R?</a></li>
<li class="chapter" data-level="1.2" data-path="first-steps.html"><a href="first-steps.html#first-steps-1"><i class="fa fa-check"></i><b>1.2</b> First Steps</a></li>
<li class="chapter" data-level="1.3" data-path="first-steps.html"><a href="first-steps.html#further-reading"><i class="fa fa-check"></i><b>1.3</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>2</b> Mathematics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="mathematics.html"><a href="mathematics.html#objects"><i class="fa fa-check"></i><b>2.1</b> Objects</a></li>
<li class="chapter" data-level="2.2" data-path="mathematics.html"><a href="mathematics.html#functions"><i class="fa fa-check"></i><b>2.2</b> Functions</a></li>
<li class="chapter" data-level="2.3" data-path="mathematics.html"><a href="mathematics.html#arrays"><i class="fa fa-check"></i><b>2.3</b> Arrays</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#types"><i class="fa fa-check"></i><b>3.1</b> Types</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#densities-and-distributions"><i class="fa fa-check"></i><b>3.2</b> Densities and Distributions</a></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#joint-distributions"><i class="fa fa-check"></i><b>3.3</b> Joint Distributions</a></li>
<li class="chapter" data-level="3.4" data-path="data.html"><a href="data.html#conditional-distributions"><i class="fa fa-check"></i><b>3.4</b> Conditional Distributions</a></li>
<li class="chapter" data-level="3.5" data-path="data.html"><a href="data.html#further-reading-1"><i class="fa fa-check"></i><b>3.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="random-variables.html"><a href="random-variables.html"><i class="fa fa-check"></i><b>4</b> Random Variables</a>
<ul>
<li class="chapter" data-level="4.1" data-path="random-variables.html"><a href="random-variables.html#discrete"><i class="fa fa-check"></i><b>4.1</b> Discrete</a></li>
<li class="chapter" data-level="4.2" data-path="random-variables.html"><a href="random-variables.html#continuous"><i class="fa fa-check"></i><b>4.2</b> Continuous</a></li>
<li class="chapter" data-level="4.3" data-path="random-variables.html"><a href="random-variables.html#drawing-samples"><i class="fa fa-check"></i><b>4.3</b> Drawing Samples</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>5</b> Statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="statistics.html"><a href="statistics.html#mean-and-variance"><i class="fa fa-check"></i><b>5.1</b> Mean and Variance</a></li>
<li class="chapter" data-level="5.2" data-path="statistics.html"><a href="statistics.html#other-centerspread-statistics"><i class="fa fa-check"></i><b>5.2</b> Other Center/Spread Statistics</a></li>
<li class="chapter" data-level="5.3" data-path="statistics.html"><a href="statistics.html#shape-statistics"><i class="fa fa-check"></i><b>5.3</b> Shape Statistics</a></li>
<li class="chapter" data-level="5.4" data-path="statistics.html"><a href="statistics.html#probability-theory"><i class="fa fa-check"></i><b>5.4</b> Probability Theory</a></li>
<li class="chapter" data-level="5.5" data-path="statistics.html"><a href="statistics.html#further-reading-2"><i class="fa fa-check"></i><b>5.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="resampling.html"><a href="resampling.html"><i class="fa fa-check"></i><b>6</b> (Re)Sampling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="resampling.html"><a href="resampling.html#sample-distributions"><i class="fa fa-check"></i><b>6.1</b> Sample Distributions</a></li>
<li class="chapter" data-level="6.2" data-path="resampling.html"><a href="resampling.html#intervals"><i class="fa fa-check"></i><b>6.2</b> Intervals</a></li>
<li class="chapter" data-level="6.3" data-path="resampling.html"><a href="resampling.html#resampling-1"><i class="fa fa-check"></i><b>6.3</b> Resampling</a></li>
<li class="chapter" data-level="6.4" data-path="resampling.html"><a href="resampling.html#further-reading-3"><i class="fa fa-check"></i><b>6.4</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html"><i class="fa fa-check"></i><b>7</b> Hypothesis Tests</a>
<ul>
<li class="chapter" data-level="7.1" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#basic-ideas"><i class="fa fa-check"></i><b>7.1</b> Basic Ideas</a></li>
<li class="chapter" data-level="7.2" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#default-statistics"><i class="fa fa-check"></i><b>7.2</b> Default Statistics</a></li>
<li class="chapter" data-level="7.3" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#two-sample-differences"><i class="fa fa-check"></i><b>7.3</b> Two-Sample Differences</a></li>
<li class="chapter" data-level="7.4" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#further-reading-4"><i class="fa fa-check"></i><b>7.4</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>8</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-analysis.html"><a href="data-analysis.html#beyond-basics"><i class="fa fa-check"></i><b>8.1</b> Beyond Basics</a></li>
<li class="chapter" data-level="8.2" data-path="data-analysis.html"><a href="data-analysis.html#inputs"><i class="fa fa-check"></i><b>8.2</b> Inputs</a></li>
<li class="chapter" data-level="8.3" data-path="data-analysis.html"><a href="data-analysis.html#outputs"><i class="fa fa-check"></i><b>8.3</b> Outputs</a></li>
<li class="chapter" data-level="8.4" data-path="data-analysis.html"><a href="data-analysis.html#r-markdown-reports"><i class="fa fa-check"></i><b>8.4</b> R-Markdown Reports</a></li>
<li class="chapter" data-level="8.5" data-path="data-analysis.html"><a href="data-analysis.html#further-reading-5"><i class="fa fa-check"></i><b>8.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bivariate-data.html"><a href="bivariate-data.html"><i class="fa fa-check"></i><b>9</b> Bivariate Data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="bivariate-data.html"><a href="bivariate-data.html#statistics-1"><i class="fa fa-check"></i><b>9.1</b> Statistics</a></li>
<li class="chapter" data-level="9.2" data-path="bivariate-data.html"><a href="bivariate-data.html#probability-theory-1"><i class="fa fa-check"></i><b>9.2</b> Probability Theory</a></li>
<li class="chapter" data-level="9.3" data-path="bivariate-data.html"><a href="bivariate-data.html#further-reading-6"><i class="fa fa-check"></i><b>9.3</b> Further Reading</a></li>
</ul></li>
<li class="part"><span><b>II Introduction to Linear Regression</b></span></li>
<li class="chapter" data-level="10" data-path="basic-regression.html"><a href="basic-regression.html"><i class="fa fa-check"></i><b>10</b> Basic Regression</a>
<ul>
<li class="chapter" data-level="10.1" data-path="basic-regression.html"><a href="basic-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>10.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="10.2" data-path="basic-regression.html"><a href="basic-regression.html#variability-estimates"><i class="fa fa-check"></i><b>10.2</b> Variability Estimates</a></li>
<li class="chapter" data-level="10.3" data-path="basic-regression.html"><a href="basic-regression.html#hypothesis-tests-1"><i class="fa fa-check"></i><b>10.3</b> Hypothesis Tests</a></li>
<li class="chapter" data-level="10.4" data-path="basic-regression.html"><a href="basic-regression.html#local-linear-regression"><i class="fa fa-check"></i><b>10.4</b> Local Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="intermediate-regression.html"><a href="intermediate-regression.html"><i class="fa fa-check"></i><b>11</b> Intermediate Regression</a>
<ul>
<li class="chapter" data-level="11.1" data-path="intermediate-regression.html"><a href="intermediate-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>11.1</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="11.2" data-path="intermediate-regression.html"><a href="intermediate-regression.html#factor-variables"><i class="fa fa-check"></i><b>11.2</b> Factor Variables</a></li>
<li class="chapter" data-level="11.3" data-path="intermediate-regression.html"><a href="intermediate-regression.html#variability-estimates-1"><i class="fa fa-check"></i><b>11.3</b> Variability Estimates</a></li>
<li class="chapter" data-level="11.4" data-path="intermediate-regression.html"><a href="intermediate-regression.html#hypothesis-tests-2"><i class="fa fa-check"></i><b>11.4</b> Hypothesis Tests</a></li>
<li class="chapter" data-level="11.5" data-path="intermediate-regression.html"><a href="intermediate-regression.html#further-reading-7"><i class="fa fa-check"></i><b>11.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html"><i class="fa fa-check"></i><b>12</b> Intermediate Regression II</a>
<ul>
<li class="chapter" data-level="12.1" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html#coefficient-interpretation"><i class="fa fa-check"></i><b>12.1</b> Coefficient Interpretation</a></li>
<li class="chapter" data-level="12.2" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html#diagnostics"><i class="fa fa-check"></i><b>12.2</b> Diagnostics</a></li>
<li class="chapter" data-level="12.3" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html#transformations"><i class="fa fa-check"></i><b>12.3</b> Transformations</a></li>
<li class="chapter" data-level="12.4" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html#regressograms"><i class="fa fa-check"></i><b>12.4</b> Regressograms</a></li>
<li class="chapter" data-level="12.5" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html#more-literature"><i class="fa fa-check"></i><b>12.5</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="observational-data.html"><a href="observational-data.html"><i class="fa fa-check"></i><b>13</b> Observational Data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="observational-data.html"><a href="observational-data.html#temporal-interdependence"><i class="fa fa-check"></i><b>13.1</b> Temporal Interdependence</a></li>
<li class="chapter" data-level="13.2" data-path="observational-data.html"><a href="observational-data.html#spatial-interdependence"><i class="fa fa-check"></i><b>13.2</b> Spatial Interdependence</a></li>
<li class="chapter" data-level="13.3" data-path="observational-data.html"><a href="observational-data.html#variable-interdependence"><i class="fa fa-check"></i><b>13.3</b> Variable Interdependence</a></li>
<li class="chapter" data-level="13.4" data-path="observational-data.html"><a href="observational-data.html#further-reading-8"><i class="fa fa-check"></i><b>13.4</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="experimental-data.html"><a href="experimental-data.html"><i class="fa fa-check"></i><b>14</b> Experimental Data</a>
<ul>
<li class="chapter" data-level="14.1" data-path="experimental-data.html"><a href="experimental-data.html#design-basics"><i class="fa fa-check"></i><b>14.1</b> Design Basics</a></li>
<li class="chapter" data-level="14.2" data-path="experimental-data.html"><a href="experimental-data.html#comparisons-over-time"><i class="fa fa-check"></i><b>14.2</b> Comparisons Over Time</a></li>
<li class="chapter" data-level="14.3" data-path="experimental-data.html"><a href="experimental-data.html#natural-experiments"><i class="fa fa-check"></i><b>14.3</b> “Natural” Experiments</a></li>
<li class="chapter" data-level="14.4" data-path="experimental-data.html"><a href="experimental-data.html#further-reading-9"><i class="fa fa-check"></i><b>14.4</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="data-scientism.html"><a href="data-scientism.html"><i class="fa fa-check"></i><b>15</b> Data Scientism</a>
<ul>
<li class="chapter" data-level="15.1" data-path="data-scientism.html"><a href="data-scientism.html#false-positives"><i class="fa fa-check"></i><b>15.1</b> False Positives</a></li>
<li class="chapter" data-level="15.2" data-path="data-scientism.html"><a href="data-scientism.html#spurious-regression"><i class="fa fa-check"></i><b>15.2</b> Spurious Regression</a></li>
<li class="chapter" data-level="15.3" data-path="data-scientism.html"><a href="data-scientism.html#spurious-causal-impacts"><i class="fa fa-check"></i><b>15.3</b> Spurious Causal Impacts</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="misc.-topics.html"><a href="misc.-topics.html"><i class="fa fa-check"></i><b>16</b> Misc. Topics</a>
<ul>
<li class="chapter" data-level="16.1" data-path="misc.-topics.html"><a href="misc.-topics.html#locally-linear-multiple-regression"><i class="fa fa-check"></i><b>16.1</b> Locally Linear Multiple Regression</a></li>
<li class="chapter" data-level="16.2" data-path="misc.-topics.html"><a href="misc.-topics.html#nonparametric-tests"><i class="fa fa-check"></i><b>16.2</b> Nonparametric Tests</a></li>
<li class="chapter" data-level="16.3" data-path="misc.-topics.html"><a href="misc.-topics.html#prediction"><i class="fa fa-check"></i><b>16.3</b> Prediction</a></li>
<li class="chapter" data-level="16.4" data-path="misc.-topics.html"><a href="misc.-topics.html#decision-theory"><i class="fa fa-check"></i><b>16.4</b> Decision Theory</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://sites.google.com/view/jordan-adamson" target="blank">Jordan Adamson</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introductory Economic Statistics: Data-Driven Analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="experimental-data" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number"> 14</span> Experimental Data<a href="experimental-data.html#experimental-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<hr />
<div id="design-basics" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> Design Basics<a href="experimental-data.html#design-basics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="control-and-randomize." class="section level4 unnumbered hasAnchor">
<h4><strong>Control and Randomize</strong>.<a href="experimental-data.html#control-and-randomize." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><em>Blocking</em> and <em>Clustering</em></p>
</div>
<div id="competitive-equilibrium-example." class="section level4 unnumbered hasAnchor">
<h4><strong>Competitive Equilibrium Example</strong>.<a href="experimental-data.html#competitive-equilibrium-example." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If you have exogenous variation on one side of the market, you can get information on the other. For example, lower costs shift out supply (more is produced at given price), allowing you to trace out part of a demand curve.</p>
<p>To see this, consider an experiment where student subjects are recruited to a classroom and randomly assigned to be either buyers or sellers in a market for little red balls. In this case, the classroom environment allows the experimenter to control for various factors (e.g., the temperature of the room is constant for all subjects) and the explicit randomization of subjects means that there are not typically systematic differences in different groups of students.</p>
<p>In the experiment, sellers are given linear “cost functions” that theoretically yield individual supplies like <span class="math inline">\(\eqref{eqn:market_supply}\)</span> and are paid “price - cost”. Buyers are given linear “benefit functions” that theoretically yield individual demands like <span class="math inline">\(\eqref{eqn:market_demand}\)</span>, and are paid “benefit - price”. The theoretical predictions are theorefore given in <span class="math inline">\(\eqref{eqn:market_supply}\)</span>. Moreover, experimental manipulation of <span class="math inline">\(A_{S}\)</span> leads to
<span class="math display">\[\begin{eqnarray}
\label{eqn:comp_market_statics}
\frac{d P^{*}}{d A_{S}} = \frac{-1}{B_{D}+B_{S}}, \\
\frac{d Q^{*}}{d A_{S}} = \frac{B_{D}}{B_{D}+B_{S}}.
\end{eqnarray}\]</span>
In this case, the supply shock has identified the demand slope: <span class="math inline">\(-B_{D}=d Q^{*}/d P^{*}\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="experimental-data.html#cb214-1" tabindex="-1"></a><span class="co"># New Observations After Cost Change</span></span>
<span id="cb214-2"><a href="experimental-data.html#cb214-2" tabindex="-1"></a>EQ2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(n){</span>
<span id="cb214-3"><a href="experimental-data.html#cb214-3" tabindex="-1"></a>    demand <span class="ot">&lt;-</span> <span class="fu">qd_fun</span>(P)</span>
<span id="cb214-4"><a href="experimental-data.html#cb214-4" tabindex="-1"></a>    supply2 <span class="ot">&lt;-</span> <span class="fu">qs_fun</span>(P, <span class="at">As=</span><span class="sc">-</span><span class="fl">6.5</span>) <span class="co"># More Supplied at Given Price</span></span>
<span id="cb214-5"><a href="experimental-data.html#cb214-5" tabindex="-1"></a>    eq <span class="ot">&lt;-</span> <span class="fu">eq_fun</span>(demand, supply2, P)</span>
<span id="cb214-6"><a href="experimental-data.html#cb214-6" tabindex="-1"></a>    <span class="fu">return</span>(eq)</span>
<span id="cb214-7"><a href="experimental-data.html#cb214-7" tabindex="-1"></a>    <span class="co"># lines(supply2, P, col=rgb(0,0,1,.01))</span></span>
<span id="cb214-8"><a href="experimental-data.html#cb214-8" tabindex="-1"></a>    <span class="co">#points(eq[2], eq[1], col=rgb(0,0,1,.05), pch=16)</span></span>
<span id="cb214-9"><a href="experimental-data.html#cb214-9" tabindex="-1"></a>})</span>
<span id="cb214-10"><a href="experimental-data.html#cb214-10" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(EQ2), <span class="at">cost=</span><span class="st">&#39;2&#39;</span>, <span class="at">T=</span>(<span class="dv">1</span><span class="sc">:</span>N) <span class="sc">+</span> N)</span>
<span id="cb214-11"><a href="experimental-data.html#cb214-11" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat1, dat2)</span>
<span id="cb214-12"><a href="experimental-data.html#cb214-12" tabindex="-1"></a></span>
<span id="cb214-13"><a href="experimental-data.html#cb214-13" tabindex="-1"></a><span class="co"># Plot Simulated Market Data</span></span>
<span id="cb214-14"><a href="experimental-data.html#cb214-14" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">as.numeric</span>(dat2<span class="sc">$</span>cost)<span class="sc">==</span><span class="dv">2</span>, <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">2</span>), <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">2</span>))</span>
<span id="cb214-15"><a href="experimental-data.html#cb214-15" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb214-16"><a href="experimental-data.html#cb214-16" tabindex="-1"></a><span class="fu">plot.window</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">ylim=</span><span class="fu">range</span>(P))</span>
<span id="cb214-17"><a href="experimental-data.html#cb214-17" tabindex="-1"></a><span class="fu">points</span>(dat2<span class="sc">$</span>Q, dat2<span class="sc">$</span>P, <span class="at">col=</span>cols, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb214-18"><a href="experimental-data.html#cb214-18" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>)</span>
<span id="cb214-19"><a href="experimental-data.html#cb214-19" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb214-20"><a href="experimental-data.html#cb214-20" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;Quantity&#39;</span>,<span class="dv">1</span>, <span class="at">line=</span><span class="dv">2</span>)</span>
<span id="cb214-21"><a href="experimental-data.html#cb214-21" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;Price&#39;</span>,<span class="dv">2</span>, <span class="at">line=</span><span class="dv">2</span>)</span></code></pre></div>
</details>
<p><img src="03-LinearRegression_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<p>If the function forms for supply and demand are different from what we predicted, we can still measure how much the experimental manipulation of production costs affects the equilibrium quantity sold (and compare that to what was predicted).<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></p>
</div>
</div>
<div id="comparisons-over-time" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> Comparisons Over Time<a href="experimental-data.html#comparisons-over-time" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="regression-discontinuitieskinks." class="section level4 unnumbered hasAnchor">
<h4><strong>Regression Discontinuities/Kinks</strong>.<a href="experimental-data.html#regression-discontinuitieskinks." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The basic idea of RDD/RKD is to examine how a variable changes just before and just after a treatment. RDD estimates the difference in the levels of an outcome variable, whereas RKD estimates the difference in the slope. Turning to our canonical competitive market example, the RDD estimate is the difference between the lines at <span class="math inline">\(T=300\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="experimental-data.html#cb215-1" tabindex="-1"></a><span class="co"># Locally Linear Regression </span></span>
<span id="cb215-2"><a href="experimental-data.html#cb215-2" tabindex="-1"></a><span class="co"># (Compare means near break)</span></span>
<span id="cb215-3"><a href="experimental-data.html#cb215-3" tabindex="-1"></a></span>
<span id="cb215-4"><a href="experimental-data.html#cb215-4" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">as.numeric</span>(dat2<span class="sc">$</span>cost)<span class="sc">==</span><span class="dv">2</span>, <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">5</span>), <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>))</span>
<span id="cb215-5"><a href="experimental-data.html#cb215-5" tabindex="-1"></a><span class="fu">plot</span>(P<span class="sc">~</span>T, dat2, <span class="at">main=</span><span class="st">&#39;Effect of Cost Shock on Price&#39;</span>, </span>
<span id="cb215-6"><a href="experimental-data.html#cb215-6" tabindex="-1"></a>    <span class="at">font.main=</span><span class="dv">1</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols)</span>
<span id="cb215-7"><a href="experimental-data.html#cb215-7" tabindex="-1"></a>regP1 <span class="ot">&lt;-</span> <span class="fu">loess</span>(P<span class="sc">~</span>T, dat2[dat2<span class="sc">$</span>cost<span class="sc">==</span><span class="dv">1</span>,]) </span>
<span id="cb215-8"><a href="experimental-data.html#cb215-8" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> regP1<span class="sc">$</span>x</span>
<span id="cb215-9"><a href="experimental-data.html#cb215-9" tabindex="-1"></a><span class="co">#lm(): x1 &lt;- regP1$model$T </span></span>
<span id="cb215-10"><a href="experimental-data.html#cb215-10" tabindex="-1"></a><span class="fu">lines</span>(x1, <span class="fu">predict</span>(regP1), <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb215-11"><a href="experimental-data.html#cb215-11" tabindex="-1"></a>regP2 <span class="ot">&lt;-</span> <span class="fu">loess</span>(P<span class="sc">~</span>T, dat2[dat2<span class="sc">$</span>cost<span class="sc">==</span><span class="dv">2</span>,])</span>
<span id="cb215-12"><a href="experimental-data.html#cb215-12" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> regP2<span class="sc">$</span>x <span class="co">#regP1$model$T</span></span>
<span id="cb215-13"><a href="experimental-data.html#cb215-13" tabindex="-1"></a><span class="fu">lines</span>(x2, <span class="fu">predict</span>(regP2), <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
</details>
<p><img src="03-LinearRegression_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="experimental-data.html#cb216-1" tabindex="-1"></a></span>
<span id="cb216-2"><a href="experimental-data.html#cb216-2" tabindex="-1"></a><span class="fu">plot</span>(Q<span class="sc">~</span>T, dat2, <span class="at">main=</span><span class="st">&#39;Effect of Cost Shock on Quantity&#39;</span>,</span>
<span id="cb216-3"><a href="experimental-data.html#cb216-3" tabindex="-1"></a>    <span class="at">font.main=</span><span class="dv">1</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols)</span>
<span id="cb216-4"><a href="experimental-data.html#cb216-4" tabindex="-1"></a>regQ1 <span class="ot">&lt;-</span> <span class="fu">loess</span>(Q<span class="sc">~</span>T, dat2[dat2<span class="sc">$</span>cost<span class="sc">==</span><span class="dv">1</span>,]) </span>
<span id="cb216-5"><a href="experimental-data.html#cb216-5" tabindex="-1"></a><span class="fu">lines</span>(x1, <span class="fu">predict</span>(regQ1), <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb216-6"><a href="experimental-data.html#cb216-6" tabindex="-1"></a>regQ2 <span class="ot">&lt;-</span> <span class="fu">loess</span>(Q<span class="sc">~</span>T, dat2[dat2<span class="sc">$</span>cost<span class="sc">==</span><span class="dv">2</span>,])</span>
<span id="cb216-7"><a href="experimental-data.html#cb216-7" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> regP2<span class="sc">$</span>x <span class="co">#regP1$model$T</span></span>
<span id="cb216-8"><a href="experimental-data.html#cb216-8" tabindex="-1"></a><span class="fu">lines</span>(x2, <span class="fu">predict</span>(regQ2), <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
</details>
<p><img src="03-LinearRegression_files/figure-html/unnamed-chunk-56-2.png" width="672" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="experimental-data.html#cb217-1" tabindex="-1"></a><span class="co"># Linear Regression Alternative</span></span>
<span id="cb217-2"><a href="experimental-data.html#cb217-2" tabindex="-1"></a>sub_id <span class="ot">&lt;-</span> (dat2<span class="sc">$</span>cost<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> dat2<span class="sc">$</span>T <span class="sc">&gt;</span> <span class="dv">250</span>) <span class="sc">|</span> (dat2<span class="sc">$</span>cost<span class="sc">==</span><span class="dv">2</span> <span class="sc">&amp;</span> dat2<span class="sc">$</span>T <span class="sc">&lt;</span> <span class="dv">300</span>)</span>
<span id="cb217-3"><a href="experimental-data.html#cb217-3" tabindex="-1"></a>dat2W <span class="ot">&lt;-</span> dat2[sub_id,  ]</span>
<span id="cb217-4"><a href="experimental-data.html#cb217-4" tabindex="-1"></a>regP <span class="ot">&lt;-</span> <span class="fu">lm</span>(P<span class="sc">~</span>T<span class="sc">*</span>cost, dat2)</span>
<span id="cb217-5"><a href="experimental-data.html#cb217-5" tabindex="-1"></a>regQ <span class="ot">&lt;-</span> <span class="fu">lm</span>(Q<span class="sc">~</span>T<span class="sc">*</span>cost, dat2)</span>
<span id="cb217-6"><a href="experimental-data.html#cb217-6" tabindex="-1"></a>stargazer<span class="sc">::</span><span class="fu">stargazer</span>(regP, regQ, </span>
<span id="cb217-7"><a href="experimental-data.html#cb217-7" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&#39;html&#39;</span>,</span>
<span id="cb217-8"><a href="experimental-data.html#cb217-8" tabindex="-1"></a>    <span class="at">title=</span><span class="st">&#39;Recipe RDD&#39;</span>,</span>
<span id="cb217-9"><a href="experimental-data.html#cb217-9" tabindex="-1"></a>    <span class="at">header=</span>F)</span></code></pre></div>
</details>
<table style="text-align:center">
<caption>
<strong>Recipe RDD</strong>
</caption>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
P
</td>
<td>
Q
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
T
</td>
<td>
-0.0001
</td>
<td>
-0.00005
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.0001)
</td>
<td>
(0.0001)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
cost2
</td>
<td>
-0.884<sup>***</sup>
</td>
<td>
0.650<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.065)
</td>
<td>
(0.056)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
T:cost2
</td>
<td>
0.0002
</td>
<td>
0.0001
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.0002)
</td>
<td>
(0.0002)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
8.898<sup>***</sup>
</td>
<td>
0.891<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.023)
</td>
<td>
(0.020)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
600
</td>
<td>
600
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.813
</td>
<td>
0.795
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.812
</td>
<td>
0.794
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error (df = 596)
</td>
<td>
0.200
</td>
<td>
0.172
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic (df = 3; 596)
</td>
<td>
862.854<sup>***</sup>
</td>
<td>
768.728<sup>***</sup>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<p>Remember that this is effect is <em>local</em>: different magnitudes of the cost shock or different demand curves generally yield different estimates.</p>
<p>Moreover, note that more than just costs have changed over time: subjects in the later periods have history experience behind them while they do not in earlier periods. So hidden variables like “beliefs” are implicitly treated as well. This is one concrete reason to have an explicit control group.</p>
</div>
<div id="difference-in-differences." class="section level4 unnumbered hasAnchor">
<h4><strong>Difference in Differences</strong>.<a href="experimental-data.html#difference-in-differences." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The basic idea of DID is to examine how a variable changes in response to an exogenous shock, <em>compared to a control group</em>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="experimental-data.html#cb218-1" tabindex="-1"></a>EQ3 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>N), <span class="cf">function</span>(n){</span>
<span id="cb218-2"><a href="experimental-data.html#cb218-2" tabindex="-1"></a></span>
<span id="cb218-3"><a href="experimental-data.html#cb218-3" tabindex="-1"></a>    <span class="co"># Market Mechanisms</span></span>
<span id="cb218-4"><a href="experimental-data.html#cb218-4" tabindex="-1"></a>    demand <span class="ot">&lt;-</span> <span class="fu">qd_fun</span>(P)</span>
<span id="cb218-5"><a href="experimental-data.html#cb218-5" tabindex="-1"></a>    supply <span class="ot">&lt;-</span> <span class="fu">qs_fun</span>(P)</span>
<span id="cb218-6"><a href="experimental-data.html#cb218-6" tabindex="-1"></a></span>
<span id="cb218-7"><a href="experimental-data.html#cb218-7" tabindex="-1"></a>    <span class="co"># Compute EQ (what we observe)</span></span>
<span id="cb218-8"><a href="experimental-data.html#cb218-8" tabindex="-1"></a>    eq_id <span class="ot">&lt;-</span> <span class="fu">which.min</span>( <span class="fu">abs</span>(demand<span class="sc">-</span>supply) )</span>
<span id="cb218-9"><a href="experimental-data.html#cb218-9" tabindex="-1"></a>    eq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">P=</span>P[eq_id], <span class="at">Q=</span>demand[eq_id]) </span>
<span id="cb218-10"><a href="experimental-data.html#cb218-10" tabindex="-1"></a></span>
<span id="cb218-11"><a href="experimental-data.html#cb218-11" tabindex="-1"></a>    <span class="co"># Return Equilibrium Observations</span></span>
<span id="cb218-12"><a href="experimental-data.html#cb218-12" tabindex="-1"></a>    <span class="fu">return</span>(eq)</span>
<span id="cb218-13"><a href="experimental-data.html#cb218-13" tabindex="-1"></a>})</span>
<span id="cb218-14"><a href="experimental-data.html#cb218-14" tabindex="-1"></a>dat3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(EQ3), <span class="at">cost=</span><span class="st">&#39;1&#39;</span>, <span class="at">T=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(EQ3))</span>
<span id="cb218-15"><a href="experimental-data.html#cb218-15" tabindex="-1"></a>dat3_pre  <span class="ot">&lt;-</span> dat3[dat3<span class="sc">$</span>T <span class="sc">&lt;=</span> N ,]</span>
<span id="cb218-16"><a href="experimental-data.html#cb218-16" tabindex="-1"></a>dat3_post <span class="ot">&lt;-</span> dat3[dat3<span class="sc">$</span>T <span class="sc">&gt;</span> N ,]</span>
<span id="cb218-17"><a href="experimental-data.html#cb218-17" tabindex="-1"></a></span>
<span id="cb218-18"><a href="experimental-data.html#cb218-18" tabindex="-1"></a><span class="co"># Plot Price Data</span></span>
<span id="cb218-19"><a href="experimental-data.html#cb218-19" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb218-20"><a href="experimental-data.html#cb218-20" tabindex="-1"></a><span class="fu">plot</span>(P<span class="sc">~</span>T, dat2, <span class="at">main=</span><span class="st">&#39;Effect of Cost Shock on Price&#39;</span>, </span>
<span id="cb218-21"><a href="experimental-data.html#cb218-21" tabindex="-1"></a>    <span class="at">font.main=</span><span class="dv">1</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols, <span class="at">cex=</span>.<span class="dv">5</span>)</span>
<span id="cb218-22"><a href="experimental-data.html#cb218-22" tabindex="-1"></a><span class="fu">lines</span>(x1, <span class="fu">predict</span>(regP1), <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb218-23"><a href="experimental-data.html#cb218-23" tabindex="-1"></a><span class="fu">lines</span>(x2, <span class="fu">predict</span>(regP2), <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb218-24"><a href="experimental-data.html#cb218-24" tabindex="-1"></a><span class="co"># W/ Control group</span></span>
<span id="cb218-25"><a href="experimental-data.html#cb218-25" tabindex="-1"></a><span class="fu">points</span>(P<span class="sc">~</span>T, dat3, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>), <span class="at">cex=</span>.<span class="dv">5</span>)</span>
<span id="cb218-26"><a href="experimental-data.html#cb218-26" tabindex="-1"></a>regP3a <span class="ot">&lt;-</span> <span class="fu">loess</span>(P<span class="sc">~</span>T, dat3_pre)</span>
<span id="cb218-27"><a href="experimental-data.html#cb218-27" tabindex="-1"></a>x3a <span class="ot">&lt;-</span> regP3a<span class="sc">$</span>x</span>
<span id="cb218-28"><a href="experimental-data.html#cb218-28" tabindex="-1"></a><span class="fu">lines</span>(x3a, <span class="fu">predict</span>(regP3a), <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb218-29"><a href="experimental-data.html#cb218-29" tabindex="-1"></a>regP3b <span class="ot">&lt;-</span> <span class="fu">loess</span>(P<span class="sc">~</span>T, dat3_post)</span>
<span id="cb218-30"><a href="experimental-data.html#cb218-30" tabindex="-1"></a>x3b <span class="ot">&lt;-</span> regP3b<span class="sc">$</span>x</span>
<span id="cb218-31"><a href="experimental-data.html#cb218-31" tabindex="-1"></a><span class="fu">lines</span>(x3b, <span class="fu">predict</span>(regP3b), <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb218-32"><a href="experimental-data.html#cb218-32" tabindex="-1"></a></span>
<span id="cb218-33"><a href="experimental-data.html#cb218-33" tabindex="-1"></a></span>
<span id="cb218-34"><a href="experimental-data.html#cb218-34" tabindex="-1"></a><span class="co"># Plot Quantity Data</span></span>
<span id="cb218-35"><a href="experimental-data.html#cb218-35" tabindex="-1"></a><span class="fu">plot</span>(Q<span class="sc">~</span>T, dat2, <span class="at">main=</span><span class="st">&#39;Effect of Cost Shock on Quantity&#39;</span>,</span>
<span id="cb218-36"><a href="experimental-data.html#cb218-36" tabindex="-1"></a>    <span class="at">font.main=</span><span class="dv">1</span>, <span class="at">pch=</span><span class="dv">17</span>, <span class="at">col=</span>cols, <span class="at">cex=</span>.<span class="dv">5</span>)</span>
<span id="cb218-37"><a href="experimental-data.html#cb218-37" tabindex="-1"></a><span class="fu">lines</span>(x1, <span class="fu">predict</span>(regQ1), <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb218-38"><a href="experimental-data.html#cb218-38" tabindex="-1"></a><span class="fu">lines</span>(x2, <span class="fu">predict</span>(regQ2), <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb218-39"><a href="experimental-data.html#cb218-39" tabindex="-1"></a><span class="co"># W/ Control group</span></span>
<span id="cb218-40"><a href="experimental-data.html#cb218-40" tabindex="-1"></a><span class="fu">points</span>(Q<span class="sc">~</span>T, dat3, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>), <span class="at">cex=</span>.<span class="dv">5</span>)</span>
<span id="cb218-41"><a href="experimental-data.html#cb218-41" tabindex="-1"></a>regQ3a <span class="ot">&lt;-</span> <span class="fu">loess</span>(Q<span class="sc">~</span>T, dat3_pre) </span>
<span id="cb218-42"><a href="experimental-data.html#cb218-42" tabindex="-1"></a><span class="fu">lines</span>(x3a, <span class="fu">predict</span>(regQ3a), <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb218-43"><a href="experimental-data.html#cb218-43" tabindex="-1"></a>regQ3b <span class="ot">&lt;-</span> <span class="fu">loess</span>(Q<span class="sc">~</span>T, dat3_post) </span>
<span id="cb218-44"><a href="experimental-data.html#cb218-44" tabindex="-1"></a><span class="fu">lines</span>(x3b, <span class="fu">predict</span>(regQ3b), <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
</details>
<p><img src="03-LinearRegression_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>Linear Regression Estimates</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="experimental-data.html#cb219-1" tabindex="-1"></a><span class="co"># Pool Data</span></span>
<span id="cb219-2"><a href="experimental-data.html#cb219-2" tabindex="-1"></a>dat_pooled <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb219-3"><a href="experimental-data.html#cb219-3" tabindex="-1"></a>    <span class="fu">cbind</span>(dat2, <span class="at">EverTreated=</span><span class="dv">1</span>, <span class="at">PostPeriod=</span>(dat2<span class="sc">$</span>T <span class="sc">&gt;</span> N)),</span>
<span id="cb219-4"><a href="experimental-data.html#cb219-4" tabindex="-1"></a>    <span class="fu">cbind</span>(dat3, <span class="at">EverTreated=</span><span class="dv">0</span>, <span class="at">PostPeriod=</span>(dat3<span class="sc">$</span>T <span class="sc">&gt;</span> N)))</span>
<span id="cb219-5"><a href="experimental-data.html#cb219-5" tabindex="-1"></a>dat_pooled<span class="sc">$</span>EverTreated <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dat_pooled<span class="sc">$</span>EverTreated)</span>
<span id="cb219-6"><a href="experimental-data.html#cb219-6" tabindex="-1"></a>dat_pooled<span class="sc">$</span>PostPeriod <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(dat_pooled<span class="sc">$</span>PostPeriod)</span>
<span id="cb219-7"><a href="experimental-data.html#cb219-7" tabindex="-1"></a></span>
<span id="cb219-8"><a href="experimental-data.html#cb219-8" tabindex="-1"></a><span class="co"># Estimate Level Shift for Different Groups after T=300</span></span>
<span id="cb219-9"><a href="experimental-data.html#cb219-9" tabindex="-1"></a>regP <span class="ot">&lt;-</span> <span class="fu">lm</span>(P<span class="sc">~</span>PostPeriod<span class="sc">*</span>EverTreated, dat_pooled)</span>
<span id="cb219-10"><a href="experimental-data.html#cb219-10" tabindex="-1"></a>regQ <span class="ot">&lt;-</span> <span class="fu">lm</span>(Q<span class="sc">~</span>PostPeriod<span class="sc">*</span>EverTreated, dat_pooled)</span>
<span id="cb219-11"><a href="experimental-data.html#cb219-11" tabindex="-1"></a>stargazer<span class="sc">::</span><span class="fu">stargazer</span>(regP, regQ, </span>
<span id="cb219-12"><a href="experimental-data.html#cb219-12" tabindex="-1"></a>    <span class="at">type=</span><span class="st">&#39;html&#39;</span>,</span>
<span id="cb219-13"><a href="experimental-data.html#cb219-13" tabindex="-1"></a>    <span class="at">title=</span><span class="st">&#39;Recipe DiD&#39;</span>,</span>
<span id="cb219-14"><a href="experimental-data.html#cb219-14" tabindex="-1"></a>    <span class="at">header=</span>F)</span></code></pre></div>
</details>
<table style="text-align:center">
<caption>
<strong>Recipe DiD</strong>
</caption>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
P
</td>
<td>
Q
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
PostPeriod
</td>
<td>
-0.008
</td>
<td>
0.001
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.016)
</td>
<td>
(0.014)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
EverTreated1
</td>
<td>
-0.011
</td>
<td>
-0.007
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.016)
</td>
<td>
(0.014)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
PostPeriodTRUE:EverTreated1
</td>
<td>
-0.822<sup>***</sup>
</td>
<td>
0.674<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.023)
</td>
<td>
(0.020)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
8.892<sup>***</sup>
</td>
<td>
0.891<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.012)
</td>
<td>
(0.010)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
1,200
</td>
<td>
1,200
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.767
</td>
<td>
0.735
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.766
</td>
<td>
0.734
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error (df = 1196)
</td>
<td>
0.200
</td>
<td>
0.175
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic (df = 3; 1196)
</td>
<td>
1,310.456<sup>***</sup>
</td>
<td>
1,103.303<sup>***</sup>
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
</div>
<div id="natural-experiments" class="section level2 hasAnchor" number="14.3">
<h2><span class="header-section-number">14.3</span> “Natural” Experiments<a href="experimental-data.html#natural-experiments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Natural experiments are historical case studies that remedy the endogeneity issues in observational data. They assume that a historical events is quasi (or psuedo) random. In addition to “RDD” and “DID” methods discussed above, instrumental variables are used in historical event studies. The elementary versions use linear regression, so I can cover them here using our competitive equilibrium example from before.</p>
<div id="two-stage-least-squares-2sls." class="section level4 unnumbered hasAnchor">
<h4><strong>Two Stage Least Squares (2SLS)</strong>.<a href="experimental-data.html#two-stage-least-squares-2sls." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider the market equilibrium example, which contains a cost shock. We can simply run another regression, but there will still be a problem.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="experimental-data.html#cb220-1" tabindex="-1"></a><span class="co"># Not exactly right, but at least right sign</span></span>
<span id="cb220-2"><a href="experimental-data.html#cb220-2" tabindex="-1"></a>reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Q<span class="sc">~</span>P, <span class="at">data=</span>dat2)</span>
<span id="cb220-3"><a href="experimental-data.html#cb220-3" tabindex="-1"></a><span class="fu">summary</span>(reg2)</span>
<span id="cb220-4"><a href="experimental-data.html#cb220-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb220-5"><a href="experimental-data.html#cb220-5" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb220-6"><a href="experimental-data.html#cb220-6" tabindex="-1"></a><span class="do">## lm(formula = Q ~ P, data = dat2)</span></span>
<span id="cb220-7"><a href="experimental-data.html#cb220-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb220-8"><a href="experimental-data.html#cb220-8" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb220-9"><a href="experimental-data.html#cb220-9" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb220-10"><a href="experimental-data.html#cb220-10" tabindex="-1"></a><span class="do">## -0.76712 -0.16070  0.00393  0.15929  0.66060 </span></span>
<span id="cb220-11"><a href="experimental-data.html#cb220-11" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb220-12"><a href="experimental-data.html#cb220-12" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb220-13"><a href="experimental-data.html#cb220-13" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb220-14"><a href="experimental-data.html#cb220-14" tabindex="-1"></a><span class="do">## (Intercept)  6.69391    0.17588   38.06   &lt;2e-16 ***</span></span>
<span id="cb220-15"><a href="experimental-data.html#cb220-15" tabindex="-1"></a><span class="do">## P           -0.64642    0.02074  -31.16   &lt;2e-16 ***</span></span>
<span id="cb220-16"><a href="experimental-data.html#cb220-16" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb220-17"><a href="experimental-data.html#cb220-17" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb220-18"><a href="experimental-data.html#cb220-18" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb220-19"><a href="experimental-data.html#cb220-19" tabindex="-1"></a><span class="do">## Residual standard error: 0.2339 on 598 degrees of freedom</span></span>
<span id="cb220-20"><a href="experimental-data.html#cb220-20" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.6189, Adjusted R-squared:  0.6182 </span></span>
<span id="cb220-21"><a href="experimental-data.html#cb220-21" tabindex="-1"></a><span class="do">## F-statistic: 971.1 on 1 and 598 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</details>
It turns out that rhe noisiness of the process within each group affects our OLS estimate: <span class="math inline">\(\widehat{\beta}_{OLS}=Cov(Q^{*}, P^{*}) / Var(P^{*})\)</span>. For details, see
<details>
<summary>
<i>Within Group Variance</i>
</summary>
<p>You can experiment with the effect of different variances on both OLS and IV in the code below. And note that if we had multiple supply shifts and recorded their magnitudes, then we could recover more information about demand, perhaps tracing it out entirely.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="experimental-data.html#cb221-1" tabindex="-1"></a><span class="co"># Examine</span></span>
<span id="cb221-2"><a href="experimental-data.html#cb221-2" tabindex="-1"></a>Egrid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">Ed_sigma=</span><span class="fu">c</span>(.<span class="dv">001</span>, .<span class="dv">25</span>, <span class="dv">1</span>), <span class="at">Es_sigma=</span><span class="fu">c</span>(.<span class="dv">001</span>, .<span class="dv">25</span>, <span class="dv">1</span>))</span>
<span id="cb221-3"><a href="experimental-data.html#cb221-3" tabindex="-1"></a></span>
<span id="cb221-4"><a href="experimental-data.html#cb221-4" tabindex="-1"></a>Egrid_regs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Egrid), <span class="cf">function</span>(i){</span>
<span id="cb221-5"><a href="experimental-data.html#cb221-5" tabindex="-1"></a>    Ed_sigma <span class="ot">&lt;-</span> Egrid[i,<span class="dv">1</span>]</span>
<span id="cb221-6"><a href="experimental-data.html#cb221-6" tabindex="-1"></a>    Es_sigma <span class="ot">&lt;-</span> Egrid[i,<span class="dv">2</span>]    </span>
<span id="cb221-7"><a href="experimental-data.html#cb221-7" tabindex="-1"></a>    EQ1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(n){</span>
<span id="cb221-8"><a href="experimental-data.html#cb221-8" tabindex="-1"></a>        demand <span class="ot">&lt;-</span> <span class="fu">qd_fun</span>(P, <span class="at">Ed_sigma=</span>Ed_sigma)</span>
<span id="cb221-9"><a href="experimental-data.html#cb221-9" tabindex="-1"></a>        supply <span class="ot">&lt;-</span> <span class="fu">qs_fun</span>(P, <span class="at">Es_sigma=</span>Es_sigma)</span>
<span id="cb221-10"><a href="experimental-data.html#cb221-10" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">eq_fun</span>(demand, supply, P))</span>
<span id="cb221-11"><a href="experimental-data.html#cb221-11" tabindex="-1"></a>    })</span>
<span id="cb221-12"><a href="experimental-data.html#cb221-12" tabindex="-1"></a>    EQ2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(n){</span>
<span id="cb221-13"><a href="experimental-data.html#cb221-13" tabindex="-1"></a>        demand <span class="ot">&lt;-</span> <span class="fu">qd_fun</span>(P,<span class="at">Ed_sigma=</span>Ed_sigma)</span>
<span id="cb221-14"><a href="experimental-data.html#cb221-14" tabindex="-1"></a>        supply2 <span class="ot">&lt;-</span> <span class="fu">qs_fun</span>(P, <span class="at">As=</span><span class="sc">-</span><span class="fl">6.5</span>,<span class="at">Es_sigma=</span>Es_sigma)</span>
<span id="cb221-15"><a href="experimental-data.html#cb221-15" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">eq_fun</span>(demand, supply2, P))</span>
<span id="cb221-16"><a href="experimental-data.html#cb221-16" tabindex="-1"></a>    })</span>
<span id="cb221-17"><a href="experimental-data.html#cb221-17" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb221-18"><a href="experimental-data.html#cb221-18" tabindex="-1"></a>        <span class="fu">data.frame</span>(<span class="fu">t</span>(EQ1), <span class="at">cost=</span><span class="st">&#39;1&#39;</span>),</span>
<span id="cb221-19"><a href="experimental-data.html#cb221-19" tabindex="-1"></a>        <span class="fu">data.frame</span>(<span class="fu">t</span>(EQ2), <span class="at">cost=</span><span class="st">&#39;2&#39;</span>))</span>
<span id="cb221-20"><a href="experimental-data.html#cb221-20" tabindex="-1"></a>    <span class="fu">return</span>(dat)</span>
<span id="cb221-21"><a href="experimental-data.html#cb221-21" tabindex="-1"></a>})</span>
<span id="cb221-22"><a href="experimental-data.html#cb221-22" tabindex="-1"></a>Egrid_OLS <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Egrid_regs, <span class="cf">function</span>(dat) <span class="fu">coef</span>( <span class="fu">lm</span>(Q<span class="sc">~</span>P, <span class="at">data=</span>dat)))</span>
<span id="cb221-23"><a href="experimental-data.html#cb221-23" tabindex="-1"></a>Egrid_IV <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Egrid_regs, <span class="cf">function</span>(dat) <span class="fu">coef</span>( <span class="fu">feols</span>(Q<span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>P<span class="sc">~</span>cost, <span class="at">data=</span>dat)))</span>
<span id="cb221-24"><a href="experimental-data.html#cb221-24" tabindex="-1"></a></span>
<span id="cb221-25"><a href="experimental-data.html#cb221-25" tabindex="-1"></a><span class="co">#cbind(Egrid, coef_OLS=t(Egrid_OLS)[,2], coef_IV=t(Egrid_IV)[,2])</span></span>
<span id="cb221-26"><a href="experimental-data.html#cb221-26" tabindex="-1"></a><span class="fu">lapply</span>( <span class="fu">list</span>(Egrid_OLS, Egrid_IV), <span class="cf">function</span>(ei){</span>
<span id="cb221-27"><a href="experimental-data.html#cb221-27" tabindex="-1"></a>    Emat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(ei[<span class="dv">2</span>,],<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb221-28"><a href="experimental-data.html#cb221-28" tabindex="-1"></a>    <span class="fu">rownames</span>(Emat) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Ed_sigma.&#39;</span>,<span class="fu">c</span>(.<span class="dv">001</span>, .<span class="dv">25</span>, <span class="dv">1</span>))</span>
<span id="cb221-29"><a href="experimental-data.html#cb221-29" tabindex="-1"></a>    <span class="fu">colnames</span>(Emat) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Es_sigma.&#39;</span>,<span class="fu">c</span>(.<span class="dv">001</span>, .<span class="dv">25</span>, <span class="dv">1</span>))</span>
<span id="cb221-30"><a href="experimental-data.html#cb221-30" tabindex="-1"></a>    <span class="fu">return</span>( <span class="fu">round</span>(Emat,<span class="dv">2</span>))</span>
<span id="cb221-31"><a href="experimental-data.html#cb221-31" tabindex="-1"></a>})</span></code></pre></div>
</details>
</details>
<p>To overcome this issue, we can compute the change in the expected values <span class="math inline">\(d \mathbb{E}[Q^{*}] / d \mathbb{E}[P^{*}] =-B_{D}\)</span>. Empirically, this is estimated via the change in average value.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="experimental-data.html#cb222-1" tabindex="-1"></a><span class="co"># Wald (1940) Estimate</span></span>
<span id="cb222-2"><a href="experimental-data.html#cb222-2" tabindex="-1"></a>dat_mean <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb222-3"><a href="experimental-data.html#cb222-3" tabindex="-1"></a>    <span class="fu">colMeans</span>(dat2[dat2<span class="sc">$</span>cost<span class="sc">==</span><span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb222-4"><a href="experimental-data.html#cb222-4" tabindex="-1"></a>    <span class="fu">colMeans</span>(dat2[dat2<span class="sc">$</span>cost<span class="sc">==</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]))</span>
<span id="cb222-5"><a href="experimental-data.html#cb222-5" tabindex="-1"></a>dat_mean</span>
<span id="cb222-6"><a href="experimental-data.html#cb222-6" tabindex="-1"></a><span class="do">##             P         Q</span></span>
<span id="cb222-7"><a href="experimental-data.html#cb222-7" tabindex="-1"></a><span class="do">## [1,] 8.881133 0.8840162</span></span>
<span id="cb222-8"><a href="experimental-data.html#cb222-8" tabindex="-1"></a><span class="do">## [2,] 8.051233 1.5583621</span></span>
<span id="cb222-9"><a href="experimental-data.html#cb222-9" tabindex="-1"></a>B_est <span class="ot">&lt;-</span> <span class="fu">diff</span>(dat_mean[,<span class="dv">2</span>])<span class="sc">/</span><span class="fu">diff</span>(dat_mean[,<span class="dv">1</span>])</span>
<span id="cb222-10"><a href="experimental-data.html#cb222-10" tabindex="-1"></a><span class="fu">round</span>(B_est, <span class="dv">2</span>)</span>
<span id="cb222-11"><a href="experimental-data.html#cb222-11" tabindex="-1"></a><span class="do">## [1] -0.81</span></span></code></pre></div>
</details>
<p>We can also separately recover <span class="math inline">\(d \mathbb{E}[Q^{*}] / d \mathbb{E}[A_{S}]\)</span> and <span class="math inline">\(d \mathbb{E}[P^{*}] / d \mathbb{E}[A_{S}]\)</span> from separate regressions.<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="experimental-data.html#cb223-1" tabindex="-1"></a><span class="co"># Heckman (2000, p.58) Estimate</span></span>
<span id="cb223-2"><a href="experimental-data.html#cb223-2" tabindex="-1"></a>ols_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(P<span class="sc">~</span>cost, <span class="at">data=</span>dat2)</span>
<span id="cb223-3"><a href="experimental-data.html#cb223-3" tabindex="-1"></a>ols_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Q<span class="sc">~</span>cost, <span class="at">data=</span>dat2)</span>
<span id="cb223-4"><a href="experimental-data.html#cb223-4" tabindex="-1"></a>B_est2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(ols_2)<span class="sc">/</span><span class="fu">coef</span>(ols_1)</span>
<span id="cb223-5"><a href="experimental-data.html#cb223-5" tabindex="-1"></a><span class="fu">round</span>(B_est2[[<span class="dv">2</span>]],<span class="dv">2</span>)</span>
<span id="cb223-6"><a href="experimental-data.html#cb223-6" tabindex="-1"></a><span class="do">## [1] -0.81</span></span></code></pre></div>
</details>
<p>Alternatively, we can recover the same estimate using an 2SLS regression with two equations:
<span class="math display">\[\begin{eqnarray}
P &amp;=&amp; \alpha_{1} + A_{S} \beta_{1} + \epsilon_{1} \\
Q &amp;=&amp; \alpha_{2} + \hat{P} \beta_{2} + \epsilon_{2}.
\end{eqnarray}\]</span>
In the first regression, we estimate the average effect of the cost shock on prices. In the second equation, we estimate how the average effect of prices <em>which are exogenous to demand</em> affect quantity demanded. To see this, first substitute the equilibrium condition into the supply equation: <span class="math inline">\(Q_{D}=Q_{S}=A_{S}+B_{S} P + E_{S}\)</span>, lets us rewrite <span class="math inline">\(P\)</span> as a function of <span class="math inline">\(Q_{D}\)</span>. This yields two theoretical equations
<span class="math display">\[\begin{eqnarray}
\label{eqn:linear_supply_iv}
P &amp;=&amp; -\frac{A_{S}}{{B_{S}}} + \frac{Q_{D}}{B_{S}} - \frac{E_{S}}{B_{S}} \\
\label{eqn:linear_demand_iv}
Q_{D} &amp;=&amp;  A_{D} + B_{D} P  + E_{D}.
\end{eqnarray}\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="experimental-data.html#cb224-1" tabindex="-1"></a><span class="co"># Two Stage Least Squares Estimate</span></span>
<span id="cb224-2"><a href="experimental-data.html#cb224-2" tabindex="-1"></a>ols_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(P<span class="sc">~</span>cost, <span class="at">data=</span>dat2)</span>
<span id="cb224-3"><a href="experimental-data.html#cb224-3" tabindex="-1"></a>dat2_new  <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dat2, <span class="at">Phat=</span><span class="fu">predict</span>(ols_1))</span>
<span id="cb224-4"><a href="experimental-data.html#cb224-4" tabindex="-1"></a>reg_2sls <span class="ot">&lt;-</span> <span class="fu">lm</span>(Q<span class="sc">~</span>Phat, <span class="at">data=</span>dat2_new)</span>
<span id="cb224-5"><a href="experimental-data.html#cb224-5" tabindex="-1"></a><span class="fu">summary</span>(reg_2sls)</span>
<span id="cb224-6"><a href="experimental-data.html#cb224-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb224-7"><a href="experimental-data.html#cb224-7" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb224-8"><a href="experimental-data.html#cb224-8" tabindex="-1"></a><span class="do">## lm(formula = Q ~ Phat, data = dat2_new)</span></span>
<span id="cb224-9"><a href="experimental-data.html#cb224-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb224-10"><a href="experimental-data.html#cb224-10" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb224-11"><a href="experimental-data.html#cb224-11" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb224-12"><a href="experimental-data.html#cb224-12" tabindex="-1"></a><span class="do">## -0.57417 -0.11551  0.00219  0.11010  0.48352 </span></span>
<span id="cb224-13"><a href="experimental-data.html#cb224-13" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb224-14"><a href="experimental-data.html#cb224-14" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb224-15"><a href="experimental-data.html#cb224-15" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb224-16"><a href="experimental-data.html#cb224-16" tabindex="-1"></a><span class="do">## (Intercept)   8.1005     0.1432   56.56   &lt;2e-16 ***</span></span>
<span id="cb224-17"><a href="experimental-data.html#cb224-17" tabindex="-1"></a><span class="do">## Phat         -0.8126     0.0169  -48.09   &lt;2e-16 ***</span></span>
<span id="cb224-18"><a href="experimental-data.html#cb224-18" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb224-19"><a href="experimental-data.html#cb224-19" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb224-20"><a href="experimental-data.html#cb224-20" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb224-21"><a href="experimental-data.html#cb224-21" tabindex="-1"></a><span class="do">## Residual standard error: 0.1717 on 598 degrees of freedom</span></span>
<span id="cb224-22"><a href="experimental-data.html#cb224-22" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.7945, Adjusted R-squared:  0.7942 </span></span>
<span id="cb224-23"><a href="experimental-data.html#cb224-23" tabindex="-1"></a><span class="do">## F-statistic:  2313 on 1 and 598 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb224-24"><a href="experimental-data.html#cb224-24" tabindex="-1"></a></span>
<span id="cb224-25"><a href="experimental-data.html#cb224-25" tabindex="-1"></a><span class="co"># One Stage Instrumental Variables Estimate</span></span>
<span id="cb224-26"><a href="experimental-data.html#cb224-26" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb224-27"><a href="experimental-data.html#cb224-27" tabindex="-1"></a>reg2_iv <span class="ot">&lt;-</span> <span class="fu">feols</span>(Q<span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>P<span class="sc">~</span>cost, <span class="at">data=</span>dat2)</span>
<span id="cb224-28"><a href="experimental-data.html#cb224-28" tabindex="-1"></a><span class="fu">summary</span>(reg2_iv)</span>
<span id="cb224-29"><a href="experimental-data.html#cb224-29" tabindex="-1"></a><span class="do">## TSLS estimation - Dep. Var.: Q</span></span>
<span id="cb224-30"><a href="experimental-data.html#cb224-30" tabindex="-1"></a><span class="do">##                   Endo.    : P</span></span>
<span id="cb224-31"><a href="experimental-data.html#cb224-31" tabindex="-1"></a><span class="do">##                   Instr.   : cost</span></span>
<span id="cb224-32"><a href="experimental-data.html#cb224-32" tabindex="-1"></a><span class="do">## Second stage: Dep. Var.: Q</span></span>
<span id="cb224-33"><a href="experimental-data.html#cb224-33" tabindex="-1"></a><span class="do">## Observations: 600</span></span>
<span id="cb224-34"><a href="experimental-data.html#cb224-34" tabindex="-1"></a><span class="do">## Standard-errors: IID </span></span>
<span id="cb224-35"><a href="experimental-data.html#cb224-35" tabindex="-1"></a><span class="do">##              Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb224-36"><a href="experimental-data.html#cb224-36" tabindex="-1"></a><span class="do">## (Intercept)  8.100495   0.205264  39.4637 &lt; 2.2e-16 ***</span></span>
<span id="cb224-37"><a href="experimental-data.html#cb224-37" tabindex="-1"></a><span class="do">## fit_P       -0.812563   0.024216 -33.5546 &lt; 2.2e-16 ***</span></span>
<span id="cb224-38"><a href="experimental-data.html#cb224-38" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb224-39"><a href="experimental-data.html#cb224-39" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb224-40"><a href="experimental-data.html#cb224-40" tabindex="-1"></a><span class="do">## RMSE: 0.245726   Adj. R2: 0.577291</span></span>
<span id="cb224-41"><a href="experimental-data.html#cb224-41" tabindex="-1"></a><span class="do">## F-test (1st stage), P: stat = 2,591.5, p &lt; 2.2e-16, on 1 and 598 DoF.</span></span>
<span id="cb224-42"><a href="experimental-data.html#cb224-42" tabindex="-1"></a><span class="do">##            Wu-Hausman: stat =   518.6, p &lt; 2.2e-16, on 1 and 597 DoF.</span></span></code></pre></div>
</details>
</div>
<div id="caveats." class="section level4 unnumbered hasAnchor">
<h4><strong>Caveats</strong>.<a href="experimental-data.html#caveats." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>2SLS regression analysis can be very insightful, but I also want to stress some caveats about their practical application.</p>
<p>We always get coefficients back when running <code>feols</code>, and sometimes the computed p-values are very small. The interpretation of those numbers rests on many assumptions:</p>
<ul>
<li><em>Instrument exogeneity (Exclusion Restriction):</em> The instrument must affect outcomes only through the treatment variable (e.g., only supply is affected directly, not demand).</li>
<li><em>Instrument relevance:</em> The instrument must be strongly correlated with the endogenous regressor, implying the shock creates meaningful variation.</li>
<li><em>Functional form correctness:</em> Supply and demand are assumed linear and additively separable.</li>
<li><em>Multiple hypothesis testing risks:</em> We were not repeatedly testing different instruments, which can artificially produce significant findings by chance.</li>
</ul>
<p>We are rarely sure that all of these assumptions hold, and this is one reason why researchers often also report their OLS results. But that is insufficient, as spatial and temporal dependence also complicate inference:</p>
<ul>
<li><em>Exclusion restriction violations:</em> Spatial or temporal spillovers may cause instruments to affect the outcome through unintended channels, undermining instrument exogeneity.</li>
<li><em>Weak instruments:</em> Spatial clustering, serial correlation, or network interdependencies can reduce instrument variation, causing weak instruments.</li>
<li><em>Inference and standard errors:</em> Spatial or temporal interdependence reduces the effective sample size, making conventional standard errors misleadingly small.</li>
</ul>
</div>
</div>
<div id="further-reading-9" class="section level2 hasAnchor" number="14.4">
<h2><span class="header-section-number">14.4</span> Further Reading<a href="experimental-data.html#further-reading-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You are directed to the following resources which discusses endogeneity in more detail and how it applies generally.</p>
<ul>
<li>Causal Inference for Statistics, Social, and Biomedical Sciences: An Introduction</li>
<li><a href="https://www.mostlyharmlesseconometrics.com/" class="uri">https://www.mostlyharmlesseconometrics.com/</a></li>
<li><a href="https://www.econometrics-with-r.org" class="uri">https://www.econometrics-with-r.org</a></li>
<li><a href="https://bookdown.org/paul/applied-causal-analysis/" class="uri">https://bookdown.org/paul/applied-causal-analysis/</a></li>
<li><a href="https://mixtape.scunning.com/" class="uri">https://mixtape.scunning.com/</a></li>
<li><a href="https://theeffectbook.net/" class="uri">https://theeffectbook.net/</a></li>
<li><a href="https://www.r-causal.org/" class="uri">https://www.r-causal.org/</a></li>
<li><a href="https://matheusfacure.github.io/python-causality-handbook/landing-page.html" class="uri">https://matheusfacure.github.io/python-causality-handbook/landing-page.html</a></li>
</ul>
<p>For RDD and DID methods in natural experiments, see</p>
<ul>
<li><a href="https://bookdown.org/paul/applied-causal-analysis/rdd-regression-discontinuity-design.html" class="uri">https://bookdown.org/paul/applied-causal-analysis/rdd-regression-discontinuity-design.html</a></li>
<li><a href="https://mixtape.scunning.com/06-regression_discontinuity" class="uri">https://mixtape.scunning.com/06-regression_discontinuity</a></li>
<li><a href="https://theeffectbook.net/ch-RegressionDiscontinuity.html" class="uri">https://theeffectbook.net/ch-RegressionDiscontinuity.html</a></li>
<li><a href="https://mixtape.scunning.com/09-difference_in_differences" class="uri">https://mixtape.scunning.com/09-difference_in_differences</a></li>
<li><a href="https://theeffectbook.net/ch-DifferenceinDifference.html" class="uri">https://theeffectbook.net/ch-DifferenceinDifference.html</a></li>
<li><a href="http://www.urfie.net/read/index.html#page/226" class="uri">http://www.urfie.net/read/index.html#page/226</a></li>
</ul>
<p>For IV methods in natural experiments, see</p>
<ul>
<li><a href="https://cameron.econ.ucdavis.edu/e240a/ch04iv.pdf" class="uri">https://cameron.econ.ucdavis.edu/e240a/ch04iv.pdf</a></li>
<li><a href="https://mru.org/courses/mastering-econometrics/introduction-instrumental-variables-part-one" class="uri">https://mru.org/courses/mastering-econometrics/introduction-instrumental-variables-part-one</a></li>
<li><a href="https://www.econometrics-with-r.org/12-ivr.html" class="uri">https://www.econometrics-with-r.org/12-ivr.html</a></li>
<li><a href="https://bookdown.org/paul/applied-causal-analysis/estimation-2.html" class="uri">https://bookdown.org/paul/applied-causal-analysis/estimation-2.html</a></li>
<li><a href="https://mixtape.scunning.com/07-instrumental_variables" class="uri">https://mixtape.scunning.com/07-instrumental_variables</a></li>
<li><a href="https://theeffectbook.net/ch-InstrumentalVariables.html" class="uri">https://theeffectbook.net/ch-InstrumentalVariables.html</a></li>
<li><a href="http://www.urfie.net/read/index.html#page/247" class="uri">http://www.urfie.net/read/index.html#page/247</a></li>
</ul>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="7">
<li id="fn7"><p>Notice that even in this linear model, however, all effects are conditional: <em>The</em> effect of a cost change on quantity or price depends on the demand curve. A change in costs affects quantity supplied but not quantity demanded (which then affects equilibrium price) but the demand side of the market still matters! The change in price from a change in costs depends on the elasticity of demand.<a href="experimental-data.html#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>Mathematically, we can also do this in a single step by exploiting linear algebra:
<span class="math inline">\(\frac{\frac{ Cov(Q^{*},A_{S})}{ V(A_{S}) } }{\frac{ Cov(P^{*},A_{S})}{ V(A_{S}) }}
&amp;=&amp; \frac{Cov(Q^{*},A_{S} )}{ Cov(P^{*},A_{S})}.\)</span><a href="experimental-data.html#fnref8" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="observational-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-scientism.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["index.pdf", "index.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
