<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 9 OLS and Endogeneity | index</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content=" 9 OLS and Endogeneity | index" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 9 OLS and Endogeneity | index" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ols-diagnostics.html"/>
<link rel="next" href="data-scientism.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6.9000/profvis.js"></script>
<script src="libs/profvis-0.3.6.9000/scroll.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.8/profvis.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Primers</a></li>
<li class="toc-logo"><a href="./"><img src="Figures_Manual/Logo.png" width="140" height="100"></a></li>        

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="part"><span><b>I Programming in R</b></span></li>
<li class="chapter" data-level="2" data-path="first-steps.html"><a href="first-steps.html"><i class="fa fa-check"></i><b>2</b> First Steps</a>
<ul>
<li class="chapter" data-level="2.1" data-path="first-steps.html"><a href="first-steps.html#why-r"><i class="fa fa-check"></i><b>2.1</b> Why R</a></li>
<li class="chapter" data-level="2.2" data-path="first-steps.html"><a href="first-steps.html#install-r"><i class="fa fa-check"></i><b>2.2</b> Install R</a></li>
<li class="chapter" data-level="2.3" data-path="first-steps.html"><a href="first-steps.html#interfacing-with-r"><i class="fa fa-check"></i><b>2.3</b> Interfacing with R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>3</b> Mathematics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mathematics.html"><a href="mathematics.html#scalars"><i class="fa fa-check"></i><b>3.1</b> Scalars</a></li>
<li class="chapter" data-level="3.2" data-path="mathematics.html"><a href="mathematics.html#vectors"><i class="fa fa-check"></i><b>3.2</b> Vectors</a></li>
<li class="chapter" data-level="3.3" data-path="mathematics.html"><a href="mathematics.html#functions"><i class="fa fa-check"></i><b>3.3</b> Functions</a></li>
<li class="chapter" data-level="3.4" data-path="mathematics.html"><a href="mathematics.html#matrices"><i class="fa fa-check"></i><b>3.4</b> Matrices</a></li>
<li class="chapter" data-level="3.5" data-path="mathematics.html"><a href="mathematics.html#arrays"><i class="fa fa-check"></i><b>3.5</b> Arrays</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>4</b> Statistics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="statistics.html"><a href="statistics.html#random-variables"><i class="fa fa-check"></i><b>4.1</b> Random Variables</a></li>
<li class="chapter" data-level="4.2" data-path="statistics.html"><a href="statistics.html#functions-of-data"><i class="fa fa-check"></i><b>4.2</b> Functions of Data</a></li>
<li class="chapter" data-level="4.3" data-path="statistics.html"><a href="statistics.html#further-reading"><i class="fa fa-check"></i><b>4.3</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>5</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-analysis.html"><a href="data-analysis.html#data"><i class="fa fa-check"></i><b>5.1</b> Data</a></li>
<li class="chapter" data-level="5.2" data-path="data-analysis.html"><a href="data-analysis.html#plots"><i class="fa fa-check"></i><b>5.2</b> Plots</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="data-analysis.html"><a href="data-analysis.html#histograms"><i class="fa fa-check"></i><b>5.2.1</b> Histograms</a></li>
<li class="chapter" data-level="5.2.2" data-path="data-analysis.html"><a href="data-analysis.html#boxplots"><i class="fa fa-check"></i><b>5.2.2</b> Boxplots</a></li>
<li class="chapter" data-level="5.2.3" data-path="data-analysis.html"><a href="data-analysis.html#scatterplots"><i class="fa fa-check"></i><b>5.2.3</b> Scatterplots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="beyond-basics.html"><a href="beyond-basics.html"><i class="fa fa-check"></i><b>6</b> Beyond Basics</a>
<ul>
<li class="chapter" data-level="6.1" data-path="beyond-basics.html"><a href="beyond-basics.html#introductions-to-r"><i class="fa fa-check"></i><b>6.1</b> Introductions to R</a></li>
<li class="chapter" data-level="6.2" data-path="beyond-basics.html"><a href="beyond-basics.html#the-r-ecosystem"><i class="fa fa-check"></i><b>6.2</b> The R Ecosystem</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="beyond-basics.html"><a href="beyond-basics.html#packages"><i class="fa fa-check"></i><b>6.2.1</b> Packages</a></li>
<li class="chapter" data-level="6.2.2" data-path="beyond-basics.html"><a href="beyond-basics.html#task-views"><i class="fa fa-check"></i><b>6.2.2</b> Task Views</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="beyond-basics.html"><a href="beyond-basics.html#custom-figures"><i class="fa fa-check"></i><b>6.3</b> Custom figures</a></li>
</ul></li>
<li class="part"><span><b>II Linear Regression in R</b></span></li>
<li class="chapter" data-level="7" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html"><i class="fa fa-check"></i><b>7</b> Ordinary Least Squares</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#simple-ols-linear-regression"><i class="fa fa-check"></i><b>7.1</b> Simple OLS (linear regression)</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#variability-estimates"><i class="fa fa-check"></i><b>7.1.1</b> Variability Estimates</a></li>
<li class="chapter" data-level="7.1.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#hypothesis-tests"><i class="fa fa-check"></i><b>7.1.2</b> Hypothesis Tests</a></li>
<li class="chapter" data-level="7.1.3" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#prediction-intervals"><i class="fa fa-check"></i><b>7.1.3</b> Prediction Intervals</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#ols-multiple-linear-regression"><i class="fa fa-check"></i><b>7.2</b> OLS (multiple linear regression)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#variability-estimates-and-hypothesis-tests"><i class="fa fa-check"></i><b>7.2.1</b> Variability Estimates and Hypothesis Tests</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#coefficient-interpretation"><i class="fa fa-check"></i><b>7.3</b> Coefficient Interpretation</a></li>
<li class="chapter" data-level="7.4" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#factor-variables"><i class="fa fa-check"></i><b>7.4</b> Factor Variables</a></li>
<li class="chapter" data-level="7.5" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#more-literature"><i class="fa fa-check"></i><b>7.5</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html"><i class="fa fa-check"></i><b>8</b> OLS Diagnostics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#outliers"><i class="fa fa-check"></i><b>8.1</b> Outliers</a></li>
<li class="chapter" data-level="8.2" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#normality"><i class="fa fa-check"></i><b>8.2</b> Normality</a></li>
<li class="chapter" data-level="8.3" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#collinearity"><i class="fa fa-check"></i><b>8.3</b> Collinearity</a></li>
<li class="chapter" data-level="8.4" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#linear-in-parameters"><i class="fa fa-check"></i><b>8.4</b> Linear in Parameters</a></li>
<li class="chapter" data-level="8.5" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#more-literature-1"><i class="fa fa-check"></i><b>8.5</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html"><i class="fa fa-check"></i><b>9</b> OLS and Endogeneity</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html#two-stage-least-squares-2sls"><i class="fa fa-check"></i><b>9.1</b> Two Stage Least Squares (2SLS)</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html#competitive-market-equilibrium"><i class="fa fa-check"></i><b>9.1.1</b> Competitive Market Equilibrium</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html#regression-discontinuitieskink-rdrk"><i class="fa fa-check"></i><b>9.2</b> Regression Discontinuities/Kink (RD/RK)</a></li>
<li class="chapter" data-level="9.3" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html#difference-in-differences-did"><i class="fa fa-check"></i><b>9.3</b> Difference in Differences (DID)</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-scientism.html"><a href="data-scientism.html"><i class="fa fa-check"></i><b>10</b> Data Scientism</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-scientism.html"><a href="data-scientism.html#ols-in-the-age-of-big-data"><i class="fa fa-check"></i><b>10.1</b> OLS in the age of big data</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="data-scientism.html"><a href="data-scientism.html#us-govt-spending-on-science"><i class="fa fa-check"></i><b>10.1.1</b> US Gov’t Spending on Science</a></li>
<li class="chapter" data-level="10.1.2" data-path="data-scientism.html"><a href="data-scientism.html#false-positives-arise-from-errors"><i class="fa fa-check"></i><b>10.1.2</b> False Positives arise from errors</a></li>
<li class="chapter" data-level="10.1.3" data-path="data-scientism.html"><a href="data-scientism.html#false-positives-arise-from-regression-machines"><i class="fa fa-check"></i><b>10.1.3</b> False Positives arise from Regression Machines</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="data-scientism.html"><a href="data-scientism.html#causal-effects-sans-theory"><i class="fa fa-check"></i><b>10.2</b> Causal effects <em>sans theory</em></a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="data-scientism.html"><a href="data-scientism.html#rdd"><i class="fa fa-check"></i><b>10.2.1</b> RDD</a></li>
<li class="chapter" data-level="10.2.2" data-path="data-scientism.html"><a href="data-scientism.html#did"><i class="fa fa-check"></i><b>10.2.2</b> DID</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Reproducible Research in R</b></span></li>
<li class="chapter" data-level="11" data-path="why.html"><a href="why.html"><i class="fa fa-check"></i><b>11</b> Why?</a>
<ul>
<li class="chapter" data-level="11.1" data-path="why.html"><a href="why.html#an-example-workflow"><i class="fa fa-check"></i><b>11.1</b> An example workflow</a></li>
<li class="chapter" data-level="11.2" data-path="why.html"><a href="why.html#an-alternative-workflow"><i class="fa fa-check"></i><b>11.2</b> An alternative workflow</a></li>
<li class="chapter" data-level="11.3" data-path="why.html"><a href="why.html#r-and-r-markdown"><i class="fa fa-check"></i><b>11.3</b> R and R-Markdown</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="small-projects.html"><a href="small-projects.html"><i class="fa fa-check"></i><b>12</b> Small Projects</a>
<ul>
<li class="chapter" data-level="12.1" data-path="small-projects.html"><a href="small-projects.html#an-r-code-chunk"><i class="fa fa-check"></i><b>12.1</b> An R Code Chunk</a></li>
<li class="chapter" data-level="12.2" data-path="small-projects.html"><a href="small-projects.html#an-r-markdown-document"><i class="fa fa-check"></i><b>12.2</b> An R Markdown Document</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="small-projects.html"><a href="small-projects.html#copypaste-example"><i class="fa fa-check"></i><b>12.2.1</b> Copy/Paste Example</a></li>
<li class="chapter" data-level="12.2.2" data-path="small-projects.html"><a href="small-projects.html#a-homework-example"><i class="fa fa-check"></i><b>12.2.2</b> A Homework Example</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="small-projects.html"><a href="small-projects.html#posters-and-slides"><i class="fa fa-check"></i><b>12.3</b> Posters and Slides</a></li>
<li class="chapter" data-level="12.4" data-path="small-projects.html"><a href="small-projects.html#getting-help-w-r-markdown"><i class="fa fa-check"></i><b>12.4</b> Getting help w/ R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="large-projects.html"><a href="large-projects.html"><i class="fa fa-check"></i><b>13</b> Large Projects</a>
<ul>
<li class="chapter" data-level="13.1" data-path="large-projects.html"><a href="large-projects.html#makefile"><i class="fa fa-check"></i><b>13.1</b> MAKEFILE</a></li>
<li class="chapter" data-level="13.2" data-path="large-projects.html"><a href="large-projects.html#loggingsinking"><i class="fa fa-check"></i><b>13.2</b> Logging/Sinking</a></li>
<li class="chapter" data-level="13.3" data-path="large-projects.html"><a href="large-projects.html#class-projects"><i class="fa fa-check"></i><b>13.3</b> Class Projects</a></li>
<li class="chapter" data-level="13.4" data-path="large-projects.html"><a href="large-projects.html#debugging"><i class="fa fa-check"></i><b>13.4</b> Debugging</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="large-projects.html"><a href="large-projects.html#tracing-errors"><i class="fa fa-check"></i><b>13.4.1</b> Tracing Errors</a></li>
<li class="chapter" data-level="13.4.2" data-path="large-projects.html"><a href="large-projects.html#checking-problems"><i class="fa fa-check"></i><b>13.4.2</b> Checking problems</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="large-projects.html"><a href="large-projects.html#being-proactive"><i class="fa fa-check"></i><b>13.5</b> Being Proactive</a></li>
<li class="chapter" data-level="13.6" data-path="large-projects.html"><a href="large-projects.html#optimizing"><i class="fa fa-check"></i><b>13.6</b> Optimizing</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="large-projects.html"><a href="large-projects.html#benchmarking"><i class="fa fa-check"></i><b>13.6.1</b> Benchmarking</a></li>
<li class="chapter" data-level="13.6.2" data-path="large-projects.html"><a href="large-projects.html#bottlenecks"><i class="fa fa-check"></i><b>13.6.2</b> Bottlenecks</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="large-projects.html"><a href="large-projects.html#advanced-programming"><i class="fa fa-check"></i><b>13.7</b> Advanced Programming</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>14</b> Shiny</a>
<ul>
<li class="chapter" data-level="14.0.1" data-path="shiny.html"><a href="shiny.html#programming-guidance"><i class="fa fa-check"></i><b>14.0.1</b> Programming Guidance</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i><b>15</b> Software</a>
<ul>
<li class="chapter" data-level="15.1" data-path="software.html"><a href="software.html#latest-versions"><i class="fa fa-check"></i><b>15.1</b> Latest versions</a></li>
<li class="chapter" data-level="15.2" data-path="software.html"><a href="software.html#stata"><i class="fa fa-check"></i><b>15.2</b> Stata</a></li>
<li class="chapter" data-level="15.3" data-path="software.html"><a href="software.html#general-workflow"><i class="fa fa-check"></i><b>15.3</b> General Workflow</a></li>
<li class="chapter" data-level="15.4" data-path="software.html"><a href="software.html#sweave"><i class="fa fa-check"></i><b>15.4</b> Sweave</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://sites.google.com/view/jordan-adamson" target="blank">Jordan Adamson</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ols-and-endogeneity" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number"> 9</span> OLS and Endogeneity<a href="ols-and-endogeneity.html#ols-and-endogeneity" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<hr />
<p>Just like many economic relationships are nonlinear, many economic variables are endogenous. By this we typically mean that <span class="math inline">\(X\)</span> is an outcome determined (or caused: <span class="math inline">\(\to\)</span>) by some other variable.</p>
<ul>
<li>If <span class="math inline">\(Y \to X\)</span>, then we have reverse causality</li>
<li>If <span class="math inline">\(Y \to X\)</span> and <span class="math inline">\(X \to Y\)</span>, then we have simultaneity</li>
<li>If <span class="math inline">\(Z\to Y\)</span> and either <span class="math inline">\(Z\to X\)</span> or <span class="math inline">\(X \to Z\)</span>, then we have omitted a potentially important variable</li>
</ul>
<p>These endogeneity issues imply <span class="math inline">\(X\)</span> and <span class="math inline">\(\epsilon\)</span> are correlated, which is a barrier to interpreting OLS as a causal model.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="ols-and-endogeneity.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simulate data with an endogeneity issue</span></span>
<span id="cb263-2"><a href="ols-and-endogeneity.html#cb263-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb263-3"><a href="ols-and-endogeneity.html#cb263-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,.<span class="dv">5</span>)</span>
<span id="cb263-4"><a href="ols-and-endogeneity.html#cb263-4" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">sapply</span>(z, <span class="cf">function</span>(zi){</span>
<span id="cb263-5"><a href="ols-and-endogeneity.html#cb263-5" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,zi,<span class="dv">1</span>)</span>
<span id="cb263-6"><a href="ols-and-endogeneity.html#cb263-6" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,zi<span class="sc">*</span><span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb263-7"><a href="ols-and-endogeneity.html#cb263-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(x,y)</span>
<span id="cb263-8"><a href="ols-and-endogeneity.html#cb263-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb263-9"><a href="ols-and-endogeneity.html#cb263-9" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>xy[<span class="dv">1</span>,],<span class="at">y=</span>xy[<span class="dv">2</span>,])</span>
<span id="cb263-10"><a href="ols-and-endogeneity.html#cb263-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x, <span class="at">data=</span>xy, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">grey</span>(.<span class="dv">5</span>,.<span class="dv">5</span>))</span>
<span id="cb263-11"><a href="ols-and-endogeneity.html#cb263-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">data=</span>xy))</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>With multiple linear regression, note that endogeneity biases are not just a problem your main variable. Suppose your interested in how <span class="math inline">\(x_{1}\)</span> affects <span class="math inline">\(y\)</span>, conditional on <span class="math inline">\(x_{2}\)</span>. Letting <span class="math inline">\(X=[x_{1}, x_{2}]\)</span>, you estimate
<span class="math display">\[\begin{eqnarray}
\hat{\beta}_{OLS} = [X&#39;X]^{-1}X&#39;y
\end{eqnarray}\]</span>
You paid special attention in your research design to find a case where <span class="math inline">\(x_{1}\)</span> is truly exogenous. Unfortunately, <span class="math inline">\(x_{2}\)</span> is correlated with the error term. (How unfair, I know, especially after all that work). Nonetheless,
<span class="math display">\[\begin{eqnarray}
\mathbb{E}[X&#39;\epsilon] =
\begin{bmatrix}
0 \\ \rho
\end{bmatrix}\\
\mathbb{E}[ \hat{\beta}_{OLS} - \beta] = [X&#39;X]^{-1} \begin{bmatrix}
0 \\ \rho
\end{bmatrix} =
\begin{bmatrix}
\rho_{1} \\ \rho_{2}
\end{bmatrix}
\end{eqnarray}\]</span>
The magnitude of the bias for <span class="math inline">\(x_{1}\)</span> thus depends on the correlations between <span class="math inline">\(x_{1}\)</span> and <span class="math inline">\(x_{2}\)</span> as well as <span class="math inline">\(x_{2}\)</span> and <span class="math inline">\(\epsilon\)</span>.</p>
<p>Three statistical tools: 2SLS, RDD, and DID, are designed to address endogeneity issues. The elementary versions of these tools are linear regression. Because there are many textbooks and online notebooks that explain these methods at both high and low levels of technical detail, they are not covered extensively in this notebook. You are directed to the following resources which discuss these statistical models in more general terms and how they can be applied across many social sciences.</p>
<ul>
<li>Causal Inference for Statistics, Social, and Biomedical Sciences: An Introduction</li>
<li><a href="https://www.mostlyharmlesseconometrics.com/" class="uri">https://www.mostlyharmlesseconometrics.com/</a></li>
<li><a href="https://www.econometrics-with-r.org" class="uri">https://www.econometrics-with-r.org</a></li>
<li><a href="https://bookdown.org/paul/applied-causal-analysis/" class="uri">https://bookdown.org/paul/applied-causal-analysis/</a></li>
<li><a href="https://mixtape.scunning.com/" class="uri">https://mixtape.scunning.com/</a></li>
<li><a href="https://theeffectbook.net/" class="uri">https://theeffectbook.net/</a></li>
<li><a href="https://www.r-causal.org/" class="uri">https://www.r-causal.org/</a></li>
<li><a href="https://matheusfacure.github.io/python-causality-handbook/landing-page.html" class="uri">https://matheusfacure.github.io/python-causality-handbook/landing-page.html</a></li>
</ul>
<div id="two-stage-least-squares-2sls" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Two Stage Least Squares (2SLS)<a href="ols-and-endogeneity.html#two-stage-least-squares-2sls" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are many “Applied Statistics” approaches to 2SLS, and I encourage you to read up on them here</p>
<ul>
<li><a href="https://www.econometrics-with-r.org/12-ivr.html" class="uri">https://www.econometrics-with-r.org/12-ivr.html</a></li>
<li><a href="https://bookdown.org/paul/applied-causal-analysis/estimation-2.html" class="uri">https://bookdown.org/paul/applied-causal-analysis/estimation-2.html</a></li>
<li><a href="https://mixtape.scunning.com/07-instrumental_variables" class="uri">https://mixtape.scunning.com/07-instrumental_variables</a></li>
<li><a href="https://theeffectbook.net/ch-InstrumentalVariables.html" class="uri">https://theeffectbook.net/ch-InstrumentalVariables.html</a></li>
<li><a href="http://www.urfie.net/read/index.html#page/247" class="uri">http://www.urfie.net/read/index.html#page/247</a></li>
</ul>
<p>I will focus on the seminal case in economics, which is complementary and hopefully provides much intuition</p>
<div id="competitive-market-equilibrium" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Competitive Market Equilibrium<a href="ols-and-endogeneity.html#competitive-market-equilibrium" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Although there are many ways this simultaneity can happen, economic theorists have made great strides in analyzing the simultaneity problem as it arises from market relationships. In fact, the 2SLS statistical approach arose to understand the equilibrium of a single competitive market, which has three structural equations: (1) market supply is the sum of quantities supplied by individual firms, (2) market demand is the sum of quantities demanded by individual people, (3) market supply equals market demand.
<span class="math display">\[\begin{eqnarray}
Q^{D}(P) &amp;=&amp; \sum_{i} q^{D}_{i}(P)  \\
Q^{S}(P) &amp;=&amp; \sum_{i} q^{S}_{i}(P) \\
Q^{D} &amp;=&amp; Q^{S} = Q.
\end{eqnarray}\]</span>
This last equation implies a simultaneous “reduced form” relationship where both the price and the quantity are outcomes. If there is a linear parametric structure to these equations, then you can examine how a change in parameters affects both price and quantity. Specifically, if
<span class="math display">\[\begin{eqnarray}
\label{eqn:linear_demand}
Q^{D}(P) &amp;=&amp; A^{D} - B^{D} P + \epsilon^{D},\\
\label{eqn:linear_supply}
Q^{S}(P) &amp;=&amp; A^{S} + B^{S} P + \epsilon^{S},
\end{eqnarray}\]</span>
then equilibrium yields reduced form equations that collapse into intercept and residual terms;
<span class="math display">\[\begin{eqnarray}
P^{*} &amp;=&amp; \frac{A^{D}-A^{S}}{B^{D}+B^{S}} + \frac{\epsilon^{D} - \epsilon^{S}}{B^{D}+B^{S}} = \alpha^{P} + \nu^{P}, \\
Q^{*} &amp;=&amp; \frac{A^{S}B^{D}+ A^{D}B^{S}}{B^{D}+B^{S}} + \frac{\epsilon^{S}B^{D}+ \epsilon^{D}B^{S}}{B^{D}+B^{S}}= \alpha^{Q} + \nu^{Q}.
\end{eqnarray}\]</span></p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="ols-and-endogeneity.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Competitive Market Process</span></span>
<span id="cb264-2"><a href="ols-and-endogeneity.html#cb264-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-3"><a href="ols-and-endogeneity.html#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Parameters</span></span>
<span id="cb264-4"><a href="ols-and-endogeneity.html#cb264-4" aria-hidden="true" tabindex="-1"></a>plm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>) <span class="do">## Price Range</span></span>
<span id="cb264-5"><a href="ols-and-endogeneity.html#cb264-5" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">seq</span>(plm[<span class="dv">1</span>],plm[<span class="dv">2</span>],<span class="at">by=</span>.<span class="dv">01</span>) <span class="do">## Price to Consider</span></span>
<span id="cb264-6"><a href="ols-and-endogeneity.html#cb264-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-7"><a href="ols-and-endogeneity.html#cb264-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Demand Curve Simulator</span></span>
<span id="cb264-8"><a href="ols-and-endogeneity.html#cb264-8" aria-hidden="true" tabindex="-1"></a>qd_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(p, <span class="at">Ad=</span><span class="dv">8</span>, <span class="at">Bd=</span><span class="sc">-</span>.<span class="dv">8</span>, <span class="at">Ed_sigma=</span>.<span class="dv">25</span>){</span>
<span id="cb264-9"><a href="ols-and-endogeneity.html#cb264-9" aria-hidden="true" tabindex="-1"></a>    Qd <span class="ot">&lt;-</span> Ad <span class="sc">+</span> Bd<span class="sc">*</span>p <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,Ed_sigma)</span>
<span id="cb264-10"><a href="ols-and-endogeneity.html#cb264-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb264-11"><a href="ols-and-endogeneity.html#cb264-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-12"><a href="ols-and-endogeneity.html#cb264-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Supply Curve Simulator</span></span>
<span id="cb264-13"><a href="ols-and-endogeneity.html#cb264-13" aria-hidden="true" tabindex="-1"></a>qs_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(p, <span class="at">As=</span><span class="sc">-</span><span class="dv">8</span>, <span class="at">Bs=</span><span class="dv">1</span>, <span class="at">Es_sigma=</span>.<span class="dv">25</span>){</span>
<span id="cb264-14"><a href="ols-and-endogeneity.html#cb264-14" aria-hidden="true" tabindex="-1"></a>    Qs <span class="ot">&lt;-</span> As <span class="sc">+</span> Bs<span class="sc">*</span>p <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,Es_sigma)</span>
<span id="cb264-15"><a href="ols-and-endogeneity.html#cb264-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="ols-and-endogeneity.html#cb265-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">300</span> <span class="do">## Number of Simulations</span></span>
<span id="cb265-2"><a href="ols-and-endogeneity.html#cb265-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-3"><a href="ols-and-endogeneity.html#cb265-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Generate Equilibrium Data</span></span>
<span id="cb265-4"><a href="ols-and-endogeneity.html#cb265-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot Underlying Process</span></span>
<span id="cb265-5"><a href="ols-and-endogeneity.html#cb265-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb265-6"><a href="ols-and-endogeneity.html#cb265-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.window</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">ylim=</span>plm)</span>
<span id="cb265-7"><a href="ols-and-endogeneity.html#cb265-7" aria-hidden="true" tabindex="-1"></a>EQ1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(n){</span>
<span id="cb265-8"><a href="ols-and-endogeneity.html#cb265-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-9"><a href="ols-and-endogeneity.html#cb265-9" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Market Mechanisms</span></span>
<span id="cb265-10"><a href="ols-and-endogeneity.html#cb265-10" aria-hidden="true" tabindex="-1"></a>    demand <span class="ot">&lt;-</span> <span class="fu">qd_fun</span>(P)</span>
<span id="cb265-11"><a href="ols-and-endogeneity.html#cb265-11" aria-hidden="true" tabindex="-1"></a>    supply <span class="ot">&lt;-</span> <span class="fu">qs_fun</span>(P)</span>
<span id="cb265-12"><a href="ols-and-endogeneity.html#cb265-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-13"><a href="ols-and-endogeneity.html#cb265-13" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Compute EQ (what we observe)</span></span>
<span id="cb265-14"><a href="ols-and-endogeneity.html#cb265-14" aria-hidden="true" tabindex="-1"></a>    eq_id <span class="ot">&lt;-</span> <span class="fu">which.min</span>( <span class="fu">abs</span>(demand<span class="sc">-</span>supply) )</span>
<span id="cb265-15"><a href="ols-and-endogeneity.html#cb265-15" aria-hidden="true" tabindex="-1"></a>    eq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">P=</span>P[eq_id], <span class="at">Q=</span>demand[eq_id]) </span>
<span id="cb265-16"><a href="ols-and-endogeneity.html#cb265-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb265-17"><a href="ols-and-endogeneity.html#cb265-17" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Plot Theoretical Supply and Demand behind EQ</span></span>
<span id="cb265-18"><a href="ols-and-endogeneity.html#cb265-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(demand, P, <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">01</span>))</span>
<span id="cb265-19"><a href="ols-and-endogeneity.html#cb265-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(supply, P, <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">01</span>))</span>
<span id="cb265-20"><a href="ols-and-endogeneity.html#cb265-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(eq[<span class="dv">2</span>], eq[<span class="dv">1</span>], <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">05</span>), <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb265-21"><a href="ols-and-endogeneity.html#cb265-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-22"><a href="ols-and-endogeneity.html#cb265-22" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Return Equilibrium Observations</span></span>
<span id="cb265-23"><a href="ols-and-endogeneity.html#cb265-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(eq)</span>
<span id="cb265-24"><a href="ols-and-endogeneity.html#cb265-24" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb265-25"><a href="ols-and-endogeneity.html#cb265-25" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>)</span>
<span id="cb265-26"><a href="ols-and-endogeneity.html#cb265-26" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb265-27"><a href="ols-and-endogeneity.html#cb265-27" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;Quantity&#39;</span>,<span class="dv">1</span>, <span class="at">line=</span><span class="dv">2</span>)</span>
<span id="cb265-28"><a href="ols-and-endogeneity.html#cb265-28" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;Price&#39;</span>,<span class="dv">2</span>, <span class="at">line=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>You can simply run a regression of one variable on another, but you will need much luck to correctly interrupt the resulting number. Consider regressing quantity on price;
<span class="math display">\[\begin{eqnarray}
Q &amp;=&amp; \alpha^{Q} + \beta^{Q} P + \epsilon^{Q} = \alpha^{Q} + \beta^{Q} [\alpha^{P} + \beta^{P} Q + \epsilon^{P}] + \epsilon^{Q} \\
&amp;=&amp; \frac{[\alpha^{Q} +  \epsilon^{Q}] + \beta^{Q} [\alpha^{P} + \epsilon^{P}]}{1-\beta^{P}}
\end{eqnarray}\]</span>
We can see <span class="math inline">\(Q\)</span> is a function of <span class="math inline">\(\epsilon^{P}\)</span>, thus biasing the estimate of <span class="math inline">\(\beta^{P}\)</span>. If you were to instead regress <span class="math inline">\(Q\)</span> on <span class="math inline">\(P\)</span>, you would similarly get a number that is hard to interpret meaningfully. This simple derivation has a profound insight: price-quantity data does not generally tell you how price affects quantity supplied or demanded (and vice-versa).</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="ols-and-endogeneity.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Analyze Market Data</span></span>
<span id="cb266-2"><a href="ols-and-endogeneity.html#cb266-2" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(EQ1), <span class="at">cost=</span><span class="st">&#39;1&#39;</span>)</span>
<span id="cb266-3"><a href="ols-and-endogeneity.html#cb266-3" aria-hidden="true" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Q<span class="sc">~</span>P, <span class="at">data=</span>dat1)</span>
<span id="cb266-4"><a href="ols-and-endogeneity.html#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Q ~ P, data = dat1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.50326 -0.12722  0.00035  0.11906  0.51042 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -0.11404    0.46544  -0.245   0.8066  
## P            0.11218    0.05239   2.141   0.0331 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.178 on 298 degrees of freedom
## Multiple R-squared:  0.01515,    Adjusted R-squared:  0.01185 
## F-statistic: 4.584 on 1 and 298 DF,  p-value: 0.03308</code></pre>
<p>If you have exogeneous variation on one side of the market, ``shocks’’, you can get information on the other. Experimental manipulation of <span class="math inline">\(A^{S}\)</span> would, for example, allow you to trace out part of a demand curve:
<span class="math display">\[\begin{eqnarray}
\frac{\partial P^{*}}{\partial A^{S}} = \frac{-1}{B^{D}+B^{S}}, \\
\frac{\partial Q^{*}}{\partial A^{S}} = \frac{B^{D}}{B^{D}+B^{S}}.
\end{eqnarray}\]</span>
Notice that even in this linear model, all effects are conditional: <em>The</em> effect of a cost change on quantity or price depends on the demand curve. A change in costs affects quantity supplied but not quantity demanded (which then affects equilibrium price) but the demand side of the market still matters! The change in price from a change in costs depends on the elasticity of demand. (Likewise for changes in demand parameters.)</p>
<p>With two equations and two unknowns, we can estimate <span class="math inline">\(B^{D}\)</span> and <span class="math inline">\(B^{S}\)</span>, which was the original idea behind 2SLS. Substituting the equilibrium condition into the structural demand equation, we can rewrite them as
<span class="math display">\[\begin{eqnarray}
\label{eqn:linear_demand_iv}
P(Q) &amp;=&amp; -\frac{A^{D}}{{B^{D}}} + \frac{Q^{s}}{B^{D}} - \frac{\epsilon^{D}}{B^{D}}  = \alpha^{P} + \beta^{P} Q + \epsilon^{P}\\
\label{eqn:linear_supply_iv}
Q(P) &amp;=&amp;  A^{S}  + \epsilon^{S} +  B^{S} P .
\end{eqnarray}\]</span></p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="ols-and-endogeneity.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Supply Shifter</span></span>
<span id="cb268-2"><a href="ols-and-endogeneity.html#cb268-2" aria-hidden="true" tabindex="-1"></a>EQ2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(n){</span>
<span id="cb268-3"><a href="ols-and-endogeneity.html#cb268-3" aria-hidden="true" tabindex="-1"></a>    <span class="do">## New Demand, but same par&#39;s</span></span>
<span id="cb268-4"><a href="ols-and-endogeneity.html#cb268-4" aria-hidden="true" tabindex="-1"></a>    demand <span class="ot">&lt;-</span> <span class="fu">qd_fun</span>(P)</span>
<span id="cb268-5"><a href="ols-and-endogeneity.html#cb268-5" aria-hidden="true" tabindex="-1"></a>    <span class="do">## New Supply Curves</span></span>
<span id="cb268-6"><a href="ols-and-endogeneity.html#cb268-6" aria-hidden="true" tabindex="-1"></a>    supply2 <span class="ot">&lt;-</span> <span class="fu">qs_fun</span>(P, <span class="at">As=</span><span class="sc">-</span><span class="fl">6.5</span>)</span>
<span id="cb268-7"><a href="ols-and-endogeneity.html#cb268-7" aria-hidden="true" tabindex="-1"></a>    <span class="do">## lines(supply2, P, col=rgb(0,0,1,.01))</span></span>
<span id="cb268-8"><a href="ols-and-endogeneity.html#cb268-8" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Compute New EQ</span></span>
<span id="cb268-9"><a href="ols-and-endogeneity.html#cb268-9" aria-hidden="true" tabindex="-1"></a>    eq_id <span class="ot">&lt;-</span> <span class="fu">which.min</span>( <span class="fu">abs</span>(demand<span class="sc">-</span>supply2) )</span>
<span id="cb268-10"><a href="ols-and-endogeneity.html#cb268-10" aria-hidden="true" tabindex="-1"></a>    eq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">P=</span>P[eq_id], <span class="at">Q=</span>demand[eq_id]) </span>
<span id="cb268-11"><a href="ols-and-endogeneity.html#cb268-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#points(eq[2], eq[1], col=rgb(0,0,1,.05), pch=16)</span></span>
<span id="cb268-12"><a href="ols-and-endogeneity.html#cb268-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(eq)</span>
<span id="cb268-13"><a href="ols-and-endogeneity.html#cb268-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb268-14"><a href="ols-and-endogeneity.html#cb268-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-15"><a href="ols-and-endogeneity.html#cb268-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Market Data w/ Supply Shift</span></span>
<span id="cb268-16"><a href="ols-and-endogeneity.html#cb268-16" aria-hidden="true" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(EQ2), <span class="at">cost=</span><span class="st">&#39;2&#39;</span>)</span>
<span id="cb268-17"><a href="ols-and-endogeneity.html#cb268-17" aria-hidden="true" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat1, dat2)</span>
<span id="cb268-18"><a href="ols-and-endogeneity.html#cb268-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-19"><a href="ols-and-endogeneity.html#cb268-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-20"><a href="ols-and-endogeneity.html#cb268-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot Market Data  w/ Supply Shift</span></span>
<span id="cb268-21"><a href="ols-and-endogeneity.html#cb268-21" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">as.numeric</span>(dat2<span class="sc">$</span>cost)<span class="sc">==</span><span class="dv">2</span>, <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">2</span>), <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">2</span>))</span>
<span id="cb268-22"><a href="ols-and-endogeneity.html#cb268-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb268-23"><a href="ols-and-endogeneity.html#cb268-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.window</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">ylim=</span>plm)</span>
<span id="cb268-24"><a href="ols-and-endogeneity.html#cb268-24" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dat2<span class="sc">$</span>Q, dat2<span class="sc">$</span>P, <span class="at">col=</span>cols, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb268-25"><a href="ols-and-endogeneity.html#cb268-25" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>)</span>
<span id="cb268-26"><a href="ols-and-endogeneity.html#cb268-26" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb268-27"><a href="ols-and-endogeneity.html#cb268-27" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;Quantity&#39;</span>,<span class="dv">1</span>, <span class="at">line=</span><span class="dv">2</span>)</span>
<span id="cb268-28"><a href="ols-and-endogeneity.html#cb268-28" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;Price&#39;</span>,<span class="dv">2</span>, <span class="at">line=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="ols-and-endogeneity.html#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Not exact, at least right sign</span></span>
<span id="cb269-2"><a href="ols-and-endogeneity.html#cb269-2" aria-hidden="true" tabindex="-1"></a>reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Q<span class="sc">~</span>P, <span class="at">data=</span>dat2)</span>
<span id="cb269-3"><a href="ols-and-endogeneity.html#cb269-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Q ~ P, data = dat2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.80930 -0.15470  0.00346  0.16423  0.70722 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  6.67700    0.18096   36.90   &lt;2e-16 ***
## P           -0.64464    0.02134  -30.21   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2384 on 598 degrees of freedom
## Multiple R-squared:  0.6042, Adjusted R-squared:  0.6035 
## F-statistic: 912.7 on 1 and 598 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="ols-and-endogeneity.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Instrumental Variables Estimates</span></span>
<span id="cb271-2"><a href="ols-and-endogeneity.html#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb271-3"><a href="ols-and-endogeneity.html#cb271-3" aria-hidden="true" tabindex="-1"></a>reg2_iv <span class="ot">&lt;-</span> <span class="fu">feols</span>(Q<span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>P<span class="sc">~</span>cost, <span class="at">data=</span>dat2)</span>
<span id="cb271-4"><a href="ols-and-endogeneity.html#cb271-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg2_iv)</span></code></pre></div>
<pre><code>## TSLS estimation, Dep. Var.: Q, Endo.: P, Instr.: cost
## Second stage: Dep. Var.: Q
## Observations: 600 
## Standard-errors: IID 
##              Estimate Std. Error  t value  Pr(&gt;|t|)    
## (Intercept)  8.105260   0.210139  38.5709 &lt; 2.2e-16 ***
## fit_P       -0.813293   0.024785 -32.8140 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## RMSE: 0.250145   Adj. R2: 0.562071
## F-test (1st stage), P: stat = 2,698.8, p &lt; 2.2e-16, on 1 and 598 DoF.
##            Wu-Hausman: stat =   532.6, p &lt; 2.2e-16, on 1 and 597 DoF.</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="ols-and-endogeneity.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Many alternative packages can do IV</span></span>
<span id="cb273-2"><a href="ols-and-endogeneity.html#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="do">## library(ivreg)</span></span>
<span id="cb273-3"><a href="ols-and-endogeneity.html#cb273-3" aria-hidden="true" tabindex="-1"></a><span class="do">## summary( ivreg(Q~P|cost, data=dat2) )</span></span></code></pre></div>
<p>If we had multiple alleged supply shifts and recorded their magnitudes, then we could recover more information about demand.</p>
<p><strong>Caveat</strong> The coefficient interpretation rests on many assumptions. We have implicitly assumed</p>
<ul>
<li>both supply and demand are linear and additively seperable in covariates.</li>
<li>only supply was affected, and it was only an intercept shift.</li>
<li>the shock large enough to be picked up statistically.</li>
</ul>
<p>We always get coefficients back when fitting <code>feols</code> but are rarely confident that all these assumptions hold. This is one reason why researchers often also report their OLS results.</p>
</div>
</div>
<div id="regression-discontinuitieskink-rdrk" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Regression Discontinuities/Kink (RD/RK)<a href="ols-and-endogeneity.html#regression-discontinuitieskink-rdrk" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The basic idea here is to examine how a variable changes in response to an exogenous shock. Again, there is a large “Applied Statistics” literature I direct you to first</p>
<ul>
<li><a href="https://bookdown.org/paul/applied-causal-analysis/rdd-regression-discontinuity-design.html" class="uri">https://bookdown.org/paul/applied-causal-analysis/rdd-regression-discontinuity-design.html</a></li>
<li><a href="https://mixtape.scunning.com/06-regression_discontinuity" class="uri">https://mixtape.scunning.com/06-regression_discontinuity</a></li>
<li><a href="https://theeffectbook.net/ch-RegressionDiscontinuity.html" class="uri">https://theeffectbook.net/ch-RegressionDiscontinuity.html</a></li>
</ul>
<p>The Regression Discontinuities estimate of the cost shock is the difference in the outcome variable just before and just after the shock. We now turn to our canonical competitive market example. The RD estimate is the difference between the red and blue lines at <span class="math inline">\(T=300\)</span>.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="ols-and-endogeneity.html#cb274-1" aria-hidden="true" tabindex="-1"></a>dat2<span class="sc">$</span>T <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dat2)</span>
<span id="cb274-2"><a href="ols-and-endogeneity.html#cb274-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-3"><a href="ols-and-endogeneity.html#cb274-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(P<span class="sc">~</span>T, dat2, <span class="at">main=</span><span class="st">&#39;Effect of Cost Shock on Price&#39;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">5</span>))</span>
<span id="cb274-4"><a href="ols-and-endogeneity.html#cb274-4" aria-hidden="true" tabindex="-1"></a>regP1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(P<span class="sc">~</span>T, dat2[dat2<span class="sc">$</span>cost<span class="sc">==</span><span class="dv">1</span>,]) </span>
<span id="cb274-5"><a href="ols-and-endogeneity.html#cb274-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(regP1<span class="sc">$</span>model<span class="sc">$</span>T, <span class="fu">predict</span>(regP1), <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb274-6"><a href="ols-and-endogeneity.html#cb274-6" aria-hidden="true" tabindex="-1"></a>regP2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(P<span class="sc">~</span>T, dat2[dat2<span class="sc">$</span>cost<span class="sc">==</span><span class="dv">2</span>,]) </span>
<span id="cb274-7"><a href="ols-and-endogeneity.html#cb274-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(regP2<span class="sc">$</span>model<span class="sc">$</span>T, <span class="fu">predict</span>(regP2), <span class="at">col=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="ols-and-endogeneity.html#cb275-1" aria-hidden="true" tabindex="-1"></a>regP <span class="ot">&lt;-</span> <span class="fu">lm</span>(P<span class="sc">~</span>T<span class="sc">*</span>cost, dat2)</span>
<span id="cb275-2"><a href="ols-and-endogeneity.html#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regP)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = P ~ T * cost, data = dat2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.74929 -0.10706  0.01709  0.12333  0.48885 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  8.875e+00  2.256e-02 393.425   &lt;2e-16 ***
## T            4.092e-05  1.299e-04   0.315    0.753    
## cost2       -8.468e-01  6.372e-02 -13.288   &lt;2e-16 ***
## T:cost2      2.016e-05  1.837e-04   0.110    0.913    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1949 on 596 degrees of freedom
## Multiple R-squared:  0.8187, Adjusted R-squared:  0.8178 
## F-statistic: 897.2 on 3 and 596 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="ols-and-endogeneity.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Q<span class="sc">~</span>T, dat2, <span class="at">main=</span><span class="st">&#39;Effect of Cost Shock on Quantity&#39;</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">5</span>))</span>
<span id="cb277-2"><a href="ols-and-endogeneity.html#cb277-2" aria-hidden="true" tabindex="-1"></a>regQ1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Q<span class="sc">~</span>T, dat2[dat2<span class="sc">$</span>cost<span class="sc">==</span><span class="dv">1</span>,]) </span>
<span id="cb277-3"><a href="ols-and-endogeneity.html#cb277-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(regQ1<span class="sc">$</span>model<span class="sc">$</span>T, <span class="fu">predict</span>(regQ1), <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb277-4"><a href="ols-and-endogeneity.html#cb277-4" aria-hidden="true" tabindex="-1"></a>regQ2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Q<span class="sc">~</span>T, dat2[dat2<span class="sc">$</span>cost<span class="sc">==</span><span class="dv">2</span>,]) </span>
<span id="cb277-5"><a href="ols-and-endogeneity.html#cb277-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(regQ2<span class="sc">$</span>model<span class="sc">$</span>T, <span class="fu">predict</span>(regQ2), <span class="at">col=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="ols-and-endogeneity.html#cb278-1" aria-hidden="true" tabindex="-1"></a>regQ <span class="ot">&lt;-</span> <span class="fu">lm</span>(Q<span class="sc">~</span>T<span class="sc">*</span>cost, dat2)</span>
<span id="cb278-2"><a href="ols-and-endogeneity.html#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regQ)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Q ~ T * cost, data = dat2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.50973 -0.12377 -0.00021  0.12746  0.61296 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  8.809e-01  2.027e-02  43.463   &lt;2e-16 ***
## T            8.973e-06  1.167e-04   0.077    0.939    
## cost2        6.808e-01  5.726e-02  11.891   &lt;2e-16 ***
## T:cost2     -2.706e-05  1.651e-04  -0.164    0.870    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1751 on 596 degrees of freedom
## Multiple R-squared:  0.7872, Adjusted R-squared:  0.7862 
## F-statistic:   735 on 3 and 596 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Remember that this is effect is <em>local</em>: different magnitudes of the cost shock or different demand curves generally yeild different estimates.</p>
</div>
<div id="difference-in-differences-did" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Difference in Differences (DID)<a href="ols-and-endogeneity.html#difference-in-differences-did" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The basic idea here is to examine how a variable changes in response to an exogenous shock, <em>compared to a control group</em>. Again, there is a large “Applied Statistics” literature I direct you to first</p>
<ul>
<li><a href="https://mixtape.scunning.com/09-difference_in_differences" class="uri">https://mixtape.scunning.com/09-difference_in_differences</a></li>
<li><a href="https://theeffectbook.net/ch-DifferenceinDifference.html" class="uri">https://theeffectbook.net/ch-DifferenceinDifference.html</a></li>
<li><a href="http://www.urfie.net/read/index.html#page/226" class="uri">http://www.urfie.net/read/index.html#page/226</a></li>
</ul>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="ols-and-endogeneity.html#cb280-1" aria-hidden="true" tabindex="-1"></a>EQ3 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>N), <span class="cf">function</span>(n){</span>
<span id="cb280-2"><a href="ols-and-endogeneity.html#cb280-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-3"><a href="ols-and-endogeneity.html#cb280-3" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Market Mechanisms</span></span>
<span id="cb280-4"><a href="ols-and-endogeneity.html#cb280-4" aria-hidden="true" tabindex="-1"></a>    demand <span class="ot">&lt;-</span> <span class="fu">qd_fun</span>(P)</span>
<span id="cb280-5"><a href="ols-and-endogeneity.html#cb280-5" aria-hidden="true" tabindex="-1"></a>    supply <span class="ot">&lt;-</span> <span class="fu">qs_fun</span>(P)</span>
<span id="cb280-6"><a href="ols-and-endogeneity.html#cb280-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-7"><a href="ols-and-endogeneity.html#cb280-7" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Compute EQ (what we observe)</span></span>
<span id="cb280-8"><a href="ols-and-endogeneity.html#cb280-8" aria-hidden="true" tabindex="-1"></a>    eq_id <span class="ot">&lt;-</span> <span class="fu">which.min</span>( <span class="fu">abs</span>(demand<span class="sc">-</span>supply) )</span>
<span id="cb280-9"><a href="ols-and-endogeneity.html#cb280-9" aria-hidden="true" tabindex="-1"></a>    eq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">P=</span>P[eq_id], <span class="at">Q=</span>demand[eq_id]) </span>
<span id="cb280-10"><a href="ols-and-endogeneity.html#cb280-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-11"><a href="ols-and-endogeneity.html#cb280-11" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Return Equilibrium Observations</span></span>
<span id="cb280-12"><a href="ols-and-endogeneity.html#cb280-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(eq)</span>
<span id="cb280-13"><a href="ols-and-endogeneity.html#cb280-13" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb280-14"><a href="ols-and-endogeneity.html#cb280-14" aria-hidden="true" tabindex="-1"></a>dat3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(EQ3), <span class="at">cost=</span><span class="st">&#39;1&#39;</span>, <span class="at">T=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(EQ3))</span>
<span id="cb280-15"><a href="ols-and-endogeneity.html#cb280-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-16"><a href="ols-and-endogeneity.html#cb280-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-17"><a href="ols-and-endogeneity.html#cb280-17" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb280-18"><a href="ols-and-endogeneity.html#cb280-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(P<span class="sc">~</span>T, dat2, <span class="at">main=</span><span class="st">&#39;Effect of Cost Shock on Price&#39;</span>, <span class="at">pch=</span><span class="dv">17</span>,<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">25</span>))</span>
<span id="cb280-19"><a href="ols-and-endogeneity.html#cb280-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(P<span class="sc">~</span>T, dat3, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">25</span>))</span>
<span id="cb280-20"><a href="ols-and-endogeneity.html#cb280-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-21"><a href="ols-and-endogeneity.html#cb280-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Q<span class="sc">~</span>T, dat2, <span class="at">main=</span><span class="st">&#39;Effect of Cost Shock on Quantity&#39;</span>, <span class="at">pch=</span><span class="dv">17</span>,<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">25</span>))</span>
<span id="cb280-22"><a href="ols-and-endogeneity.html#cb280-22" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Q<span class="sc">~</span>T, dat3, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">25</span>))</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="ols-and-endogeneity.html#cb281-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat2, dat3)</span>
<span id="cb281-2"><a href="ols-and-endogeneity.html#cb281-2" aria-hidden="true" tabindex="-1"></a>regP <span class="ot">&lt;-</span> <span class="fu">lm</span>(P<span class="sc">~</span>T<span class="sc">*</span>cost, dat)</span>
<span id="cb281-3"><a href="ols-and-endogeneity.html#cb281-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regP)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = P ~ T * cost, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.74929 -0.12719  0.01159  0.12692  0.64538 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  8.874e+00  1.203e-02 737.427   &lt;2e-16 ***
## T            4.608e-05  4.005e-05   1.150    0.250    
## cost2       -8.453e-01  6.212e-02 -13.608   &lt;2e-16 ***
## T:cost2      1.500e-05  1.388e-04   0.108    0.914    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1993 on 1196 degrees of freedom
## Multiple R-squared:  0.7653, Adjusted R-squared:  0.7647 
## F-statistic:  1300 on 3 and 1196 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="ols-and-endogeneity.html#cb283-1" aria-hidden="true" tabindex="-1"></a>regQ <span class="ot">&lt;-</span> <span class="fu">lm</span>(Q<span class="sc">~</span>T<span class="sc">*</span>cost, dat)</span>
<span id="cb283-2"><a href="ols-and-endogeneity.html#cb283-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regQ)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Q ~ T * cost, data = dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.52578 -0.12678  0.00116  0.12668  0.61296 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  8.834e-01  1.086e-02  81.372   &lt;2e-16 ***
## T            1.085e-05  3.614e-05   0.300    0.764    
## cost2        6.784e-01  5.604e-02  12.105   &lt;2e-16 ***
## T:cost2     -2.893e-05  1.252e-04  -0.231    0.817    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1798 on 1196 degrees of freedom
## Multiple R-squared:  0.7217, Adjusted R-squared:  0.721 
## F-statistic:  1034 on 3 and 1196 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Again, the effects are local.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ols-diagnostics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-scientism.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["index.pdf", "index.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
