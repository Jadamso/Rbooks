<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 14 Observational Data | index</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content=" 14 Observational Data | index" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 14 Observational Data | index" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multiple-regression-ii.html"/>
<link rel="next" href="experimental-data.html"/>
<script src="libs/jquery-3.7.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/core-js-2.5.3/shim.min.js"></script>
<script src="libs/react-18.2.0/react.min.js"></script>
<script src="libs/react-18.2.0/react-dom.min.js"></script>
<script src="libs/reactwidget-2.0.0/react-tools.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/reactable-0.4.4/reactable.css" rel="stylesheet" />
<script src="libs/reactable-binding-0.4.4/reactable.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6.9000/profvis.js"></script>
<script src="libs/profvis-0.3.6.9000/scroll.js"></script>
<link href="libs/highlight-11.10.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-11.10.0/highlight.min.js"></script>
<script src="libs/profvis-binding-0.4.0/profvis.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Rbooks</a></li>
<li class="toc-logo"><a href="./"><img src="Figures_Manual/Logo.png" width="140" height="100"></a></li>        

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="part"><span><b>I Data Analysis in R</b></span></li>
<li class="chapter" data-level="2" data-path="first-steps.html"><a href="first-steps.html"><i class="fa fa-check"></i><b>2</b> First Steps</a>
<ul>
<li class="chapter" data-level="2.1" data-path="first-steps.html"><a href="first-steps.html#why-r"><i class="fa fa-check"></i><b>2.1</b> Why R</a></li>
<li class="chapter" data-level="2.2" data-path="first-steps.html"><a href="first-steps.html#install-r"><i class="fa fa-check"></i><b>2.2</b> Install R</a></li>
<li class="chapter" data-level="2.3" data-path="first-steps.html"><a href="first-steps.html#interfacing-with-r"><i class="fa fa-check"></i><b>2.3</b> Interfacing with R</a></li>
<li class="chapter" data-level="2.4" data-path="first-steps.html"><a href="first-steps.html#introductions-to-r"><i class="fa fa-check"></i><b>2.4</b> Introductions to R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>3</b> Mathematics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mathematics.html"><a href="mathematics.html#scalars"><i class="fa fa-check"></i><b>3.1</b> Scalars</a></li>
<li class="chapter" data-level="3.2" data-path="mathematics.html"><a href="mathematics.html#vectors"><i class="fa fa-check"></i><b>3.2</b> Vectors</a></li>
<li class="chapter" data-level="3.3" data-path="mathematics.html"><a href="mathematics.html#functions"><i class="fa fa-check"></i><b>3.3</b> Functions</a></li>
<li class="chapter" data-level="3.4" data-path="mathematics.html"><a href="mathematics.html#loops"><i class="fa fa-check"></i><b>3.4</b> Loops</a></li>
<li class="chapter" data-level="3.5" data-path="mathematics.html"><a href="mathematics.html#logic"><i class="fa fa-check"></i><b>3.5</b> Logic</a></li>
<li class="chapter" data-level="3.6" data-path="mathematics.html"><a href="mathematics.html#matrices"><i class="fa fa-check"></i><b>3.6</b> Matrices</a></li>
<li class="chapter" data-level="3.7" data-path="mathematics.html"><a href="mathematics.html#arrays"><i class="fa fa-check"></i><b>3.7</b> Arrays</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>4</b> Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data.html"><a href="data.html#types"><i class="fa fa-check"></i><b>4.1</b> Types</a></li>
<li class="chapter" data-level="4.2" data-path="data.html"><a href="data.html#empirical-distributions"><i class="fa fa-check"></i><b>4.2</b> Empirical Distributions</a></li>
<li class="chapter" data-level="4.3" data-path="data.html"><a href="data.html#joint-distributions"><i class="fa fa-check"></i><b>4.3</b> Joint Distributions</a></li>
<li class="chapter" data-level="4.4" data-path="data.html"><a href="data.html#conditional-distributions"><i class="fa fa-check"></i><b>4.4</b> Conditional Distributions</a></li>
<li class="chapter" data-level="4.5" data-path="data.html"><a href="data.html#random-variables"><i class="fa fa-check"></i><b>4.5</b> Random Variables</a></li>
<li class="chapter" data-level="4.6" data-path="data.html"><a href="data.html#further-reading"><i class="fa fa-check"></i><b>4.6</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>5</b> Statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="statistics.html"><a href="statistics.html#mean-and-variance"><i class="fa fa-check"></i><b>5.1</b> Mean and Variance</a></li>
<li class="chapter" data-level="5.2" data-path="statistics.html"><a href="statistics.html#shape-statistics"><i class="fa fa-check"></i><b>5.2</b> Shape Statistics</a></li>
<li class="chapter" data-level="5.3" data-path="statistics.html"><a href="statistics.html#other-centerspread-statistics"><i class="fa fa-check"></i><b>5.3</b> Other Center/Spread Statistics</a></li>
<li class="chapter" data-level="5.4" data-path="statistics.html"><a href="statistics.html#associations"><i class="fa fa-check"></i><b>5.4</b> Associations</a></li>
<li class="chapter" data-level="5.5" data-path="statistics.html"><a href="statistics.html#beyond-basics"><i class="fa fa-check"></i><b>5.5</b> Beyond Basics</a></li>
<li class="chapter" data-level="5.6" data-path="statistics.html"><a href="statistics.html#further-reading-1"><i class="fa fa-check"></i><b>5.6</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="resampling.html"><a href="resampling.html"><i class="fa fa-check"></i><b>6</b> (Re)Sampling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="resampling.html"><a href="resampling.html#sample-distributions"><i class="fa fa-check"></i><b>6.1</b> Sample Distributions</a></li>
<li class="chapter" data-level="6.2" data-path="resampling.html"><a href="resampling.html#intervals"><i class="fa fa-check"></i><b>6.2</b> Intervals</a></li>
<li class="chapter" data-level="6.3" data-path="resampling.html"><a href="resampling.html#resampling-1"><i class="fa fa-check"></i><b>6.3</b> Resampling</a></li>
<li class="chapter" data-level="6.4" data-path="resampling.html"><a href="resampling.html#value-of-more-data"><i class="fa fa-check"></i><b>6.4</b> Value of More Data</a></li>
<li class="chapter" data-level="6.5" data-path="resampling.html"><a href="resampling.html#further-reading-2"><i class="fa fa-check"></i><b>6.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html"><i class="fa fa-check"></i><b>7</b> Hypothesis Tests</a>
<ul>
<li class="chapter" data-level="7.1" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#basic-ideas"><i class="fa fa-check"></i><b>7.1</b> Basic Ideas</a></li>
<li class="chapter" data-level="7.2" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#default-statistics"><i class="fa fa-check"></i><b>7.2</b> Default Statistics</a></li>
<li class="chapter" data-level="7.3" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#two-sample-differences"><i class="fa fa-check"></i><b>7.3</b> Two-Sample Differences</a></li>
<li class="chapter" data-level="7.4" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#further-literature"><i class="fa fa-check"></i><b>7.4</b> Further Literature</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>8</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-analysis.html"><a href="data-analysis.html#reading-in"><i class="fa fa-check"></i><b>8.1</b> Reading In</a></li>
<li class="chapter" data-level="8.2" data-path="data-analysis.html"><a href="data-analysis.html#cleaning-data"><i class="fa fa-check"></i><b>8.2</b> Cleaning Data</a></li>
<li class="chapter" data-level="8.3" data-path="data-analysis.html"><a href="data-analysis.html#polishing"><i class="fa fa-check"></i><b>8.3</b> Polishing</a></li>
<li class="chapter" data-level="8.4" data-path="data-analysis.html"><a href="data-analysis.html#interactive"><i class="fa fa-check"></i><b>8.4</b> Interactive</a></li>
<li class="chapter" data-level="8.5" data-path="data-analysis.html"><a href="data-analysis.html#custom-figures"><i class="fa fa-check"></i><b>8.5</b> Custom Figures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="reporting.html"><a href="reporting.html"><i class="fa fa-check"></i><b>9</b> Reporting</a>
<ul>
<li class="chapter" data-level="9.1" data-path="reporting.html"><a href="reporting.html#r-and-r-markdown"><i class="fa fa-check"></i><b>9.1</b> R and R-Markdown</a></li>
<li class="chapter" data-level="9.2" data-path="reporting.html"><a href="reporting.html#simple-reports"><i class="fa fa-check"></i><b>9.2</b> Simple Reports</a></li>
<li class="chapter" data-level="9.3" data-path="reporting.html"><a href="reporting.html#posters-and-slides"><i class="fa fa-check"></i><b>9.3</b> Posters and Slides</a></li>
<li class="chapter" data-level="9.4" data-path="reporting.html"><a href="reporting.html#more-literature"><i class="fa fa-check"></i><b>9.4</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="probability-theory.html"><a href="probability-theory.html"><i class="fa fa-check"></i><b>10</b> Probability Theory</a>
<ul>
<li class="chapter" data-level="10.1" data-path="probability-theory.html"><a href="probability-theory.html#mean-and-variance-1"><i class="fa fa-check"></i><b>10.1</b> Mean and Variance</a></li>
<li class="chapter" data-level="10.2" data-path="probability-theory.html"><a href="probability-theory.html#bivariate-distributions"><i class="fa fa-check"></i><b>10.2</b> Bivariate Distributions</a></li>
<li class="chapter" data-level="10.3" data-path="probability-theory.html"><a href="probability-theory.html#further-reading-3"><i class="fa fa-check"></i><b>10.3</b> Further Reading</a></li>
</ul></li>
<li class="part"><span><b>II Linear Regression in R</b></span></li>
<li class="chapter" data-level="11" data-path="regression-basics.html"><a href="regression-basics.html"><i class="fa fa-check"></i><b>11</b> Regression Basics</a>
<ul>
<li class="chapter" data-level="11.1" data-path="regression-basics.html"><a href="regression-basics.html#simple-linear-regression"><i class="fa fa-check"></i><b>11.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="11.2" data-path="regression-basics.html"><a href="regression-basics.html#variability-estimates"><i class="fa fa-check"></i><b>11.2</b> Variability Estimates</a></li>
<li class="chapter" data-level="11.3" data-path="regression-basics.html"><a href="regression-basics.html#hypothesis-tests-1"><i class="fa fa-check"></i><b>11.3</b> Hypothesis Tests</a></li>
<li class="chapter" data-level="11.4" data-path="regression-basics.html"><a href="regression-basics.html#local-linear-regression"><i class="fa fa-check"></i><b>11.4</b> Local Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>12</b> Multiple Regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="multiple-regression.html"><a href="multiple-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>12.1</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="12.2" data-path="multiple-regression.html"><a href="multiple-regression.html#factor-variables"><i class="fa fa-check"></i><b>12.2</b> Factor Variables</a></li>
<li class="chapter" data-level="12.3" data-path="multiple-regression.html"><a href="multiple-regression.html#variability-estimates-1"><i class="fa fa-check"></i><b>12.3</b> Variability Estimates</a></li>
<li class="chapter" data-level="12.4" data-path="multiple-regression.html"><a href="multiple-regression.html#hypothesis-tests-2"><i class="fa fa-check"></i><b>12.4</b> Hypothesis Tests</a></li>
<li class="chapter" data-level="12.5" data-path="multiple-regression.html"><a href="multiple-regression.html#coefficient-interpretation"><i class="fa fa-check"></i><b>12.5</b> Coefficient Interpretation</a></li>
<li class="chapter" data-level="12.6" data-path="multiple-regression.html"><a href="multiple-regression.html#more-literature-1"><i class="fa fa-check"></i><b>12.6</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multiple-regression-ii.html"><a href="multiple-regression-ii.html"><i class="fa fa-check"></i><b>13</b> Multiple Regression II</a>
<ul>
<li class="chapter" data-level="13.1" data-path="multiple-regression-ii.html"><a href="multiple-regression-ii.html#diagnostics"><i class="fa fa-check"></i><b>13.1</b> Diagnostics</a></li>
<li class="chapter" data-level="13.2" data-path="multiple-regression-ii.html"><a href="multiple-regression-ii.html#transformations"><i class="fa fa-check"></i><b>13.2</b> Transformations</a></li>
<li class="chapter" data-level="13.3" data-path="multiple-regression-ii.html"><a href="multiple-regression-ii.html#regressograms"><i class="fa fa-check"></i><b>13.3</b> Regressograms</a></li>
<li class="chapter" data-level="13.4" data-path="multiple-regression-ii.html"><a href="multiple-regression-ii.html#more-literature-2"><i class="fa fa-check"></i><b>13.4</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="observational-data.html"><a href="observational-data.html"><i class="fa fa-check"></i><b>14</b> Observational Data</a>
<ul>
<li class="chapter" data-level="14.1" data-path="observational-data.html"><a href="observational-data.html#temporal-interdependence"><i class="fa fa-check"></i><b>14.1</b> Temporal Interdependence</a></li>
<li class="chapter" data-level="14.2" data-path="observational-data.html"><a href="observational-data.html#spatial-interdependence"><i class="fa fa-check"></i><b>14.2</b> Spatial Interdependence</a></li>
<li class="chapter" data-level="14.3" data-path="observational-data.html"><a href="observational-data.html#endogeneity-issues"><i class="fa fa-check"></i><b>14.3</b> Endogeneity Issues</a></li>
<li class="chapter" data-level="14.4" data-path="observational-data.html"><a href="observational-data.html#historical-event-studies"><i class="fa fa-check"></i><b>14.4</b> Historical Event Studies</a></li>
<li class="chapter" data-level="14.5" data-path="observational-data.html"><a href="observational-data.html#more-literature-3"><i class="fa fa-check"></i><b>14.5</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="experimental-data.html"><a href="experimental-data.html"><i class="fa fa-check"></i><b>15</b> Experimental Data</a>
<ul>
<li class="chapter" data-level="15.1" data-path="experimental-data.html"><a href="experimental-data.html#regression-discontinuitieskink-rdrk"><i class="fa fa-check"></i><b>15.1</b> Regression Discontinuities/Kink (RD/RK)</a></li>
<li class="chapter" data-level="15.2" data-path="experimental-data.html"><a href="experimental-data.html#difference-in-differences-did"><i class="fa fa-check"></i><b>15.2</b> Difference in Differences (DID)</a></li>
<li class="chapter" data-level="15.3" data-path="experimental-data.html"><a href="experimental-data.html#more-literature-4"><i class="fa fa-check"></i><b>15.3</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="data-scientism.html"><a href="data-scientism.html"><i class="fa fa-check"></i><b>16</b> Data Scientism</a>
<ul>
<li class="chapter" data-level="16.1" data-path="data-scientism.html"><a href="data-scientism.html#data-errors"><i class="fa fa-check"></i><b>16.1</b> Data Errors</a></li>
<li class="chapter" data-level="16.2" data-path="data-scientism.html"><a href="data-scientism.html#p-hacking"><i class="fa fa-check"></i><b>16.2</b> P-Hacking</a></li>
<li class="chapter" data-level="16.3" data-path="data-scientism.html"><a href="data-scientism.html#spurious-regression"><i class="fa fa-check"></i><b>16.3</b> Spurious Regression</a></li>
<li class="chapter" data-level="16.4" data-path="data-scientism.html"><a href="data-scientism.html#spurious-causal-impacts"><i class="fa fa-check"></i><b>16.4</b> Spurious Causal Impacts</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="misc.-topics.html"><a href="misc.-topics.html"><i class="fa fa-check"></i><b>17</b> Misc. Topics</a>
<ul>
<li class="chapter" data-level="17.1" data-path="misc.-topics.html"><a href="misc.-topics.html#locally-linear-multiple-regression"><i class="fa fa-check"></i><b>17.1</b> Locally Linear Multiple Regression</a></li>
<li class="chapter" data-level="17.2" data-path="misc.-topics.html"><a href="misc.-topics.html#nonparametric-tests"><i class="fa fa-check"></i><b>17.2</b> Nonparametric Tests</a></li>
<li class="chapter" data-level="17.3" data-path="misc.-topics.html"><a href="misc.-topics.html#prediction"><i class="fa fa-check"></i><b>17.3</b> Prediction</a></li>
<li class="chapter" data-level="17.4" data-path="misc.-topics.html"><a href="misc.-topics.html#decision-analysis"><i class="fa fa-check"></i><b>17.4</b> Decision Analysis</a></li>
</ul></li>
<li class="part"><span><b>III Reproducible Research in R</b></span></li>
<li class="chapter" data-level="18" data-path="why.html"><a href="why.html"><i class="fa fa-check"></i><b>18</b> Why?</a>
<ul>
<li class="chapter" data-level="18.1" data-path="why.html"><a href="why.html#an-example-workflow"><i class="fa fa-check"></i><b>18.1</b> An example workflow</a></li>
<li class="chapter" data-level="18.2" data-path="why.html"><a href="why.html#an-alternative-workflow"><i class="fa fa-check"></i><b>18.2</b> An alternative workflow</a></li>
<li class="chapter" data-level="18.3" data-path="why.html"><a href="why.html#task-views"><i class="fa fa-check"></i><b>18.3</b> Task Views</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="large-projects.html"><a href="large-projects.html"><i class="fa fa-check"></i><b>19</b> Large Projects</a>
<ul>
<li class="chapter" data-level="19.1" data-path="large-projects.html"><a href="large-projects.html#scripting"><i class="fa fa-check"></i><b>19.1</b> Scripting</a></li>
<li class="chapter" data-level="19.2" data-path="large-projects.html"><a href="large-projects.html#organization"><i class="fa fa-check"></i><b>19.2</b> Organization</a></li>
<li class="chapter" data-level="19.3" data-path="large-projects.html"><a href="large-projects.html#loggingsinking"><i class="fa fa-check"></i><b>19.3</b> Logging/Sinking</a></li>
<li class="chapter" data-level="19.4" data-path="large-projects.html"><a href="large-projects.html#class-projects"><i class="fa fa-check"></i><b>19.4</b> Class Projects</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="performance.html"><a href="performance.html"><i class="fa fa-check"></i><b>20</b> Performance</a>
<ul>
<li class="chapter" data-level="20.1" data-path="performance.html"><a href="performance.html#debugging"><i class="fa fa-check"></i><b>20.1</b> Debugging</a></li>
<li class="chapter" data-level="20.2" data-path="performance.html"><a href="performance.html#optimizing"><i class="fa fa-check"></i><b>20.2</b> Optimizing</a></li>
<li class="chapter" data-level="20.3" data-path="performance.html"><a href="performance.html#advanced-optimizing"><i class="fa fa-check"></i><b>20.3</b> Advanced Optimizing</a></li>
<li class="chapter" data-level="20.4" data-path="performance.html"><a href="performance.html#more-literature-5"><i class="fa fa-check"></i><b>20.4</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>21</b> Applications</a>
<ul>
<li class="chapter" data-level="21.1" data-path="applications.html"><a href="applications.html#more-literature-6"><i class="fa fa-check"></i><b>21.1</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i><b>22</b> Software</a>
<ul>
<li class="chapter" data-level="22.1" data-path="software.html"><a href="software.html#latest-versions"><i class="fa fa-check"></i><b>22.1</b> Latest versions</a></li>
<li class="chapter" data-level="22.2" data-path="software.html"><a href="software.html#general-workflow"><i class="fa fa-check"></i><b>22.2</b> General Workflow</a></li>
<li class="chapter" data-level="22.3" data-path="software.html"><a href="software.html#sweave"><i class="fa fa-check"></i><b>22.3</b> Sweave</a></li>
<li class="chapter" data-level="22.4" data-path="software.html"><a href="software.html#stata"><i class="fa fa-check"></i><b>22.4</b> Stata</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://sites.google.com/view/jordan-adamson" target="blank">Jordan Adamson</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="observational-data" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number"> 14</span> Observational Data<a href="observational-data.html#observational-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<hr />
<div id="temporal-interdependence" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> Temporal Interdependence<a href="observational-data.html#temporal-interdependence" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Stationary vs. Nonstationary</strong></p>
<p><strong>Measures of temporal association: ACF, CCF</strong></p>
</div>
<div id="spatial-interdependence" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> Spatial Interdependence<a href="observational-data.html#spatial-interdependence" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Stationary vs. Nonstationary</strong></p>
<p><strong>Measures of spatial association: ACF, CCF</strong></p>
</div>
<div id="endogeneity-issues" class="section level2 hasAnchor" number="14.3">
<h2><span class="header-section-number">14.3</span> Endogeneity Issues<a href="observational-data.html#endogeneity-issues" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Just like many economic relationships are nonlinear, many economic variables are endogenous. By this we typically mean that <span class="math inline">\(X\)</span> is an outcome determined (or caused: <span class="math inline">\(\to\)</span>) by some other variable.</p>
<ul>
<li>If <span class="math inline">\(Y \to X\)</span>, then we have reverse causality</li>
<li>If <span class="math inline">\(Y \to X\)</span> and <span class="math inline">\(X \to Y\)</span>, then we have simultaneity</li>
<li>If <span class="math inline">\(Z\to Y\)</span> and either <span class="math inline">\(Z\to X\)</span> or <span class="math inline">\(X \to Z\)</span>, then we have omitted a potentially important variable</li>
</ul>
<p>These endogeneity issues imply <span class="math inline">\(X\)</span> and <span class="math inline">\(\epsilon\)</span> are correlated, which is a barrier to interpreting OLS estimates causally. (<span class="math inline">\(X\)</span> and <span class="math inline">\(\epsilon\)</span> may be correlated for other reasons too, such as when <span class="math inline">\(X\)</span> is measured with error.)</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="observational-data.html#cb468-1" tabindex="-1"></a><span class="co"># Simulate data with an endogeneity issue</span></span>
<span id="cb468-2"><a href="observational-data.html#cb468-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb468-3"><a href="observational-data.html#cb468-3" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n,<span class="dv">1</span>,.<span class="dv">5</span>)</span>
<span id="cb468-4"><a href="observational-data.html#cb468-4" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">sapply</span>(z, <span class="cf">function</span>(zi){</span>
<span id="cb468-5"><a href="observational-data.html#cb468-5" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,zi,<span class="dv">1</span>)</span>
<span id="cb468-6"><a href="observational-data.html#cb468-6" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,zi<span class="sc">*</span><span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb468-7"><a href="observational-data.html#cb468-7" tabindex="-1"></a>    <span class="fu">c</span>(x,y)</span>
<span id="cb468-8"><a href="observational-data.html#cb468-8" tabindex="-1"></a>})</span>
<span id="cb468-9"><a href="observational-data.html#cb468-9" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>xy[<span class="dv">1</span>,],<span class="at">y=</span>xy[<span class="dv">2</span>,])</span>
<span id="cb468-10"><a href="observational-data.html#cb468-10" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x, <span class="at">data=</span>xy, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">5</span>))</span>
<span id="cb468-11"><a href="observational-data.html#cb468-11" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">data=</span>xy))</span></code></pre></div>
<p><img src="03-LinearRegression_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>With multiple linear regression, endogeneity biases are not just a problem for your main variable of interest. Suppose your interested in how <span class="math inline">\(x_{1}\)</span> affects <span class="math inline">\(y\)</span>, conditional on <span class="math inline">\(x_{2}\)</span>. Letting <span class="math inline">\(X=[x_{1}, x_{2}]\)</span>, you estimate
<span class="math display">\[\begin{eqnarray}
\hat{\beta}_{OLS} = [X&#39;X]^{-1}X&#39;y
\end{eqnarray}\]</span>
You paid special attention in your research design to find a case where <span class="math inline">\(x_{1}\)</span> is truly exogenous. Unfortunately, <span class="math inline">\(x_{2}\)</span> is correlated with the error term. (How unfair, I know, especially after all that work). Nonetheless,
<span class="math display">\[\begin{eqnarray}
\mathbb{E}[X&#39;\epsilon] =
\begin{bmatrix}
0 \\ \rho
\end{bmatrix}\\
\mathbb{E}[ \hat{\beta}_{OLS} - \beta] = [X&#39;X]^{-1} \begin{bmatrix}
0 \\ \rho
\end{bmatrix} =
\begin{bmatrix}
\rho_{1} \\ \rho_{2}
\end{bmatrix}
\end{eqnarray}\]</span>
The magnitude of the bias for <span class="math inline">\(x_{1}\)</span> thus depends on the correlations between <span class="math inline">\(x_{1}\)</span> and <span class="math inline">\(x_{2}\)</span> as well as <span class="math inline">\(x_{2}\)</span> and <span class="math inline">\(\epsilon\)</span>.</p>
<p>I will focus on the seminal economic example to provide some intuition.</p>
<p><strong>Competitive Market Equilibrium</strong>. This model has three structural relationships: (1) market supply is the sum of quantities supplied by individual firms at a given price, (2) market demand is the sum of quantities demanded by individual people at a given price, and (3) market supply equals market demand in equilibrium. Assuming market supply and demand are linear, we can write these three relationships as
<span class="math display">\[\begin{eqnarray}
Q_{S}(P) &amp;=&amp; A_{S} + B_{S} P + E_{S},\\
Q_{D}(P) &amp;=&amp; A_{D} - B_{D} P + E_{D},\\
Q_{D} &amp;=&amp; Q_{S} = Q.
%%  $Q_{D}(P) = \sum_{i} q_{D}_{i}(P)$,
\end{eqnarray}\]</span>
This last equation implies a simultaneous “reduced form” relationship where both the price and the quantity are outcomes. With a linear parametric structure to these equations, we can use algebra to solve for the equilibrium price and quantity analytically as
<span class="math display">\[\begin{eqnarray}
P^{*} &amp;=&amp; \frac{A_{D}-A_{S}}{B_{D}+B_{S}} + \frac{E_{D} - E_{S}}{B_{D}+B_{S}}, \\
Q^{*} &amp;=&amp; \frac{A_{S}B_{D}+ A_{D}B_{S}}{B_{D}+B_{S}} + \frac{E_{S}B_{D}+ E_{D}B_{S}}{B_{D}+B_{S}}.
\end{eqnarray}\]</span></p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="observational-data.html#cb469-1" tabindex="-1"></a><span class="co"># Demand Curve Simulator</span></span>
<span id="cb469-2"><a href="observational-data.html#cb469-2" tabindex="-1"></a>qd_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(p, <span class="at">Ad=</span><span class="dv">8</span>, <span class="at">Bd=</span><span class="sc">-</span>.<span class="dv">8</span>, <span class="at">Ed_sigma=</span>.<span class="dv">25</span>){</span>
<span id="cb469-3"><a href="observational-data.html#cb469-3" tabindex="-1"></a>    Qd <span class="ot">&lt;-</span> Ad <span class="sc">+</span> Bd<span class="sc">*</span>p <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,Ed_sigma)</span>
<span id="cb469-4"><a href="observational-data.html#cb469-4" tabindex="-1"></a>    <span class="fu">return</span>(Qd)</span>
<span id="cb469-5"><a href="observational-data.html#cb469-5" tabindex="-1"></a>}</span>
<span id="cb469-6"><a href="observational-data.html#cb469-6" tabindex="-1"></a></span>
<span id="cb469-7"><a href="observational-data.html#cb469-7" tabindex="-1"></a><span class="co"># Supply Curve Simulator</span></span>
<span id="cb469-8"><a href="observational-data.html#cb469-8" tabindex="-1"></a>qs_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(p, <span class="at">As=</span><span class="sc">-</span><span class="dv">8</span>, <span class="at">Bs=</span><span class="dv">1</span>, <span class="at">Es_sigma=</span>.<span class="dv">25</span>){</span>
<span id="cb469-9"><a href="observational-data.html#cb469-9" tabindex="-1"></a>    Qs <span class="ot">&lt;-</span> As <span class="sc">+</span> Bs<span class="sc">*</span>p <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,Es_sigma)</span>
<span id="cb469-10"><a href="observational-data.html#cb469-10" tabindex="-1"></a>    <span class="fu">return</span>(Qs)</span>
<span id="cb469-11"><a href="observational-data.html#cb469-11" tabindex="-1"></a>}</span>
<span id="cb469-12"><a href="observational-data.html#cb469-12" tabindex="-1"></a></span>
<span id="cb469-13"><a href="observational-data.html#cb469-13" tabindex="-1"></a><span class="co"># Quantity Supplied and Demanded at 3 Prices</span></span>
<span id="cb469-14"><a href="observational-data.html#cb469-14" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">P=</span><span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">D=</span><span class="fu">qd_fun</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">S=</span><span class="fu">qs_fun</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">10</span>))</span></code></pre></div>
<pre><code>##       P           D          S
## [1,]  8  1.57237229 -0.3224074
## [2,]  9  0.77237229  0.6775926
## [3,] 10 -0.02762771  1.6775926</code></pre>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="observational-data.html#cb471-1" tabindex="-1"></a><span class="co"># Market Equilibrium Finder</span></span>
<span id="cb471-2"><a href="observational-data.html#cb471-2" tabindex="-1"></a>eq_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(demand, supply, P){</span>
<span id="cb471-3"><a href="observational-data.html#cb471-3" tabindex="-1"></a>    <span class="co"># Compute EQ (what we observe)</span></span>
<span id="cb471-4"><a href="observational-data.html#cb471-4" tabindex="-1"></a>    eq_id <span class="ot">&lt;-</span> <span class="fu">which.min</span>( <span class="fu">abs</span>(demand<span class="sc">-</span>supply) )</span>
<span id="cb471-5"><a href="observational-data.html#cb471-5" tabindex="-1"></a>    eq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">P=</span>P[eq_id], <span class="at">Q=</span>demand[eq_id]) </span>
<span id="cb471-6"><a href="observational-data.html#cb471-6" tabindex="-1"></a>    <span class="fu">return</span>(eq)</span>
<span id="cb471-7"><a href="observational-data.html#cb471-7" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="observational-data.html#cb472-1" tabindex="-1"></a><span class="co"># Simulations Parameters</span></span>
<span id="cb472-2"><a href="observational-data.html#cb472-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">300</span> <span class="co"># Number of Market Interactions</span></span>
<span id="cb472-3"><a href="observational-data.html#cb472-3" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="at">by=</span>.<span class="dv">01</span>) <span class="co"># Price Range to Consider</span></span>
<span id="cb472-4"><a href="observational-data.html#cb472-4" tabindex="-1"></a></span>
<span id="cb472-5"><a href="observational-data.html#cb472-5" tabindex="-1"></a><span class="co"># Generate Data from Competitive Market  </span></span>
<span id="cb472-6"><a href="observational-data.html#cb472-6" tabindex="-1"></a><span class="co"># Plot Underlying Process</span></span>
<span id="cb472-7"><a href="observational-data.html#cb472-7" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb472-8"><a href="observational-data.html#cb472-8" tabindex="-1"></a><span class="fu">plot.window</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">ylim=</span><span class="fu">range</span>(P))</span>
<span id="cb472-9"><a href="observational-data.html#cb472-9" tabindex="-1"></a>EQ1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(n){</span>
<span id="cb472-10"><a href="observational-data.html#cb472-10" tabindex="-1"></a>    <span class="co"># Market Data Generating Process</span></span>
<span id="cb472-11"><a href="observational-data.html#cb472-11" tabindex="-1"></a>    demand <span class="ot">&lt;-</span> <span class="fu">qd_fun</span>(P)</span>
<span id="cb472-12"><a href="observational-data.html#cb472-12" tabindex="-1"></a>    supply <span class="ot">&lt;-</span> <span class="fu">qs_fun</span>(P)</span>
<span id="cb472-13"><a href="observational-data.html#cb472-13" tabindex="-1"></a>    eq <span class="ot">&lt;-</span> <span class="fu">eq_fun</span>(demand, supply, P)    </span>
<span id="cb472-14"><a href="observational-data.html#cb472-14" tabindex="-1"></a>    <span class="co"># Plot Theoretical Supply and Demand</span></span>
<span id="cb472-15"><a href="observational-data.html#cb472-15" tabindex="-1"></a>    <span class="fu">lines</span>(demand, P, <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">01</span>))</span>
<span id="cb472-16"><a href="observational-data.html#cb472-16" tabindex="-1"></a>    <span class="fu">lines</span>(supply, P, <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">01</span>))</span>
<span id="cb472-17"><a href="observational-data.html#cb472-17" tabindex="-1"></a>    <span class="fu">points</span>(eq[<span class="dv">2</span>], eq[<span class="dv">1</span>], <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">05</span>), <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb472-18"><a href="observational-data.html#cb472-18" tabindex="-1"></a>    <span class="co"># Save Data</span></span>
<span id="cb472-19"><a href="observational-data.html#cb472-19" tabindex="-1"></a>    <span class="fu">return</span>(eq)</span>
<span id="cb472-20"><a href="observational-data.html#cb472-20" tabindex="-1"></a>})</span>
<span id="cb472-21"><a href="observational-data.html#cb472-21" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>)</span>
<span id="cb472-22"><a href="observational-data.html#cb472-22" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb472-23"><a href="observational-data.html#cb472-23" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;Quantity&#39;</span>,<span class="dv">1</span>, <span class="at">line=</span><span class="dv">2</span>)</span>
<span id="cb472-24"><a href="observational-data.html#cb472-24" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;Price&#39;</span>,<span class="dv">2</span>, <span class="at">line=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-LinearRegression_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>Suppose we ask “what is the effect of price on quantity?” You can simply run a regression of quantity (“Y”) on price (“X”): <span class="math inline">\(\widehat{\beta}_{OLS} = Cov(Q^{*}, P^{*}) / Var(P^{*})\)</span>. You get a number back, but it is hard to interpret meaningfully.</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="observational-data.html#cb473-1" tabindex="-1"></a><span class="co"># Analyze Market Data</span></span>
<span id="cb473-2"><a href="observational-data.html#cb473-2" tabindex="-1"></a>dat1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(EQ1), <span class="at">cost=</span><span class="st">&#39;1&#39;</span>)</span>
<span id="cb473-3"><a href="observational-data.html#cb473-3" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Q<span class="sc">~</span>P, <span class="at">data=</span>dat1)</span>
<span id="cb473-4"><a href="observational-data.html#cb473-4" tabindex="-1"></a><span class="fu">summary</span>(reg1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Q ~ P, data = dat1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.54547 -0.11614 -0.00358  0.11621  0.53075 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  0.53119    0.48762   1.089    0.277
## P            0.04072    0.05476   0.744    0.458
## 
## Residual standard error: 0.1811 on 298 degrees of freedom
## Multiple R-squared:  0.001852,   Adjusted R-squared:  -0.001497 
## F-statistic: 0.553 on 1 and 298 DF,  p-value: 0.4577</code></pre>
<p>This simple derivation has a profound insight: price-quantity data does not generally tell you how price affects quantity (or vice-versa). The reason is simultaneity: price and quantity mutually cause one another in markets.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a></p>
<p>Moreover, this example also clarifies that our initial question “what is the effect of price on quantity?” is misguided. We could more sensibly ask “what is the effect of price on quantity supplied?” or “what is the effect of price on quantity demanded?”</p>
</div>
<div id="historical-event-studies" class="section level2 hasAnchor" number="14.4">
<h2><span class="header-section-number">14.4</span> Historical Event Studies<a href="observational-data.html#historical-event-studies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Historical Event Studies, sometimes called “natural experiments”, are case studies to remedy the endogeneity issues in observational data. The elementary versions use linear regressions, so I can cover them here using our competitive equilibrium example from before.</p>
<p><strong>Two Stage Least Squares (2SLS)</strong>.
If you have exogenous variation on one side of the market, “shocks”, you can get information on the other. For example, lower costs shift out supply (more is produced at given price), allowing you to trace out part of a demand curve.
Experimental manipulation of <span class="math inline">\(A_{S}\)</span> leads to
<span class="math display">\[\begin{eqnarray}
\label{eqn:comp_market_statics}
\frac{d P^{*}}{d A_{S}} = \frac{-1}{B_{D}+B_{S}}, \\
\frac{d Q^{*}}{d A_{S}} = \frac{B_{D}}{B_{D}+B_{S}}.
\end{eqnarray}\]</span>
So, absent any other changes, we could recover <span class="math inline">\(-B_{D}=d Q^{*}/d P^{*}\)</span>. In this case, the supply shock has identified the demand slope.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="observational-data.html#cb475-1" tabindex="-1"></a><span class="co"># New Observations After Cost Change</span></span>
<span id="cb475-2"><a href="observational-data.html#cb475-2" tabindex="-1"></a>EQ2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(n){</span>
<span id="cb475-3"><a href="observational-data.html#cb475-3" tabindex="-1"></a>    demand <span class="ot">&lt;-</span> <span class="fu">qd_fun</span>(P)</span>
<span id="cb475-4"><a href="observational-data.html#cb475-4" tabindex="-1"></a>    supply2 <span class="ot">&lt;-</span> <span class="fu">qs_fun</span>(P, <span class="at">As=</span><span class="sc">-</span><span class="fl">6.5</span>) <span class="co"># More Supplied at Given Price</span></span>
<span id="cb475-5"><a href="observational-data.html#cb475-5" tabindex="-1"></a>    eq <span class="ot">&lt;-</span> <span class="fu">eq_fun</span>(demand, supply2, P)</span>
<span id="cb475-6"><a href="observational-data.html#cb475-6" tabindex="-1"></a>    <span class="fu">return</span>(eq)</span>
<span id="cb475-7"><a href="observational-data.html#cb475-7" tabindex="-1"></a>    <span class="co"># lines(supply2, P, col=rgb(0,0,1,.01))</span></span>
<span id="cb475-8"><a href="observational-data.html#cb475-8" tabindex="-1"></a>    <span class="co">#points(eq[2], eq[1], col=rgb(0,0,1,.05), pch=16)</span></span>
<span id="cb475-9"><a href="observational-data.html#cb475-9" tabindex="-1"></a>})</span>
<span id="cb475-10"><a href="observational-data.html#cb475-10" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(EQ2), <span class="at">cost=</span><span class="st">&#39;2&#39;</span>)</span>
<span id="cb475-11"><a href="observational-data.html#cb475-11" tabindex="-1"></a></span>
<span id="cb475-12"><a href="observational-data.html#cb475-12" tabindex="-1"></a><span class="co"># Plot Market Data</span></span>
<span id="cb475-13"><a href="observational-data.html#cb475-13" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat1, dat2)</span>
<span id="cb475-14"><a href="observational-data.html#cb475-14" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">as.numeric</span>(dat2<span class="sc">$</span>cost)<span class="sc">==</span><span class="dv">2</span>, <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">2</span>), <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">2</span>))</span>
<span id="cb475-15"><a href="observational-data.html#cb475-15" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb475-16"><a href="observational-data.html#cb475-16" tabindex="-1"></a><span class="fu">plot.window</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">ylim=</span><span class="fu">range</span>(P))</span>
<span id="cb475-17"><a href="observational-data.html#cb475-17" tabindex="-1"></a><span class="fu">points</span>(dat2<span class="sc">$</span>Q, dat2<span class="sc">$</span>P, <span class="at">col=</span>cols, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb475-18"><a href="observational-data.html#cb475-18" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>)</span>
<span id="cb475-19"><a href="observational-data.html#cb475-19" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb475-20"><a href="observational-data.html#cb475-20" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;Quantity&#39;</span>,<span class="dv">1</span>, <span class="at">line=</span><span class="dv">2</span>)</span>
<span id="cb475-21"><a href="observational-data.html#cb475-21" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;Price&#39;</span>,<span class="dv">2</span>, <span class="at">line=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-LinearRegression_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>We are not quite done yet, however. We have pooled two datasets that are separately problematic, and the noisiness of the process within each group affects our OLS estimate: <span class="math inline">\(\widehat{\beta}_{OLS}=Cov(Q^{*}, P^{*}) / Var(P^{*})\)</span>.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="observational-data.html#cb476-1" tabindex="-1"></a><span class="co"># Not exactly right, but at least right sign</span></span>
<span id="cb476-2"><a href="observational-data.html#cb476-2" tabindex="-1"></a>reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Q<span class="sc">~</span>P, <span class="at">data=</span>dat2)</span>
<span id="cb476-3"><a href="observational-data.html#cb476-3" tabindex="-1"></a><span class="fu">summary</span>(reg2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Q ~ P, data = dat2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.72222 -0.16511 -0.00112  0.16667  0.67665 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  6.32899    0.16562   38.21   &lt;2e-16 ***
## P           -0.60386    0.01953  -30.92   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2286 on 598 degrees of freedom
## Multiple R-squared:  0.6152, Adjusted R-squared:  0.6145 
## F-statistic: 955.9 on 1 and 598 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Although the individual observations are noisy, we can compute the change in the expected values <span class="math inline">\(d \mathbb{E}[Q^{*}] / d \mathbb{E}[P^{*}] =-B_{D}\)</span>. Empirically, this is estimated via the change in average value.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="observational-data.html#cb478-1" tabindex="-1"></a><span class="co"># Wald (1940) Estimate</span></span>
<span id="cb478-2"><a href="observational-data.html#cb478-2" tabindex="-1"></a>dat_mean <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb478-3"><a href="observational-data.html#cb478-3" tabindex="-1"></a>    <span class="fu">colMeans</span>(dat2[dat2<span class="sc">$</span>cost<span class="sc">==</span><span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]),</span>
<span id="cb478-4"><a href="observational-data.html#cb478-4" tabindex="-1"></a>    <span class="fu">colMeans</span>(dat2[dat2<span class="sc">$</span>cost<span class="sc">==</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]))</span>
<span id="cb478-5"><a href="observational-data.html#cb478-5" tabindex="-1"></a>dat_mean</span></code></pre></div>
<pre><code>##             P         Q
## [1,] 8.902567 0.8937285
## [2,] 8.030433 1.5391571</code></pre>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="observational-data.html#cb480-1" tabindex="-1"></a>B_est <span class="ot">&lt;-</span> <span class="fu">diff</span>(dat_mean[,<span class="dv">2</span>])<span class="sc">/</span><span class="fu">diff</span>(dat_mean[,<span class="dv">1</span>])</span>
<span id="cb480-2"><a href="observational-data.html#cb480-2" tabindex="-1"></a><span class="fu">round</span>(B_est, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] -0.74</code></pre>
<p>We can also seperately recover <span class="math inline">\(d \mathbb{E}[Q^{*}] / d \mathbb{E}[A_{S}]\)</span> and <span class="math inline">\(d \mathbb{E}[P^{*}] / d \mathbb{E}[A_{S}]\)</span> from seperate regressions</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="observational-data.html#cb482-1" tabindex="-1"></a><span class="co"># Heckman (2000, p.58) Estimate</span></span>
<span id="cb482-2"><a href="observational-data.html#cb482-2" tabindex="-1"></a>ols_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(P<span class="sc">~</span>cost, <span class="at">data=</span>dat2)</span>
<span id="cb482-3"><a href="observational-data.html#cb482-3" tabindex="-1"></a>ols_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Q<span class="sc">~</span>cost, <span class="at">data=</span>dat2)</span>
<span id="cb482-4"><a href="observational-data.html#cb482-4" tabindex="-1"></a>B_est2 <span class="ot">&lt;-</span> <span class="fu">coef</span>(ols_2)<span class="sc">/</span><span class="fu">coef</span>(ols_1)</span>
<span id="cb482-5"><a href="observational-data.html#cb482-5" tabindex="-1"></a><span class="fu">round</span>(B_est2[[<span class="dv">2</span>]],<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] -0.74</code></pre>
<p>Mathematically, we can also do this in a single step by exploiting linear algebra:
<span class="math display">\[\begin{eqnarray}
\frac{\frac{ Cov(Q^{*},A_{S})}{ V(A_{S}) } }{\frac{ Cov(P^{*},A_{S})}{ V(A_{S}) }}
&amp;=&amp; \frac{Cov(Q^{*},A_{S} )}{ Cov(P^{*},A_{S})}.
\end{eqnarray}\]</span></p>
<p>Alternatively, we can recover the same estimate using an instrumental variables regression that has two equations:
<span class="math display">\[\begin{eqnarray}
P &amp;=&amp; \alpha_{1} + A_{S} \beta_{1} + \epsilon_{1} \\
Q &amp;=&amp; \alpha_{2} + \hat{P} \beta_{2} + \epsilon_{2}.
\end{eqnarray}\]</span>
In the first regression, we estimate the average effect of the cost shock on prices. In the second equation, we estimate how the average effect of prices <em>which are exogenous to demand</em> affect quantity demanded. To see this, first substitute the equilibrium condition into the supply equation: <span class="math inline">\(Q_{D}=Q_{S}=A_{S}+B_{S} P + E_{S}\)</span>, lets us rewrite <span class="math inline">\(P\)</span> as a function of <span class="math inline">\(Q_{D}\)</span>. This yields two theoretical equations
<span class="math display">\[\begin{eqnarray}
\label{eqn:linear_supply_iv}
P &amp;=&amp; -\frac{A_{S}}{{B_{S}}} + \frac{Q_{D}}{B_{S}} - \frac{E_{S}}{B_{S}} \\
\label{eqn:linear_demand_iv}
Q_{D} &amp;=&amp;  A_{D} + B_{D} P  + E_{D}.
\end{eqnarray}\]</span></p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="observational-data.html#cb484-1" tabindex="-1"></a><span class="co"># Two Stage Least Squares Estimate</span></span>
<span id="cb484-2"><a href="observational-data.html#cb484-2" tabindex="-1"></a>ols_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(P<span class="sc">~</span>cost, <span class="at">data=</span>dat2)</span>
<span id="cb484-3"><a href="observational-data.html#cb484-3" tabindex="-1"></a>dat2_new  <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dat2, <span class="at">Phat=</span><span class="fu">predict</span>(ols_1))</span>
<span id="cb484-4"><a href="observational-data.html#cb484-4" tabindex="-1"></a>reg_2sls <span class="ot">&lt;-</span> <span class="fu">lm</span>(Q<span class="sc">~</span>Phat, <span class="at">data=</span>dat2_new)</span>
<span id="cb484-5"><a href="observational-data.html#cb484-5" tabindex="-1"></a><span class="fu">summary</span>(reg_2sls)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Q ~ Phat, data = dat2_new)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.57884 -0.11513 -0.00611  0.11558  0.52413 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  7.48214    0.14054   53.24   &lt;2e-16 ***
## Phat        -0.74006    0.01658  -44.64   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1771 on 598 degrees of freedom
## Multiple R-squared:  0.7692, Adjusted R-squared:  0.7688 
## F-statistic:  1993 on 1 and 598 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="observational-data.html#cb486-1" tabindex="-1"></a><span class="co"># One Stage Instrumental Variables Estimate</span></span>
<span id="cb486-2"><a href="observational-data.html#cb486-2" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb486-3"><a href="observational-data.html#cb486-3" tabindex="-1"></a>reg2_iv <span class="ot">&lt;-</span> <span class="fu">feols</span>(Q<span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>P<span class="sc">~</span>cost, <span class="at">data=</span>dat2)</span>
<span id="cb486-4"><a href="observational-data.html#cb486-4" tabindex="-1"></a><span class="fu">summary</span>(reg2_iv)</span></code></pre></div>
<pre><code>## TSLS estimation - Dep. Var.: Q
##                   Endo.    : P
##                   Instr.   : cost
## Second stage: Dep. Var.: Q
## Observations: 600
## Standard-errors: IID 
##              Estimate Std. Error  t value  Pr(&gt;|t|)    
## (Intercept)  7.482138   0.188708  39.6494 &lt; 2.2e-16 ***
## fit_P       -0.740057   0.022259 -33.2472 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## RMSE: 0.237363   Adj. R2: 0.58318
## F-test (1st stage), P: stat = 2,971.6, p &lt; 2.2e-16, on 1 and 598 DoF.
##            Wu-Hausman: stat =   404.9, p &lt; 2.2e-16, on 1 and 597 DoF.</code></pre>
<p><strong>Within Group Variance</strong>.
You can experiment with the effect of different variances on both OLS and IV in the code below. And note that if we had multiple supply shifts and recorded their magnitudes, then we could recover more information about demand, perhaps tracing it out entirely.</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="observational-data.html#cb488-1" tabindex="-1"></a><span class="co"># Examine</span></span>
<span id="cb488-2"><a href="observational-data.html#cb488-2" tabindex="-1"></a>Egrid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">Ed_sigma=</span><span class="fu">c</span>(.<span class="dv">001</span>, .<span class="dv">25</span>, <span class="dv">1</span>), <span class="at">Es_sigma=</span><span class="fu">c</span>(.<span class="dv">001</span>, .<span class="dv">25</span>, <span class="dv">1</span>))</span>
<span id="cb488-3"><a href="observational-data.html#cb488-3" tabindex="-1"></a></span>
<span id="cb488-4"><a href="observational-data.html#cb488-4" tabindex="-1"></a>Egrid_regs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Egrid), <span class="cf">function</span>(i){</span>
<span id="cb488-5"><a href="observational-data.html#cb488-5" tabindex="-1"></a>    Ed_sigma <span class="ot">&lt;-</span> Egrid[i,<span class="dv">1</span>]</span>
<span id="cb488-6"><a href="observational-data.html#cb488-6" tabindex="-1"></a>    Es_sigma <span class="ot">&lt;-</span> Egrid[i,<span class="dv">2</span>]    </span>
<span id="cb488-7"><a href="observational-data.html#cb488-7" tabindex="-1"></a>    EQ1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(n){</span>
<span id="cb488-8"><a href="observational-data.html#cb488-8" tabindex="-1"></a>        demand <span class="ot">&lt;-</span> <span class="fu">qd_fun</span>(P, <span class="at">Ed_sigma=</span>Ed_sigma)</span>
<span id="cb488-9"><a href="observational-data.html#cb488-9" tabindex="-1"></a>        supply <span class="ot">&lt;-</span> <span class="fu">qs_fun</span>(P, <span class="at">Es_sigma=</span>Es_sigma)</span>
<span id="cb488-10"><a href="observational-data.html#cb488-10" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">eq_fun</span>(demand, supply, P))</span>
<span id="cb488-11"><a href="observational-data.html#cb488-11" tabindex="-1"></a>    })</span>
<span id="cb488-12"><a href="observational-data.html#cb488-12" tabindex="-1"></a>    EQ2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(n){</span>
<span id="cb488-13"><a href="observational-data.html#cb488-13" tabindex="-1"></a>        demand <span class="ot">&lt;-</span> <span class="fu">qd_fun</span>(P,<span class="at">Ed_sigma=</span>Ed_sigma)</span>
<span id="cb488-14"><a href="observational-data.html#cb488-14" tabindex="-1"></a>        supply2 <span class="ot">&lt;-</span> <span class="fu">qs_fun</span>(P, <span class="at">As=</span><span class="sc">-</span><span class="fl">6.5</span>,<span class="at">Es_sigma=</span>Es_sigma)</span>
<span id="cb488-15"><a href="observational-data.html#cb488-15" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">eq_fun</span>(demand, supply2, P))</span>
<span id="cb488-16"><a href="observational-data.html#cb488-16" tabindex="-1"></a>    })</span>
<span id="cb488-17"><a href="observational-data.html#cb488-17" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb488-18"><a href="observational-data.html#cb488-18" tabindex="-1"></a>        <span class="fu">data.frame</span>(<span class="fu">t</span>(EQ1), <span class="at">cost=</span><span class="st">&#39;1&#39;</span>),</span>
<span id="cb488-19"><a href="observational-data.html#cb488-19" tabindex="-1"></a>        <span class="fu">data.frame</span>(<span class="fu">t</span>(EQ2), <span class="at">cost=</span><span class="st">&#39;2&#39;</span>))</span>
<span id="cb488-20"><a href="observational-data.html#cb488-20" tabindex="-1"></a>    <span class="fu">return</span>(dat)</span>
<span id="cb488-21"><a href="observational-data.html#cb488-21" tabindex="-1"></a>})</span>
<span id="cb488-22"><a href="observational-data.html#cb488-22" tabindex="-1"></a>Egrid_OLS <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Egrid_regs, <span class="cf">function</span>(dat) <span class="fu">coef</span>( <span class="fu">lm</span>(Q<span class="sc">~</span>P, <span class="at">data=</span>dat)))</span>
<span id="cb488-23"><a href="observational-data.html#cb488-23" tabindex="-1"></a>Egrid_IV <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Egrid_regs, <span class="cf">function</span>(dat) <span class="fu">coef</span>( <span class="fu">feols</span>(Q<span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>P<span class="sc">~</span>cost, <span class="at">data=</span>dat)))</span>
<span id="cb488-24"><a href="observational-data.html#cb488-24" tabindex="-1"></a></span>
<span id="cb488-25"><a href="observational-data.html#cb488-25" tabindex="-1"></a><span class="co">#cbind(Egrid, coef_OLS=t(Egrid_OLS)[,2], coef_IV=t(Egrid_IV)[,2])</span></span>
<span id="cb488-26"><a href="observational-data.html#cb488-26" tabindex="-1"></a><span class="fu">lapply</span>( <span class="fu">list</span>(Egrid_OLS, Egrid_IV), <span class="cf">function</span>(ei){</span>
<span id="cb488-27"><a href="observational-data.html#cb488-27" tabindex="-1"></a>    Emat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(ei[<span class="dv">2</span>,],<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb488-28"><a href="observational-data.html#cb488-28" tabindex="-1"></a>    <span class="fu">rownames</span>(Emat) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Ed_sigma.&#39;</span>,<span class="fu">c</span>(.<span class="dv">001</span>, .<span class="dv">25</span>, <span class="dv">1</span>))</span>
<span id="cb488-29"><a href="observational-data.html#cb488-29" tabindex="-1"></a>    <span class="fu">colnames</span>(Emat) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;Es_sigma.&#39;</span>,<span class="fu">c</span>(.<span class="dv">001</span>, .<span class="dv">25</span>, <span class="dv">1</span>))</span>
<span id="cb488-30"><a href="observational-data.html#cb488-30" tabindex="-1"></a>    <span class="fu">return</span>( <span class="fu">round</span>(Emat,<span class="dv">2</span>))</span>
<span id="cb488-31"><a href="observational-data.html#cb488-31" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## [[1]]
##                Es_sigma.0.001 Es_sigma.0.25 Es_sigma.1
## Ed_sigma.0.001          -0.80         -0.80      -0.80
## Ed_sigma.0.25           -0.63         -0.62      -0.74
## Ed_sigma.1               0.36          0.28      -0.13
## 
## [[2]]
##                Es_sigma.0.001 Es_sigma.0.25 Es_sigma.1
## Ed_sigma.0.001          -0.80         -0.80      -0.80
## Ed_sigma.0.25           -0.80         -0.78      -0.81
## Ed_sigma.1              -0.68         -0.86      -0.76</code></pre>
<p><strong>Caveats</strong>.
2SLS regression analysis can be very insightful, but I also want to stress some caveats about their practical application.</p>
<p>We always get coefficients back when running <code>feols</code>, and sometimes the computed p-values are very small. The interpretation of those numbers rests on many assumptions:</p>
<ul>
<li><em>Instrument exogeneity (Exclusion Restriction):</em> The instrument must affect outcomes only through the treatment variable (e.g., only supply is affected directly, not demand).</li>
<li><em>Instrument relevance:</em> The instrument must be strongly correlated with the endogenous regressor, implying the shock creates meaningful variation.</li>
<li><em>Functional form correctness:</em> Supply and demand are assumed linear and additively separable.</li>
<li><em>Multiple hypothesis testing risks:</em> We were not repeatedly testing different instruments, which can artificially produce significant findings by chance.</li>
</ul>
<p>We are rarely sure that all of these assumptions hold, and this is one reason why researchers often also report their OLS results. But that is insufficient, as spatial and temporal dependence also complicate inference:</p>
<ul>
<li><em>Exclusion restriction violations:</em> Spatial or temporal spillovers may cause instruments to affect the outcome through unintended channels, undermining instrument exogeneity.</li>
<li><em>Weak instruments:</em> Spatial clustering, serial correlation, or network interdependencies can reduce instrument variation, causing weak instruments.</li>
<li><em>Inference and standard errors:</em> Spatial or temporal interdependence reduces the effective sample size, making conventional standard errors misleadingly small.</li>
</ul>
<p><strong>Other Types of Event Studies</strong>
In addition to 2SLS, “RDD” and “DID” methods are also used in Historical Event Studies to address endogeneity issues in observational data. Moreover, the elementary versions of these tools are also linear regression. “RDD” and “DID” methods are designed for actual experiments, however, so we will cover them in that chapter instead.</p>
</div>
<div id="more-literature-3" class="section level2 hasAnchor" number="14.5">
<h2><span class="header-section-number">14.5</span> More Literature<a href="observational-data.html#more-literature-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You are directed to the following resources which discusses endogeneity in more detail and how it applies generally.</p>
<ul>
<li>Causal Inference for Statistics, Social, and Biomedical Sciences: An Introduction</li>
<li><a href="https://www.mostlyharmlesseconometrics.com/" class="uri">https://www.mostlyharmlesseconometrics.com/</a></li>
<li><a href="https://www.econometrics-with-r.org" class="uri">https://www.econometrics-with-r.org</a></li>
<li><a href="https://bookdown.org/paul/applied-causal-analysis/" class="uri">https://bookdown.org/paul/applied-causal-analysis/</a></li>
<li><a href="https://mixtape.scunning.com/" class="uri">https://mixtape.scunning.com/</a></li>
<li><a href="https://theeffectbook.net/" class="uri">https://theeffectbook.net/</a></li>
<li><a href="https://www.r-causal.org/" class="uri">https://www.r-causal.org/</a></li>
<li><a href="https://matheusfacure.github.io/python-causality-handbook/landing-page.html" class="uri">https://matheusfacure.github.io/python-causality-handbook/landing-page.html</a></li>
</ul>
<p>For IV,</p>
<ul>
<li><a href="https://cameron.econ.ucdavis.edu/e240a/ch04iv.pdf" class="uri">https://cameron.econ.ucdavis.edu/e240a/ch04iv.pdf</a></li>
<li><a href="https://mru.org/courses/mastering-econometrics/introduction-instrumental-variables-part-one" class="uri">https://mru.org/courses/mastering-econometrics/introduction-instrumental-variables-part-one</a></li>
<li><a href="https://www.econometrics-with-r.org/12-ivr.html" class="uri">https://www.econometrics-with-r.org/12-ivr.html</a></li>
<li><a href="https://bookdown.org/paul/applied-causal-analysis/estimation-2.html" class="uri">https://bookdown.org/paul/applied-causal-analysis/estimation-2.html</a></li>
<li><a href="https://mixtape.scunning.com/07-instrumental_variables" class="uri">https://mixtape.scunning.com/07-instrumental_variables</a></li>
<li><a href="https://theeffectbook.net/ch-InstrumentalVariables.html" class="uri">https://theeffectbook.net/ch-InstrumentalVariables.html</a></li>
<li><a href="http://www.urfie.net/read/index.html#page/247" class="uri">http://www.urfie.net/read/index.html#page/247</a></li>
</ul>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="6">
<li id="fn6"><p>Although there are many ways this simultaneity can happen, economic theorists have made great strides in analyzing the simultaneity problem as it arises from equilibrium market relationships. In fact, 2SLS arose to understand agricultural markets.<a href="observational-data.html#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>Notice that even in this linear model, however, all effects are conditional: <em>The</em> effect of a cost change on quantity or price depends on the demand curve. A change in costs affects quantity supplied but not quantity demanded (which then affects equilibrium price) but the demand side of the market still matters! The change in price from a change in costs depends on the elasticity of demand.<a href="observational-data.html#fnref7" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multiple-regression-ii.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="experimental-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["index.pdf", "index.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
