<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>15&nbsp; Multivariate Data I – Introductory Economic Statistics: A Data-Driven Approach using R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03_02_InterprettingRegression.html" rel="next">
<link href="./03-00-MultivariateData.html" rel="prev">
<link href="./Figures_Manual/Logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-fbf999dcfc8fa9a188f5a90e00cb1364.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-00-MultivariateData.html">Multivariate Data</a></li><li class="breadcrumb-item"><a href="./03_01_IntermediateRegression.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Multivariate Data I</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introductory Economic Statistics: A Data-Driven Approach using R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/Jadamso/Rbooks/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./00-00-GettingStarted.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_01_FirstSteps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">First Steps</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_02_Mathematics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Mathematics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./01-00-UnivariateData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Univariate Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_03_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_04_RandomVariables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Random Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_05_Statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_06_Sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">(Re)Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_07_HypothesisTests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Hypothesis Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_08_MiscTopics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Misc. Univariate Topics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02-00-BivariateData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bivariate Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_01_BivariateDistributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Bivariate Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_02_BivariateStatistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Bivariate Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_03_BasicRegression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Simple Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_04_KernelIntro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Local Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_05_MiscTopics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Misc. Bivariate Topics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_06_DataAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Data Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./03-00-MultivariateData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multivariate Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_01_IntermediateRegression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Multivariate Data I</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_02_InterprettingRegression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Multivariate Data II</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_03_ObservationalData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Observational Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_04_ExperimentalData.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Experimental Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_05_DataScientism.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Data Scientism</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_10_MiscTopics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Misc. Multivariate Topics</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-00-MultivariateData.html">Multivariate Data</a></li><li class="breadcrumb-item"><a href="./03_01_IntermediateRegression.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Multivariate Data I</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Multivariate Data I</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<hr>
<p>First, note that you can summarize a dataset with multiple variables using the previous tools.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect Dataset on police arrests for the USA in 1973</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(USArrests)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">##            Murder Assault UrbanPop Rape</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Alabama      13.2     236       58 21.2</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Alaska       10.0     263       48 44.5</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Arizona       8.1     294       80 31.0</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Arkansas      8.8     190       50 19.5</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">## California    9.0     276       91 40.6</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Colorado      7.9     204       78 38.7</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>( USArrests[,<span class="fu">c</span>(<span class="st">'Murder'</span>,<span class="st">'Assault'</span>,<span class="st">'UrbanPop'</span>)],</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">hist.col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">25</span>), <span class="at">breaks=</span><span class="dv">30</span>, <span class="at">density=</span>F, <span class="at">hist.border=</span><span class="cn">NA</span>, <span class="co"># Diagonal</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ellipses=</span>F, <span class="at">rug=</span>F, <span class="at">smoother=</span>F, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">'red'</span> <span class="co"># Lower Triangle</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_01_IntermediateRegression_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>You can also use size, color, and shape to distinguish conditional relationships.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># High Assault Areas</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>assault_high <span class="ot">&lt;-</span> USArrests<span class="sc">$</span>Assault <span class="sc">&gt;</span> <span class="fu">median</span>(USArrests<span class="sc">$</span>Assault)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>col_high <span class="ot">&lt;-</span> <span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>col_low <span class="ot">&lt;-</span> <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">5</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(assault_high, col_high, col_low)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Show High Assault Areas via 'cex=' or 'pch='</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Could further add regression lines for each data split</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Murder<span class="sc">~</span>UrbanPop, USArrests, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>outer_legend <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">fig=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">oma=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">on.exit</span>(<span class="fu">par</span>(opar))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">type=</span><span class="st">'n'</span>, <span class="at">bty=</span><span class="st">'n'</span>, <span class="at">xaxt=</span><span class="st">'n'</span>, <span class="at">yaxt=</span><span class="st">'n'</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(...)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">outer_legend</span>(<span class="st">'topright'</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="st">'many assualts'</span>, <span class="st">'few assaults'</span>),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">c</span>(col_high, col_low),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">horiz=</span>T, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">bty=</span><span class="st">'n'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_01_IntermediateRegression_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>See also <a href="https://plotly.com/r/bubble-charts/" class="uri">https://plotly.com/r/bubble-charts/</a></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter Plot</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>USArrests<span class="sc">$</span>ID <span class="ot">&lt;-</span> <span class="fu">rownames</span>(USArrests)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    USArrests, <span class="at">x =</span> <span class="sc">~</span>UrbanPop, <span class="at">y =</span> <span class="sc">~</span>Assault,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode=</span><span class="st">'markers'</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">type=</span><span class="st">'scatter'</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">hoverinfo=</span><span class="st">'text'</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">'&lt;b&gt;'</span>, ID, <span class="st">'&lt;/b&gt;'</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;br&gt;Urban  :"</span>, UrbanPop,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;br&gt;Assault:"</span>, Assault,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"&lt;br&gt;Murder :"</span>, Murder),</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="sc">~</span>Murder,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">marker=</span><span class="fu">list</span>(</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">size=</span><span class="sc">~</span>Murder,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">opacity=</span><span class="fl">0.5</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">showscale=</span>T,  </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">colorbar =</span> <span class="fu">list</span>(<span class="at">title=</span><span class="st">'Murder Arrests (per 100,000)'</span>)))</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">layout</span>(fig,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">showlegend=</span>F,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span><span class="st">'Crime and Urbanization in America 1975'</span>,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Percent of People in an Urban Area'</span>),</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Assault Arrests per 100,000 People'</span>))</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>fig</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-977612a5cf8ed989850a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-977612a5cf8ed989850a">{"x":{"visdat":{"277d1baa793":["function () ","plotlyVisDat"]},"cur_data":"277d1baa793","attrs":{"277d1baa793":{"x":{},"y":{},"mode":"markers","hoverinfo":"text","text":{},"marker":{"size":{},"opacity":0.5,"showscale":true,"colorbar":{"title":"Murder Arrests (per 100,000)"}},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"showlegend":false,"title":"Crime and Urbanization in America 1975","xaxis":{"domain":[0,1],"automargin":true,"title":"Percent of People in an Urban Area"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Assault Arrests per 100,000 People"},"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[58,48,80,50,91,78,77,72,80,60,83,54,83,65,57,66,52,66,51,67,85,74,66,44,70,53,62,81,56,89,70,86,45,44,75,68,67,72,87,48,45,59,80,80,32,63,73,39,66,60],"y":[236,263,294,190,276,204,110,238,335,211,46,120,249,113,56,115,109,249,83,300,149,255,72,259,178,109,102,252,57,159,285,254,337,45,120,151,159,106,174,279,86,188,201,120,48,156,145,81,53,161],"mode":"markers","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"text":["<b> Alabama <\/b> <br>Urban  : 58 <br>Assault: 236 <br>Murder : 13.2","<b> Alaska <\/b> <br>Urban  : 48 <br>Assault: 263 <br>Murder : 10","<b> Arizona <\/b> <br>Urban  : 80 <br>Assault: 294 <br>Murder : 8.1","<b> Arkansas <\/b> <br>Urban  : 50 <br>Assault: 190 <br>Murder : 8.8","<b> California <\/b> <br>Urban  : 91 <br>Assault: 276 <br>Murder : 9","<b> Colorado <\/b> <br>Urban  : 78 <br>Assault: 204 <br>Murder : 7.9","<b> Connecticut <\/b> <br>Urban  : 77 <br>Assault: 110 <br>Murder : 3.3","<b> Delaware <\/b> <br>Urban  : 72 <br>Assault: 238 <br>Murder : 5.9","<b> Florida <\/b> <br>Urban  : 80 <br>Assault: 335 <br>Murder : 15.4","<b> Georgia <\/b> <br>Urban  : 60 <br>Assault: 211 <br>Murder : 17.4","<b> Hawaii <\/b> <br>Urban  : 83 <br>Assault: 46 <br>Murder : 5.3","<b> Idaho <\/b> <br>Urban  : 54 <br>Assault: 120 <br>Murder : 2.6","<b> Illinois <\/b> <br>Urban  : 83 <br>Assault: 249 <br>Murder : 10.4","<b> Indiana <\/b> <br>Urban  : 65 <br>Assault: 113 <br>Murder : 7.2","<b> Iowa <\/b> <br>Urban  : 57 <br>Assault: 56 <br>Murder : 2.2","<b> Kansas <\/b> <br>Urban  : 66 <br>Assault: 115 <br>Murder : 6","<b> Kentucky <\/b> <br>Urban  : 52 <br>Assault: 109 <br>Murder : 9.7","<b> Louisiana <\/b> <br>Urban  : 66 <br>Assault: 249 <br>Murder : 15.4","<b> Maine <\/b> <br>Urban  : 51 <br>Assault: 83 <br>Murder : 2.1","<b> Maryland <\/b> <br>Urban  : 67 <br>Assault: 300 <br>Murder : 11.3","<b> Massachusetts <\/b> <br>Urban  : 85 <br>Assault: 149 <br>Murder : 4.4","<b> Michigan <\/b> <br>Urban  : 74 <br>Assault: 255 <br>Murder : 12.1","<b> Minnesota <\/b> <br>Urban  : 66 <br>Assault: 72 <br>Murder : 2.7","<b> Mississippi <\/b> <br>Urban  : 44 <br>Assault: 259 <br>Murder : 16.1","<b> Missouri <\/b> <br>Urban  : 70 <br>Assault: 178 <br>Murder : 9","<b> Montana <\/b> <br>Urban  : 53 <br>Assault: 109 <br>Murder : 6","<b> Nebraska <\/b> <br>Urban  : 62 <br>Assault: 102 <br>Murder : 4.3","<b> Nevada <\/b> <br>Urban  : 81 <br>Assault: 252 <br>Murder : 12.2","<b> New Hampshire <\/b> <br>Urban  : 56 <br>Assault: 57 <br>Murder : 2.1","<b> New Jersey <\/b> <br>Urban  : 89 <br>Assault: 159 <br>Murder : 7.4","<b> New Mexico <\/b> <br>Urban  : 70 <br>Assault: 285 <br>Murder : 11.4","<b> New York <\/b> <br>Urban  : 86 <br>Assault: 254 <br>Murder : 11.1","<b> North Carolina <\/b> <br>Urban  : 45 <br>Assault: 337 <br>Murder : 13","<b> North Dakota <\/b> <br>Urban  : 44 <br>Assault: 45 <br>Murder : 0.8","<b> Ohio <\/b> <br>Urban  : 75 <br>Assault: 120 <br>Murder : 7.3","<b> Oklahoma <\/b> <br>Urban  : 68 <br>Assault: 151 <br>Murder : 6.6","<b> Oregon <\/b> <br>Urban  : 67 <br>Assault: 159 <br>Murder : 4.9","<b> Pennsylvania <\/b> <br>Urban  : 72 <br>Assault: 106 <br>Murder : 6.3","<b> Rhode Island <\/b> <br>Urban  : 87 <br>Assault: 174 <br>Murder : 3.4","<b> South Carolina <\/b> <br>Urban  : 48 <br>Assault: 279 <br>Murder : 14.4","<b> South Dakota <\/b> <br>Urban  : 45 <br>Assault: 86 <br>Murder : 3.8","<b> Tennessee <\/b> <br>Urban  : 59 <br>Assault: 188 <br>Murder : 13.2","<b> Texas <\/b> <br>Urban  : 80 <br>Assault: 201 <br>Murder : 12.7","<b> Utah <\/b> <br>Urban  : 80 <br>Assault: 120 <br>Murder : 3.2","<b> Vermont <\/b> <br>Urban  : 32 <br>Assault: 48 <br>Murder : 2.2","<b> Virginia <\/b> <br>Urban  : 63 <br>Assault: 156 <br>Murder : 8.5","<b> Washington <\/b> <br>Urban  : 73 <br>Assault: 145 <br>Murder : 4","<b> West Virginia <\/b> <br>Urban  : 39 <br>Assault: 81 <br>Murder : 5.7","<b> Wisconsin <\/b> <br>Urban  : 66 <br>Assault: 53 <br>Murder : 2.6","<b> Wyoming <\/b> <br>Urban  : 60 <br>Assault: 161 <br>Murder : 6.8"],"marker":{"colorbar":{"title":"Murder Arrests (per 100,000)","ticklen":2},"cmin":0.80000000000000004,"cmax":17.399999999999999,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[13.199999999999999,10,8.0999999999999996,8.8000000000000007,9,7.9000000000000004,3.2999999999999998,5.9000000000000004,15.4,17.399999999999999,5.2999999999999998,2.6000000000000001,10.4,7.2000000000000002,2.2000000000000002,6,9.6999999999999993,15.4,2.1000000000000001,11.300000000000001,4.4000000000000004,12.1,2.7000000000000002,16.100000000000001,9,6,4.2999999999999998,12.199999999999999,2.1000000000000001,7.4000000000000004,11.4,11.1,13,0.80000000000000004,7.2999999999999998,6.5999999999999996,4.9000000000000004,6.2999999999999998,3.3999999999999999,14.4,3.7999999999999998,13.199999999999999,12.699999999999999,3.2000000000000002,2.2000000000000002,8.5,4,5.7000000000000002,2.6000000000000001,6.7999999999999998],"size":[13.199999999999999,10,8.0999999999999996,8.8000000000000007,9,7.9000000000000004,3.2999999999999998,5.9000000000000004,15.4,17.399999999999999,5.2999999999999998,2.6000000000000001,10.4,7.2000000000000002,2.2000000000000002,6,9.6999999999999993,15.4,2.1000000000000001,11.300000000000001,4.4000000000000004,12.1,2.7000000000000002,16.100000000000001,9,6,4.2999999999999998,12.199999999999999,2.1000000000000001,7.4000000000000004,11.4,11.1,13,0.80000000000000004,7.2999999999999998,6.5999999999999996,4.9000000000000004,6.2999999999999998,3.3999999999999999,14.4,3.7999999999999998,13.199999999999999,12.699999999999999,3.2000000000000002,2.2000000000000002,8.5,4,5.7000000000000002,2.6000000000000001,6.7999999999999998],"opacity":0.5,"line":{"colorbar":{"title":"","ticklen":2},"cmin":0.80000000000000004,"cmax":17.399999999999999,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[13.199999999999999,10,8.0999999999999996,8.8000000000000007,9,7.9000000000000004,3.2999999999999998,5.9000000000000004,15.4,17.399999999999999,5.2999999999999998,2.6000000000000001,10.4,7.2000000000000002,2.2000000000000002,6,9.6999999999999993,15.4,2.1000000000000001,11.300000000000001,4.4000000000000004,12.1,2.7000000000000002,16.100000000000001,9,6,4.2999999999999998,12.199999999999999,2.1000000000000001,7.4000000000000004,11.4,11.1,13,0.80000000000000004,7.2999999999999998,6.5999999999999996,4.9000000000000004,6.2999999999999998,3.3999999999999999,14.4,3.7999999999999998,13.199999999999999,12.699999999999999,3.2000000000000002,2.2000000000000002,8.5,4,5.7000000000000002,2.6000000000000001,6.7999999999999998]}},"type":"scatter","xaxis":"x","yaxis":"y","frame":null},{"x":[32,91],"y":[45,337],"type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"Murder","ticklen":2},"cmin":0.80000000000000004,"cmax":17.399999999999999,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[0.80000000000000004,17.399999999999999],"line":{"color":"rgba(255,127,14,1)"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="multiple-linear-regression" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="multiple-linear-regression"><span class="header-section-number">15.1</span> Multiple Linear Regression</h2>
<p>With <span class="math inline">\(K\)</span> variables, the linear model is <span class="math display">\[
y_i=\beta_0+\beta_1 x_{i1}+\beta_2 x_{i2}+\ldots+\beta_K x_{iK}+\epsilon_i = [1~~  x_{i1} ~~...~~ x_{iK}] \beta + \epsilon_i
\]</span> and our objective is <span class="math display">\[
min_{\beta} \sum_{i=1}^{N} (\epsilon_i)^2.
\]</span></p>
<p>Denoting <span class="math display">\[
y= \begin{pmatrix}
y_{1} \\ \vdots \\ y_{N}
\end{pmatrix} \quad
\textbf{X} = \begin{pmatrix}
1 &amp; x_{11} &amp; ... &amp; x_{1K} \\
&amp; \vdots &amp; &amp; \\
1 &amp; x_{N1} &amp; ... &amp; x_{NK}
\end{pmatrix},
\]</span> we can also write the model and objective in matrix form <span class="math display">\[
y=\textbf{X}\beta+\epsilon\\
min_{\beta} (\epsilon' \epsilon)
\]</span></p>
<p>Minimizing the squared errors yields coefficient estimates <span class="math display">\[
\hat{\beta}=(\textbf{X}'\textbf{X})^{-1}\textbf{X}'y
\]</span> and predictions <span class="math display">\[
\hat{y}=\textbf{X} \hat{\beta} \\
\hat{\epsilon}=y - \hat{y} \\
\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually Compute</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> USArrests[,<span class="st">'Murder'</span>]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> USArrests[,<span class="fu">c</span>(<span class="st">'Assault'</span>,<span class="st">'UrbanPop'</span>)]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">cbind</span>(<span class="dv">1</span>,X))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>XtXi <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>Bhat <span class="ot">&lt;-</span> XtXi <span class="sc">%*%</span> (<span class="fu">t</span>(X)<span class="sc">%*%</span>Y)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(Bhat)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1]  3.20715340  0.04390995 -0.04451047</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Check</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder<span class="sc">~</span>Assault<span class="sc">+</span>UrbanPop, <span class="at">data=</span>USArrests)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(reg)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)     Assault    UrbanPop </span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  3.20715340  0.04390995 -0.04451047</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>To measure the ``Goodness of fit’’ of the model, we can again plot our predictions.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(USArrests<span class="sc">$</span>Murder, <span class="fu">predict</span>(reg), <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">5</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_01_IntermediateRegression_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also again compute sums of squared errors. Adding random data may sometimes improve the fit, however, so we adjust the <span class="math inline">\(R^2\)</span> by the number of covariates <span class="math inline">\(K\)</span>. <span class="math display">\[
R^2 = \frac{ESS}{TSS}=1-\frac{RSS}{TSS}\\
R^2_{\text{adj.}} = 1-\frac{N-1}{N-K}(1-R^2)
\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ksims <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> ksims){ </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    USArrests[,<span class="fu">paste0</span>(<span class="st">'R'</span>,k)] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">nrow</span>(USArrests),<span class="dv">0</span>,<span class="dv">20</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>reg_sim <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ksims, <span class="cf">function</span>(k){</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    rvars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Assault'</span>,<span class="st">'UrbanPop'</span>, <span class="fu">paste0</span>(<span class="st">'R'</span>,<span class="dv">1</span><span class="sc">:</span>k))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    rvars2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(rvars, <span class="at">collapse=</span><span class="st">'+'</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    reg_k <span class="ot">&lt;-</span> <span class="fu">lm</span>( <span class="fu">paste0</span>(<span class="st">'Murder~'</span>,rvars2), <span class="at">data=</span>USArrests)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>R2_sim <span class="ot">&lt;-</span> <span class="fu">sapply</span>(reg_sim, <span class="cf">function</span>(reg_k){  <span class="fu">summary</span>(reg_k)<span class="sc">$</span>r.squared })</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>R2adj_sim <span class="ot">&lt;-</span> <span class="fu">sapply</span>(reg_sim, <span class="cf">function</span>(reg_k){  <span class="fu">summary</span>(reg_k)<span class="sc">$</span>adj.r.squared })</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.window</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(ksims, R2_sim)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(ksims, R2adj_sim, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(R<span class="sc">^</span><span class="dv">2</span>),<span class="dv">2</span>, <span class="at">line=</span><span class="dv">3</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">'Additional Random Covariates'</span>, <span class="dv">1</span>, <span class="at">line=</span><span class="dv">3</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topleft'</span>, <span class="at">horiz=</span>T,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="st">'Undjusted'</span>, <span class="st">'Adjusted'</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">16</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_01_IntermediateRegression_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="factor-variables" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="factor-variables"><span class="header-section-number">15.2</span> Factor Variables</h2>
<p>So far, we have discussed cardinal data where the difference between units always means the same thing: e.g., <span class="math inline">\(4-3=2-1\)</span>. There are also factor variables</p>
<ul>
<li>Ordered: refers to Ordinal data. The difference between units means something, but not always the same thing. For example, <span class="math inline">\(4th - 3rd \neq 2nd - 1st\)</span>.</li>
<li>Unordered: refers to Categorical data. The difference between units is meaningless. For example, <span class="math inline">\(B-A=?\)</span></li>
</ul>
<p>To analyze either factor, we often convert them into indicator variables or dummies; <span class="math inline">\(D_{c}=\mathbf{1}( Factor = c)\)</span>. One common case is if you have observations of individuals over time periods, then you may have two factor variables. An unordered factor that indicates who an individual is; for example <span class="math inline">\(D_{i}=\mathbf{1}( Individual = i)\)</span>, and an order factor that indicates the time period; for example <span class="math inline">\(D_{t}=\mathbf{1}( Time \in [month~ t, month~ t+1) )\)</span>. There are many other cases you see factor variables, including spatial ID’s in purely cross sectional data.</p>
<p>Be careful not to handle categorical data as if they were cardinal. E.g., generate city data with Leipzig=1, Lausanne=2, LosAngeles=3, … and then include city as if it were a cardinal number (that’s a big no-no). The same applied to ordinal data; PopulationLeipzig=2, PopulationLausanne=3, PopulationLosAngeles=1.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="dv">3</span>,<span class="dv">8</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="fl">0.4</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>fo <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rbinom</span>(N,<span class="dv">4</span>,.<span class="dv">5</span>), <span class="at">ordered=</span>T)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>fu <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'A'</span>,<span class="st">'B'</span>),N<span class="sc">/</span><span class="dv">2</span>), <span class="at">ordered=</span>F)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>dA <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>(fu<span class="sc">==</span><span class="st">'A'</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">^</span><span class="fu">as.integer</span>(fo)<span class="sc">*</span>dA )<span class="sc">*</span><span class="fu">sqrt</span>(x)<span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">as.integer</span>(fo)<span class="sc">*</span>e</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>dat_f <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y,x,fo,fu)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>With factors, you can still include them in the design matrix of an OLS regression <span class="math display">\[
y_{it} = x_{it} \beta_{x} + d_{t}\beta_{t}
\]</span> When, as commonly done, the factors are modeled as being additively seperable, they are modeled “fixed effects”.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Simply including the factors into the OLS regression yields a “dummy variable” fixed effects estimator. <strong>Hansen Econometrics, Theorem 17.1:</strong> <em>The fixed effects estimator of <span class="math inline">\(\beta\)</span> algebraically equals the dummy variable estimator of <span class="math inline">\(\beta\)</span>. The two estimators have the same residuals.</em> <!--
In fact, if the fixed effect is ``fully unstructured then the only way to consistently estimate the coefficient $\beta$ is by an estimator which is invariant'' (Hansen Econometrics, p). 
--></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fe_reg1 <span class="ot">&lt;-</span> <span class="fu">feols</span>(y<span class="sc">~</span>x<span class="sc">|</span>fo<span class="sc">+</span>fu, dat_f)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fe_reg1)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="do">##        x </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 1.047302</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(fe_reg1)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="do">## $fo</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="do">##         0         1         2         3         4 </span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  7.431407 10.233385 14.989790 24.427619 38.051168 </span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="do">## $fu</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="do">##         A         B </span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="do">##   0.00000 -23.11941</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare Coefficients</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>fe_reg0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~-</span><span class="dv">1</span><span class="sc">+</span>x<span class="sc">+</span>fo<span class="sc">+</span>fu, dat_f)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>( fe_reg0 )</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="do">##          x        fo0        fo1        fo2        fo3        fo4        fuB </span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="do">##   1.047302   7.431407  10.233385  14.989790  24.427619  38.051168 -23.119406</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>With fixed effects, we can also compute averages for each group and construct a <em>between estimator</em>: <span class="math inline">\(\bar{y}_i = \alpha + \bar{x}_i \beta\)</span>. Or we can subtract the average from each group to construct a <em>within estimator</em>: <span class="math inline">\((y_{it} - \bar{y}_i) = (x_{it}-\bar{x}_i)\beta\)</span>.</p>
<!-- 
> The labels "random effects" and "fixed effects" are misleading. These are labels which arose in the early literature and we are stuck with these labels today. In a previous era regressors were viewed as "fixed". Viewing the individual effect as an unobserved regressor leads to the label of the individual effect as "fixed". Today, we rarely refer to regressors as "fixed" when dealing with observational data. We view all variables as random. Consequently describing u i as "fixed" does not make much sense and it is hardly a contrast with the "random effect" label since under either assumption u i is treated as random. Once again, the labels are unfortunate but the key difference is whether u i is correlated with the regressors.
-->
</section>
<section id="variability-estimates" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="variability-estimates"><span class="header-section-number">15.3</span> Variability Estimates</h2>
<p>To estimate the variability of our estimates, we can use the same <em>data-driven</em> methods introduced in the last section. As before, we can conduct independent hypothesis tests using t-values.</p>
<p>We can also conduct <em>joint</em> tests that account for interdependancies in our estimates. For example, to test whether two coefficients both equal <span class="math inline">\(0\)</span>, we bootstrap the <em>joint</em> distribution of coefficients.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap SE's</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>boots <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">399</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>boot_regs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(boots, <span class="cf">function</span>(b){</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    b_id <span class="ot">&lt;-</span> <span class="fu">sample</span>( <span class="fu">nrow</span>(USArrests), <span class="at">replace=</span>T)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    xy_b <span class="ot">&lt;-</span> USArrests[b_id,]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    reg_b <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder<span class="sc">~</span>Assault<span class="sc">+</span>UrbanPop, <span class="at">dat=</span>xy_b)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>boot_coefs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(boot_regs, coef)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Recenter at 0 to impose the null</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#boot_means &lt;- rowMeans(boot_coefs)</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#boot_coefs0 &lt;- sweep(boot_coefs, MARGIN=1, STATS=boot_means)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>boot_coef_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="at">ID=</span>boots, <span class="fu">t</span>(boot_coefs)))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> plotly<span class="sc">::</span><span class="fu">plot_ly</span>(boot_coef_df,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>UrbanPop, <span class="at">y =</span> <span class="sc">~</span>Assault,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">'&lt;b&gt; bootstrap dataset: '</span>, ID, <span class="st">'&lt;/b&gt;'</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">'&lt;br&gt;Coef. Urban  :'</span>, <span class="fu">round</span>(UrbanPop,<span class="dv">3</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">'&lt;br&gt;Coef. Murder :'</span>, <span class="fu">round</span>(Assault,<span class="dv">3</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">'&lt;br&gt;Coef. Intercept :'</span>, <span class="fu">round</span>(<span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>,<span class="dv">3</span>)),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">hoverinfo=</span><span class="st">'text'</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">showlegend=</span>F,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">marker=</span><span class="fu">list</span>( <span class="at">color=</span><span class="st">'rgba(0, 0, 0, 0.5)'</span>))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> plotly<span class="sc">::</span><span class="fu">layout</span>(fig,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">showlegend=</span>F,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span><span class="st">'Joint Distribution of Coefficients (under the null)'</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title=</span><span class="st">'UrbanPop Coefficient'</span>),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title=</span><span class="st">'Assualt Coefficient'</span>))</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>fig</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-36809249dd3e367e2a4b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-36809249dd3e367e2a4b">{"x":{"visdat":{"277d2b3082cf":["function () ","plotlyVisDat"]},"cur_data":"277d2b3082cf","attrs":{"277d2b3082cf":{"mode":"markers","x":{},"y":{},"text":{},"hoverinfo":"text","showlegend":false,"marker":{"color":"rgba(0, 0, 0, 0.5)"},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"showlegend":false,"title":"Joint Distribution of Coefficients (under the null)","xaxis":{"domain":[0,1],"automargin":true,"title":"UrbanPop Coefficient"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Assualt Coefficient"},"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"mode":"markers","x":[-0.028179881036572436,-0.064225016900445547,-0.088178788611093323,-0.06479378272938778,-0.048315161009530955,-0.01148128619088476,-0.043551426171098195,-0.021883867166907562,-0.029719724489219133,-0.030500548445368342,-0.070752974165548044,-0.045161500362728688,-0.034912145961625035,-0.047756981134009086,-0.0072491885107060375,-0.05847347380240131,-0.023115293979009948,-0.086090073869582409,-0.022227262866672134,-0.058452107149573475,-0.076724983799924248,-0.0091682945870952826,-0.029508760981538325,-0.057715418852040706,-0.057616227800558369,0.034154934130867065,-0.057690134901768102,-0.054123666485227991,-0.029976154015325308,-0.038700977749920359,-0.020856657593471543,-0.03462785299053546,-0.074806697761369528,-0.076091986014155594,-0.0086417415725854718,-0.04792852508131136,-0.035667063022671162,-0.070810812029933681,-0.01166149060231347,-0.045158675808942929,-0.089788623590846661,-0.031233387064197735,-0.0059461321719573882,-0.078745625776456427,-0.056855713302921489,-0.035241715852018476,-0.053505736628111387,-0.050511548289527766,-0.050104959684859236,-0.0249210512253971,-0.026810391816742028,-0.10963980453326633,-0.082905558927246381,-0.080209561056026599,-1.217791960900164e-06,-0.091708476307207423,-0.026810047048982669,-0.066775800793865761,-0.020899107661842903,-0.0036359422287513361,-0.069330495113437793,-0.023112834062374972,-0.028139492457417106,-0.046069206734907171,-0.065938151608030002,-0.038668687350873768,-0.0073753340415232509,-0.014918079422019656,-0.046870531335205842,-0.012280577620314287,-0.045389449408585657,-0.058850310455725786,-0.045099477106076161,-0.069949334919844675,-0.0083546178975742371,-0.042948274721130018,-0.024382892336949388,-0.051713360087050513,-0.046502927285455416,-0.10791621332486559,-0.038847723264358078,-0.025024583221749386,0.00039666014399544454,-0.020406787236863736,-0.001457655042836756,-0.060463192591162826,-0.01789403412379531,-0.0095115518170851756,-0.020346677880443281,-0.073153688236511832,-0.037238213287190992,-0.061846883464439104,-0.073623598335983351,-0.059302312227391615,-0.040433772159334587,-0.048442520255902309,-0.016958102340590243,-0.026305617419001621,-0.0079753140044084951,0.0033986729734940585,-0.030509370759320056,-0.024009809234997216,-0.038841132019176834,-0.067279881699714647,-0.084676955354106145,-0.043924047453614883,-0.071873517732693265,-0.026973726408059853,-0.071103222771218416,-0.038158027970829657,-0.038371642513042446,-0.0073742287018672519,-0.07260567696012607,-0.07971008393918981,-0.051999543232201205,-0.045532637841139471,-0.055386957924381364,-0.087138228954297306,-0.0006683583139762059,-0.085462621581616965,-0.08078393365307443,-0.033545746633567644,0.0081863022121811783,-0.036935379546542135,-0.06137366963354652,-0.054738201031458669,-0.083229315688970393,-0.086315459770514344,-0.076396150195668658,-0.038395924107274555,-0.062966124088682282,-0.028765714639871515,-0.024567488384158013,-0.029003906912738991,-0.11372552548051004,-0.061600608281299707,-0.10113241506353579,-0.053034688857651356,-0.068093492857533036,-0.02052702158346981,-0.013160051195735231,-0.03932534559383543,-0.10310017666843178,-0.056876530034025437,-0.044683179347573689,-0.028871958135539461,0.00096155077565107747,-0.040266218583672408,-0.02679964472972745,0.0068763097378857514,-0.08330675361470373,-0.086821837487431081,-0.058646689837058966,-0.052332336723587371,-0.07558947268803437,-0.0099753056788863727,-0.081483011778202108,-0.034476367889069152,-0.096593169041693058,-0.041909738937768767,-0.047371690630228655,-0.055302610314811929,0.0014692265768556263,-0.067058470108329229,-0.049875944632910875,-0.067405799759110804,-0.043180727369620468,-0.07765611659473147,-0.061842025101123028,-0.05914710674276942,-0.090502207708416785,-0.03473322513116426,-0.059443082454453143,-0.040047960280430249,-0.052702674022752471,-0.021458794562177731,-0.032113348412297509,-0.09385711434072154,-0.030440368895470034,-0.062278896315871371,-0.058758046637534547,-0.023450378198393504,-0.0053868621532056991,-0.10331021403376059,-0.02288558614323934,-0.066865144669332507,0.00029161818315148671,-0.06761481832935437,-0.040684050723302924,-0.037649586978838592,-0.037290367660748107,-0.043573573939921943,-0.037631012782723308,-0.034930003283951711,-0.029833030296093698,-0.080723441485281003,-0.01043422031255249,-0.043534497210212582,0.014919435564305111,-0.039658296984175806,-0.033936366596920016,-0.086090325779811086,-0.069348432534620336,-0.015276457165836796,-0.11078169925911241,-0.013000437358728665,-0.046818163565762828,-0.032934403420236638,-0.038538356674939184,-0.11779297714776468,-0.066339017048739485,-0.078858087674098687,-0.0315114471890999,-0.067241857222221396,-0.047199566511210066,-0.10947067255218643,-0.055079149996945874,-0.025205790409418772,-0.017124080139561803,-0.023242417684048871,-0.017993527672819035,-0.056927352981134875,-0.0013536201144488237,-0.025940087952353228,-0.074368875832165379,-0.05779401284241497,-0.092958149798115133,-0.074842616168382683,-0.02364229989050284,-0.0082959691331913055,-0.039774758274252441,-0.083468348648987972,-0.062102469658605296,-0.015484828497906784,-0.060575188093778376,-0.043536485415239086,-0.054056868823008038,-0.046162957257333576,-0.059812368679171911,-0.050126694538125627,-0.043257752982839501,-0.029840776189867444,-0.086524675542106425,-0.085314485212009822,-0.055567210100884598,-0.039478780054265077,-0.077951671012786397,-0.054758514693198958,-0.051602813709106424,-0.076881546140613544,-0.054433874997148919,-0.037941434777276128,-0.019248961476495401,-0.059661603519385861,-0.057566497584039943,-0.11250104320298503,-0.086988333929235911,-0.015618704081734212,0.0061638430617519295,-0.067619532784786024,-0.041191338134882384,-0.040979770511985397,-0.084281134857864135,-0.057461273703025832,-0.03339206398431805,-0.061462670874685162,-0.045833843056081965,-0.042182556280739338,-0.050825226265456304,-0.021658229055947879,-0.032443297675154754,-0.08218561539596668,-0.051329110620812191,-0.016545188828547934,-0.043027155426728435,-0.050011383189547648,-0.065685390179233985,-0.095114042551665931,-0.035760954501108028,-0.07654663728040384,-0.076695249285901254,-0.097272165331274016,-0.044468226921537873,-0.028538343068675236,-0.083702654246458355,-0.1073664804461149,-0.012782573076106854,-0.024506122894586854,-0.02605598811989529,-0.10480930507963587,-0.044417329418071159,-0.06763922619193008,-0.066130419266891685,-0.010275911457436631,-0.056962736902937669,-0.014764798574557749,-0.014154761305151175,-0.027810604857425755,-0.071550013803940729,-0.048258375558742642,-0.070647827099771923,-0.035538289654582632,-0.033980069284767843,-0.0070982286504644504,-0.028849727431647251,-0.082456907535116294,-0.025763683712133795,-0.057904897540766359,-0.11682044145457421,-0.066837858892248844,-0.067522978931856464,-0.0081936670951774128,-0.020367463565137769,-0.056347889582317359,-0.045594832703051105,-0.017658040197635175,-0.076230437645627591,-0.0094454833071979331,-0.026666921900582619,-0.060821584532943146,-0.027658565902159989,-0.11006969774437549,-0.05800869092755305,-0.035787075899214663,-0.083117581908476207,-0.10608182716251849,-0.035610323067715575,-0.055129727063479489,-0.046273930410561957,-0.069984117192641221,-0.057718429786780732,-0.039665597515142696,-0.036632477253523019,-0.030328064733051243,-0.077271716824926992,-0.078806906098268389,-0.060077110596506542,-0.029079179599205199,-0.085261968782302452,-0.064857125136463134,-0.088215347354329107,0.010129791271904899,-0.05627794107300594,-0.024915910408047973,-0.079974884607680929,-0.10471145277962743,-0.053448459420283374,-0.032864638952919793,-0.036930410002961538,-0.040783763149322735,-0.039623023749928363,-0.015948039561952627,-0.062100779602715345,-0.065643183507239869,-0.062813809049694386,-0.031384937872021519,-0.031066195536134111,-0.038035907334252064,-0.041626135186457983,-0.074611544487033943,-0.030439846436847197,-0.033931368288454868,-0.050384037493200196,-0.051185507344731832,-0.031214607692890958,-0.051765990626473267,-0.058885709970047551,-0.049601099088704678,-0.016594196094346234,-0.05120583488230681,-0.033306680590183539,-0.02031104312097964,-0.09465754236381016,-0.0465257414370518,-0.075366848298905068,-0.030273221797451656,-0.029202867736793533,-0.01941476398388484,-0.056639497323076458,-0.0071700515373364368,-0.028954813263764489,-0.030085259968499718,-0.022633444165303294,-0.027645284172337879,-0.073288741146915304,-0.058653713775409684,-0.095108941943972944,-0.043917637038861757,-0.026835155696738586,-0.023885667001091255,-0.017176754777751432,-0.045606864593176387,-0.0088265758835375675,-0.05340482644642118,-0.021882657375449512,-0.074680546725229544,-0.062678886489045474,-0.014268976056034235,-0.05020006171420361],"y":[0.042916235285857238,0.042963101510342383,0.043199857276471409,0.044627659796777748,0.043762343773039974,0.038107603958693365,0.051524939740479045,0.039701094455950957,0.037162258621765011,0.044410691891039474,0.041563214748115432,0.039486647390061427,0.048328165278799233,0.043710235059582839,0.04274312384628081,0.04102620012501286,0.037713311179244681,0.039937734504180145,0.042970347871394775,0.044857940830293826,0.048042940479437267,0.03886412990711275,0.044365904591887509,0.041118718706170489,0.047035595762505038,0.034763138850823605,0.042859896274176586,0.038508199908389162,0.043583550291059203,0.051977808387637936,0.041670437346691507,0.043017228020333399,0.040761138277386547,0.048552202320956493,0.044815623428181565,0.037004894953661556,0.03884795823616103,0.0405681572547704,0.040543960409462988,0.041233566465182218,0.050454221382846901,0.04120786727673928,0.041583045422424227,0.051611217470036788,0.044298885965515546,0.042542662821233194,0.052712377380733623,0.044809593147791267,0.041686639388205313,0.042836925759784393,0.03791389735706098,0.042219834419975538,0.05012496860432019,0.051972347324548522,0.032511694813052328,0.052987923068107443,0.040897402993764466,0.039319046279886152,0.037690622230118556,0.039299072360667792,0.043825403083076746,0.042958785081268387,0.043217571886086971,0.040263365456856097,0.044428673602504846,0.048361110683294545,0.042459557533456933,0.041063074932814039,0.047545589078816688,0.042226131366952448,0.043138964706707549,0.055325016323034826,0.041888418383602327,0.041606812958994883,0.042266004193332048,0.043073795142642979,0.041876080059376909,0.041482447662370532,0.043997896669425662,0.047817940143827106,0.042396224376026165,0.038096050366186483,0.044495943790650215,0.043185600144632533,0.045911796036704665,0.042231935052483974,0.040516261287140067,0.043969095619672764,0.040083390807525855,0.040041818590346299,0.043251041123719379,0.050014966691918503,0.04800534034897825,0.038436013363566383,0.04140528590410214,0.04940050200186083,0.045183726227171747,0.036784723747315833,0.042708705976542437,0.041654686194924316,0.04580711679460988,0.031569827231943542,0.044842868107764791,0.046747455133420247,0.047620098692328354,0.04984764667587168,0.049478026157583468,0.044179811990267298,0.042391878643113154,0.044407467395832505,0.03977483723654103,0.035541262082055339,0.051927046270679157,0.047308103742812774,0.041671642551591268,0.042875121934327978,0.05039386456731431,0.040521996162375867,0.047550276121713565,0.043415991622363655,0.04236249702247398,0.039635202279893623,0.036434623890241886,0.047424896384411733,0.040880610125514777,0.047362818645286596,0.04327792014540853,0.052443248215373751,0.044859595421493197,0.04131925826023912,0.052978704747014757,0.045257978697322745,0.038202026617831335,0.048417299357186909,0.048133709353093482,0.039996387333471689,0.046661154694774637,0.044262066968169547,0.047069341217187491,0.041125475211517562,0.042154606803182011,0.039136692393412664,0.056380937076697939,0.042961959802994464,0.049521351426073681,0.043559128770604777,0.039387237362167801,0.039625940914090794,0.044127757766281805,0.040938166376465676,0.04951682148586023,0.042098633064470835,0.042199061002214773,0.051144405200962299,0.051143380700919588,0.039902397231678335,0.041876871652230634,0.044028174065184056,0.046453767009403409,0.040357851720396423,0.03735017158078905,0.046415893342903608,0.041688622254113052,0.047557553987750779,0.048940433311765431,0.056020932457478814,0.034715855309384612,0.039295571939693269,0.051776725391378814,0.04788927835869021,0.056561891601506119,0.04495866863209047,0.049357829733300877,0.042790317281952914,0.043212514476958321,0.043018534406743393,0.03970784622968046,0.053902040244714809,0.039094836055082759,0.043992878974849971,0.053030958155506042,0.048602397898403732,0.041861060719922301,0.054518799851744577,0.039029631889861943,0.057462846791838086,0.045105185344849669,0.043539969885399848,0.046323759289949348,0.044920016798643908,0.047625393708934587,0.039773175441566416,0.049955435863390817,0.046424813467568951,0.044812917249352976,0.046952681902419344,0.042767280480210133,0.045046556917826455,0.041198945261525954,0.041705527763365037,0.043969037532285975,0.044783079110584337,0.04480416498955541,0.04642013557426785,0.051453999040749029,0.041808095734341806,0.038254778325069301,0.039463184700312647,0.042082465482524326,0.047688063026637834,0.044642968153050432,0.04630145422932859,0.038681807419309815,0.045347635761986159,0.046950932299449119,0.052454988465721761,0.044146711473032944,0.041122444134281413,0.041227915940178744,0.035942281882361961,0.039591699244373391,0.045533254398162769,0.037333845829287358,0.043032365585252745,0.04460955446150864,0.04425898412299397,0.046416164809824197,0.050641523696423683,0.045356281428047103,0.042986188843141607,0.040235187139811342,0.055469739648721116,0.045881370501952935,0.040292314269169231,0.045838391436947963,0.046327675759709204,0.045613471822550503,0.050662272848665944,0.04808157624830401,0.045154618408502926,0.036132117710355648,0.037466170756125891,0.043657497678701668,0.050720201558282656,0.04954749615372793,0.044585748220842811,0.045913292543854227,0.04722297148678449,0.045700956361381044,0.054260239200054128,0.041524728708668544,0.041517566770432161,0.03969680846601413,0.044157752737101874,0.04762091404932834,0.046649639534016754,0.047188855068447409,0.038805484764475963,0.037729062922776058,0.045435331260448381,0.043552686859972399,0.043599702957200809,0.04344083223758493,0.047284135073333539,0.034578815526937458,0.035511745233489558,0.047601312567708588,0.039497361623163245,0.040840577029690281,0.039111966988398229,0.045737164550639309,0.050450442091542889,0.042049508538029919,0.048864606716828463,0.040177810723797593,0.045399683745757952,0.049953419551567325,0.044521680083241609,0.043442041277432467,0.045495178477292626,0.045003559880810409,0.045719077753388931,0.041792596645376399,0.041357151957540861,0.049309624408246391,0.050461658757409884,0.040647251933363084,0.044143779107832092,0.045024320294409441,0.056028545710020347,0.045510831035324023,0.041200218687131696,0.040742015159002158,0.03919131725839016,0.041527843754473069,0.040975933197705261,0.037507266929066432,0.039411985194463921,0.039181596105493745,0.043385073181379963,0.041586485040046139,0.052629558980588804,0.040357801787045018,0.037263116159491412,0.042209875385532086,0.041881436003941008,0.042476247610880653,0.042182041875602913,0.048761054342147364,0.047933210117783488,0.038878140076685573,0.041807021558185567,0.046481698291678884,0.039964949790875434,0.040510834141017901,0.041865558282271051,0.047019417083283381,0.044022879676945799,0.047251716534858441,0.043467559309112634,0.047379279111635385,0.044303827590362291,0.039966381933669762,0.041671011925721216,0.05284498788416072,0.049102417407059361,0.046905055325630302,0.041978150923552685,0.045696913663975602,0.042384467188832917,0.044583246347790019,0.045072234425406289,0.041624708861184453,0.047544211887294768,0.050523330716916413,0.050190940563820952,0.049953387204843352,0.03995621002426715,0.05699035145317273,0.05292661491261777,0.04901716174924859,0.036147657276879935,0.051418050512591372,0.04280060480093878,0.05282601943037897,0.046518664759929967,0.040276415589331989,0.046167803498838318,0.043904050709321352,0.045388634114053958,0.040399170278003792,0.040302910738671011,0.038156656957998247,0.044794370448527791,0.057626717356413323,0.045731647093634219,0.043637117834589047,0.039018697077323666,0.035318780495066482,0.047741370423976921,0.038202810475588114,0.04007464317971686,0.043505193923316018,0.048644090815648779,0.038296669744465238,0.037415521163377242,0.045220913505830955,0.04340781505832958,0.042094455238231347,0.041016627513324869,0.044103972075141967,0.042413700212925572,0.052643165901975819,0.041800750704049268,0.05429232882807139,0.042015851576304185,0.042582940318961524,0.047713075965555692,0.045816156908453774,0.038564704302637351,0.038346940172899996,0.048585317000554545,0.039295827143590763,0.04008741217749015,0.04918448128895303,0.040346590835302391,0.050860422670670202,0.049510080125428818,0.04176737383668741,0.043249130321890192,0.042038773583223957,0.0479283910035678,0.04284658098199607,0.051009204864280087,0.035628815361719031,0.045676180899056444,0.043882384842310981,0.046464406010675391,0.043831815179808727],"text":["<b> bootstrap dataset:  1 <\/b> <br>Coef. Urban  : -0.028 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 2.787","<b> bootstrap dataset:  2 <\/b> <br>Coef. Urban  : -0.064 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 4.811","<b> bootstrap dataset:  3 <\/b> <br>Coef. Urban  : -0.088 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 5.689","<b> bootstrap dataset:  4 <\/b> <br>Coef. Urban  : -0.065 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 4.018","<b> bootstrap dataset:  5 <\/b> <br>Coef. Urban  : -0.048 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 3.26","<b> bootstrap dataset:  6 <\/b> <br>Coef. Urban  : -0.011 <br>Coef. Murder : 0.038 <br>Coef. Intercept : 1.742","<b> bootstrap dataset:  7 <\/b> <br>Coef. Urban  : -0.044 <br>Coef. Murder : 0.052 <br>Coef. Intercept : 2.297","<b> bootstrap dataset:  8 <\/b> <br>Coef. Urban  : -0.022 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 2.198","<b> bootstrap dataset:  9 <\/b> <br>Coef. Urban  : -0.03 <br>Coef. Murder : 0.037 <br>Coef. Intercept : 3.026","<b> bootstrap dataset:  10 <\/b> <br>Coef. Urban  : -0.031 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 1.882","<b> bootstrap dataset:  11 <\/b> <br>Coef. Urban  : -0.071 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 5.422","<b> bootstrap dataset:  12 <\/b> <br>Coef. Urban  : -0.045 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 3.493","<b> bootstrap dataset:  13 <\/b> <br>Coef. Urban  : -0.035 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 1.684","<b> bootstrap dataset:  14 <\/b> <br>Coef. Urban  : -0.048 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 3.423","<b> bootstrap dataset:  15 <\/b> <br>Coef. Urban  : -0.007 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 0.975","<b> bootstrap dataset:  16 <\/b> <br>Coef. Urban  : -0.058 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 4.379","<b> bootstrap dataset:  17 <\/b> <br>Coef. Urban  : -0.023 <br>Coef. Murder : 0.038 <br>Coef. Intercept : 2.579","<b> bootstrap dataset:  18 <\/b> <br>Coef. Urban  : -0.086 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 7.129","<b> bootstrap dataset:  19 <\/b> <br>Coef. Urban  : -0.022 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 1.492","<b> bootstrap dataset:  20 <\/b> <br>Coef. Urban  : -0.058 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 3.642","<b> bootstrap dataset:  21 <\/b> <br>Coef. Urban  : -0.077 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 4.387","<b> bootstrap dataset:  22 <\/b> <br>Coef. Urban  : -0.009 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 1.809","<b> bootstrap dataset:  23 <\/b> <br>Coef. Urban  : -0.03 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 2.184","<b> bootstrap dataset:  24 <\/b> <br>Coef. Urban  : -0.058 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 4.531","<b> bootstrap dataset:  25 <\/b> <br>Coef. Urban  : -0.058 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 3.908","<b> bootstrap dataset:  26 <\/b> <br>Coef. Urban  : 0.034 <br>Coef. Murder : 0.035 <br>Coef. Intercept : -0.465","<b> bootstrap dataset:  27 <\/b> <br>Coef. Urban  : -0.058 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 4.573","<b> bootstrap dataset:  28 <\/b> <br>Coef. Urban  : -0.054 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 4.883","<b> bootstrap dataset:  29 <\/b> <br>Coef. Urban  : -0.03 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 2.456","<b> bootstrap dataset:  30 <\/b> <br>Coef. Urban  : -0.039 <br>Coef. Murder : 0.052 <br>Coef. Intercept : 1.528","<b> bootstrap dataset:  31 <\/b> <br>Coef. Urban  : -0.021 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 1.565","<b> bootstrap dataset:  32 <\/b> <br>Coef. Urban  : -0.035 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 2.882","<b> bootstrap dataset:  33 <\/b> <br>Coef. Urban  : -0.075 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 5.096","<b> bootstrap dataset:  34 <\/b> <br>Coef. Urban  : -0.076 <br>Coef. Murder : 0.049 <br>Coef. Intercept : 4.83","<b> bootstrap dataset:  35 <\/b> <br>Coef. Urban  : -0.009 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 1.027","<b> bootstrap dataset:  36 <\/b> <br>Coef. Urban  : -0.048 <br>Coef. Murder : 0.037 <br>Coef. Intercept : 4.193","<b> bootstrap dataset:  37 <\/b> <br>Coef. Urban  : -0.036 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 3.356","<b> bootstrap dataset:  38 <\/b> <br>Coef. Urban  : -0.071 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 4.619","<b> bootstrap dataset:  39 <\/b> <br>Coef. Urban  : -0.012 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 1.74","<b> bootstrap dataset:  40 <\/b> <br>Coef. Urban  : -0.045 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 4.275","<b> bootstrap dataset:  41 <\/b> <br>Coef. Urban  : -0.09 <br>Coef. Murder : 0.05 <br>Coef. Intercept : 5.666","<b> bootstrap dataset:  42 <\/b> <br>Coef. Urban  : -0.031 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 2.882","<b> bootstrap dataset:  43 <\/b> <br>Coef. Urban  : -0.006 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 1.292","<b> bootstrap dataset:  44 <\/b> <br>Coef. Urban  : -0.079 <br>Coef. Murder : 0.052 <br>Coef. Intercept : 4.234","<b> bootstrap dataset:  45 <\/b> <br>Coef. Urban  : -0.057 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 3.943","<b> bootstrap dataset:  46 <\/b> <br>Coef. Urban  : -0.035 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 2.894","<b> bootstrap dataset:  47 <\/b> <br>Coef. Urban  : -0.054 <br>Coef. Murder : 0.053 <br>Coef. Intercept : 3.456","<b> bootstrap dataset:  48 <\/b> <br>Coef. Urban  : -0.051 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 3.506","<b> bootstrap dataset:  49 <\/b> <br>Coef. Urban  : -0.05 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 4.148","<b> bootstrap dataset:  50 <\/b> <br>Coef. Urban  : -0.025 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 2.056","<b> bootstrap dataset:  51 <\/b> <br>Coef. Urban  : -0.027 <br>Coef. Murder : 0.038 <br>Coef. Intercept : 2.701","<b> bootstrap dataset:  52 <\/b> <br>Coef. Urban  : -0.11 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 8.803","<b> bootstrap dataset:  53 <\/b> <br>Coef. Urban  : -0.083 <br>Coef. Murder : 0.05 <br>Coef. Intercept : 4.379","<b> bootstrap dataset:  54 <\/b> <br>Coef. Urban  : -0.08 <br>Coef. Murder : 0.052 <br>Coef. Intercept : 4.52","<b> bootstrap dataset:  55 <\/b> <br>Coef. Urban  : 0 <br>Coef. Murder : 0.033 <br>Coef. Intercept : 1.445","<b> bootstrap dataset:  56 <\/b> <br>Coef. Urban  : -0.092 <br>Coef. Murder : 0.053 <br>Coef. Intercept : 4.71","<b> bootstrap dataset:  57 <\/b> <br>Coef. Urban  : -0.027 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 2.198","<b> bootstrap dataset:  58 <\/b> <br>Coef. Urban  : -0.067 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 4.85","<b> bootstrap dataset:  59 <\/b> <br>Coef. Urban  : -0.021 <br>Coef. Murder : 0.038 <br>Coef. Intercept : 2.745","<b> bootstrap dataset:  60 <\/b> <br>Coef. Urban  : -0.004 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 1.808","<b> bootstrap dataset:  61 <\/b> <br>Coef. Urban  : -0.069 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 4.7","<b> bootstrap dataset:  62 <\/b> <br>Coef. Urban  : -0.023 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 1.641","<b> bootstrap dataset:  63 <\/b> <br>Coef. Urban  : -0.028 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 2.882","<b> bootstrap dataset:  64 <\/b> <br>Coef. Urban  : -0.046 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 3.751","<b> bootstrap dataset:  65 <\/b> <br>Coef. Urban  : -0.066 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 5.113","<b> bootstrap dataset:  66 <\/b> <br>Coef. Urban  : -0.039 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 1.851","<b> bootstrap dataset:  67 <\/b> <br>Coef. Urban  : -0.007 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 1.092","<b> bootstrap dataset:  68 <\/b> <br>Coef. Urban  : -0.015 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 1.362","<b> bootstrap dataset:  69 <\/b> <br>Coef. Urban  : -0.047 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 2.573","<b> bootstrap dataset:  70 <\/b> <br>Coef. Urban  : -0.012 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 1.478","<b> bootstrap dataset:  71 <\/b> <br>Coef. Urban  : -0.045 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 3.257","<b> bootstrap dataset:  72 <\/b> <br>Coef. Urban  : -0.059 <br>Coef. Murder : 0.055 <br>Coef. Intercept : 3.212","<b> bootstrap dataset:  73 <\/b> <br>Coef. Urban  : -0.045 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 3.731","<b> bootstrap dataset:  74 <\/b> <br>Coef. Urban  : -0.07 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 4.947","<b> bootstrap dataset:  75 <\/b> <br>Coef. Urban  : -0.008 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 0.913","<b> bootstrap dataset:  76 <\/b> <br>Coef. Urban  : -0.043 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 2.531","<b> bootstrap dataset:  77 <\/b> <br>Coef. Urban  : -0.024 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 2.141","<b> bootstrap dataset:  78 <\/b> <br>Coef. Urban  : -0.052 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 3.609","<b> bootstrap dataset:  79 <\/b> <br>Coef. Urban  : -0.047 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 3.683","<b> bootstrap dataset:  80 <\/b> <br>Coef. Urban  : -0.108 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 7.375","<b> bootstrap dataset:  81 <\/b> <br>Coef. Urban  : -0.039 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 2.663","<b> bootstrap dataset:  82 <\/b> <br>Coef. Urban  : -0.025 <br>Coef. Murder : 0.038 <br>Coef. Intercept : 2.631","<b> bootstrap dataset:  83 <\/b> <br>Coef. Urban  : 0 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 0.264","<b> bootstrap dataset:  84 <\/b> <br>Coef. Urban  : -0.02 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 1.68","<b> bootstrap dataset:  85 <\/b> <br>Coef. Urban  : -0.001 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 0.335","<b> bootstrap dataset:  86 <\/b> <br>Coef. Urban  : -0.06 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 4.207","<b> bootstrap dataset:  87 <\/b> <br>Coef. Urban  : -0.018 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 2.141","<b> bootstrap dataset:  88 <\/b> <br>Coef. Urban  : -0.01 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 1.152","<b> bootstrap dataset:  89 <\/b> <br>Coef. Urban  : -0.02 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 2.39","<b> bootstrap dataset:  90 <\/b> <br>Coef. Urban  : -0.073 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 5.633","<b> bootstrap dataset:  91 <\/b> <br>Coef. Urban  : -0.037 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 2.348","<b> bootstrap dataset:  92 <\/b> <br>Coef. Urban  : -0.062 <br>Coef. Murder : 0.05 <br>Coef. Intercept : 3.483","<b> bootstrap dataset:  93 <\/b> <br>Coef. Urban  : -0.074 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 4.413","<b> bootstrap dataset:  94 <\/b> <br>Coef. Urban  : -0.059 <br>Coef. Murder : 0.038 <br>Coef. Intercept : 5.429","<b> bootstrap dataset:  95 <\/b> <br>Coef. Urban  : -0.04 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 3.56","<b> bootstrap dataset:  96 <\/b> <br>Coef. Urban  : -0.048 <br>Coef. Murder : 0.049 <br>Coef. Intercept : 2.883","<b> bootstrap dataset:  97 <\/b> <br>Coef. Urban  : -0.017 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 0.934","<b> bootstrap dataset:  98 <\/b> <br>Coef. Urban  : -0.026 <br>Coef. Murder : 0.037 <br>Coef. Intercept : 2.812","<b> bootstrap dataset:  99 <\/b> <br>Coef. Urban  : -0.008 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 1.436","<b> bootstrap dataset:  100 <\/b> <br>Coef. Urban  : 0.003 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 1.159","<b> bootstrap dataset:  101 <\/b> <br>Coef. Urban  : -0.031 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 2.339","<b> bootstrap dataset:  102 <\/b> <br>Coef. Urban  : -0.024 <br>Coef. Murder : 0.032 <br>Coef. Intercept : 3.53","<b> bootstrap dataset:  103 <\/b> <br>Coef. Urban  : -0.039 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 2.692","<b> bootstrap dataset:  104 <\/b> <br>Coef. Urban  : -0.067 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 4.208","<b> bootstrap dataset:  105 <\/b> <br>Coef. Urban  : -0.085 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 5.351","<b> bootstrap dataset:  106 <\/b> <br>Coef. Urban  : -0.044 <br>Coef. Murder : 0.05 <br>Coef. Intercept : 1.909","<b> bootstrap dataset:  107 <\/b> <br>Coef. Urban  : -0.072 <br>Coef. Murder : 0.049 <br>Coef. Intercept : 3.974","<b> bootstrap dataset:  108 <\/b> <br>Coef. Urban  : -0.027 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 2.116","<b> bootstrap dataset:  109 <\/b> <br>Coef. Urban  : -0.071 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 4.734","<b> bootstrap dataset:  110 <\/b> <br>Coef. Urban  : -0.038 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 1.913","<b> bootstrap dataset:  111 <\/b> <br>Coef. Urban  : -0.038 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 3.354","<b> bootstrap dataset:  112 <\/b> <br>Coef. Urban  : -0.007 <br>Coef. Murder : 0.036 <br>Coef. Intercept : 2.177","<b> bootstrap dataset:  113 <\/b> <br>Coef. Urban  : -0.073 <br>Coef. Murder : 0.052 <br>Coef. Intercept : 3.376","<b> bootstrap dataset:  114 <\/b> <br>Coef. Urban  : -0.08 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 5.414","<b> bootstrap dataset:  115 <\/b> <br>Coef. Urban  : -0.052 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 4.016","<b> bootstrap dataset:  116 <\/b> <br>Coef. Urban  : -0.046 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 3.333","<b> bootstrap dataset:  117 <\/b> <br>Coef. Urban  : -0.055 <br>Coef. Murder : 0.05 <br>Coef. Intercept : 3.208","<b> bootstrap dataset:  118 <\/b> <br>Coef. Urban  : -0.087 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 6.506","<b> bootstrap dataset:  119 <\/b> <br>Coef. Urban  : -0.001 <br>Coef. Murder : 0.048 <br>Coef. Intercept : -0.304","<b> bootstrap dataset:  120 <\/b> <br>Coef. Urban  : -0.085 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 6.302","<b> bootstrap dataset:  121 <\/b> <br>Coef. Urban  : -0.081 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 5.744","<b> bootstrap dataset:  122 <\/b> <br>Coef. Urban  : -0.034 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 3.461","<b> bootstrap dataset:  123 <\/b> <br>Coef. Urban  : 0.008 <br>Coef. Murder : 0.036 <br>Coef. Intercept : 0.512","<b> bootstrap dataset:  124 <\/b> <br>Coef. Urban  : -0.037 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 2.389","<b> bootstrap dataset:  125 <\/b> <br>Coef. Urban  : -0.061 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 4.369","<b> bootstrap dataset:  126 <\/b> <br>Coef. Urban  : -0.055 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 3.277","<b> bootstrap dataset:  127 <\/b> <br>Coef. Urban  : -0.083 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 5.826","<b> bootstrap dataset:  128 <\/b> <br>Coef. Urban  : -0.086 <br>Coef. Murder : 0.052 <br>Coef. Intercept : 4.5","<b> bootstrap dataset:  129 <\/b> <br>Coef. Urban  : -0.076 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 5.061","<b> bootstrap dataset:  130 <\/b> <br>Coef. Urban  : -0.038 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 2.598","<b> bootstrap dataset:  131 <\/b> <br>Coef. Urban  : -0.063 <br>Coef. Murder : 0.053 <br>Coef. Intercept : 3.43","<b> bootstrap dataset:  132 <\/b> <br>Coef. Urban  : -0.029 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 1.885","<b> bootstrap dataset:  133 <\/b> <br>Coef. Urban  : -0.025 <br>Coef. Murder : 0.038 <br>Coef. Intercept : 2.74","<b> bootstrap dataset:  134 <\/b> <br>Coef. Urban  : -0.029 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 0.991","<b> bootstrap dataset:  135 <\/b> <br>Coef. Urban  : -0.114 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 7.267","<b> bootstrap dataset:  136 <\/b> <br>Coef. Urban  : -0.062 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 4.629","<b> bootstrap dataset:  137 <\/b> <br>Coef. Urban  : -0.101 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 5.846","<b> bootstrap dataset:  138 <\/b> <br>Coef. Urban  : -0.053 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 3.565","<b> bootstrap dataset:  139 <\/b> <br>Coef. Urban  : -0.068 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 4.392","<b> bootstrap dataset:  140 <\/b> <br>Coef. Urban  : -0.021 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 2.727","<b> bootstrap dataset:  141 <\/b> <br>Coef. Urban  : -0.013 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 1.805","<b> bootstrap dataset:  142 <\/b> <br>Coef. Urban  : -0.039 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 3.369","<b> bootstrap dataset:  143 <\/b> <br>Coef. Urban  : -0.103 <br>Coef. Murder : 0.056 <br>Coef. Intercept : 5.249","<b> bootstrap dataset:  144 <\/b> <br>Coef. Urban  : -0.057 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 3.995","<b> bootstrap dataset:  145 <\/b> <br>Coef. Urban  : -0.045 <br>Coef. Murder : 0.05 <br>Coef. Intercept : 2.422","<b> bootstrap dataset:  146 <\/b> <br>Coef. Urban  : -0.029 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 2.422","<b> bootstrap dataset:  147 <\/b> <br>Coef. Urban  : 0.001 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 0.42","<b> bootstrap dataset:  148 <\/b> <br>Coef. Urban  : -0.04 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 4.001","<b> bootstrap dataset:  149 <\/b> <br>Coef. Urban  : -0.027 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 2.071","<b> bootstrap dataset:  150 <\/b> <br>Coef. Urban  : 0.007 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 0.06","<b> bootstrap dataset:  151 <\/b> <br>Coef. Urban  : -0.083 <br>Coef. Murder : 0.05 <br>Coef. Intercept : 5.362","<b> bootstrap dataset:  152 <\/b> <br>Coef. Urban  : -0.087 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 6.143","<b> bootstrap dataset:  153 <\/b> <br>Coef. Urban  : -0.059 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 4.581","<b> bootstrap dataset:  154 <\/b> <br>Coef. Urban  : -0.052 <br>Coef. Murder : 0.051 <br>Coef. Intercept : 2.681","<b> bootstrap dataset:  155 <\/b> <br>Coef. Urban  : -0.076 <br>Coef. Murder : 0.051 <br>Coef. Intercept : 4.171","<b> bootstrap dataset:  156 <\/b> <br>Coef. Urban  : -0.01 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 1.661","<b> bootstrap dataset:  157 <\/b> <br>Coef. Urban  : -0.081 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 6.612","<b> bootstrap dataset:  158 <\/b> <br>Coef. Urban  : -0.034 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 1.956","<b> bootstrap dataset:  159 <\/b> <br>Coef. Urban  : -0.097 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 6.033","<b> bootstrap dataset:  160 <\/b> <br>Coef. Urban  : -0.042 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 3.533","<b> bootstrap dataset:  161 <\/b> <br>Coef. Urban  : -0.047 <br>Coef. Murder : 0.037 <br>Coef. Intercept : 4.604","<b> bootstrap dataset:  162 <\/b> <br>Coef. Urban  : -0.055 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 3.508","<b> bootstrap dataset:  163 <\/b> <br>Coef. Urban  : 0.001 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 0.471","<b> bootstrap dataset:  164 <\/b> <br>Coef. Urban  : -0.067 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 3.931","<b> bootstrap dataset:  165 <\/b> <br>Coef. Urban  : -0.05 <br>Coef. Murder : 0.049 <br>Coef. Intercept : 2.618","<b> bootstrap dataset:  166 <\/b> <br>Coef. Urban  : -0.067 <br>Coef. Murder : 0.056 <br>Coef. Intercept : 3.581","<b> bootstrap dataset:  167 <\/b> <br>Coef. Urban  : -0.043 <br>Coef. Murder : 0.035 <br>Coef. Intercept : 5.105","<b> bootstrap dataset:  168 <\/b> <br>Coef. Urban  : -0.078 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 6.156","<b> bootstrap dataset:  169 <\/b> <br>Coef. Urban  : -0.062 <br>Coef. Murder : 0.052 <br>Coef. Intercept : 3.431","<b> bootstrap dataset:  170 <\/b> <br>Coef. Urban  : -0.059 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 3.287","<b> bootstrap dataset:  171 <\/b> <br>Coef. Urban  : -0.091 <br>Coef. Murder : 0.057 <br>Coef. Intercept : 3.911","<b> bootstrap dataset:  172 <\/b> <br>Coef. Urban  : -0.035 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 2.557","<b> bootstrap dataset:  173 <\/b> <br>Coef. Urban  : -0.059 <br>Coef. Murder : 0.049 <br>Coef. Intercept : 3.492","<b> bootstrap dataset:  174 <\/b> <br>Coef. Urban  : -0.04 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 3.186","<b> bootstrap dataset:  175 <\/b> <br>Coef. Urban  : -0.053 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 3.825","<b> bootstrap dataset:  176 <\/b> <br>Coef. Urban  : -0.021 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 1.953","<b> bootstrap dataset:  177 <\/b> <br>Coef. Urban  : -0.032 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 3.613","<b> bootstrap dataset:  178 <\/b> <br>Coef. Urban  : -0.094 <br>Coef. Murder : 0.054 <br>Coef. Intercept : 4.905","<b> bootstrap dataset:  179 <\/b> <br>Coef. Urban  : -0.03 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 3.491","<b> bootstrap dataset:  180 <\/b> <br>Coef. Urban  : -0.062 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 4.669","<b> bootstrap dataset:  181 <\/b> <br>Coef. Urban  : -0.059 <br>Coef. Murder : 0.053 <br>Coef. Intercept : 2.87","<b> bootstrap dataset:  182 <\/b> <br>Coef. Urban  : -0.023 <br>Coef. Murder : 0.049 <br>Coef. Intercept : 1.055","<b> bootstrap dataset:  183 <\/b> <br>Coef. Urban  : -0.005 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 0.944","<b> bootstrap dataset:  184 <\/b> <br>Coef. Urban  : -0.103 <br>Coef. Murder : 0.055 <br>Coef. Intercept : 4.935","<b> bootstrap dataset:  185 <\/b> <br>Coef. Urban  : -0.023 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 2.512","<b> bootstrap dataset:  186 <\/b> <br>Coef. Urban  : -0.067 <br>Coef. Murder : 0.057 <br>Coef. Intercept : 3.296","<b> bootstrap dataset:  187 <\/b> <br>Coef. Urban  : 0 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 0.229","<b> bootstrap dataset:  188 <\/b> <br>Coef. Urban  : -0.068 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 4.886","<b> bootstrap dataset:  189 <\/b> <br>Coef. Urban  : -0.041 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 2.171","<b> bootstrap dataset:  190 <\/b> <br>Coef. Urban  : -0.038 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 1.945","<b> bootstrap dataset:  191 <\/b> <br>Coef. Urban  : -0.037 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 1.843","<b> bootstrap dataset:  192 <\/b> <br>Coef. Urban  : -0.044 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 3.936","<b> bootstrap dataset:  193 <\/b> <br>Coef. Urban  : -0.038 <br>Coef. Murder : 0.05 <br>Coef. Intercept : 1.576","<b> bootstrap dataset:  194 <\/b> <br>Coef. Urban  : -0.035 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 1.956","<b> bootstrap dataset:  195 <\/b> <br>Coef. Urban  : -0.03 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 2.151","<b> bootstrap dataset:  196 <\/b> <br>Coef. Urban  : -0.081 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 5.233","<b> bootstrap dataset:  197 <\/b> <br>Coef. Urban  : -0.01 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 1.415","<b> bootstrap dataset:  198 <\/b> <br>Coef. Urban  : -0.044 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 3.028","<b> bootstrap dataset:  199 <\/b> <br>Coef. Urban  : 0.015 <br>Coef. Murder : 0.041 <br>Coef. Intercept : -0.39","<b> bootstrap dataset:  200 <\/b> <br>Coef. Urban  : -0.04 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 3.221","<b> bootstrap dataset:  201 <\/b> <br>Coef. Urban  : -0.034 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 2.41","<b> bootstrap dataset:  202 <\/b> <br>Coef. Urban  : -0.086 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 6.138","<b> bootstrap dataset:  203 <\/b> <br>Coef. Urban  : -0.069 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 4.743","<b> bootstrap dataset:  204 <\/b> <br>Coef. Urban  : -0.015 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 0.901","<b> bootstrap dataset:  205 <\/b> <br>Coef. Urban  : -0.111 <br>Coef. Murder : 0.051 <br>Coef. Intercept : 6.675","<b> bootstrap dataset:  206 <\/b> <br>Coef. Urban  : -0.013 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 1.808","<b> bootstrap dataset:  207 <\/b> <br>Coef. Urban  : -0.047 <br>Coef. Murder : 0.038 <br>Coef. Intercept : 4.22","<b> bootstrap dataset:  208 <\/b> <br>Coef. Urban  : -0.033 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 2.744","<b> bootstrap dataset:  209 <\/b> <br>Coef. Urban  : -0.039 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 2.853","<b> bootstrap dataset:  210 <\/b> <br>Coef. Urban  : -0.118 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 8.208","<b> bootstrap dataset:  211 <\/b> <br>Coef. Urban  : -0.066 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 4.269","<b> bootstrap dataset:  212 <\/b> <br>Coef. Urban  : -0.079 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 4.512","<b> bootstrap dataset:  213 <\/b> <br>Coef. Urban  : -0.032 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 2.672","<b> bootstrap dataset:  214 <\/b> <br>Coef. Urban  : -0.067 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 4.295","<b> bootstrap dataset:  215 <\/b> <br>Coef. Urban  : -0.047 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 2.619","<b> bootstrap dataset:  216 <\/b> <br>Coef. Urban  : -0.109 <br>Coef. Murder : 0.052 <br>Coef. Intercept : 5.682","<b> bootstrap dataset:  217 <\/b> <br>Coef. Urban  : -0.055 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 3.951","<b> bootstrap dataset:  218 <\/b> <br>Coef. Urban  : -0.025 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 2.873","<b> bootstrap dataset:  219 <\/b> <br>Coef. Urban  : -0.017 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 1.556","<b> bootstrap dataset:  220 <\/b> <br>Coef. Urban  : -0.023 <br>Coef. Murder : 0.036 <br>Coef. Intercept : 2.642","<b> bootstrap dataset:  221 <\/b> <br>Coef. Urban  : -0.018 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 1.804","<b> bootstrap dataset:  222 <\/b> <br>Coef. Urban  : -0.057 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 3.804","<b> bootstrap dataset:  223 <\/b> <br>Coef. Urban  : -0.001 <br>Coef. Murder : 0.037 <br>Coef. Intercept : 1.982","<b> bootstrap dataset:  224 <\/b> <br>Coef. Urban  : -0.026 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 1.615","<b> bootstrap dataset:  225 <\/b> <br>Coef. Urban  : -0.074 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 5.29","<b> bootstrap dataset:  226 <\/b> <br>Coef. Urban  : -0.058 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 4.115","<b> bootstrap dataset:  227 <\/b> <br>Coef. Urban  : -0.093 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 5.894","<b> bootstrap dataset:  228 <\/b> <br>Coef. Urban  : -0.075 <br>Coef. Murder : 0.051 <br>Coef. Intercept : 4.149","<b> bootstrap dataset:  229 <\/b> <br>Coef. Urban  : -0.024 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 1.981","<b> bootstrap dataset:  230 <\/b> <br>Coef. Urban  : -0.008 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 0.89","<b> bootstrap dataset:  231 <\/b> <br>Coef. Urban  : -0.04 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 3.462","<b> bootstrap dataset:  232 <\/b> <br>Coef. Urban  : -0.083 <br>Coef. Murder : 0.055 <br>Coef. Intercept : 4.815","<b> bootstrap dataset:  233 <\/b> <br>Coef. Urban  : -0.062 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 3.728","<b> bootstrap dataset:  234 <\/b> <br>Coef. Urban  : -0.015 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 2.236","<b> bootstrap dataset:  235 <\/b> <br>Coef. Urban  : -0.061 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 4.352","<b> bootstrap dataset:  236 <\/b> <br>Coef. Urban  : -0.044 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 2.805","<b> bootstrap dataset:  237 <\/b> <br>Coef. Urban  : -0.054 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 3.699","<b> bootstrap dataset:  238 <\/b> <br>Coef. Urban  : -0.046 <br>Coef. Murder : 0.051 <br>Coef. Intercept : 2.684","<b> bootstrap dataset:  239 <\/b> <br>Coef. Urban  : -0.06 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 4.128","<b> bootstrap dataset:  240 <\/b> <br>Coef. Urban  : -0.05 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 3.689","<b> bootstrap dataset:  241 <\/b> <br>Coef. Urban  : -0.043 <br>Coef. Murder : 0.036 <br>Coef. Intercept : 4.288","<b> bootstrap dataset:  242 <\/b> <br>Coef. Urban  : -0.03 <br>Coef. Murder : 0.037 <br>Coef. Intercept : 3.368","<b> bootstrap dataset:  243 <\/b> <br>Coef. Urban  : -0.087 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 5.255","<b> bootstrap dataset:  244 <\/b> <br>Coef. Urban  : -0.085 <br>Coef. Murder : 0.051 <br>Coef. Intercept : 5.164","<b> bootstrap dataset:  245 <\/b> <br>Coef. Urban  : -0.056 <br>Coef. Murder : 0.05 <br>Coef. Intercept : 3.129","<b> bootstrap dataset:  246 <\/b> <br>Coef. Urban  : -0.039 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 2.204","<b> bootstrap dataset:  247 <\/b> <br>Coef. Urban  : -0.078 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 5.45","<b> bootstrap dataset:  248 <\/b> <br>Coef. Urban  : -0.055 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 3.069","<b> bootstrap dataset:  249 <\/b> <br>Coef. Urban  : -0.052 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 3.498","<b> bootstrap dataset:  250 <\/b> <br>Coef. Urban  : -0.077 <br>Coef. Murder : 0.054 <br>Coef. Intercept : 4.12","<b> bootstrap dataset:  251 <\/b> <br>Coef. Urban  : -0.054 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 4.197","<b> bootstrap dataset:  252 <\/b> <br>Coef. Urban  : -0.038 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 2.645","<b> bootstrap dataset:  253 <\/b> <br>Coef. Urban  : -0.019 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 2.937","<b> bootstrap dataset:  254 <\/b> <br>Coef. Urban  : -0.06 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 4.492","<b> bootstrap dataset:  255 <\/b> <br>Coef. Urban  : -0.058 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 3.075","<b> bootstrap dataset:  256 <\/b> <br>Coef. Urban  : -0.113 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 7.208","<b> bootstrap dataset:  257 <\/b> <br>Coef. Urban  : -0.087 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 6.069","<b> bootstrap dataset:  258 <\/b> <br>Coef. Urban  : -0.016 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 2.005","<b> bootstrap dataset:  259 <\/b> <br>Coef. Urban  : 0.006 <br>Coef. Murder : 0.038 <br>Coef. Intercept : 0.815","<b> bootstrap dataset:  260 <\/b> <br>Coef. Urban  : -0.068 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 3.898","<b> bootstrap dataset:  261 <\/b> <br>Coef. Urban  : -0.041 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 2.306","<b> bootstrap dataset:  262 <\/b> <br>Coef. Urban  : -0.041 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 2.932","<b> bootstrap dataset:  263 <\/b> <br>Coef. Urban  : -0.084 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 5.587","<b> bootstrap dataset:  264 <\/b> <br>Coef. Urban  : -0.057 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 3.591","<b> bootstrap dataset:  265 <\/b> <br>Coef. Urban  : -0.033 <br>Coef. Murder : 0.035 <br>Coef. Intercept : 3.129","<b> bootstrap dataset:  266 <\/b> <br>Coef. Urban  : -0.061 <br>Coef. Murder : 0.036 <br>Coef. Intercept : 5.726","<b> bootstrap dataset:  267 <\/b> <br>Coef. Urban  : -0.046 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 2.976","<b> bootstrap dataset:  268 <\/b> <br>Coef. Urban  : -0.042 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 3.063","<b> bootstrap dataset:  269 <\/b> <br>Coef. Urban  : -0.051 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 4.01","<b> bootstrap dataset:  270 <\/b> <br>Coef. Urban  : -0.022 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 2.007","<b> bootstrap dataset:  271 <\/b> <br>Coef. Urban  : -0.032 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 2.516","<b> bootstrap dataset:  272 <\/b> <br>Coef. Urban  : -0.082 <br>Coef. Murder : 0.05 <br>Coef. Intercept : 4.663","<b> bootstrap dataset:  273 <\/b> <br>Coef. Urban  : -0.051 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 4.102","<b> bootstrap dataset:  274 <\/b> <br>Coef. Urban  : -0.017 <br>Coef. Murder : 0.049 <br>Coef. Intercept : 0.95","<b> bootstrap dataset:  275 <\/b> <br>Coef. Urban  : -0.043 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 3.905","<b> bootstrap dataset:  276 <\/b> <br>Coef. Urban  : -0.05 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 3.258","<b> bootstrap dataset:  277 <\/b> <br>Coef. Urban  : -0.066 <br>Coef. Murder : 0.05 <br>Coef. Intercept : 3.864","<b> bootstrap dataset:  278 <\/b> <br>Coef. Urban  : -0.095 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 7.264","<b> bootstrap dataset:  279 <\/b> <br>Coef. Urban  : -0.036 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 2.703","<b> bootstrap dataset:  280 <\/b> <br>Coef. Urban  : -0.077 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 4.629","<b> bootstrap dataset:  281 <\/b> <br>Coef. Urban  : -0.077 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 4.991","<b> bootstrap dataset:  282 <\/b> <br>Coef. Urban  : -0.097 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 5.936","<b> bootstrap dataset:  283 <\/b> <br>Coef. Urban  : -0.044 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 3.441","<b> bootstrap dataset:  284 <\/b> <br>Coef. Urban  : -0.029 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 2.094","<b> bootstrap dataset:  285 <\/b> <br>Coef. Urban  : -0.084 <br>Coef. Murder : 0.049 <br>Coef. Intercept : 5.147","<b> bootstrap dataset:  286 <\/b> <br>Coef. Urban  : -0.107 <br>Coef. Murder : 0.05 <br>Coef. Intercept : 6.797","<b> bootstrap dataset:  287 <\/b> <br>Coef. Urban  : -0.013 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 1.704","<b> bootstrap dataset:  288 <\/b> <br>Coef. Urban  : -0.025 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 1.992","<b> bootstrap dataset:  289 <\/b> <br>Coef. Urban  : -0.026 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 1.865","<b> bootstrap dataset:  290 <\/b> <br>Coef. Urban  : -0.105 <br>Coef. Murder : 0.056 <br>Coef. Intercept : 4.823","<b> bootstrap dataset:  291 <\/b> <br>Coef. Urban  : -0.044 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 3.085","<b> bootstrap dataset:  292 <\/b> <br>Coef. Urban  : -0.068 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 4.904","<b> bootstrap dataset:  293 <\/b> <br>Coef. Urban  : -0.066 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 5.431","<b> bootstrap dataset:  294 <\/b> <br>Coef. Urban  : -0.01 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 1.697","<b> bootstrap dataset:  295 <\/b> <br>Coef. Urban  : -0.057 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 4.964","<b> bootstrap dataset:  296 <\/b> <br>Coef. Urban  : -0.015 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 1.65","<b> bootstrap dataset:  297 <\/b> <br>Coef. Urban  : -0.014 <br>Coef. Murder : 0.038 <br>Coef. Intercept : 2.436","<b> bootstrap dataset:  298 <\/b> <br>Coef. Urban  : -0.028 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 3.483","<b> bootstrap dataset:  299 <\/b> <br>Coef. Urban  : -0.072 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 6.006","<b> bootstrap dataset:  300 <\/b> <br>Coef. Urban  : -0.048 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 3.14","<b> bootstrap dataset:  301 <\/b> <br>Coef. Urban  : -0.071 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 5.21","<b> bootstrap dataset:  302 <\/b> <br>Coef. Urban  : -0.036 <br>Coef. Murder : 0.053 <br>Coef. Intercept : 1.465","<b> bootstrap dataset:  303 <\/b> <br>Coef. Urban  : -0.034 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 2.864","<b> bootstrap dataset:  304 <\/b> <br>Coef. Urban  : -0.007 <br>Coef. Murder : 0.037 <br>Coef. Intercept : 2.221","<b> bootstrap dataset:  305 <\/b> <br>Coef. Urban  : -0.029 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 1.918","<b> bootstrap dataset:  306 <\/b> <br>Coef. Urban  : -0.082 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 6.002","<b> bootstrap dataset:  307 <\/b> <br>Coef. Urban  : -0.026 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 2.314","<b> bootstrap dataset:  308 <\/b> <br>Coef. Urban  : -0.058 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 4.06","<b> bootstrap dataset:  309 <\/b> <br>Coef. Urban  : -0.117 <br>Coef. Murder : 0.049 <br>Coef. Intercept : 6.659","<b> bootstrap dataset:  310 <\/b> <br>Coef. Urban  : -0.067 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 4.422","<b> bootstrap dataset:  311 <\/b> <br>Coef. Urban  : -0.068 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 4.989","<b> bootstrap dataset:  312 <\/b> <br>Coef. Urban  : -0.008 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 1.027","<b> bootstrap dataset:  313 <\/b> <br>Coef. Urban  : -0.02 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 1.55","<b> bootstrap dataset:  314 <\/b> <br>Coef. Urban  : -0.056 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 4.691","<b> bootstrap dataset:  315 <\/b> <br>Coef. Urban  : -0.046 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 3.388","<b> bootstrap dataset:  316 <\/b> <br>Coef. Urban  : -0.018 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 2.185","<b> bootstrap dataset:  317 <\/b> <br>Coef. Urban  : -0.076 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 4.884","<b> bootstrap dataset:  318 <\/b> <br>Coef. Urban  : -0.009 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 1.343","<b> bootstrap dataset:  319 <\/b> <br>Coef. Urban  : -0.027 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 1.43","<b> bootstrap dataset:  320 <\/b> <br>Coef. Urban  : -0.061 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 4.515","<b> bootstrap dataset:  321 <\/b> <br>Coef. Urban  : -0.028 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 1.691","<b> bootstrap dataset:  322 <\/b> <br>Coef. Urban  : -0.11 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 7.425","<b> bootstrap dataset:  323 <\/b> <br>Coef. Urban  : -0.058 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 4.633","<b> bootstrap dataset:  324 <\/b> <br>Coef. Urban  : -0.036 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 2.911","<b> bootstrap dataset:  325 <\/b> <br>Coef. Urban  : -0.083 <br>Coef. Murder : 0.053 <br>Coef. Intercept : 4.439","<b> bootstrap dataset:  326 <\/b> <br>Coef. Urban  : -0.106 <br>Coef. Murder : 0.049 <br>Coef. Intercept : 6.21","<b> bootstrap dataset:  327 <\/b> <br>Coef. Urban  : -0.036 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 2.097","<b> bootstrap dataset:  328 <\/b> <br>Coef. Urban  : -0.055 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 4.394","<b> bootstrap dataset:  329 <\/b> <br>Coef. Urban  : -0.046 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 2.431","<b> bootstrap dataset:  330 <\/b> <br>Coef. Urban  : -0.07 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 4.34","<b> bootstrap dataset:  331 <\/b> <br>Coef. Urban  : -0.058 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 3.497","<b> bootstrap dataset:  332 <\/b> <br>Coef. Urban  : -0.04 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 2.553","<b> bootstrap dataset:  333 <\/b> <br>Coef. Urban  : -0.037 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 2.868","<b> bootstrap dataset:  334 <\/b> <br>Coef. Urban  : -0.03 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 2.015","<b> bootstrap dataset:  335 <\/b> <br>Coef. Urban  : -0.077 <br>Coef. Murder : 0.051 <br>Coef. Intercept : 3.787","<b> bootstrap dataset:  336 <\/b> <br>Coef. Urban  : -0.079 <br>Coef. Murder : 0.05 <br>Coef. Intercept : 4.572","<b> bootstrap dataset:  337 <\/b> <br>Coef. Urban  : -0.06 <br>Coef. Murder : 0.05 <br>Coef. Intercept : 3.489","<b> bootstrap dataset:  338 <\/b> <br>Coef. Urban  : -0.029 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 2.621","<b> bootstrap dataset:  339 <\/b> <br>Coef. Urban  : -0.085 <br>Coef. Murder : 0.057 <br>Coef. Intercept : 3.921","<b> bootstrap dataset:  340 <\/b> <br>Coef. Urban  : -0.065 <br>Coef. Murder : 0.053 <br>Coef. Intercept : 3.35","<b> bootstrap dataset:  341 <\/b> <br>Coef. Urban  : -0.088 <br>Coef. Murder : 0.049 <br>Coef. Intercept : 5.89","<b> bootstrap dataset:  342 <\/b> <br>Coef. Urban  : 0.01 <br>Coef. Murder : 0.036 <br>Coef. Intercept : 0.664","<b> bootstrap dataset:  343 <\/b> <br>Coef. Urban  : -0.056 <br>Coef. Murder : 0.051 <br>Coef. Intercept : 3.101","<b> bootstrap dataset:  344 <\/b> <br>Coef. Urban  : -0.025 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 2.054","<b> bootstrap dataset:  345 <\/b> <br>Coef. Urban  : -0.08 <br>Coef. Murder : 0.053 <br>Coef. Intercept : 4.278","<b> bootstrap dataset:  346 <\/b> <br>Coef. Urban  : -0.105 <br>Coef. Murder : 0.047 <br>Coef. Intercept : 6.985","<b> bootstrap dataset:  347 <\/b> <br>Coef. Urban  : -0.053 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 4.452","<b> bootstrap dataset:  348 <\/b> <br>Coef. Urban  : -0.033 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 1.914","<b> bootstrap dataset:  349 <\/b> <br>Coef. Urban  : -0.037 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 3.172","<b> bootstrap dataset:  350 <\/b> <br>Coef. Urban  : -0.041 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 3.26","<b> bootstrap dataset:  351 <\/b> <br>Coef. Urban  : -0.04 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 3.506","<b> bootstrap dataset:  352 <\/b> <br>Coef. Urban  : -0.016 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 1.615","<b> bootstrap dataset:  353 <\/b> <br>Coef. Urban  : -0.062 <br>Coef. Murder : 0.038 <br>Coef. Intercept : 5.316","<b> bootstrap dataset:  354 <\/b> <br>Coef. Urban  : -0.066 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 3.992","<b> bootstrap dataset:  355 <\/b> <br>Coef. Urban  : -0.063 <br>Coef. Murder : 0.058 <br>Coef. Intercept : 2.582","<b> bootstrap dataset:  356 <\/b> <br>Coef. Urban  : -0.031 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 2.161","<b> bootstrap dataset:  357 <\/b> <br>Coef. Urban  : -0.031 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 2.079","<b> bootstrap dataset:  358 <\/b> <br>Coef. Urban  : -0.038 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 4.06","<b> bootstrap dataset:  359 <\/b> <br>Coef. Urban  : -0.042 <br>Coef. Murder : 0.035 <br>Coef. Intercept : 4.323","<b> bootstrap dataset:  360 <\/b> <br>Coef. Urban  : -0.075 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 4.765","<b> bootstrap dataset:  361 <\/b> <br>Coef. Urban  : -0.03 <br>Coef. Murder : 0.038 <br>Coef. Intercept : 2.928","<b> bootstrap dataset:  362 <\/b> <br>Coef. Urban  : -0.034 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 3.375","<b> bootstrap dataset:  363 <\/b> <br>Coef. Urban  : -0.05 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 3.461","<b> bootstrap dataset:  364 <\/b> <br>Coef. Urban  : -0.051 <br>Coef. Murder : 0.049 <br>Coef. Intercept : 2.787","<b> bootstrap dataset:  365 <\/b> <br>Coef. Urban  : -0.031 <br>Coef. Murder : 0.038 <br>Coef. Intercept : 2.919","<b> bootstrap dataset:  366 <\/b> <br>Coef. Urban  : -0.052 <br>Coef. Murder : 0.037 <br>Coef. Intercept : 4.043","<b> bootstrap dataset:  367 <\/b> <br>Coef. Urban  : -0.059 <br>Coef. Murder : 0.045 <br>Coef. Intercept : 3.936","<b> bootstrap dataset:  368 <\/b> <br>Coef. Urban  : -0.05 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 3.912","<b> bootstrap dataset:  369 <\/b> <br>Coef. Urban  : -0.017 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 1.443","<b> bootstrap dataset:  370 <\/b> <br>Coef. Urban  : -0.051 <br>Coef. Murder : 0.041 <br>Coef. Intercept : 4.905","<b> bootstrap dataset:  371 <\/b> <br>Coef. Urban  : -0.033 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 2.779","<b> bootstrap dataset:  372 <\/b> <br>Coef. Urban  : -0.02 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 1.608","<b> bootstrap dataset:  373 <\/b> <br>Coef. Urban  : -0.095 <br>Coef. Murder : 0.053 <br>Coef. Intercept : 4.456","<b> bootstrap dataset:  374 <\/b> <br>Coef. Urban  : -0.047 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 4.09","<b> bootstrap dataset:  375 <\/b> <br>Coef. Urban  : -0.075 <br>Coef. Murder : 0.054 <br>Coef. Intercept : 3.576","<b> bootstrap dataset:  376 <\/b> <br>Coef. Urban  : -0.03 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 2.481","<b> bootstrap dataset:  377 <\/b> <br>Coef. Urban  : -0.029 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 2.641","<b> bootstrap dataset:  378 <\/b> <br>Coef. Urban  : -0.019 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 0.735","<b> bootstrap dataset:  379 <\/b> <br>Coef. Urban  : -0.057 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 4.171","<b> bootstrap dataset:  380 <\/b> <br>Coef. Urban  : -0.007 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 1.793","<b> bootstrap dataset:  381 <\/b> <br>Coef. Urban  : -0.029 <br>Coef. Murder : 0.038 <br>Coef. Intercept : 2.452","<b> bootstrap dataset:  382 <\/b> <br>Coef. Urban  : -0.03 <br>Coef. Murder : 0.049 <br>Coef. Intercept : 1.242","<b> bootstrap dataset:  383 <\/b> <br>Coef. Urban  : -0.023 <br>Coef. Murder : 0.039 <br>Coef. Intercept : 2.003","<b> bootstrap dataset:  384 <\/b> <br>Coef. Urban  : -0.028 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 3.065","<b> bootstrap dataset:  385 <\/b> <br>Coef. Urban  : -0.073 <br>Coef. Murder : 0.049 <br>Coef. Intercept : 4.685","<b> bootstrap dataset:  386 <\/b> <br>Coef. Urban  : -0.059 <br>Coef. Murder : 0.04 <br>Coef. Intercept : 5.102","<b> bootstrap dataset:  387 <\/b> <br>Coef. Urban  : -0.095 <br>Coef. Murder : 0.051 <br>Coef. Intercept : 5.128","<b> bootstrap dataset:  388 <\/b> <br>Coef. Urban  : -0.044 <br>Coef. Murder : 0.05 <br>Coef. Intercept : 2.609","<b> bootstrap dataset:  389 <\/b> <br>Coef. Urban  : -0.027 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 2.192","<b> bootstrap dataset:  390 <\/b> <br>Coef. Urban  : -0.024 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 2.045","<b> bootstrap dataset:  391 <\/b> <br>Coef. Urban  : -0.017 <br>Coef. Murder : 0.042 <br>Coef. Intercept : 1.607","<b> bootstrap dataset:  392 <\/b> <br>Coef. Urban  : -0.046 <br>Coef. Murder : 0.048 <br>Coef. Intercept : 3.146","<b> bootstrap dataset:  393 <\/b> <br>Coef. Urban  : -0.009 <br>Coef. Murder : 0.043 <br>Coef. Intercept : 0.674","<b> bootstrap dataset:  394 <\/b> <br>Coef. Urban  : -0.053 <br>Coef. Murder : 0.051 <br>Coef. Intercept : 3.681","<b> bootstrap dataset:  395 <\/b> <br>Coef. Urban  : -0.022 <br>Coef. Murder : 0.036 <br>Coef. Intercept : 3.071","<b> bootstrap dataset:  396 <\/b> <br>Coef. Urban  : -0.075 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 4.891","<b> bootstrap dataset:  397 <\/b> <br>Coef. Urban  : -0.063 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 4.361","<b> bootstrap dataset:  398 <\/b> <br>Coef. Urban  : -0.014 <br>Coef. Murder : 0.046 <br>Coef. Intercept : 1.25","<b> bootstrap dataset:  399 <\/b> <br>Coef. Urban  : -0.05 <br>Coef. Murder : 0.044 <br>Coef. Intercept : 3.556"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"showlegend":false,"marker":{"color":"rgba(0, 0, 0, 0.5)","line":{"color":"rgba(31,119,180,1)"}},"type":"scatter","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="hypothesis-tests" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="hypothesis-tests"><span class="header-section-number">15.4</span> Hypothesis Tests</h2>
<section id="f-statistic." class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="f-statistic."><strong>F-statistic</strong>.</h4>
<p>We can also use an <span class="math inline">\(F\)</span> test for any <span class="math inline">\(q\)</span> hypotheses. Specifically, when <span class="math inline">\(q\)</span> hypotheses <em>restrict</em> a model, the degrees of freedom drop from <span class="math inline">\(k_{u}\)</span> to <span class="math inline">\(k_{r}\)</span> and the residual sum of squares <span class="math inline">\(RSS=\sum_{i}(y_{i}-\widehat{y}_{i})^2\)</span> typically increases. We compute the statistic <span class="math display">\[
F_{q} = \frac{(RSS_{r}-RSS_{u})/(k_{u}-k_{r})}{RSS_{u}/(N-k_{u})}
\]</span></p>
<p>If you test whether all <span class="math inline">\(K\)</span> variables are significant, the restricted model is a simple intercept and <span class="math inline">\(RSS_{r}=TSS\)</span>, and <span class="math inline">\(F_{q}\)</span> can be written in terms of <span class="math inline">\(R^2\)</span>: <span class="math inline">\(F_{K} = \frac{R^2}{1-R^2} \frac{N-K}{K-1}\)</span>. The first fraction is the relative goodness of fit, and the second fraction is an adjustment for degrees of freedom (similar to how we adjusted the <span class="math inline">\(R^2\)</span> term before).</p>
<p>To conduct a hypothesis test, first compute a null distribution by randomly reshuffling the outcomes and recompute the <span class="math inline">\(F\)</span> statistic, and then compare how often random data give something as extreme as your initial statistic. For some intuition on this F test, examine how the adjusted <span class="math inline">\(R^2\)</span> statistic varies with bootstrap samples.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap under the null</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>boots <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">399</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>boot_regs0 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(boots, <span class="cf">function</span>(b){</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate bootstrap sample</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  xy_b <span class="ot">&lt;-</span> USArrests</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  b_id <span class="ot">&lt;-</span> <span class="fu">sample</span>( <span class="fu">nrow</span>(USArrests), <span class="at">replace=</span>T)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Impose the null</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  xy_b<span class="sc">$</span>Murder <span class="ot">&lt;-</span>  xy_b<span class="sc">$</span>Murder[b_id]</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run regression</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  reg_b <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder<span class="sc">~</span>Assault<span class="sc">+</span>UrbanPop, <span class="at">dat=</span>xy_b)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Get null distribution for adjusted R2</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>R2adj_sim0 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(boot_regs0, <span class="cf">function</span>(reg_k){</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(reg_k)<span class="sc">$</span>adj.r.squared })</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(R2adj_sim0, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">breaks=</span><span class="dv">25</span>, <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">''</span>, <span class="at">xlab=</span><span class="fu">expression</span>(<span class="st">'adj.'</span><span class="sc">~</span>R[b]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare to initial statistic</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">summary</span>(reg)<span class="sc">$</span>adj.r.squared, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03_01_IntermediateRegression_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note that <em>hypothesis testing is not to be done routinely</em>, as additional complications arise when testing multiple hypothesis sequentially.</p>
<p>Under some additional assumptions <span class="math inline">\(F_{q}\)</span> follows an F-distribution. For more about F-testing, see https://online.stat.psu.edu/stat501/lesson/6/6.2 and https://www.econometrics.blog/post/understanding-the-f-statistic/</p>
</section>
<section id="anova" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="anova"><strong>ANOVA</strong></h4>
<p>Under some additional parametric assumptions about the data generating process, the F-statistic follows an <span class="math inline">\(F\)</span> distribution. This case is well-studied historically, often under the title Analysis of Variance (ANOVA).</p>
<p>An important case corresponds to the restricted model having no explanatory variables (i.e., our model is <span class="math inline">\(Y_{i}=\overline{Y}\)</span>)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>reg_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder <span class="sc">~</span> Assault <span class="sc">+</span> UrbanPop <span class="sc">+</span> Rape, <span class="at">data =</span> USArrests)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>reg_none <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder <span class="sc">~</span> <span class="dv">1</span>, <span class="at">dat=</span>USArrests)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(reg_none, reg_full)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 1: Murder ~ 1</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 2: Murder ~ Assault + UrbanPop + Rape</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    </span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     49 929.55                                  </span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     46 304.83  3    624.72 31.424 3.322e-11 ***</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual F-test</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>rss0 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">resid</span>(reg_none)<span class="sc">^</span><span class="dv">2</span>) <span class="co"># restricted</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>rss1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">resid</span>(reg_full)<span class="sc">^</span><span class="dv">2</span>) <span class="co"># unrestricted</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>df0  <span class="ot">&lt;-</span> <span class="fu">df.residual</span>(reg_none)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>df1  <span class="ot">&lt;-</span> <span class="fu">df.residual</span>(reg_full)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>F    <span class="ot">&lt;-</span> ((rss0 <span class="sc">-</span> rss1)<span class="sc">/</span>(df0<span class="sc">-</span>df1)) <span class="sc">/</span> (rss1<span class="sc">/</span>df1) <span class="co"># observed F stat</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>p    <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pf</span>(F, df0<span class="sc">-</span>df1, df1) <span class="co"># where F falls in the F-distribution</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(F, p)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="do">##             F            p</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,] 31.42399 3.322431e-11</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Whether you take a parametric or nonparametric approach to hypothesis testing, you can easily test whether variables are additively separable with an <span class="math inline">\(F\)</span> test.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Empirical Example</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder<span class="sc">~</span>Assault<span class="sc">+</span>UrbanPop, USArrests)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder<span class="sc">~</span>Assault<span class="sc">*</span>UrbanPop, USArrests)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(reg1, reg2)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 1: Murder ~ Assault + UrbanPop</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 2: Murder ~ Assault * UrbanPop</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="do">##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     47 312.87                           </span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     46 300.93  1    11.944 1.8258 0.1832</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## # Simulation Example</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="do">## N &lt;- 1000</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="do">## x &lt;- runif(N,3,8)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="do">## e &lt;- rnorm(N,0,0.4)</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="do">## fo &lt;- factor(rbinom(N,4,.5), ordered=T)</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="do">## fu &lt;- factor(rep(c('A','B'),N/2), ordered=F)</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="do">## dA &lt;- 1*(fu=='A')</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="do">## y &lt;- (2^as.integer(fo)*dA )*sqrt(x)+ 2*as.integer(fo)*e</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="do">## dat_f &lt;- data.frame(y,x,fo,fu)</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="do">## reg0 &lt;- lm(y~-1+x+fo+fu, dat_f)</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="do">## reg1 &lt;- lm(y~-1+x+fo*fu, dat_f)</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="do">## reg2 &lt;- lm(y~-1+x*fo*fu, dat_f)</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="do">## anova(reg0, reg2)</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="do">## anova(reg0, reg1, reg2)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="further-reading" class="level2" data-number="15.5">
<h2 data-number="15.5" class="anchored" data-anchor-id="further-reading"><span class="header-section-number">15.5</span> Further Reading</h2>
<p>For OLS, see</p>
<ul>
<li><a href="https://bookdown.org/josiesmith/qrmbook/linear-estimation-and-minimizing-error.html" class="uri">https://bookdown.org/josiesmith/qrmbook/linear-estimation-and-minimizing-error.html</a></li>
<li><a href="https://www.econometrics-with-r.org/4-lrwor.html" class="uri">https://www.econometrics-with-r.org/4-lrwor.html</a></li>
<li><a href="https://www.econometrics-with-r.org/6-rmwmr.html" class="uri">https://www.econometrics-with-r.org/6-rmwmr.html</a></li>
<li><a href="https://www.econometrics-with-r.org/7-htaciimr.html" class="uri">https://www.econometrics-with-r.org/7-htaciimr.html</a></li>
<li><a href="https://bookdown.org/ripberjt/labbook/bivariate-linear-regression.html" class="uri">https://bookdown.org/ripberjt/labbook/bivariate-linear-regression.html</a></li>
<li><a href="https://bookdown.org/ripberjt/labbook/multivariable-linear-regression.html" class="uri">https://bookdown.org/ripberjt/labbook/multivariable-linear-regression.html</a></li>
<li><a href="https://online.stat.psu.edu/stat462/node/137/" class="uri">https://online.stat.psu.edu/stat462/node/137/</a></li>
<li><a href="https://book.stat420.org/" class="uri">https://book.stat420.org/</a></li>
<li>Hill, Griffiths &amp; Lim (2007), Principles of Econometrics, 3rd ed., Wiley, S. 86f.</li>
<li>Verbeek (2004), A Guide to Modern Econometrics, 2nd ed., Wiley, S. 51ff.</li>
<li>Asteriou &amp; Hall (2011), Applied Econometrics, 2nd ed., Palgrave MacMillan, S. 177ff.</li>
<li><a href="https://online.stat.psu.edu/stat485/lesson/11/" class="uri">https://online.stat.psu.edu/stat485/lesson/11/</a></li>
</ul>
<p>To derive OLS coefficients in Matrix form, see</p>
<ul>
<li><a href="https://jrnold.github.io/intro-methods-notes/ols-in-matrix-form.html" class="uri">https://jrnold.github.io/intro-methods-notes/ols-in-matrix-form.html</a></li>
<li><a href="https://www.fsb.miamioh.edu/lij14/411_note_matrix.pdf" class="uri">https://www.fsb.miamioh.edu/lij14/411_note_matrix.pdf</a></li>
<li><a href="https://web.stanford.edu/~mrosenfe/soc_meth_proj3/matrix_OLS_NYU_notes.pdf" class="uri">https://web.stanford.edu/~mrosenfe/soc_meth_proj3/matrix_OLS_NYU_notes.pdf</a></li>
</ul>
<p>For fixed effects, see</p>
<ul>
<li><a href="https://www.econometrics-with-r.org/10-rwpd.html" class="uri">https://www.econometrics-with-r.org/10-rwpd.html</a></li>
<li><a href="https://bookdown.org/josiesmith/qrmbook/topics-in-multiple-regression.html" class="uri">https://bookdown.org/josiesmith/qrmbook/topics-in-multiple-regression.html</a></li>
<li><a href="https://bookdown.org/ripberjt/labbook/multivariable-linear-regression.html" class="uri">https://bookdown.org/ripberjt/labbook/multivariable-linear-regression.html</a></li>
<li><a href="https://www.princeton.edu/~otorres/Panel101.pdf" class="uri">https://www.princeton.edu/~otorres/Panel101.pdf</a></li>
<li><a href="https://www.stata.com/manuals13/xtxtreg.pdf" class="uri">https://www.stata.com/manuals13/xtxtreg.pdf</a></li>
</ul>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>There are also <em>random effects</em>: the factor variable comes from a distribution that is uncorrelated with the regressors. This is rarely used in economics today, however, and are mostly included for historical reasons and special cases where fixed effects cannot be estimated due to data limitations.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/jadamso\.github\.io\/Rbooks\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-00-MultivariateData.html" class="pagination-link" aria-label="Multivariate Data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Multivariate Data</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03_02_InterprettingRegression.html" class="pagination-link" aria-label="Multivariate Data II">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Multivariate Data II</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>