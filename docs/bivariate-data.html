<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 9 Bivariate Data | Introductory Economic Statistics: Data-Driven Analysis in R</title>
  <meta name="description" content=" 9 Bivariate Data | Introductory Economic Statistics: Data-Driven Analysis in R" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content=" 9 Bivariate Data | Introductory Economic Statistics: Data-Driven Analysis in R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 9 Bivariate Data | Introductory Economic Statistics: Data-Driven Analysis in R" />
  
  
  

<meta name="author" content="Jordan Adamson" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-analysis.html"/>
<link rel="next" href="basic-regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.11.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="libs/core-js-2.5.3/shim.min.js"></script>
<script src="libs/react-18.2.0/react.min.js"></script>
<script src="libs/react-18.2.0/react-dom.min.js"></script>
<script src="libs/reactwidget-2.0.0/react-tools.js"></script>
<link href="libs/reactable-0.4.4/reactable.css" rel="stylesheet" />
<script src="libs/reactable-binding-0.4.4/reactable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li> </li>
<li class="divider"></li>
<li><a href="index.html#index" id="toc-index"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Introduction to Data Analysis</b></span></li>
<li class="chapter" data-level="1" data-path="first-steps.html"><a href="first-steps.html"><i class="fa fa-check"></i><b>1</b> First Steps</a>
<ul>
<li class="chapter" data-level="1.1" data-path="first-steps.html"><a href="first-steps.html#why-program-in-r"><i class="fa fa-check"></i><b>1.1</b> Why Program in R?</a></li>
<li class="chapter" data-level="1.2" data-path="first-steps.html"><a href="first-steps.html#first-steps-1"><i class="fa fa-check"></i><b>1.2</b> First Steps</a></li>
<li class="chapter" data-level="1.3" data-path="first-steps.html"><a href="first-steps.html#further-reading"><i class="fa fa-check"></i><b>1.3</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>2</b> Mathematics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="mathematics.html"><a href="mathematics.html#objects"><i class="fa fa-check"></i><b>2.1</b> Objects</a></li>
<li class="chapter" data-level="2.2" data-path="mathematics.html"><a href="mathematics.html#functions"><i class="fa fa-check"></i><b>2.2</b> Functions</a></li>
<li class="chapter" data-level="2.3" data-path="mathematics.html"><a href="mathematics.html#arrays"><i class="fa fa-check"></i><b>2.3</b> Arrays</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#types"><i class="fa fa-check"></i><b>3.1</b> Types</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#densities-and-distributions"><i class="fa fa-check"></i><b>3.2</b> Densities and Distributions</a></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#joint-distributions"><i class="fa fa-check"></i><b>3.3</b> Joint Distributions</a></li>
<li class="chapter" data-level="3.4" data-path="data.html"><a href="data.html#conditional-distributions"><i class="fa fa-check"></i><b>3.4</b> Conditional Distributions</a></li>
<li class="chapter" data-level="3.5" data-path="data.html"><a href="data.html#further-reading-1"><i class="fa fa-check"></i><b>3.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="random-variables.html"><a href="random-variables.html"><i class="fa fa-check"></i><b>4</b> Random Variables</a>
<ul>
<li class="chapter" data-level="4.1" data-path="random-variables.html"><a href="random-variables.html#discrete"><i class="fa fa-check"></i><b>4.1</b> Discrete</a></li>
<li class="chapter" data-level="4.2" data-path="random-variables.html"><a href="random-variables.html#continuous"><i class="fa fa-check"></i><b>4.2</b> Continuous</a></li>
<li class="chapter" data-level="4.3" data-path="random-variables.html"><a href="random-variables.html#drawing-samples"><i class="fa fa-check"></i><b>4.3</b> Drawing Samples</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>5</b> Statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="statistics.html"><a href="statistics.html#mean-and-variance"><i class="fa fa-check"></i><b>5.1</b> Mean and Variance</a></li>
<li class="chapter" data-level="5.2" data-path="statistics.html"><a href="statistics.html#other-centerspread-statistics"><i class="fa fa-check"></i><b>5.2</b> Other Center/Spread Statistics</a></li>
<li class="chapter" data-level="5.3" data-path="statistics.html"><a href="statistics.html#shape-statistics"><i class="fa fa-check"></i><b>5.3</b> Shape Statistics</a></li>
<li class="chapter" data-level="5.4" data-path="statistics.html"><a href="statistics.html#probability-theory"><i class="fa fa-check"></i><b>5.4</b> Probability Theory</a></li>
<li class="chapter" data-level="5.5" data-path="statistics.html"><a href="statistics.html#further-reading-2"><i class="fa fa-check"></i><b>5.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="resampling.html"><a href="resampling.html"><i class="fa fa-check"></i><b>6</b> (Re)Sampling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="resampling.html"><a href="resampling.html#sample-distributions"><i class="fa fa-check"></i><b>6.1</b> Sample Distributions</a></li>
<li class="chapter" data-level="6.2" data-path="resampling.html"><a href="resampling.html#intervals"><i class="fa fa-check"></i><b>6.2</b> Intervals</a></li>
<li class="chapter" data-level="6.3" data-path="resampling.html"><a href="resampling.html#resampling-1"><i class="fa fa-check"></i><b>6.3</b> Resampling</a></li>
<li class="chapter" data-level="6.4" data-path="resampling.html"><a href="resampling.html#further-reading-3"><i class="fa fa-check"></i><b>6.4</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html"><i class="fa fa-check"></i><b>7</b> Hypothesis Tests</a>
<ul>
<li class="chapter" data-level="7.1" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#basic-ideas"><i class="fa fa-check"></i><b>7.1</b> Basic Ideas</a></li>
<li class="chapter" data-level="7.2" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#default-statistics"><i class="fa fa-check"></i><b>7.2</b> Default Statistics</a></li>
<li class="chapter" data-level="7.3" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#two-sample-differences"><i class="fa fa-check"></i><b>7.3</b> Two-Sample Differences</a></li>
<li class="chapter" data-level="7.4" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#further-reading-4"><i class="fa fa-check"></i><b>7.4</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>8</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-analysis.html"><a href="data-analysis.html#beyond-basics"><i class="fa fa-check"></i><b>8.1</b> Beyond Basics</a></li>
<li class="chapter" data-level="8.2" data-path="data-analysis.html"><a href="data-analysis.html#inputs"><i class="fa fa-check"></i><b>8.2</b> Inputs</a></li>
<li class="chapter" data-level="8.3" data-path="data-analysis.html"><a href="data-analysis.html#outputs"><i class="fa fa-check"></i><b>8.3</b> Outputs</a></li>
<li class="chapter" data-level="8.4" data-path="data-analysis.html"><a href="data-analysis.html#r-markdown-reports"><i class="fa fa-check"></i><b>8.4</b> R-Markdown Reports</a></li>
<li class="chapter" data-level="8.5" data-path="data-analysis.html"><a href="data-analysis.html#further-reading-5"><i class="fa fa-check"></i><b>8.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bivariate-data.html"><a href="bivariate-data.html"><i class="fa fa-check"></i><b>9</b> Bivariate Data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="bivariate-data.html"><a href="bivariate-data.html#statistics-1"><i class="fa fa-check"></i><b>9.1</b> Statistics</a></li>
<li class="chapter" data-level="9.2" data-path="bivariate-data.html"><a href="bivariate-data.html#probability-theory-1"><i class="fa fa-check"></i><b>9.2</b> Probability Theory</a></li>
<li class="chapter" data-level="9.3" data-path="bivariate-data.html"><a href="bivariate-data.html#further-reading-6"><i class="fa fa-check"></i><b>9.3</b> Further Reading</a></li>
</ul></li>
<li class="part"><span><b>II Introduction to Linear Regression</b></span></li>
<li class="chapter" data-level="10" data-path="basic-regression.html"><a href="basic-regression.html"><i class="fa fa-check"></i><b>10</b> Basic Regression</a>
<ul>
<li class="chapter" data-level="10.1" data-path="basic-regression.html"><a href="basic-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>10.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="10.2" data-path="basic-regression.html"><a href="basic-regression.html#variability-estimates"><i class="fa fa-check"></i><b>10.2</b> Variability Estimates</a></li>
<li class="chapter" data-level="10.3" data-path="basic-regression.html"><a href="basic-regression.html#hypothesis-tests-1"><i class="fa fa-check"></i><b>10.3</b> Hypothesis Tests</a></li>
<li class="chapter" data-level="10.4" data-path="basic-regression.html"><a href="basic-regression.html#local-linear-regression"><i class="fa fa-check"></i><b>10.4</b> Local Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="intermediate-regression.html"><a href="intermediate-regression.html"><i class="fa fa-check"></i><b>11</b> Intermediate Regression</a>
<ul>
<li class="chapter" data-level="11.1" data-path="intermediate-regression.html"><a href="intermediate-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>11.1</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="11.2" data-path="intermediate-regression.html"><a href="intermediate-regression.html#factor-variables"><i class="fa fa-check"></i><b>11.2</b> Factor Variables</a></li>
<li class="chapter" data-level="11.3" data-path="intermediate-regression.html"><a href="intermediate-regression.html#variability-estimates-1"><i class="fa fa-check"></i><b>11.3</b> Variability Estimates</a></li>
<li class="chapter" data-level="11.4" data-path="intermediate-regression.html"><a href="intermediate-regression.html#hypothesis-tests-2"><i class="fa fa-check"></i><b>11.4</b> Hypothesis Tests</a></li>
<li class="chapter" data-level="11.5" data-path="intermediate-regression.html"><a href="intermediate-regression.html#further-reading-7"><i class="fa fa-check"></i><b>11.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html"><i class="fa fa-check"></i><b>12</b> Intermediate Regression II</a>
<ul>
<li class="chapter" data-level="12.1" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html#coefficient-interpretation"><i class="fa fa-check"></i><b>12.1</b> Coefficient Interpretation</a></li>
<li class="chapter" data-level="12.2" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html#diagnostics"><i class="fa fa-check"></i><b>12.2</b> Diagnostics</a></li>
<li class="chapter" data-level="12.3" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html#transformations"><i class="fa fa-check"></i><b>12.3</b> Transformations</a></li>
<li class="chapter" data-level="12.4" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html#regressograms"><i class="fa fa-check"></i><b>12.4</b> Regressograms</a></li>
<li class="chapter" data-level="12.5" data-path="intermediate-regression-ii.html"><a href="intermediate-regression-ii.html#more-literature"><i class="fa fa-check"></i><b>12.5</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="observational-data.html"><a href="observational-data.html"><i class="fa fa-check"></i><b>13</b> Observational Data</a>
<ul>
<li class="chapter" data-level="13.1" data-path="observational-data.html"><a href="observational-data.html#temporal-interdependence"><i class="fa fa-check"></i><b>13.1</b> Temporal Interdependence</a></li>
<li class="chapter" data-level="13.2" data-path="observational-data.html"><a href="observational-data.html#spatial-interdependence"><i class="fa fa-check"></i><b>13.2</b> Spatial Interdependence</a></li>
<li class="chapter" data-level="13.3" data-path="observational-data.html"><a href="observational-data.html#variable-interdependence"><i class="fa fa-check"></i><b>13.3</b> Variable Interdependence</a></li>
<li class="chapter" data-level="13.4" data-path="observational-data.html"><a href="observational-data.html#further-reading-8"><i class="fa fa-check"></i><b>13.4</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="experimental-data.html"><a href="experimental-data.html"><i class="fa fa-check"></i><b>14</b> Experimental Data</a>
<ul>
<li class="chapter" data-level="14.1" data-path="experimental-data.html"><a href="experimental-data.html#design-basics"><i class="fa fa-check"></i><b>14.1</b> Design Basics</a></li>
<li class="chapter" data-level="14.2" data-path="experimental-data.html"><a href="experimental-data.html#comparisons-over-time"><i class="fa fa-check"></i><b>14.2</b> Comparisons Over Time</a></li>
<li class="chapter" data-level="14.3" data-path="experimental-data.html"><a href="experimental-data.html#natural-experiments"><i class="fa fa-check"></i><b>14.3</b> “Natural” Experiments</a></li>
<li class="chapter" data-level="14.4" data-path="experimental-data.html"><a href="experimental-data.html#further-reading-9"><i class="fa fa-check"></i><b>14.4</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="data-scientism.html"><a href="data-scientism.html"><i class="fa fa-check"></i><b>15</b> Data Scientism</a>
<ul>
<li class="chapter" data-level="15.1" data-path="data-scientism.html"><a href="data-scientism.html#false-positives"><i class="fa fa-check"></i><b>15.1</b> False Positives</a></li>
<li class="chapter" data-level="15.2" data-path="data-scientism.html"><a href="data-scientism.html#spurious-regression"><i class="fa fa-check"></i><b>15.2</b> Spurious Regression</a></li>
<li class="chapter" data-level="15.3" data-path="data-scientism.html"><a href="data-scientism.html#spurious-causal-impacts"><i class="fa fa-check"></i><b>15.3</b> Spurious Causal Impacts</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="misc.-topics.html"><a href="misc.-topics.html"><i class="fa fa-check"></i><b>16</b> Misc. Topics</a>
<ul>
<li class="chapter" data-level="16.1" data-path="misc.-topics.html"><a href="misc.-topics.html#locally-linear-multiple-regression"><i class="fa fa-check"></i><b>16.1</b> Locally Linear Multiple Regression</a></li>
<li class="chapter" data-level="16.2" data-path="misc.-topics.html"><a href="misc.-topics.html#nonparametric-tests"><i class="fa fa-check"></i><b>16.2</b> Nonparametric Tests</a></li>
<li class="chapter" data-level="16.3" data-path="misc.-topics.html"><a href="misc.-topics.html#prediction"><i class="fa fa-check"></i><b>16.3</b> Prediction</a></li>
<li class="chapter" data-level="16.4" data-path="misc.-topics.html"><a href="misc.-topics.html#decision-theory"><i class="fa fa-check"></i><b>16.4</b> Decision Theory</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://sites.google.com/view/jordan-adamson" target="blank">Jordan Adamson</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introductory Economic Statistics: Data-Driven Analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bivariate-data" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number"> 9</span> Bivariate Data<a href="bivariate-data.html#bivariate-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="statistics-1" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Statistics<a href="bivariate-data.html#statistics-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are several ways to quantitatively describe the relationship between two variables, <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>. The major differences surround whether the variables are cardinal, ordinal, or categorical.</p>
<div id="correlation." class="section level4 unnumbered hasAnchor">
<h4><strong>Correlation</strong>.<a href="bivariate-data.html#correlation." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Pearson (Linear) Correlation</strong>.
Suppose <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are both cardinal data. As such, you can compute the most famous measure of association, the covariance:
<span class="math display">\[
C_{XY} =  \sum_{i} [X_i - \overline{X}] [Y_i - \overline{Y}] / N
\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="bivariate-data.html#cb150-1" tabindex="-1"></a><span class="co"># Bivariate Data from USArrests</span></span>
<span id="cb150-2"><a href="bivariate-data.html#cb150-2" tabindex="-1"></a>xy <span class="ot">&lt;-</span> USArrests[,<span class="fu">c</span>(<span class="st">&#39;Murder&#39;</span>,<span class="st">&#39;UrbanPop&#39;</span>)]</span>
<span id="cb150-3"><a href="bivariate-data.html#cb150-3" tabindex="-1"></a><span class="co">#plot(xy, pch=16, col=grey(0,.25))</span></span>
<span id="cb150-4"><a href="bivariate-data.html#cb150-4" tabindex="-1"></a><span class="fu">cov</span>(xy)</span>
<span id="cb150-5"><a href="bivariate-data.html#cb150-5" tabindex="-1"></a><span class="do">##             Murder   UrbanPop</span></span>
<span id="cb150-6"><a href="bivariate-data.html#cb150-6" tabindex="-1"></a><span class="do">## Murder   18.970465   4.386204</span></span>
<span id="cb150-7"><a href="bivariate-data.html#cb150-7" tabindex="-1"></a><span class="do">## UrbanPop  4.386204 209.518776</span></span></code></pre></div>
</details>
<p>Note that <span class="math inline">\(C_{XX}=V_{X}\)</span>.
For ease of interpretation, we rescale this statistic to always lay between <span class="math inline">\(-1\)</span> and <span class="math inline">\(1\)</span>
<span class="math display">\[
r_{XY} = \frac{ C_{XY} }{ \sqrt{V_X} \sqrt{V_Y}}
\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="bivariate-data.html#cb151-1" tabindex="-1"></a><span class="fu">cor</span>(xy)[<span class="dv">2</span>]</span>
<span id="cb151-2"><a href="bivariate-data.html#cb151-2" tabindex="-1"></a><span class="do">## [1] 0.06957262</span></span></code></pre></div>
</details>
<p><strong>Falk Codeviance</strong>.
The Codeviance is a robust alternative to Covariance. Instead of relying on means (which can be sensitive to outliers), it uses medians (<span class="math inline">\(\tilde{X}\)</span>) to capture the central tendency.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> We can also scale the Codeviance by the median absolute deviation to compute the median correlation.
<span class="math display">\[
\text{CoDev}(X,Y) = \text{Med}\left\{ |X_i - \tilde{X}| |Y_i - \tilde{Y}| \right\} \\
\tilde{r}_{XY} = \frac{ \text{CoDev}(X,Y) }{ \text{MAD}(X) \text{MAD}(Y) }.
\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="bivariate-data.html#cb152-1" tabindex="-1"></a>cor_m <span class="ot">&lt;-</span> <span class="cf">function</span>(xy) {</span>
<span id="cb152-2"><a href="bivariate-data.html#cb152-2" tabindex="-1"></a>  <span class="co"># Compute medians for each column</span></span>
<span id="cb152-3"><a href="bivariate-data.html#cb152-3" tabindex="-1"></a>  med <span class="ot">&lt;-</span> <span class="fu">apply</span>(xy, <span class="dv">2</span>, median)</span>
<span id="cb152-4"><a href="bivariate-data.html#cb152-4" tabindex="-1"></a>  <span class="co"># Subtract the medians from each column</span></span>
<span id="cb152-5"><a href="bivariate-data.html#cb152-5" tabindex="-1"></a>  xm <span class="ot">&lt;-</span> <span class="fu">sweep</span>(xy, <span class="dv">2</span>, med, <span class="st">&quot;-&quot;</span>)</span>
<span id="cb152-6"><a href="bivariate-data.html#cb152-6" tabindex="-1"></a>  <span class="co"># Compute CoDev</span></span>
<span id="cb152-7"><a href="bivariate-data.html#cb152-7" tabindex="-1"></a>  CoDev <span class="ot">&lt;-</span> <span class="fu">median</span>(xm[, <span class="dv">1</span>] <span class="sc">*</span> xm[, <span class="dv">2</span>])</span>
<span id="cb152-8"><a href="bivariate-data.html#cb152-8" tabindex="-1"></a>  <span class="co"># Compute the medians of absolute deviation</span></span>
<span id="cb152-9"><a href="bivariate-data.html#cb152-9" tabindex="-1"></a>  MadProd <span class="ot">&lt;-</span> <span class="fu">prod</span>( <span class="fu">apply</span>(<span class="fu">abs</span>(xm), <span class="dv">2</span>, median) )</span>
<span id="cb152-10"><a href="bivariate-data.html#cb152-10" tabindex="-1"></a>  <span class="co"># Return the robust correlation measure</span></span>
<span id="cb152-11"><a href="bivariate-data.html#cb152-11" tabindex="-1"></a>  <span class="fu">return</span>( CoDev <span class="sc">/</span> MadProd)</span>
<span id="cb152-12"><a href="bivariate-data.html#cb152-12" tabindex="-1"></a>}</span>
<span id="cb152-13"><a href="bivariate-data.html#cb152-13" tabindex="-1"></a><span class="fu">cor_m</span>(xy)</span>
<span id="cb152-14"><a href="bivariate-data.html#cb152-14" tabindex="-1"></a><span class="do">## [1] 0.005707763</span></span></code></pre></div>
</details>
</div>
<div id="kendalls-tau." class="section level4 unnumbered hasAnchor">
<h4><strong>Kendall’s Tau</strong>.<a href="bivariate-data.html#kendalls-tau." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suppose <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are both <em>ordered</em> variables. Kendall’s Tau measures the strength and direction of association by counting the number of concordant pairs (where the ranks agree) versus discordant pairs (where the ranks disagree). A value of <span class="math inline">\(\tau = 1\)</span> implies perfect agreement in rankings, <span class="math inline">\(\tau = -1\)</span> indicates perfect disagreement, and <span class="math inline">\(\tau = 0\)</span> suggests no association in the ordering.
<span class="math display">\[
\tau = \frac{2}{n(n-1)} \sum_{i} \sum_{j &gt; i} \text{sgn} \Bigl( (X_i - X_j)(Y_i - Y_j) \Bigr),
\]</span>
where the sign function is:
<span class="math display">\[
\text{sgn}(z) =
\begin{cases}
+1 &amp; \text{if } z &gt; 0\\
0  &amp; \text{if } z = 0 \\
-1 &amp; \text{if} z &lt; 0
\end{cases}.
\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="bivariate-data.html#cb153-1" tabindex="-1"></a>xy <span class="ot">&lt;-</span> USArrests[,<span class="fu">c</span>(<span class="st">&#39;Murder&#39;</span>,<span class="st">&#39;UrbanPop&#39;</span>)]</span>
<span id="cb153-2"><a href="bivariate-data.html#cb153-2" tabindex="-1"></a>xy[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rank</span>(xy[,<span class="dv">1</span>] )</span>
<span id="cb153-3"><a href="bivariate-data.html#cb153-3" tabindex="-1"></a>xy[,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rank</span>(xy[,<span class="dv">2</span>] )</span>
<span id="cb153-4"><a href="bivariate-data.html#cb153-4" tabindex="-1"></a><span class="co"># plot(xy, pch=16, col=grey(0,.25))</span></span>
<span id="cb153-5"><a href="bivariate-data.html#cb153-5" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="fu">cor</span>(xy[, <span class="dv">1</span>], xy[, <span class="dv">2</span>], <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb153-6"><a href="bivariate-data.html#cb153-6" tabindex="-1"></a><span class="fu">round</span>(tau, <span class="dv">3</span>)</span>
<span id="cb153-7"><a href="bivariate-data.html#cb153-7" tabindex="-1"></a><span class="do">## [1] 0.074</span></span></code></pre></div>
</details>
</div>
<div id="cramers-v." class="section level4 unnumbered hasAnchor">
<h4><strong>Cramer’s V</strong>.<a href="bivariate-data.html#cramers-v." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suppose <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are both <em>categorical</em> variables; the value of <span class="math inline">\(X\)</span> is one of <span class="math inline">\(1...r\)</span> categories and the value of <span class="math inline">\(Y\)</span> is one of <span class="math inline">\(1...k\)</span> categories. Cramer’s V quantifies the strength of association by adjusting a “chi-squared” statistic to provide a measure that ranges from 0 to 1; 0 indicates no association while a value closer to 1 signifies a strong association.</p>
<p>First, consider a contingency table for <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> with <span class="math inline">\(r\)</span> rows and <span class="math inline">\(k\)</span> columns. The chi-square statistic is then defined as:</p>
<p><span class="math display">\[
\chi^2 = \sum_{i=1}^{r} \sum_{j=1}^{k} \frac{(O_{ij} - E_{ij})^2}{E_{ij}}.
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(O_{ij}\)</span> denote the observed frequency in cell <span class="math inline">\((i, j)\)</span>,</li>
<li><span class="math inline">\(E_{ij} = \frac{R_i \cdot C_j}{n}\)</span> is the expected frequency for each cell if <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent</li>
<li><span class="math inline">\(R_i\)</span> denote the total frequency for row <span class="math inline">\(i\)</span> (i.e., <span class="math inline">\(R_i = \sum_{j=1}^{k} O_{ij}\)</span>),</li>
<li><span class="math inline">\(C_j\)</span> denote the total frequency for column <span class="math inline">\(j\)</span> (i.e., <span class="math inline">\(C_j = \sum_{i=1}^{r} O_{ij}\)</span>),</li>
<li><span class="math inline">\(n\)</span> be the grand total of observations, so that <span class="math inline">\(n = \sum_{i=1}^{r} \sum_{j=1}^{k} O_{ij}\)</span>.</li>
</ul>
<p>Second, normalize the chi-square statistic with the sample size and the degrees of freedom to compute Cramer’s V.</p>
<p><span class="math display">\[
V = \sqrt{\frac{\chi^2 / n}{\min(k - 1, \, r - 1)}},
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(n\)</span> is the total sample size,</li>
<li><span class="math inline">\(k\)</span> is the number of categories for one variable,</li>
<li><span class="math inline">\(r\)</span> is the number of categories for the other variable.</li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="bivariate-data.html#cb154-1" tabindex="-1"></a>xy <span class="ot">&lt;-</span> USArrests[,<span class="fu">c</span>(<span class="st">&#39;Murder&#39;</span>,<span class="st">&#39;UrbanPop&#39;</span>)]</span>
<span id="cb154-2"><a href="bivariate-data.html#cb154-2" tabindex="-1"></a>xy[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cut</span>(xy[,<span class="dv">1</span>],<span class="dv">3</span>)</span>
<span id="cb154-3"><a href="bivariate-data.html#cb154-3" tabindex="-1"></a>xy[,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">cut</span>(xy[,<span class="dv">2</span>],<span class="dv">4</span>)</span>
<span id="cb154-4"><a href="bivariate-data.html#cb154-4" tabindex="-1"></a><span class="fu">table</span>(xy)</span>
<span id="cb154-5"><a href="bivariate-data.html#cb154-5" tabindex="-1"></a><span class="do">##               UrbanPop</span></span>
<span id="cb154-6"><a href="bivariate-data.html#cb154-6" tabindex="-1"></a><span class="do">## Murder         (31.9,46.8] (46.8,61.5] (61.5,76.2] (76.2,91.1]</span></span>
<span id="cb154-7"><a href="bivariate-data.html#cb154-7" tabindex="-1"></a><span class="do">##   (0.783,6.33]           4           5           8           5</span></span>
<span id="cb154-8"><a href="bivariate-data.html#cb154-8" tabindex="-1"></a><span class="do">##   (6.33,11.9]            0           4           7           6</span></span>
<span id="cb154-9"><a href="bivariate-data.html#cb154-9" tabindex="-1"></a><span class="do">##   (11.9,17.4]            2           4           2           3</span></span>
<span id="cb154-10"><a href="bivariate-data.html#cb154-10" tabindex="-1"></a></span>
<span id="cb154-11"><a href="bivariate-data.html#cb154-11" tabindex="-1"></a>cor_v <span class="ot">&lt;-</span> <span class="cf">function</span>(xy){</span>
<span id="cb154-12"><a href="bivariate-data.html#cb154-12" tabindex="-1"></a>    <span class="co"># Create a contingency table from the categorical variables</span></span>
<span id="cb154-13"><a href="bivariate-data.html#cb154-13" tabindex="-1"></a>    tbl <span class="ot">&lt;-</span> <span class="fu">table</span>(xy)</span>
<span id="cb154-14"><a href="bivariate-data.html#cb154-14" tabindex="-1"></a>    <span class="co"># Compute the chi-square statistic (without Yates&#39; continuity correction)</span></span>
<span id="cb154-15"><a href="bivariate-data.html#cb154-15" tabindex="-1"></a>    chi2 <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(tbl, <span class="at">correct=</span><span class="cn">FALSE</span>)<span class="sc">$</span>statistic</span>
<span id="cb154-16"><a href="bivariate-data.html#cb154-16" tabindex="-1"></a>    <span class="co"># Total sample size</span></span>
<span id="cb154-17"><a href="bivariate-data.html#cb154-17" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">sum</span>(tbl)</span>
<span id="cb154-18"><a href="bivariate-data.html#cb154-18" tabindex="-1"></a>    <span class="co"># Compute the minimum degrees of freedom (min(rows-1, columns-1))</span></span>
<span id="cb154-19"><a href="bivariate-data.html#cb154-19" tabindex="-1"></a>    df_min <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">nrow</span>(tbl) <span class="sc">-</span> <span class="dv">1</span>, <span class="fu">ncol</span>(tbl) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb154-20"><a href="bivariate-data.html#cb154-20" tabindex="-1"></a>    <span class="co"># Calculate Cramer&#39;s V</span></span>
<span id="cb154-21"><a href="bivariate-data.html#cb154-21" tabindex="-1"></a>    V <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((chi2 <span class="sc">/</span> n) <span class="sc">/</span> df_min)</span>
<span id="cb154-22"><a href="bivariate-data.html#cb154-22" tabindex="-1"></a>    <span class="fu">return</span>(V)</span>
<span id="cb154-23"><a href="bivariate-data.html#cb154-23" tabindex="-1"></a>}</span>
<span id="cb154-24"><a href="bivariate-data.html#cb154-24" tabindex="-1"></a><span class="fu">cor_v</span>(xy)</span>
<span id="cb154-25"><a href="bivariate-data.html#cb154-25" tabindex="-1"></a><span class="do">## X-squared </span></span>
<span id="cb154-26"><a href="bivariate-data.html#cb154-26" tabindex="-1"></a><span class="do">## 0.2307071</span></span>
<span id="cb154-27"><a href="bivariate-data.html#cb154-27" tabindex="-1"></a></span>
<span id="cb154-28"><a href="bivariate-data.html#cb154-28" tabindex="-1"></a><span class="co"># DescTools::CramerV( table(xy) )</span></span></code></pre></div>
</details>
</div>
</div>
<div id="probability-theory-1" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Probability Theory<a href="bivariate-data.html#probability-theory-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose we have two discrete variables <span class="math inline">\(X_{1}\)</span> and <span class="math inline">\(X_{2}\)</span>.</p>
<p>Their <strong>joint distribution</strong> is denoted as
<span class="math display">\[\begin{eqnarray}
Prob(X_{1} = x_{1}, X_{2} = x_{2})
\end{eqnarray}\]</span>
The <strong>conditional distributions</strong> are defined as
<span class="math display">\[\begin{eqnarray}
Prob(X_{1} = x_{1} | X_{2} = x_{2}) = \frac{ Prob(X_{1} = x_{1}, X_{2} = x_{2})}{ Prob( X_{2} = x_{2} )}\\
Prob(X_{2} = x_{2} | X_{1} = x_{1}) = \frac{ Prob(X_{1} = x_{1}, X_{2} = x_{2})}{ Prob( X_{1} = x_{1} )}
\end{eqnarray}\]</span>
The <strong>marginal distributions</strong> are then defined as
<span class="math display">\[\begin{eqnarray}
Prob(X_{1} = x_{1}) = \sum_{x_{2}} Prob(X_{1} = x_{1} | X_{2} = x_{2}) Prob( X_{2} = x_{2} ) \\
Prob(X_{2} = x_{2}) = \sum_{x_{1}} Prob(X_{2} = x_{2} | X_{1} = x_{1}) Prob( X_{1} = x_{1} ),
\end{eqnarray}\]</span>
which is also known as the <em>law of total probability</em>.</p>
<div id="example-fair-coin." class="section level4 unnumbered hasAnchor">
<h4><strong>Example: Fair Coin</strong>.<a href="bivariate-data.html#example-fair-coin." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For one example, Consider flipping two coins. Denoted each coin as <span class="math inline">\(i \in \{1, 2\}\)</span>, and mark whether “heads” is face up; <span class="math inline">\(X_{i}=1\)</span> if Heads and <span class="math inline">\(=0\)</span> if Tails. Suppose both coins are “fair”: <span class="math inline">\(Prob(X_{1}=1)= 1/2\)</span> and <span class="math inline">\(Prob(X_{2}=1|X_{1})=1/2\)</span>, then the four potential outcomes have equal probabilities. The joint distribution is
<span class="math display">\[\begin{eqnarray}
Prob(X_{1} = x_{1}, X_{2} = x_{2}) &amp;=&amp; Prob(X_{1} = x_{1}) Prob(X_{2} = x_{2})\\
Prob(X_{1} = 0, X_{2} = 0) &amp;=&amp; 1/2 \times 1/2 = 1/4 \\
Prob(X_{1} = 0, X_{2} = 1) &amp;=&amp; 1/4 \\
Prob(X_{1} = 1, X_{2} = 0) &amp;=&amp; 1/4 \\
Prob(X_{1} = 1, X_{2} = 1) &amp;=&amp; 1/4 .
\end{eqnarray}\]</span>
The marginal distribution of the second coin is
<span class="math display">\[\begin{eqnarray}
Prob(X_{2} = 0) &amp;=&amp; Prob(X_{2} = 0 | X_{1} = 0) Prob(X_{1}=0) + Prob(X_{2} = 0 | X_{1} = 1) Prob(X_{1}=1)\\
&amp;=&amp; 1/2 \times 1/2 + 1/2 \times 1/2 = 1/2\\
Prob(X_{2} = 1) &amp;=&amp; Prob(X_{2} = 1 | X_{1} = 0) Prob(X_{1}=0) + Prob(X_{2} = 1 | X_{1} = 1) Prob(X_{1}=1)\\
&amp;=&amp; 1/2 \times 1/2 + 1/2 \times 1/2 = 1/2
\end{eqnarray}\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="bivariate-data.html#cb155-1" tabindex="-1"></a><span class="co"># Create a 2x2 matrix for the joint distribution.</span></span>
<span id="cb155-2"><a href="bivariate-data.html#cb155-2" tabindex="-1"></a><span class="co"># Rows correspond to X1 (coin 1), and columns correspond to X2 (coin 2).</span></span>
<span id="cb155-3"><a href="bivariate-data.html#cb155-3" tabindex="-1"></a>P_fair <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb155-4"><a href="bivariate-data.html#cb155-4" tabindex="-1"></a><span class="fu">rownames</span>(P_fair) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X1=0&quot;</span>, <span class="st">&quot;X1=1&quot;</span>)</span>
<span id="cb155-5"><a href="bivariate-data.html#cb155-5" tabindex="-1"></a><span class="fu">colnames</span>(P_fair) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X2=0&quot;</span>, <span class="st">&quot;X2=1&quot;</span>)</span>
<span id="cb155-6"><a href="bivariate-data.html#cb155-6" tabindex="-1"></a>P_fair</span>
<span id="cb155-7"><a href="bivariate-data.html#cb155-7" tabindex="-1"></a><span class="do">##      X2=0 X2=1</span></span>
<span id="cb155-8"><a href="bivariate-data.html#cb155-8" tabindex="-1"></a><span class="do">## X1=0 0.25 0.25</span></span>
<span id="cb155-9"><a href="bivariate-data.html#cb155-9" tabindex="-1"></a><span class="do">## X1=1 0.25 0.25</span></span>
<span id="cb155-10"><a href="bivariate-data.html#cb155-10" tabindex="-1"></a></span>
<span id="cb155-11"><a href="bivariate-data.html#cb155-11" tabindex="-1"></a><span class="co"># Compute the marginal distributions.</span></span>
<span id="cb155-12"><a href="bivariate-data.html#cb155-12" tabindex="-1"></a><span class="co"># Marginal for X1: sum across columns.</span></span>
<span id="cb155-13"><a href="bivariate-data.html#cb155-13" tabindex="-1"></a>P_X1 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(P_fair)</span>
<span id="cb155-14"><a href="bivariate-data.html#cb155-14" tabindex="-1"></a>P_X1</span>
<span id="cb155-15"><a href="bivariate-data.html#cb155-15" tabindex="-1"></a><span class="do">## X1=0 X1=1 </span></span>
<span id="cb155-16"><a href="bivariate-data.html#cb155-16" tabindex="-1"></a><span class="do">##  0.5  0.5</span></span>
<span id="cb155-17"><a href="bivariate-data.html#cb155-17" tabindex="-1"></a><span class="co"># Marginal for X2: sum across rows.</span></span>
<span id="cb155-18"><a href="bivariate-data.html#cb155-18" tabindex="-1"></a>P_X2 <span class="ot">&lt;-</span> <span class="fu">colSums</span>(P_fair)</span>
<span id="cb155-19"><a href="bivariate-data.html#cb155-19" tabindex="-1"></a>P_X2</span>
<span id="cb155-20"><a href="bivariate-data.html#cb155-20" tabindex="-1"></a><span class="do">## X2=0 X2=1 </span></span>
<span id="cb155-21"><a href="bivariate-data.html#cb155-21" tabindex="-1"></a><span class="do">##  0.5  0.5</span></span>
<span id="cb155-22"><a href="bivariate-data.html#cb155-22" tabindex="-1"></a></span>
<span id="cb155-23"><a href="bivariate-data.html#cb155-23" tabindex="-1"></a><span class="co"># Compute the conditional probabilities Prob(X2 | X1).</span></span>
<span id="cb155-24"><a href="bivariate-data.html#cb155-24" tabindex="-1"></a>cond_X2_given_X1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb155-25"><a href="bivariate-data.html#cb155-25" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) {</span>
<span id="cb155-26"><a href="bivariate-data.html#cb155-26" tabindex="-1"></a>  cond_X2_given_X1[, j] <span class="ot">&lt;-</span> P_fair[, j] <span class="sc">/</span> P_X1[j]</span>
<span id="cb155-27"><a href="bivariate-data.html#cb155-27" tabindex="-1"></a>}</span>
<span id="cb155-28"><a href="bivariate-data.html#cb155-28" tabindex="-1"></a><span class="fu">rownames</span>(cond_X2_given_X1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X2=0&quot;</span>, <span class="st">&quot;X2=1&quot;</span>)</span>
<span id="cb155-29"><a href="bivariate-data.html#cb155-29" tabindex="-1"></a><span class="fu">colnames</span>(cond_X2_given_X1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;given X1=0&quot;</span>, <span class="st">&quot;given X1=1&quot;</span>)</span>
<span id="cb155-30"><a href="bivariate-data.html#cb155-30" tabindex="-1"></a>cond_X2_given_X1</span>
<span id="cb155-31"><a href="bivariate-data.html#cb155-31" tabindex="-1"></a><span class="do">##      given X1=0 given X1=1</span></span>
<span id="cb155-32"><a href="bivariate-data.html#cb155-32" tabindex="-1"></a><span class="do">## X2=0        0.5        0.5</span></span>
<span id="cb155-33"><a href="bivariate-data.html#cb155-33" tabindex="-1"></a><span class="do">## X2=1        0.5        0.5</span></span></code></pre></div>
</details>
</div>
<div id="example-unfair-coin." class="section level4 unnumbered hasAnchor">
<h4><strong>Example: Unfair Coin</strong>.<a href="bivariate-data.html#example-unfair-coin." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider a second example, where the second coin is “Completely Unfair”, so that it is always the same as the first. The outcomes generated with a Completely Unfair coin are the same as if we only flipped one coin.
<span class="math display">\[\begin{eqnarray}
Prob(X_{1} = x_{1}, X_{2} = x_{2}) &amp;=&amp; Prob(X_{1} = x_{1}) \mathbf{1}( x_{1}=x_{2} )\\
Prob(X_{1} = 0, X_{2} = 0) &amp;=&amp; 1/2 \\
Prob(X_{1} = 0, X_{2} = 1) &amp;=&amp; 0 \\
Prob(X_{1} = 1, X_{2} = 0) &amp;=&amp; 0 \\
Prob(X_{1} = 1, X_{2} = 1) &amp;=&amp; 1/2 .
\end{eqnarray}\]</span>
Note that <span class="math inline">\(\mathbf{1}(X_{1}=1)\)</span> means <span class="math inline">\(X_{1}= 1\)</span> and <span class="math inline">\(0\)</span> if <span class="math inline">\(X_{1}\neq0\)</span>.
The marginal distribution of the second coin is
<span class="math display">\[\begin{eqnarray}
Prob(X_{2} = 0)
&amp;=&amp; Prob(X_{2} = 0 | X_{1} = 0) Prob(X_{1}=0) + Prob(X_{2} = 0 | X_{1} = 1) Prob(X_{1} = 1)\\
&amp;=&amp; 1/2 \times 1 + 0 \times 1/2 = 1/2 .\\
Prob(X_{2} = 1)
&amp;=&amp; Prob(X_{2} = 1 | X_{1} =0) Prob( X_{1} = 0) + Prob(X_{2} = 1 | X_{1} = 1) Prob( X_{1} = 1)\\
&amp;=&amp; 0\times 1/2 + 1 \times 1/2 = 1/2 .
\end{eqnarray}\]</span>
which is the same as in the first example! Different joint distributions can have the same marginal distributions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="bivariate-data.html#cb156-1" tabindex="-1"></a><span class="co"># Create the joint distribution matrix for the unfair coin case.</span></span>
<span id="cb156-2"><a href="bivariate-data.html#cb156-2" tabindex="-1"></a>P_unfair <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb156-3"><a href="bivariate-data.html#cb156-3" tabindex="-1"></a><span class="fu">rownames</span>(P_unfair) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X1=0&quot;</span>, <span class="st">&quot;X1=1&quot;</span>)</span>
<span id="cb156-4"><a href="bivariate-data.html#cb156-4" tabindex="-1"></a><span class="fu">colnames</span>(P_unfair) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X2=0&quot;</span>, <span class="st">&quot;X2=1&quot;</span>)</span>
<span id="cb156-5"><a href="bivariate-data.html#cb156-5" tabindex="-1"></a>P_unfair</span>
<span id="cb156-6"><a href="bivariate-data.html#cb156-6" tabindex="-1"></a><span class="do">##      X2=0 X2=1</span></span>
<span id="cb156-7"><a href="bivariate-data.html#cb156-7" tabindex="-1"></a><span class="do">## X1=0  0.5  0.0</span></span>
<span id="cb156-8"><a href="bivariate-data.html#cb156-8" tabindex="-1"></a><span class="do">## X1=1  0.0  0.5</span></span>
<span id="cb156-9"><a href="bivariate-data.html#cb156-9" tabindex="-1"></a></span>
<span id="cb156-10"><a href="bivariate-data.html#cb156-10" tabindex="-1"></a><span class="co"># Compute the marginal distribution for X2 in the unfair case.</span></span>
<span id="cb156-11"><a href="bivariate-data.html#cb156-11" tabindex="-1"></a>P_X2_unfair <span class="ot">&lt;-</span> <span class="fu">colSums</span>(P_unfair)</span>
<span id="cb156-12"><a href="bivariate-data.html#cb156-12" tabindex="-1"></a>P_X1_unfair <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(P_unfair)</span>
<span id="cb156-13"><a href="bivariate-data.html#cb156-13" tabindex="-1"></a></span>
<span id="cb156-14"><a href="bivariate-data.html#cb156-14" tabindex="-1"></a><span class="co"># Compute the conditional probabilities Prob(X1 | X2) for the unfair coin.</span></span>
<span id="cb156-15"><a href="bivariate-data.html#cb156-15" tabindex="-1"></a>cond_X2_given_X1_unfair <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb156-16"><a href="bivariate-data.html#cb156-16" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) {</span>
<span id="cb156-17"><a href="bivariate-data.html#cb156-17" tabindex="-1"></a>  <span class="cf">if</span> (P_X1_unfair[j] <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb156-18"><a href="bivariate-data.html#cb156-18" tabindex="-1"></a>    cond_X2_given_X1_unfair[, j] <span class="ot">&lt;-</span> P_unfair[, j] <span class="sc">/</span> P_X1_unfair[j]</span>
<span id="cb156-19"><a href="bivariate-data.html#cb156-19" tabindex="-1"></a>  }</span>
<span id="cb156-20"><a href="bivariate-data.html#cb156-20" tabindex="-1"></a>}</span>
<span id="cb156-21"><a href="bivariate-data.html#cb156-21" tabindex="-1"></a><span class="fu">rownames</span>(cond_X2_given_X1_unfair) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X2=0&quot;</span>, <span class="st">&quot;X2=1&quot;</span>)</span>
<span id="cb156-22"><a href="bivariate-data.html#cb156-22" tabindex="-1"></a><span class="fu">colnames</span>(cond_X2_given_X1_unfair) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;given X1=0&quot;</span>, <span class="st">&quot;given X1=1&quot;</span>)</span>
<span id="cb156-23"><a href="bivariate-data.html#cb156-23" tabindex="-1"></a>cond_X2_given_X1_unfair</span>
<span id="cb156-24"><a href="bivariate-data.html#cb156-24" tabindex="-1"></a><span class="do">##      given X1=0 given X1=1</span></span>
<span id="cb156-25"><a href="bivariate-data.html#cb156-25" tabindex="-1"></a><span class="do">## X2=0          1          0</span></span>
<span id="cb156-26"><a href="bivariate-data.html#cb156-26" tabindex="-1"></a><span class="do">## X2=1          0          1</span></span></code></pre></div>
</details>
</div>
<div id="bayes-theorem." class="section level4 unnumbered hasAnchor">
<h4><strong>Bayes’ Theorem</strong>.<a href="bivariate-data.html#bayes-theorem." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finally, note <strong>Bayes’ Theorem</strong>:
<span class="math display">\[\begin{eqnarray}
Prob(X_{1} = x_{1} | X_{2} = x_{2})  Prob( X_{2} = x_{2})
    &amp;=&amp; Prob(X_{1} = x_{1}, X_{2} = x_{2}) = Prob(X_{2} = x_{2} | X_{1} = x_{1}) Prob(X_{1} = x_{1}).\\
Prob(X_{1} = x_{1} | X_{2} = x_{2})
    &amp;=&amp; \frac{ Prob(X_{2} = x_{2} | X_{1} = x_{1}) Prob(X_{1}=x_{1}) }{ Prob( X_{2} = x_{2}) }.
\end{eqnarray}\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="bivariate-data.html#cb157-1" tabindex="-1"></a><span class="co"># Verify Bayes&#39; theorem for the unfair coin case:</span></span>
<span id="cb157-2"><a href="bivariate-data.html#cb157-2" tabindex="-1"></a><span class="co"># Compute Prob(X1=1 | X2=1) using the formula:</span></span>
<span id="cb157-3"><a href="bivariate-data.html#cb157-3" tabindex="-1"></a><span class="co">#   Prob(X1=1 | X2=1) = [Prob(X2=1 | X1=1) * Prob(X1=1)] / Prob(X2=1)</span></span>
<span id="cb157-4"><a href="bivariate-data.html#cb157-4" tabindex="-1"></a></span>
<span id="cb157-5"><a href="bivariate-data.html#cb157-5" tabindex="-1"></a>P_X1_1 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb157-6"><a href="bivariate-data.html#cb157-6" tabindex="-1"></a>P_X2_1_given_X1_1 <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># Since coin 2 copies coin 1.</span></span>
<span id="cb157-7"><a href="bivariate-data.html#cb157-7" tabindex="-1"></a>P_X2_1 <span class="ot">&lt;-</span> P_X2_unfair[<span class="st">&quot;X2=1&quot;</span>]</span>
<span id="cb157-8"><a href="bivariate-data.html#cb157-8" tabindex="-1"></a></span>
<span id="cb157-9"><a href="bivariate-data.html#cb157-9" tabindex="-1"></a>bayes_result <span class="ot">&lt;-</span> (P_X2_1_given_X1_1 <span class="sc">*</span> P_X1_1) <span class="sc">/</span> P_X2_1</span>
<span id="cb157-10"><a href="bivariate-data.html#cb157-10" tabindex="-1"></a>bayes_result</span>
<span id="cb157-11"><a href="bivariate-data.html#cb157-11" tabindex="-1"></a><span class="do">## X2=1 </span></span>
<span id="cb157-12"><a href="bivariate-data.html#cb157-12" tabindex="-1"></a><span class="do">##    1</span></span></code></pre></div>
</details>
</div>
</div>
<div id="further-reading-6" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Further Reading<a href="bivariate-data.html#further-reading-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Many introductory econometrics textbooks have a good appendix on probability and statistics. There are many useful texts online too</p>
<p>See the Further reading about Probability Theory in the Statistics chaper.</p>
<ul>
<li><a href="https://www.r-bloggers.com/2024/03/calculating-conditional-probability-in-r/" class="uri">https://www.r-bloggers.com/2024/03/calculating-conditional-probability-in-r/</a></li>
</ul>
<p>Other Statistics
* <a href="https://cran.r-project.org/web/packages/qualvar/vignettes/wilcox1973.html" class="uri">https://cran.r-project.org/web/packages/qualvar/vignettes/wilcox1973.html</a></p>

</div>
</div>



</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>See also <em>Theil-Sen Estimator</em>, which may be seen as a precursor.<a href="bivariate-data.html#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="basic-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["index.pdf", "index.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
