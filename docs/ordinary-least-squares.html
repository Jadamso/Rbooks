<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 6 Ordinary Least Squares | index</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content=" 6 Ordinary Least Squares | index" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 6 Ordinary Least Squares | index" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="moving-beyond-the-basics.html"/>
<link rel="next" href="ols-diagnostics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6.9000/profvis.js"></script>
<script src="libs/profvis-0.3.6.9000/scroll.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.8/profvis.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Primers</a></li>
<li class="toc-logo"><a href="./"><img src="Figures_Manual/Logo.png" width="140" height="100"></a></li>        

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="part"><span><b>I Introduction to R</b></span></li>
<li class="chapter" data-level="2" data-path="first-steps-on-programming-in-r.html"><a href="first-steps-on-programming-in-r.html"><i class="fa fa-check"></i><b>2</b> First steps on Programming in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="first-steps-on-programming-in-r.html"><a href="first-steps-on-programming-in-r.html#install-r"><i class="fa fa-check"></i><b>2.1</b> Install R</a></li>
<li class="chapter" data-level="2.2" data-path="first-steps-on-programming-in-r.html"><a href="first-steps-on-programming-in-r.html#interfacing-with-the-gui"><i class="fa fa-check"></i><b>2.2</b> Interfacing with the GUI</a></li>
<li class="chapter" data-level="2.3" data-path="first-steps-on-programming-in-r.html"><a href="first-steps-on-programming-in-r.html#introductions-to-r"><i class="fa fa-check"></i><b>2.3</b> Introductions to R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mathematical-objects.html"><a href="mathematical-objects.html"><i class="fa fa-check"></i><b>3</b> Mathematical Objects</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mathematical-objects.html"><a href="mathematical-objects.html#scalars-and-vectors"><i class="fa fa-check"></i><b>3.1</b> Scalars and Vectors</a></li>
<li class="chapter" data-level="3.2" data-path="mathematical-objects.html"><a href="mathematical-objects.html#functions-of-scalars-and-vectors"><i class="fa fa-check"></i><b>3.2</b> Functions of Scalars and Vectors</a></li>
<li class="chapter" data-level="3.3" data-path="mathematical-objects.html"><a href="mathematical-objects.html#functions-of-functions"><i class="fa fa-check"></i><b>3.3</b> Functions of Functions</a></li>
<li class="chapter" data-level="3.4" data-path="mathematical-objects.html"><a href="mathematical-objects.html#matrices-and-matrix-functions"><i class="fa fa-check"></i><b>3.4</b> Matrices and Matrix-Functions</a></li>
<li class="chapter" data-level="3.5" data-path="mathematical-objects.html"><a href="mathematical-objects.html#arrays-and-array-functions"><i class="fa fa-check"></i><b>3.5</b> Arrays and Array Functions</a></li>
<li class="chapter" data-level="3.6" data-path="mathematical-objects.html"><a href="mathematical-objects.html#other-commom-types-of-data"><i class="fa fa-check"></i><b>3.6</b> Other Commom Types of Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plots.html"><a href="plots.html"><i class="fa fa-check"></i><b>4</b> Plots</a>
<ul>
<li class="chapter" data-level="4.1" data-path="plots.html"><a href="plots.html#basics"><i class="fa fa-check"></i><b>4.1</b> Basics</a></li>
<li class="chapter" data-level="4.2" data-path="plots.html"><a href="plots.html#equation-fitting-example"><i class="fa fa-check"></i><b>4.2</b> Equation Fitting Example</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="moving-beyond-the-basics.html"><a href="moving-beyond-the-basics.html"><i class="fa fa-check"></i><b>5</b> Moving beyond the basics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="moving-beyond-the-basics.html"><a href="moving-beyond-the-basics.html#task-views"><i class="fa fa-check"></i><b>5.1</b> Task Views</a></li>
<li class="chapter" data-level="5.2" data-path="moving-beyond-the-basics.html"><a href="moving-beyond-the-basics.html#custom-figures"><i class="fa fa-check"></i><b>5.2</b> Custom figures</a></li>
</ul></li>
<li class="part"><span><b>II Introduction to Linear Regression in R</b></span></li>
<li class="chapter" data-level="6" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html"><i class="fa fa-check"></i><b>6</b> Ordinary Least Squares</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#simple-ols-linear-regression"><i class="fa fa-check"></i><b>6.1</b> Simple OLS (linear regression)</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#variability-estimates-and-hypothesis-tests"><i class="fa fa-check"></i><b>6.1.1</b> Variability Estimates and Hypothesis Tests</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#ols-multiple-linear-regression"><i class="fa fa-check"></i><b>6.2</b> OLS (multiple linear regression)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#variability-estimates-and-hypothesis-tests-under-construction"><i class="fa fa-check"></i><b>6.2.1</b> Variability Estimates and Hypothesis Tests [Under Construction]</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#coefficient-interpretation"><i class="fa fa-check"></i><b>6.3</b> Coefficient Interpretation</a></li>
<li class="chapter" data-level="6.4" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#factor-variables"><i class="fa fa-check"></i><b>6.4</b> Factor Variables</a></li>
<li class="chapter" data-level="6.5" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#more-literature"><i class="fa fa-check"></i><b>6.5</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html"><i class="fa fa-check"></i><b>7</b> OLS Diagnostics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#assessing-outliers"><i class="fa fa-check"></i><b>7.1</b> Assessing Outliers</a></li>
<li class="chapter" data-level="7.2" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#assessing-normality-and-collinearity"><i class="fa fa-check"></i><b>7.2</b> Assessing Normality and Collinearity</a></li>
<li class="chapter" data-level="7.3" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#linear-in-parameters"><i class="fa fa-check"></i><b>7.3</b> Linear in parameters</a></li>
<li class="chapter" data-level="7.4" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#more-literature-1"><i class="fa fa-check"></i><b>7.4</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html"><i class="fa fa-check"></i><b>8</b> OLS and Endogeneity</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html#two-stage-least-squares-2sls"><i class="fa fa-check"></i><b>8.1</b> Two Stage Least Squares (2SLS)</a></li>
<li class="chapter" data-level="8.2" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html#regression-discontinuitieskink-rdrk"><i class="fa fa-check"></i><b>8.2</b> Regression Discontinuities/Kink (RD/RK)</a></li>
<li class="chapter" data-level="8.3" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html#difference-in-differences-did"><i class="fa fa-check"></i><b>8.3</b> Difference in Differences (DID)</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-scientism.html"><a href="data-scientism.html"><i class="fa fa-check"></i><b>9</b> Data scientism</a>
<ul>
<li class="chapter" data-level="9.1" data-path="data-scientism.html"><a href="data-scientism.html#ols-in-the-age-of-big-data"><i class="fa fa-check"></i><b>9.1</b> OLS in the age of big data</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="data-scientism.html"><a href="data-scientism.html#us-govt-spending-on-science"><i class="fa fa-check"></i><b>9.1.1</b> US Gov’t Spending on Science</a></li>
<li class="chapter" data-level="9.1.2" data-path="data-scientism.html"><a href="data-scientism.html#false-positives-arise-from-errors"><i class="fa fa-check"></i><b>9.1.2</b> False Positives arise from errors</a></li>
<li class="chapter" data-level="9.1.3" data-path="data-scientism.html"><a href="data-scientism.html#false-positives-arise-from-regression-machines"><i class="fa fa-check"></i><b>9.1.3</b> False Positives arise from Regression Machines</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="data-scientism.html"><a href="data-scientism.html#causal-effects-sans-theory"><i class="fa fa-check"></i><b>9.2</b> Causal effects <em>sans theory</em></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="data-scientism.html"><a href="data-scientism.html#rdd"><i class="fa fa-check"></i><b>9.2.1</b> RDD</a></li>
<li class="chapter" data-level="9.2.2" data-path="data-scientism.html"><a href="data-scientism.html#did"><i class="fa fa-check"></i><b>9.2.2</b> DID</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Introduction to Reproducible R</b></span></li>
<li class="chapter" data-level="10" data-path="why-be-reproducible.html"><a href="why-be-reproducible.html"><i class="fa fa-check"></i><b>10</b> Why be reproducible</a>
<ul>
<li class="chapter" data-level="10.1" data-path="why-be-reproducible.html"><a href="why-be-reproducible.html#an-example-workflow"><i class="fa fa-check"></i><b>10.1</b> An example workflow</a></li>
<li class="chapter" data-level="10.2" data-path="why-be-reproducible.html"><a href="why-be-reproducible.html#an-alternative-workflow"><i class="fa fa-check"></i><b>10.2</b> An alternative workflow</a></li>
<li class="chapter" data-level="10.3" data-path="why-be-reproducible.html"><a href="why-be-reproducible.html#r-and-r-markdown"><i class="fa fa-check"></i><b>10.3</b> R and R-Markdown</a></li>
<li class="chapter" data-level="10.4" data-path="why-be-reproducible.html"><a href="why-be-reproducible.html#types-of-projects"><i class="fa fa-check"></i><b>10.4</b> Types of Projects</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="small-scale-projects.html"><a href="small-scale-projects.html"><i class="fa fa-check"></i><b>11</b> Small Scale Projects</a>
<ul>
<li class="chapter" data-level="11.1" data-path="small-scale-projects.html"><a href="small-scale-projects.html#an-r-code-chunk"><i class="fa fa-check"></i><b>11.1</b> An R Code Chunk</a></li>
<li class="chapter" data-level="11.2" data-path="small-scale-projects.html"><a href="small-scale-projects.html#an-r-markdown-document"><i class="fa fa-check"></i><b>11.2</b> An R Markdown Document</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="small-scale-projects.html"><a href="small-scale-projects.html#copypaste-example"><i class="fa fa-check"></i><b>11.2.1</b> Copy/Paste Example</a></li>
<li class="chapter" data-level="11.2.2" data-path="small-scale-projects.html"><a href="small-scale-projects.html#a-homework-example"><i class="fa fa-check"></i><b>11.2.2</b> A Homework Example</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="small-scale-projects.html"><a href="small-scale-projects.html#posters-and-slides"><i class="fa fa-check"></i><b>11.3</b> Posters and Slides</a></li>
<li class="chapter" data-level="11.4" data-path="small-scale-projects.html"><a href="small-scale-projects.html#getting-help-w-r-markdown"><i class="fa fa-check"></i><b>11.4</b> Getting help w/ R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="medium-scale-projects.html"><a href="medium-scale-projects.html"><i class="fa fa-check"></i><b>12</b> Medium Scale Projects</a>
<ul>
<li class="chapter" data-level="12.1" data-path="medium-scale-projects.html"><a href="medium-scale-projects.html#makefile"><i class="fa fa-check"></i><b>12.1</b> MAKEFILE</a></li>
<li class="chapter" data-level="12.2" data-path="medium-scale-projects.html"><a href="medium-scale-projects.html#loggingsinking"><i class="fa fa-check"></i><b>12.2</b> Logging/Sinking</a></li>
<li class="chapter" data-level="12.3" data-path="medium-scale-projects.html"><a href="medium-scale-projects.html#final-step"><i class="fa fa-check"></i><b>12.3</b> Final Step</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="large-scale-projects.html"><a href="large-scale-projects.html"><i class="fa fa-check"></i><b>13</b> Large Scale Projects</a>
<ul>
<li class="chapter" data-level="13.1" data-path="large-scale-projects.html"><a href="large-scale-projects.html#debugging"><i class="fa fa-check"></i><b>13.1</b> Debugging</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="large-scale-projects.html"><a href="large-scale-projects.html#tracing-errors"><i class="fa fa-check"></i><b>13.1.1</b> Tracing Errors</a></li>
<li class="chapter" data-level="13.1.2" data-path="large-scale-projects.html"><a href="large-scale-projects.html#checking-problems"><i class="fa fa-check"></i><b>13.1.2</b> Checking problems</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="large-scale-projects.html"><a href="large-scale-projects.html#being-proactive"><i class="fa fa-check"></i><b>13.2</b> Being Proactive</a></li>
<li class="chapter" data-level="13.3" data-path="large-scale-projects.html"><a href="large-scale-projects.html#optimizing"><i class="fa fa-check"></i><b>13.3</b> Optimizing</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="large-scale-projects.html"><a href="large-scale-projects.html#benchmarking"><i class="fa fa-check"></i><b>13.3.1</b> Benchmarking</a></li>
<li class="chapter" data-level="13.3.2" data-path="large-scale-projects.html"><a href="large-scale-projects.html#bottlenecks"><i class="fa fa-check"></i><b>13.3.2</b> Bottlenecks</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="large-scale-projects.html"><a href="large-scale-projects.html#further-programming-guidance"><i class="fa fa-check"></i><b>13.4</b> Further Programming Guidance</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>14</b> Shiny</a>
<ul>
<li class="chapter" data-level="14.0.1" data-path="shiny.html"><a href="shiny.html#programming-guidance"><i class="fa fa-check"></i><b>14.0.1</b> Programming Guidance</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i><b>15</b> Software</a>
<ul>
<li class="chapter" data-level="15.1" data-path="software.html"><a href="software.html#latest-versions"><i class="fa fa-check"></i><b>15.1</b> Latest versions</a></li>
<li class="chapter" data-level="15.2" data-path="software.html"><a href="software.html#stata"><i class="fa fa-check"></i><b>15.2</b> Stata</a></li>
<li class="chapter" data-level="15.3" data-path="software.html"><a href="software.html#general-workflow"><i class="fa fa-check"></i><b>15.3</b> General Workflow</a></li>
<li class="chapter" data-level="15.4" data-path="software.html"><a href="software.html#sweave"><i class="fa fa-check"></i><b>15.4</b> Sweave</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://sites.google.com/view/jordan-adamson" target="blank">Jordan Adamson</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ordinary-least-squares" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number"> 6</span> Ordinary Least Squares<a href="ordinary-least-squares.html#ordinary-least-squares" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<hr />
<div id="simple-ols-linear-regression" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Simple OLS (linear regression)<a href="ordinary-least-squares.html#simple-ols-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Model and objective
<span class="math display">\[
y_i=\alpha+\beta x_i+\epsilon_{i} \\
\epsilon_{i} = y_i - [\alpha+\beta x_i]\\
min_{\beta} \sum_{i=1}^{n} (\epsilon_{i})^2
\]</span></p>
<p>Point Estimates
<span class="math display">\[
\hat{\alpha}=\bar{y}-\hat{\beta}\bar{x} = \widehat{\mathbb{E}}[Y] - \hat{\beta} \widehat{\mathbb{E}}[X] \\
\hat{\beta}=\frac{\sum_{i}^{}(x_i-\bar{x})(y_i-\bar{y})}{\sum_{i}^{}(x_i-\bar{x})^2} = \frac{\widehat{Cov}[X,Y]}{\widehat{\mathbb{V}}[X]}\\
\hat{y}_i=\hat{\alpha}+\hat{\beta}x_i\\
\hat{\epsilon}_i=y_i-\hat{y}_i\\
\]</span></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="ordinary-least-squares.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Example 1 (Theoretical)</span></span>
<span id="cb115-2"><a href="ordinary-least-squares.html#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="ordinary-least-squares.html#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Generate Dataset</span></span>
<span id="cb115-4"><a href="ordinary-least-squares.html#cb115-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb115-5"><a href="ordinary-least-squares.html#cb115-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,.<span class="dv">5</span>)</span>
<span id="cb115-6"><a href="ordinary-least-squares.html#cb115-6" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">sapply</span>(z, <span class="cf">function</span>(zi){</span>
<span id="cb115-7"><a href="ordinary-least-squares.html#cb115-7" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,zi<span class="sc">*</span><span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb115-8"><a href="ordinary-least-squares.html#cb115-8" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,zi<span class="sc">*</span><span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb115-9"><a href="ordinary-least-squares.html#cb115-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(x,y)</span>
<span id="cb115-10"><a href="ordinary-least-squares.html#cb115-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb115-11"><a href="ordinary-least-squares.html#cb115-11" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>xy[<span class="dv">1</span>,],<span class="at">y=</span>xy[<span class="dv">2</span>,])</span>
<span id="cb115-12"><a href="ordinary-least-squares.html#cb115-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-13"><a href="ordinary-least-squares.html#cb115-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot Data</span></span>
<span id="cb115-14"><a href="ordinary-least-squares.html#cb115-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x, xy, <span class="at">col=</span><span class="fu">grey</span>(.<span class="dv">5</span>,.<span class="dv">5</span>), <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb115-15"><a href="ordinary-least-squares.html#cb115-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-16"><a href="ordinary-least-squares.html#cb115-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate Regression Coefficeints</span></span>
<span id="cb115-17"><a href="ordinary-least-squares.html#cb115-17" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">dat=</span>xy)</span>
<span id="cb115-18"><a href="ordinary-least-squares.html#cb115-18" aria-hidden="true" tabindex="-1"></a>reg</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = xy)
## 
## Coefficients:
## (Intercept)            x  
##      0.3264       0.6295</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="ordinary-least-squares.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Add Predictions to Plot</span></span>
<span id="cb117-2"><a href="ordinary-least-squares.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(reg, <span class="at">col=</span><span class="st">&#39;orange&#39;</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Sums of Squared Errors
<span class="math display">\[
\underbrace{\sum\nolimits_{i}(y_i-\bar{y})^2}_\text{TSS}=\underbrace{\sum\nolimits_{i}(\hat{y}_i-\bar{y})^2}_\text{RSS}+\underbrace{\sum\nolimits_{i}\hat{\epsilon}^2}_\text{ESS}\\
R^2 = \frac{RSS}{TSS}=1-\frac{ESS}{TSS}
\]</span>
Note that <span class="math inline">\(R^2\)</span> is also called the coefficient of determination.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="ordinary-least-squares.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Manually Compute Goodness of Fit</span></span>
<span id="cb118-2"><a href="ordinary-least-squares.html#cb118-2" aria-hidden="true" tabindex="-1"></a>Ehat <span class="ot">&lt;-</span> <span class="fu">resid</span>(reg)</span>
<span id="cb118-3"><a href="ordinary-least-squares.html#cb118-3" aria-hidden="true" tabindex="-1"></a>ESS  <span class="ot">&lt;-</span> <span class="fu">sum</span>(Ehat<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb118-4"><a href="ordinary-least-squares.html#cb118-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> xy<span class="sc">$</span>y</span>
<span id="cb118-5"><a href="ordinary-least-squares.html#cb118-5" aria-hidden="true" tabindex="-1"></a>TSS  <span class="ot">&lt;-</span> <span class="fu">sum</span>((Y<span class="sc">-</span><span class="fu">mean</span>(Y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb118-6"><a href="ordinary-least-squares.html#cb118-6" aria-hidden="true" tabindex="-1"></a>R2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ESS<span class="sc">/</span>TSS</span>
<span id="cb118-7"><a href="ordinary-least-squares.html#cb118-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-8"><a href="ordinary-least-squares.html#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Check R2</span></span>
<span id="cb118-9"><a href="ordinary-least-squares.html#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.2759816</code></pre>
<div id="variability-estimates-and-hypothesis-tests" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Variability Estimates and Hypothesis Tests<a href="ordinary-least-squares.html#variability-estimates-and-hypothesis-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The classic estimates for variability are the Standard Error of the Regression <span class="math inline">\(\hat{\sigma}\)</span>, and Standard Error of the Coefficient Estimates <span class="math inline">\(\hat{\sigma}_{\hat{\alpha}}\)</span> and <span class="math inline">\(\hat{\sigma}_{\hat{\alpha}}\)</span> — or simply Standard Errors.
<span class="math display">\[
\hat{\sigma}^2 = \frac{1}{n-2}\sum_{i}\hat{\epsilon_{i}}^2\\
\hat{\sigma}^2_{\hat{\alpha}}=\hat{\sigma}^2\left[\frac{1}{n}+\frac{\bar{x}^2}{\sum_{i}(x_i-\bar{x})^2}\right]\\
\hat{\sigma}^2_{\hat{\beta}}=\frac{\hat{\sigma}^2}{\sum_{i}(x_i-\bar{x})^2}.
\]</span>
These estimates are motivated by particular data generating proceses, and you can read more about this at <a href="https://www.econometrics-with-r.org/4-lrwor.html" class="uri">https://www.econometrics-with-r.org/4-lrwor.html</a>.</p>
<p>We can also estimate variabilty using <em>data-driven</em> methods that assume much less about the data generating process. We focus on the simplest, the jackknife, where we loop through each row of the dataset. In each iteration of the loop, we drop that observation from the dataset and reestimate the statistic of interest. We then calculate the standard deviation of the statistic across all ``subsamples’’.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="ordinary-least-squares.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Example 1 Continued</span></span>
<span id="cb120-2"><a href="ordinary-least-squares.html#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="ordinary-least-squares.html#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Point Estimates</span></span>
<span id="cb120-4"><a href="ordinary-least-squares.html#cb120-4" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">dat=</span>xy)</span>
<span id="cb120-5"><a href="ordinary-least-squares.html#cb120-5" aria-hidden="true" tabindex="-1"></a>coefX <span class="ot">&lt;-</span> <span class="fu">coef</span>(reg)[<span class="st">&#39;x&#39;</span>]</span>
<span id="cb120-6"><a href="ordinary-least-squares.html#cb120-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-7"><a href="ordinary-least-squares.html#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Standard Errors for Beta</span></span>
<span id="cb120-8"><a href="ordinary-least-squares.html#cb120-8" aria-hidden="true" tabindex="-1"></a>jack_regs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(xy), <span class="cf">function</span>(i){</span>
<span id="cb120-9"><a href="ordinary-least-squares.html#cb120-9" aria-hidden="true" tabindex="-1"></a>    xy_i <span class="ot">&lt;-</span> xy[<span class="sc">-</span>i,]</span>
<span id="cb120-10"><a href="ordinary-least-squares.html#cb120-10" aria-hidden="true" tabindex="-1"></a>    reg_u <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">dat=</span>xy_i)</span>
<span id="cb120-11"><a href="ordinary-least-squares.html#cb120-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb120-12"><a href="ordinary-least-squares.html#cb120-12" aria-hidden="true" tabindex="-1"></a>jack_coefs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(jack_regs, coef)[<span class="st">&#39;x&#39;</span>,]</span>
<span id="cb120-13"><a href="ordinary-least-squares.html#cb120-13" aria-hidden="true" tabindex="-1"></a>jack_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(jack_coefs)</span>
<span id="cb120-14"><a href="ordinary-least-squares.html#cb120-14" aria-hidden="true" tabindex="-1"></a>jack_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(jack_coefs)</span>
<span id="cb120-15"><a href="ordinary-least-squares.html#cb120-15" aria-hidden="true" tabindex="-1"></a>jack_cl <span class="ot">&lt;-</span> jack_mean<span class="dv">-2</span><span class="sc">*</span>jack_se</span>
<span id="cb120-16"><a href="ordinary-least-squares.html#cb120-16" aria-hidden="true" tabindex="-1"></a>jack_cu <span class="ot">&lt;-</span> jack_mean<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>jack_se</span>
<span id="cb120-17"><a href="ordinary-least-squares.html#cb120-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-18"><a href="ordinary-least-squares.html#cb120-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Jackknife Distribution</span></span>
<span id="cb120-19"><a href="ordinary-least-squares.html#cb120-19" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(jack_coefs, <span class="at">breaks=</span><span class="dv">25</span>, <span class="at">main=</span><span class="st">&#39;&#39;</span>,</span>
<span id="cb120-20"><a href="ordinary-least-squares.html#cb120-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="fu">expression</span>(beta[<span class="sc">-</span>i]),</span>
<span id="cb120-21"><a href="ordinary-least-squares.html#cb120-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim=</span><span class="fu">range</span>(<span class="fu">c</span>(jack_coefs, jack_cl, jack_cu)))</span>
<span id="cb120-22"><a href="ordinary-least-squares.html#cb120-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>jack_mean, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb120-23"><a href="ordinary-least-squares.html#cb120-23" aria-hidden="true" tabindex="-1"></a><span class="do">##abline(v=coefX, lty=1, col=&#39;blue&#39;, lwd=2)</span></span>
<span id="cb120-24"><a href="ordinary-least-squares.html#cb120-24" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>jack_cl, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb120-25"><a href="ordinary-least-squares.html#cb120-25" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>jack_cu, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p><strong>Hypothesis Testing: Impose the Null</strong>
Regardless of how we calculate standard errors, we can use them to conduct a t-test. Specifically, we can use them to compute a t-value. We also compute the distribution of t-values under the null hypothesis, and compare how extreme the oberved value is. Often, we our null hypothesis is ``‘no relationship’’. And, under some assumptions, we theoretically know that the null distribution is a <span class="math inline">\(t_{n-2}\)</span>. For more on regression t-testing, see <a href="https://www.econometrics-with-r.org/4-lrwor.html" class="uri">https://www.econometrics-with-r.org/4-lrwor.html</a>.</p>
<p>We can also compute the null distribution using <em>data-driven</em> methods that assume much less about the data generating process. We focus on the simplest, the bootstrap, where loop through a large number of simulations. In each iteration of the loop, we drop impose the null hypothesis and reestimate the statistic of interest. We then calculate the standard deviation of the statistic across all ``resamples’’.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="ordinary-least-squares.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Example 1 Continued Again</span></span>
<span id="cb121-2"><a href="ordinary-least-squares.html#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="ordinary-least-squares.html#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Null Distribution for Beta</span></span>
<span id="cb121-4"><a href="ordinary-least-squares.html#cb121-4" aria-hidden="true" tabindex="-1"></a>boots <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">399</span></span>
<span id="cb121-5"><a href="ordinary-least-squares.html#cb121-5" aria-hidden="true" tabindex="-1"></a>boot_regs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(boots, <span class="cf">function</span>(b){</span>
<span id="cb121-6"><a href="ordinary-least-squares.html#cb121-6" aria-hidden="true" tabindex="-1"></a>    xy_b <span class="ot">&lt;-</span> xy</span>
<span id="cb121-7"><a href="ordinary-least-squares.html#cb121-7" aria-hidden="true" tabindex="-1"></a>    xy_b<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">sample</span>( xy_b<span class="sc">$</span>y, <span class="at">replace=</span>T)</span>
<span id="cb121-8"><a href="ordinary-least-squares.html#cb121-8" aria-hidden="true" tabindex="-1"></a>    reg_b <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">dat=</span>xy_b)</span>
<span id="cb121-9"><a href="ordinary-least-squares.html#cb121-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb121-10"><a href="ordinary-least-squares.html#cb121-10" aria-hidden="true" tabindex="-1"></a>boot_coefs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(boot_regs, coef)[<span class="st">&#39;x&#39;</span>,]</span>
<span id="cb121-11"><a href="ordinary-least-squares.html#cb121-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-12"><a href="ordinary-least-squares.html#cb121-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Bootstrap Distribution</span></span>
<span id="cb121-13"><a href="ordinary-least-squares.html#cb121-13" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot_coefs, <span class="at">breaks=</span><span class="dv">25</span>, <span class="at">main=</span><span class="st">&#39;&#39;</span>,</span>
<span id="cb121-14"><a href="ordinary-least-squares.html#cb121-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="fu">expression</span>(beta[b]),</span>
<span id="cb121-15"><a href="ordinary-least-squares.html#cb121-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim=</span><span class="fu">range</span>(<span class="fu">c</span>(boot_coefs, coefX)))</span>
<span id="cb121-16"><a href="ordinary-least-squares.html#cb121-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>coefX, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p><strong>Hypothesis Testing: Invert a CI</strong>
The other main way to conduct hypothesis tests is to examine whether a confidence interval contains a hypothesized value. Often, this is <span class="math inline">\(0\)</span>.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="ordinary-least-squares.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Example 1 Continued Yet Again</span></span>
<span id="cb122-2"><a href="ordinary-least-squares.html#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="ordinary-least-squares.html#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Distribution for Beta</span></span>
<span id="cb122-4"><a href="ordinary-least-squares.html#cb122-4" aria-hidden="true" tabindex="-1"></a>boots <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">399</span></span>
<span id="cb122-5"><a href="ordinary-least-squares.html#cb122-5" aria-hidden="true" tabindex="-1"></a>boot_regs2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(boots, <span class="cf">function</span>(b){</span>
<span id="cb122-6"><a href="ordinary-least-squares.html#cb122-6" aria-hidden="true" tabindex="-1"></a>    id_b <span class="ot">&lt;-</span> <span class="fu">sample</span>( <span class="fu">nrow</span>(xy), <span class="at">replace=</span>T)</span>
<span id="cb122-7"><a href="ordinary-least-squares.html#cb122-7" aria-hidden="true" tabindex="-1"></a>    xy_b <span class="ot">&lt;-</span> xy[id_b,]</span>
<span id="cb122-8"><a href="ordinary-least-squares.html#cb122-8" aria-hidden="true" tabindex="-1"></a>    reg_b <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">dat=</span>xy_b)</span>
<span id="cb122-9"><a href="ordinary-least-squares.html#cb122-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb122-10"><a href="ordinary-least-squares.html#cb122-10" aria-hidden="true" tabindex="-1"></a>boot_coefs2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(boot_regs2, coef)[<span class="st">&#39;x&#39;</span>,]</span>
<span id="cb122-11"><a href="ordinary-least-squares.html#cb122-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-12"><a href="ordinary-least-squares.html#cb122-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Bootstrap Distribution</span></span>
<span id="cb122-13"><a href="ordinary-least-squares.html#cb122-13" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot_coefs2, <span class="at">breaks=</span><span class="dv">25</span>, <span class="at">main=</span><span class="st">&#39;&#39;</span>, <span class="at">xlab=</span><span class="fu">expression</span>(beta[b]),</span>
<span id="cb122-14"><a href="ordinary-least-squares.html#cb122-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim=</span><span class="fu">range</span>(<span class="fu">c</span>(<span class="dv">0</span>,boot_coefs2)))</span>
<span id="cb122-15"><a href="ordinary-least-squares.html#cb122-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>( <span class="at">v=</span><span class="fu">quantile</span>(boot_coefs2, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>)))</span>
<span id="cb122-16"><a href="ordinary-least-squares.html#cb122-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>We can also bootstrap other statistics, such as a t-statistic or <span class="math inline">\(R^2\)</span>. However, we are rarely interested in computing standard errrors and conducting hypothesis tests for two variables. We only work through the ideas in the two-variable case to better understand the multi-variable case.</p>
</div>
</div>
<div id="ols-multiple-linear-regression" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> OLS (multiple linear regression)<a href="ordinary-least-squares.html#ols-multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Model and objective
<span class="math display">\[
y_i=\beta_0+\beta_1x_{i1}+\beta_2x_{i2}+\ldots+\beta_kx_{ik}+\epsilon_i = X_{i}\beta + +\epsilon_i \\
min_{\beta} \sum_{i=1}^{n} (\epsilon_i)^2
\]</span></p>
<p>Point Estimates in matrix form
<span class="math display">\[
y=\textbf{X}\beta+\epsilon\\
\hat{\beta}=(\textbf{X}&#39;\textbf{X})^{-1}\textbf{X}&#39;y
\]</span></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="ordinary-least-squares.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Example 2 (Empirical)</span></span>
<span id="cb123-2"><a href="ordinary-least-squares.html#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Inspect Dataset on police arrests for the USA in 1973</span></span>
<span id="cb123-3"><a href="ordinary-least-squares.html#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(USArrests)</span></code></pre></div>
<pre><code>##            Murder Assault UrbanPop Rape
## Alabama      13.2     236       58 21.2
## Alaska       10.0     263       48 44.5
## Arizona       8.1     294       80 31.0
## Arkansas      8.8     190       50 19.5
## California    9.0     276       91 40.6
## Colorado      7.9     204       78 38.7</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="ordinary-least-squares.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Simple Plot</span></span>
<span id="cb125-2"><a href="ordinary-least-squares.html#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(Assault~UrbanPop, USArrests, col=grey(0,.5), pch=16,</span></span>
<span id="cb125-3"><a href="ordinary-least-squares.html#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co">#    cex=USArrests$Murder/diff(range(USArrests$Murder))*2,</span></span>
<span id="cb125-4"><a href="ordinary-least-squares.html#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co">#    main=&#39;US Murder arrests (per 100,000)&#39;)</span></span>
<span id="cb125-5"><a href="ordinary-least-squares.html#cb125-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-6"><a href="ordinary-least-squares.html#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Superior Plot</span></span>
<span id="cb125-7"><a href="ordinary-least-squares.html#cb125-7" aria-hidden="true" tabindex="-1"></a>USArrests<span class="sc">$</span>ID <span class="ot">&lt;-</span> <span class="fu">rownames</span>(USArrests)</span>
<span id="cb125-8"><a href="ordinary-least-squares.html#cb125-8" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">plot_ly</span>(</span>
<span id="cb125-9"><a href="ordinary-least-squares.html#cb125-9" aria-hidden="true" tabindex="-1"></a>  USArrests, <span class="at">x =</span> <span class="sc">~</span>UrbanPop, <span class="at">y =</span> <span class="sc">~</span>Assault,</span>
<span id="cb125-10"><a href="ordinary-least-squares.html#cb125-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">&#39;State: &#39;</span>, ID, <span class="st">&quot;&lt;br&gt;Murder Arrests:&quot;</span>, Murder),</span>
<span id="cb125-11"><a href="ordinary-least-squares.html#cb125-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="sc">~</span>Murder,</span>
<span id="cb125-12"><a href="ordinary-least-squares.html#cb125-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="sc">~</span>Murder, <span class="at">opacity =</span> <span class="fl">0.5</span>),</span>
<span id="cb125-13"><a href="ordinary-least-squares.html#cb125-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&#39;Murder arrests (per 100,000)&#39;</span>)</span></code></pre></div>
<pre><code>## No trace type specified:
##   Based on info supplied, a &#39;scatter&#39; trace seems appropriate.
##   Read more about this trace type -&gt; https://plotly.com/r/reference/#scatter</code></pre>
<pre><code>## No scatter mode specifed:
##   Setting the mode to markers
##   Read more about this attribute -&gt; https://plotly.com/r/reference/#scatter-mode</code></pre>
<pre><code>## Warning: &#39;scatter&#39; objects don&#39;t have these attributes: &#39;title&#39;
## Valid attributes include:
## &#39;cliponaxis&#39;, &#39;connectgaps&#39;, &#39;customdata&#39;, &#39;customdatasrc&#39;, &#39;dx&#39;, &#39;dy&#39;, &#39;error_x&#39;, &#39;error_y&#39;, &#39;fill&#39;, &#39;fillcolor&#39;, &#39;fillpattern&#39;, &#39;groupnorm&#39;, &#39;hoverinfo&#39;, &#39;hoverinfosrc&#39;, &#39;hoverlabel&#39;, &#39;hoveron&#39;, &#39;hovertemplate&#39;, &#39;hovertemplatesrc&#39;, &#39;hovertext&#39;, &#39;hovertextsrc&#39;, &#39;ids&#39;, &#39;idssrc&#39;, &#39;legendgroup&#39;, &#39;legendgrouptitle&#39;, &#39;legendrank&#39;, &#39;line&#39;, &#39;marker&#39;, &#39;meta&#39;, &#39;metasrc&#39;, &#39;mode&#39;, &#39;name&#39;, &#39;opacity&#39;, &#39;orientation&#39;, &#39;selected&#39;, &#39;selectedpoints&#39;, &#39;showlegend&#39;, &#39;stackgaps&#39;, &#39;stackgroup&#39;, &#39;stream&#39;, &#39;text&#39;, &#39;textfont&#39;, &#39;textposition&#39;, &#39;textpositionsrc&#39;, &#39;textsrc&#39;, &#39;texttemplate&#39;, &#39;texttemplatesrc&#39;, &#39;transforms&#39;, &#39;type&#39;, &#39;uid&#39;, &#39;uirevision&#39;, &#39;unselected&#39;, &#39;visible&#39;, &#39;x&#39;, &#39;x0&#39;, &#39;xaxis&#39;, &#39;xcalendar&#39;, &#39;xhoverformat&#39;, &#39;xperiod&#39;, &#39;xperiod0&#39;, &#39;xperiodalignment&#39;, &#39;xsrc&#39;, &#39;y&#39;, &#39;y0&#39;, &#39;yaxis&#39;, &#39;ycalendar&#39;, &#39;yhoverformat&#39;, &#39;yperiod&#39;, &#39;yperiod0&#39;, &#39;yperiodalignment&#39;, &#39;ysrc&#39;, &#39;key&#39;, &#39;set&#39;, &#39;frame&#39;, &#39;transforms&#39;, &#39;_isNestedKey&#39;, &#39;_isSimpleKey&#39;, &#39;_isGraticule&#39;, &#39;_bbox&#39;</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ce87be325fd72165e7d2" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-ce87be325fd72165e7d2">{"x":{"visdat":{"bdb7753a9998":["function () ","plotlyVisDat"]},"cur_data":"bdb7753a9998","attrs":{"bdb7753a9998":{"x":{},"y":{},"text":{},"marker":{"size":{},"opacity":0.5},"title":"Murder arrests (per 100,000)","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"UrbanPop"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Assault"},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[58,48,80,50,91,78,77,72,80,60,83,54,83,65,57,66,52,66,51,67,85,74,66,44,70,53,62,81,56,89,70,86,45,44,75,68,67,72,87,48,45,59,80,80,32,63,73,39,66,60],"y":[236,263,294,190,276,204,110,238,335,211,46,120,249,113,56,115,109,249,83,300,149,255,72,259,178,109,102,252,57,159,285,254,337,45,120,151,159,106,174,279,86,188,201,120,48,156,145,81,53,161],"text":["State:  Alabama <br>Murder Arrests: 13.2","State:  Alaska <br>Murder Arrests: 10","State:  Arizona <br>Murder Arrests: 8.1","State:  Arkansas <br>Murder Arrests: 8.8","State:  California <br>Murder Arrests: 9","State:  Colorado <br>Murder Arrests: 7.9","State:  Connecticut <br>Murder Arrests: 3.3","State:  Delaware <br>Murder Arrests: 5.9","State:  Florida <br>Murder Arrests: 15.4","State:  Georgia <br>Murder Arrests: 17.4","State:  Hawaii <br>Murder Arrests: 5.3","State:  Idaho <br>Murder Arrests: 2.6","State:  Illinois <br>Murder Arrests: 10.4","State:  Indiana <br>Murder Arrests: 7.2","State:  Iowa <br>Murder Arrests: 2.2","State:  Kansas <br>Murder Arrests: 6","State:  Kentucky <br>Murder Arrests: 9.7","State:  Louisiana <br>Murder Arrests: 15.4","State:  Maine <br>Murder Arrests: 2.1","State:  Maryland <br>Murder Arrests: 11.3","State:  Massachusetts <br>Murder Arrests: 4.4","State:  Michigan <br>Murder Arrests: 12.1","State:  Minnesota <br>Murder Arrests: 2.7","State:  Mississippi <br>Murder Arrests: 16.1","State:  Missouri <br>Murder Arrests: 9","State:  Montana <br>Murder Arrests: 6","State:  Nebraska <br>Murder Arrests: 4.3","State:  Nevada <br>Murder Arrests: 12.2","State:  New Hampshire <br>Murder Arrests: 2.1","State:  New Jersey <br>Murder Arrests: 7.4","State:  New Mexico <br>Murder Arrests: 11.4","State:  New York <br>Murder Arrests: 11.1","State:  North Carolina <br>Murder Arrests: 13","State:  North Dakota <br>Murder Arrests: 0.8","State:  Ohio <br>Murder Arrests: 7.3","State:  Oklahoma <br>Murder Arrests: 6.6","State:  Oregon <br>Murder Arrests: 4.9","State:  Pennsylvania <br>Murder Arrests: 6.3","State:  Rhode Island <br>Murder Arrests: 3.4","State:  South Carolina <br>Murder Arrests: 14.4","State:  South Dakota <br>Murder Arrests: 3.8","State:  Tennessee <br>Murder Arrests: 13.2","State:  Texas <br>Murder Arrests: 12.7","State:  Utah <br>Murder Arrests: 3.2","State:  Vermont <br>Murder Arrests: 2.2","State:  Virginia <br>Murder Arrests: 8.5","State:  Washington <br>Murder Arrests: 4","State:  West Virginia <br>Murder Arrests: 5.7","State:  Wisconsin <br>Murder Arrests: 2.6","State:  Wyoming <br>Murder Arrests: 6.8"],"marker":{"colorbar":{"title":"Murder","ticklen":2},"cmin":0.80000000000000004,"cmax":17.399999999999999,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[13.199999999999999,10,8.0999999999999996,8.8000000000000007,9,7.9000000000000004,3.2999999999999998,5.9000000000000004,15.4,17.399999999999999,5.2999999999999998,2.6000000000000001,10.4,7.2000000000000002,2.2000000000000002,6,9.6999999999999993,15.4,2.1000000000000001,11.300000000000001,4.4000000000000004,12.1,2.7000000000000002,16.100000000000001,9,6,4.2999999999999998,12.199999999999999,2.1000000000000001,7.4000000000000004,11.4,11.1,13,0.80000000000000004,7.2999999999999998,6.5999999999999996,4.9000000000000004,6.2999999999999998,3.3999999999999999,14.4,3.7999999999999998,13.199999999999999,12.699999999999999,3.2000000000000002,2.2000000000000002,8.5,4,5.7000000000000002,2.6000000000000001,6.7999999999999998],"size":[13.199999999999999,10,8.0999999999999996,8.8000000000000007,9,7.9000000000000004,3.2999999999999998,5.9000000000000004,15.4,17.399999999999999,5.2999999999999998,2.6000000000000001,10.4,7.2000000000000002,2.2000000000000002,6,9.6999999999999993,15.4,2.1000000000000001,11.300000000000001,4.4000000000000004,12.1,2.7000000000000002,16.100000000000001,9,6,4.2999999999999998,12.199999999999999,2.1000000000000001,7.4000000000000004,11.4,11.1,13,0.80000000000000004,7.2999999999999998,6.5999999999999996,4.9000000000000004,6.2999999999999998,3.3999999999999999,14.4,3.7999999999999998,13.199999999999999,12.699999999999999,3.2000000000000002,2.2000000000000002,8.5,4,5.7000000000000002,2.6000000000000001,6.7999999999999998],"opacity":0.5,"line":{"colorbar":{"title":"","ticklen":2},"cmin":0.80000000000000004,"cmax":17.399999999999999,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[13.199999999999999,10,8.0999999999999996,8.8000000000000007,9,7.9000000000000004,3.2999999999999998,5.9000000000000004,15.4,17.399999999999999,5.2999999999999998,2.6000000000000001,10.4,7.2000000000000002,2.2000000000000002,6,9.6999999999999993,15.4,2.1000000000000001,11.300000000000001,4.4000000000000004,12.1,2.7000000000000002,16.100000000000001,9,6,4.2999999999999998,12.199999999999999,2.1000000000000001,7.4000000000000004,11.4,11.1,13,0.80000000000000004,7.2999999999999998,6.5999999999999996,4.9000000000000004,6.2999999999999998,3.3999999999999999,14.4,3.7999999999999998,13.199999999999999,12.699999999999999,3.2000000000000002,2.2000000000000002,8.5,4,5.7000000000000002,2.6000000000000001,6.7999999999999998]}},"title":"Murder arrests (per 100,000)","type":"scatter","mode":"markers","xaxis":"x","yaxis":"y","frame":null},{"x":[32,91],"y":[45,337],"type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"Murder","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"cmin":0.80000000000000004,"cmax":17.399999999999999,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[0.80000000000000004,17.399999999999999],"line":{"color":"rgba(255,127,14,1)"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="ordinary-least-squares.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For further exploratory plotting,</span></span>
<span id="cb129-2"><a href="ordinary-least-squares.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="do">## see https://plotly.com/r/bubble-charts/</span></span></code></pre></div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="ordinary-least-squares.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Manually Compute</span></span>
<span id="cb130-2"><a href="ordinary-least-squares.html#cb130-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> USArrests[,<span class="st">&#39;Murder&#39;</span>]</span>
<span id="cb130-3"><a href="ordinary-least-squares.html#cb130-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> USArrests[,<span class="fu">c</span>(<span class="st">&#39;Assault&#39;</span>,<span class="st">&#39;UrbanPop&#39;</span>)]</span>
<span id="cb130-4"><a href="ordinary-least-squares.html#cb130-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">cbind</span>(<span class="dv">1</span>,X))</span>
<span id="cb130-5"><a href="ordinary-least-squares.html#cb130-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-6"><a href="ordinary-least-squares.html#cb130-6" aria-hidden="true" tabindex="-1"></a>XtXi <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)</span>
<span id="cb130-7"><a href="ordinary-least-squares.html#cb130-7" aria-hidden="true" tabindex="-1"></a>Bhat <span class="ot">&lt;-</span> XtXi <span class="sc">%*%</span> (<span class="fu">t</span>(X)<span class="sc">%*%</span>Y)</span>
<span id="cb130-8"><a href="ordinary-least-squares.html#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(Bhat)</span></code></pre></div>
<pre><code>## [1]  3.20715340  0.04390995 -0.04451047</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="ordinary-least-squares.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Check</span></span>
<span id="cb132-2"><a href="ordinary-least-squares.html#cb132-2" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder<span class="sc">~</span>Assault<span class="sc">+</span>UrbanPop, <span class="at">data=</span>USArrests)</span>
<span id="cb132-3"><a href="ordinary-least-squares.html#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(reg)</span></code></pre></div>
<pre><code>## (Intercept)     Assault    UrbanPop 
##  3.20715340  0.04390995 -0.04451047</code></pre>
<p>Sums of Squared Errors
<span class="math display">\[
R^2 = \frac{RSS}{TSS}=1-\frac{ESS}{TSS}\\
R^2_{\text{adj.}} = 1-\frac{n-1}{n-K}(1-R^2)
\]</span>
With multiple variables, sometimes random data may improve the fit. So we adjust the <span class="math inline">\(R^2\)</span> by the number of covariates <span class="math inline">\(K\)</span>.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="ordinary-least-squares.html#cb134-1" aria-hidden="true" tabindex="-1"></a>ksims <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb134-2"><a href="ordinary-least-squares.html#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> ksims){ </span>
<span id="cb134-3"><a href="ordinary-least-squares.html#cb134-3" aria-hidden="true" tabindex="-1"></a>    USArrests[,<span class="fu">paste0</span>(<span class="st">&#39;R&#39;</span>,k)] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">nrow</span>(USArrests),<span class="dv">0</span>,<span class="dv">20</span>)</span>
<span id="cb134-4"><a href="ordinary-least-squares.html#cb134-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb134-5"><a href="ordinary-least-squares.html#cb134-5" aria-hidden="true" tabindex="-1"></a>reg_sim <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ksims, <span class="cf">function</span>(k){</span>
<span id="cb134-6"><a href="ordinary-least-squares.html#cb134-6" aria-hidden="true" tabindex="-1"></a>    rvars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Assault&#39;</span>,<span class="st">&#39;UrbanPop&#39;</span>, <span class="fu">paste0</span>(<span class="st">&#39;R&#39;</span>,<span class="dv">1</span><span class="sc">:</span>k))</span>
<span id="cb134-7"><a href="ordinary-least-squares.html#cb134-7" aria-hidden="true" tabindex="-1"></a>    rvars2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(rvars, <span class="at">collapse=</span><span class="st">&#39;+&#39;</span>)</span>
<span id="cb134-8"><a href="ordinary-least-squares.html#cb134-8" aria-hidden="true" tabindex="-1"></a>    reg_k <span class="ot">&lt;-</span> <span class="fu">lm</span>( <span class="fu">paste0</span>(<span class="st">&#39;Murder~&#39;</span>,rvars2), <span class="at">data=</span>USArrests)</span>
<span id="cb134-9"><a href="ordinary-least-squares.html#cb134-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb134-10"><a href="ordinary-least-squares.html#cb134-10" aria-hidden="true" tabindex="-1"></a>R2_sim <span class="ot">&lt;-</span> <span class="fu">sapply</span>(reg_sim, <span class="cf">function</span>(reg_k){  <span class="fu">summary</span>(reg_k)<span class="sc">$</span>r.squared })</span>
<span id="cb134-11"><a href="ordinary-least-squares.html#cb134-11" aria-hidden="true" tabindex="-1"></a>R2adj_sim <span class="ot">&lt;-</span> <span class="fu">sapply</span>(reg_sim, <span class="cf">function</span>(reg_k){  <span class="fu">summary</span>(reg_k)<span class="sc">$</span>adj.r.squared })</span>
<span id="cb134-12"><a href="ordinary-least-squares.html#cb134-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-13"><a href="ordinary-least-squares.html#cb134-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb134-14"><a href="ordinary-least-squares.html#cb134-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.window</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb134-15"><a href="ordinary-least-squares.html#cb134-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(ksims, R2_sim)</span>
<span id="cb134-16"><a href="ordinary-least-squares.html#cb134-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(ksims, R2adj_sim, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb134-17"><a href="ordinary-least-squares.html#cb134-17" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>)</span>
<span id="cb134-18"><a href="ordinary-least-squares.html#cb134-18" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb134-19"><a href="ordinary-least-squares.html#cb134-19" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(R<span class="sc">^</span><span class="dv">2</span>),<span class="dv">2</span>, <span class="at">line=</span><span class="dv">3</span>)</span>
<span id="cb134-20"><a href="ordinary-least-squares.html#cb134-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;Additional Random Covariates&#39;</span>, <span class="dv">1</span>, <span class="at">line=</span><span class="dv">3</span>)</span>
<span id="cb134-21"><a href="ordinary-least-squares.html#cb134-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="at">horiz=</span>T,</span>
<span id="cb134-22"><a href="ordinary-least-squares.html#cb134-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&#39;Undjusted&#39;</span>, <span class="st">&#39;Adjusted&#39;</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">16</span>))</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div id="variability-estimates-and-hypothesis-tests-under-construction" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Variability Estimates and Hypothesis Tests [Under Construction]<a href="ordinary-least-squares.html#variability-estimates-and-hypothesis-tests-under-construction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In general, note that the linear model has
<span class="math display">\[
\hat{\Sigma}_{\beta} = (X&#39;X)^{-1} X&#39; \widehat{\Omega} X (X&#39;X)^{-1}.\\
\widehat{\Omega} = \begin{pmatrix}
\hat{\sigma}_{1,1} &amp; ... &amp; \hat{\sigma}_{1,n}\\
&amp; ... &amp;  \\
\hat{\sigma}_{n,1} &amp; ... &amp; \hat{\sigma}_{n,n}
\end{pmatrix}
\]</span>
Standard Errors are the diagonal: <span class="math inline">\(diag( \hat{\Sigma}_{\beta} )\)</span></p>
<p><strong>Classical Linear Model (CLM)</strong>
Independance: <span class="math inline">\(\hat{\sigma_{i,j}}=0\)</span>
Homoskedasticity:
<span class="math display">\[
diag( \widehat{\Omega} ) = [\hat{\sigma}^2, \hat{\sigma}^2, ..., \hat{\sigma}^2] \\
\hat{\sigma}^2=\frac{1}{n-K}\sum_{i}\hat{\epsilon}_i^2\\
\]</span>
IID Variability Estimates
<span class="math display">\[
\hat{\Sigma}_{\beta} = \hat{\sigma}^2 (X&#39;X)^{-1}\\
\]</span></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="ordinary-least-squares.html#cb135-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb135-2"><a href="ordinary-least-squares.html#cb135-2" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X)</span>
<span id="cb135-3"><a href="ordinary-least-squares.html#cb135-3" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sum</span>( Ehat<span class="sc">^</span><span class="dv">2</span> )<span class="sc">/</span>(n<span class="sc">-</span>K)</span>
<span id="cb135-4"><a href="ordinary-least-squares.html#cb135-4" aria-hidden="true" tabindex="-1"></a>Vhat <span class="ot">&lt;-</span> s <span class="sc">*</span> XtXi</span>
<span id="cb135-5"><a href="ordinary-least-squares.html#cb135-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-6"><a href="ordinary-least-squares.html#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(reg)</span></code></pre></div>
<pre><code>##              (Intercept)       Assault      UrbanPop
## (Intercept)  3.030349406 -1.532127e-03 -4.021339e-02
## Assault     -0.001532127  2.096605e-05 -3.124864e-05
## UrbanPop    -0.040213394 -3.124864e-05  6.949864e-04</code></pre>
<p><strong>Reality</strong>
There are common violations to the iid case.
Heteroskedasticity:
<span class="math display">\[
diag( \widehat{\Omega} ) = [\widehat{\sigma^2_{1}}, \widehat{\sigma^2_{1}}, ..., \widehat{\sigma^2_{n}}]\\
\widehat{\sigma^2_{i}} = \hat{\epsilon_{i}}^2
\]</span></p>
<p>Autocorrelation Dependance: <span class="math inline">\(\sigma_{i,j}=f( dist(i,j) )\)</span>.</p>
<p>Cluster Dependance:
<span class="math display">\[\sigma_{i,j}=
\begin{cases}
\hat{\sigma}_{group1} &amp; i,j \in \text{group } 1\\
...\\
\hat{\sigma}_{groupG} &amp; i,j \in \text{group } G \\
0 &amp; \text{otherwise} \\
\end{cases}
\]</span></p>
<p>This is for a later course. (See <a href="https://cran.r-project.org/web/packages/sandwich/vignettes/sandwich.pdf" class="uri">https://cran.r-project.org/web/packages/sandwich/vignettes/sandwich.pdf</a> and then <a href="https://cran.r-project.org/web/packages/sandwich/vignettes/sandwich-CL.pdf" class="uri">https://cran.r-project.org/web/packages/sandwich/vignettes/sandwich-CL.pdf</a>)</p>
<p><strong>Hypothesis Testing</strong> is not to be done routinely. For one hypothesis, we can use a <span class="math inline">\(t\)</span> test. For multiple, we can use an <span class="math inline">\(F\)</span> test.
<span class="math display">\[
\hat{t}_{j} = \frac{\hat{\beta}_j - \beta_{0} }{\hat{\sigma}_{\\hat{\beta}_j}}\sim t_{n-K} \\
\hat{F}_{q} = \frac{(ESS_{restricted}-ESS_{unrestricted})/q}{ESS_{unrestricted}/(n-K)} \sim F_{q,n-K}
\]</span></p>
<p>Note that <span class="math inline">\(\hat{F}\)</span> can be written in terms of unrestricted and restricted <span class="math inline">\(R^2\)</span></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="ordinary-least-squares.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Seperate tests each coef is 0</span></span>
<span id="cb137-2"><a href="ordinary-least-squares.html#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate standard errors, t–statistics, p-values</span></span>
<span id="cb137-3"><a href="ordinary-least-squares.html#cb137-3" aria-hidden="true" tabindex="-1"></a>SEhat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(Vhat))</span>
<span id="cb137-4"><a href="ordinary-least-squares.html#cb137-4" aria-hidden="true" tabindex="-1"></a>That  <span class="ot">&lt;-</span> Bhat<span class="sc">/</span>SEhat</span>
<span id="cb137-5"><a href="ordinary-least-squares.html#cb137-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-6"><a href="ordinary-least-squares.html#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="do">## One Sided Test for P(t &gt; That | Null)</span></span>
<span id="cb137-7"><a href="ordinary-least-squares.html#cb137-7" aria-hidden="true" tabindex="-1"></a>Phat1  <span class="ot">&lt;-</span> <span class="fu">pt</span>(That, n<span class="sc">-</span>K)</span>
<span id="cb137-8"><a href="ordinary-least-squares.html#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Two Sided Test for P(t &gt; That or  t &lt; -That | Null)</span></span>
<span id="cb137-9"><a href="ordinary-least-squares.html#cb137-9" aria-hidden="true" tabindex="-1"></a>Phat2  <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>( <span class="fu">abs</span>(That), n<span class="sc">-</span>K) <span class="sc">+</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(That), n<span class="sc">-</span>K)</span>
<span id="cb137-10"><a href="ordinary-least-squares.html#cb137-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-11"><a href="ordinary-least-squares.html#cb137-11" aria-hidden="true" tabindex="-1"></a>Phat2</span></code></pre></div>
<pre><code>##                  [,1]
## 1        1.480485e-02
## Assault  1.091559e-17
## UrbanPop 2.480018e-02</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="ordinary-least-squares.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Murder ~ Assault + UrbanPop, data = USArrests)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.5530 -1.7093 -0.3677  1.2284  7.5985 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.207153   1.740790   1.842   0.0717 .  
## Assault      0.043910   0.004579   9.590 1.22e-12 ***
## UrbanPop    -0.044510   0.026363  -1.688   0.0980 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.58 on 47 degrees of freedom
## Multiple R-squared:  0.6634, Adjusted R-squared:  0.6491 
## F-statistic: 46.32 on 2 and 47 DF,  p-value: 7.704e-12</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="ordinary-least-squares.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Joint test all 3 coefs are 0</span></span>
<span id="cb141-2"><a href="ordinary-least-squares.html#cb141-2" aria-hidden="true" tabindex="-1"></a>Fhat <span class="ot">&lt;-</span> (TSS <span class="sc">-</span> ESS)<span class="sc">/</span>ESS <span class="sc">*</span> (n<span class="sc">-</span>K)<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb141-3"><a href="ordinary-least-squares.html#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pf</span>(Fhat, <span class="dv">3</span>, n<span class="sc">-</span>K)</span></code></pre></div>
<pre><code>## [1] 0.001552493</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="ordinary-least-squares.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg)<span class="sc">$</span>fstatistic</span></code></pre></div>
<pre><code>##    value    numdf    dendf 
## 46.31903  2.00000 47.00000</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="ordinary-least-squares.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Murder ~ Assault + UrbanPop, data = USArrests)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.5530 -1.7093 -0.3677  1.2284  7.5985 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.207153   1.740790   1.842   0.0717 .  
## Assault      0.043910   0.004579   9.590 1.22e-12 ***
## UrbanPop    -0.044510   0.026363  -1.688   0.0980 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.58 on 47 degrees of freedom
## Multiple R-squared:  0.6634, Adjusted R-squared:  0.6491 
## F-statistic: 46.32 on 2 and 47 DF,  p-value: 7.704e-12</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="ordinary-least-squares.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Null Bootstrap Distribution for R2</span></span>
<span id="cb147-2"><a href="ordinary-least-squares.html#cb147-2" aria-hidden="true" tabindex="-1"></a>boot_R2s <span class="ot">&lt;-</span> <span class="fu">sapply</span>(boot_regs, <span class="cf">function</span>(reg_b){</span>
<span id="cb147-3"><a href="ordinary-least-squares.html#cb147-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(reg_b)<span class="sc">$</span>r.squared</span>
<span id="cb147-4"><a href="ordinary-least-squares.html#cb147-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb147-5"><a href="ordinary-least-squares.html#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot_R2s, <span class="at">breaks=</span><span class="dv">25</span>, <span class="at">main=</span><span class="st">&#39;&#39;</span>, <span class="at">xlab=</span><span class="fu">expression</span>(R[b]<span class="sc">^</span><span class="dv">2</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">50</span>))</span>
<span id="cb147-6"><a href="ordinary-least-squares.html#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">summary</span>(reg)<span class="sc">$</span>r.squared, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
</div>
<div id="coefficient-interpretation" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Coefficient Interpretation<a href="ordinary-least-squares.html#coefficient-interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Notice that we have gotten pretty far without actually trying to meaningfully interpret regression coefficients. That is because the above procedure will always give us number, regardless as to whether the true data generating process is linear or not. So, to be cautious, we have been interpretting the regression outputs while being agnostic as to how the data are generated. We now consider a special situation where we know the data are generated according to a linear process and are only uncertain about the parameter values.</p>
<p><em>If</em> the data generating process is
<span class="math display">\[
y=X\beta + \epsilon\\
\mathbb{E}[\epsilon | X]=0,
\]</span>
then we have a famous result that lets us attach a simple interpretation of OLS coefficients as unbiased estimates of the effect of X:
<span class="math display">\[
\hat{\beta} = (X&#39;X)^{-1}X&#39;y = (X&#39;X)^{-1}X&#39;(X\beta + \epsilon) = \beta + (X&#39;X)^{-1}X&#39;\epsilon\\
\mathbb{E}\left[ \hat{\beta} \right] = \mathbb{E}\left[ (X&#39;X)^{-1}X&#39;y \right] = \beta + (X&#39;X)^{-1}\mathbb{E}\left[ X&#39;\epsilon \right] = \beta
\]</span></p>
<p>Generate a simulated dataset with 30 observations and two exogenous variables. Assume the following relationship: <span class="math inline">\(yi = \beta_0 + \beta_1 x_{1,i} + \beta_2 x_{2,i} + \epsilon_i\)</span> where the variables and the error term are realizations of the following data generating processes (DGP):</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="ordinary-least-squares.html#cb148-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb148-2"><a href="ordinary-least-squares.html#cb148-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb148-3"><a href="ordinary-least-squares.html#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="ordinary-least-squares.html#cb148-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb148-5"><a href="ordinary-least-squares.html#cb148-5" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,.<span class="dv">7</span>)</span>
<span id="cb148-6"><a href="ordinary-least-squares.html#cb148-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>,x1,x2)</span>
<span id="cb148-7"><a href="ordinary-least-squares.html#cb148-7" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">3</span>)</span>
<span id="cb148-8"><a href="ordinary-least-squares.html#cb148-8" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> X<span class="sc">%*%</span>B <span class="sc">+</span> e</span>
<span id="cb148-9"><a href="ordinary-least-squares.html#cb148-9" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Y,X)</span>
<span id="cb148-10"><a href="ordinary-least-squares.html#cb148-10" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>x1<span class="sc">+</span>x2, <span class="at">data=</span>dat))</span></code></pre></div>
<pre><code>## (Intercept)          x1          x2 
##    9.097868    1.496441    1.652753</code></pre>
<p>Simulate the distribution of coefficients under a correctly specified model. Interpret the average.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="ordinary-least-squares.html#cb150-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb150-2"><a href="ordinary-least-squares.html#cb150-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb150-3"><a href="ordinary-least-squares.html#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="ordinary-least-squares.html#cb150-4" aria-hidden="true" tabindex="-1"></a>Coefs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">400</span>, <span class="cf">function</span>(sim){</span>
<span id="cb150-5"><a href="ordinary-least-squares.html#cb150-5" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb150-6"><a href="ordinary-least-squares.html#cb150-6" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,.<span class="dv">7</span>)</span>
<span id="cb150-7"><a href="ordinary-least-squares.html#cb150-7" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>,x1,x2)</span>
<span id="cb150-8"><a href="ordinary-least-squares.html#cb150-8" aria-hidden="true" tabindex="-1"></a>    e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">3</span>)</span>
<span id="cb150-9"><a href="ordinary-least-squares.html#cb150-9" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> X<span class="sc">%*%</span>B <span class="sc">+</span> e</span>
<span id="cb150-10"><a href="ordinary-least-squares.html#cb150-10" aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Y,x1,x2)</span>
<span id="cb150-11"><a href="ordinary-least-squares.html#cb150-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>x1<span class="sc">+</span>x2, <span class="at">data=</span>dat))</span>
<span id="cb150-12"><a href="ordinary-least-squares.html#cb150-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb150-13"><a href="ordinary-least-squares.html#cb150-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-14"><a href="ordinary-least-squares.html#cb150-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb150-15"><a href="ordinary-least-squares.html#cb150-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb150-16"><a href="ordinary-least-squares.html#cb150-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(Coefs[i,], <span class="at">xlab=</span><span class="fu">bquote</span>(beta[.(i)]), <span class="at">main=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb150-17"><a href="ordinary-least-squares.html#cb150-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(Coefs[i,]), <span class="at">col=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb150-18"><a href="ordinary-least-squares.html#cb150-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v=</span>B[i], <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb150-19"><a href="ordinary-least-squares.html#cb150-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Note that for joint tests, we look at the joint distribution of coefficients</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="ordinary-least-squares.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ks)</span>
<span id="cb151-2"><a href="ordinary-least-squares.html#cb151-2" aria-hidden="true" tabindex="-1"></a>Bjoint <span class="ot">&lt;-</span> <span class="fu">t</span>(Coefs[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,])</span>
<span id="cb151-3"><a href="ordinary-least-squares.html#cb151-3" aria-hidden="true" tabindex="-1"></a>fBjoint <span class="ot">&lt;-</span> <span class="fu">histde</span>(Bjoint, <span class="at">binw=</span><span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">5</span>))</span>
<span id="cb151-4"><a href="ordinary-least-squares.html#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fBjoint, <span class="at">xlab=</span><span class="fu">expression</span>(beta[<span class="dv">2</span>]), <span class="at">ylab=</span><span class="fu">expression</span>(beta[<span class="dv">3</span>]))</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Many economic phenomena are nonlinear, even when including potential transforms of <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>. Sometimes the OLS model may still be a good or even great approximation (how good depends on the research question). In any case, you are safe to interpret your OLS coefficients as “conditional correlations”. For example, examine the distribution of coefficients under this mispecified model. Interpret the average.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="ordinary-least-squares.html#cb152-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb152-2"><a href="ordinary-least-squares.html#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="ordinary-least-squares.html#cb152-3" aria-hidden="true" tabindex="-1"></a>Coefs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">600</span>, <span class="cf">function</span>(sim){</span>
<span id="cb152-4"><a href="ordinary-least-squares.html#cb152-4" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb152-5"><a href="ordinary-least-squares.html#cb152-5" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,.<span class="dv">7</span>)</span>
<span id="cb152-6"><a href="ordinary-least-squares.html#cb152-6" aria-hidden="true" tabindex="-1"></a>    e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">3</span>)</span>
<span id="cb152-7"><a href="ordinary-least-squares.html#cb152-7" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">*</span>x2 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(x1)<span class="sc">^</span>x2 <span class="sc">+</span> e</span>
<span id="cb152-8"><a href="ordinary-least-squares.html#cb152-8" aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Y,x1,x2)</span>
<span id="cb152-9"><a href="ordinary-least-squares.html#cb152-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>x1<span class="sc">+</span>x2, <span class="at">data=</span>dat))</span>
<span id="cb152-10"><a href="ordinary-least-squares.html#cb152-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb152-11"><a href="ordinary-least-squares.html#cb152-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-12"><a href="ordinary-least-squares.html#cb152-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb152-13"><a href="ordinary-least-squares.html#cb152-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb152-14"><a href="ordinary-least-squares.html#cb152-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(Coefs[i,],  <span class="at">xlab=</span><span class="fu">bquote</span>(beta[.(i)]), <span class="at">main=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb152-15"><a href="ordinary-least-squares.html#cb152-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(Coefs[i,]), <span class="at">col=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb152-16"><a href="ordinary-least-squares.html#cb152-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="factor-variables" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Factor Variables<a href="ordinary-least-squares.html#factor-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far, we have discussed cardinal data where the difference between units always means the same thing: e.g., <span class="math inline">\(4 -3=3-2\)</span>. There are also factor variables</p>
<ul>
<li>Ordered: The difference between units means something, but not always the same thing. E.g., <span class="math inline">\(1st - 2nd \neq 2nd - 3rd\)</span>.</li>
<li>Unordered: The difference between units does not mean something <span class="math inline">\(B-A =??\)</span></li>
</ul>
<p>Sometimes Ordinal and Categorical data are called Ordinal and Categorical variables.</p>
<p>To analyze either factor, we often convert them into indicator variables or dummies; <span class="math inline">\(D_{c}=\mathbf{1}( Factor = c)\)</span>. One common case is if you have observations of individuals over time periods, then you may have two factor variables. An unordered factor that indicates who an individual is; for example <span class="math inline">\(D_{i}=\mathbf{1}( Individual = i)\)</span>, and an order factor that indicates the time period; for example <span class="math inline">\(D_{t}=\mathbf{1}( Time \in [month~ t, month~ t+1) )\)</span>. There are many other cases you see factor variables, including spatial ID’s in purely cross sectional data.</p>
<p>Be careful not to handle categorical data as if they were cardinal. E.g., generate city data with Leipzig=1, Lausanne=2, LosAngeles=3, … and then include city as if it were a cardinal number (that’s a big no-no). The same applied to ordinal data; PopulationLeipzig=2, PopulationLausanne=3, PopulationLosAngeles=1.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="ordinary-least-squares.html#cb153-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb153-2"><a href="ordinary-least-squares.html#cb153-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="dv">3</span>,<span class="dv">8</span>)</span>
<span id="cb153-3"><a href="ordinary-least-squares.html#cb153-3" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="fl">0.4</span>)</span>
<span id="cb153-4"><a href="ordinary-least-squares.html#cb153-4" aria-hidden="true" tabindex="-1"></a>fo <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rbinom</span>(N,<span class="dv">4</span>,.<span class="dv">5</span>), <span class="at">ordered=</span>T)</span>
<span id="cb153-5"><a href="ordinary-least-squares.html#cb153-5" aria-hidden="true" tabindex="-1"></a>fu <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;A&#39;</span>,<span class="st">&#39;B&#39;</span>),N<span class="sc">/</span><span class="dv">2</span>), <span class="at">ordered=</span>F)</span>
<span id="cb153-6"><a href="ordinary-least-squares.html#cb153-6" aria-hidden="true" tabindex="-1"></a>dA <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>(fu<span class="sc">==</span><span class="st">&#39;A&#39;</span>)</span>
<span id="cb153-7"><a href="ordinary-least-squares.html#cb153-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">^</span><span class="fu">as.integer</span>(fo)<span class="sc">*</span>dA )<span class="sc">*</span><span class="fu">sqrt</span>(x)<span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">as.integer</span>(fo)<span class="sc">*</span>e</span>
<span id="cb153-8"><a href="ordinary-least-squares.html#cb153-8" aria-hidden="true" tabindex="-1"></a>dat_f <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y,x,fo,fu)</span></code></pre></div>
<p>With factors, you can still include them in the design matrix of an OLS regression
<span class="math display">\[
y_{it} = x_{it} \beta_{x} + d_{c}\beta_{c}
\]</span>
When, as commonly done, the factors are modeled as being additively seperable, they are modelled as either “fixed” or “random” effects.</p>
<p>Simply including the factors into the OLS regression yields a “dummy variable” fixed effects estimator.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="ordinary-least-squares.html#cb154-1" aria-hidden="true" tabindex="-1"></a>fe_reg0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span>fo<span class="sc">+</span>fu, dat_f)</span>
<span id="cb154-2"><a href="ordinary-least-squares.html#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fe_reg0)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + fo + fu, data = dat_f)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -35.808  -5.471  -0.114   5.791  41.652 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  20.9843     1.1676  17.973  &lt; 2e-16 ***
## x             1.0056     0.1932   5.205 2.35e-07 ***
## fo.L         28.6990     1.0535  27.242  &lt; 2e-16 ***
## fo.Q         12.1229     0.9227  13.139  &lt; 2e-16 ***
## fo.C          2.7619     0.7213   3.829 0.000137 ***
## fo^4          0.9292     0.5390   1.724 0.085030 .  
## fuB         -22.6951     0.5626 -40.339  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.877 on 993 degrees of freedom
## Multiple R-squared:  0.7331, Adjusted R-squared:  0.7315 
## F-statistic: 454.5 on 6 and 993 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We can also compute averages for each group and construct a “between estimator”
<span class="math display">\[
\overline{y}_i = \alpha + \overline{x}_i \beta
\]</span>
Or we can subtract the average from each group to construct a “within estimator”,
<span class="math display">\[
(y_{it} - \overline{y}_i) = (x_{it}-\overline{x}_i)\beta\\
\]</span>
that tends to be more computationally efficient, has corrections for standard errors, and has additional summary statistics.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="ordinary-least-squares.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb156-2"><a href="ordinary-least-squares.html#cb156-2" aria-hidden="true" tabindex="-1"></a>fe_reg1 <span class="ot">&lt;-</span> <span class="fu">feols</span>(y<span class="sc">~</span>x<span class="sc">|</span>fo<span class="sc">+</span>fu, dat_f)</span>
<span id="cb156-3"><a href="ordinary-least-squares.html#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fe_reg1)</span></code></pre></div>
<pre><code>## OLS estimation, Dep. Var.: y
## Observations: 1,000 
## Fixed-effects: fo: 5,  fu: 2
## Standard-errors: Clustered (fo) 
##   Estimate Std. Error t value Pr(&gt;|t|)    
## x  1.00556   0.342108 2.93931 0.042418 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## RMSE: 8.84557     Adj. R2: 0.731451
##                 Within R2: 0.026562</code></pre>
<p><strong>Hansen Econometrics, Theorem 17.1:</strong> The fixed effects estimator of <span class="math inline">\(\beta\)</span> algebraically equals the dummy
variable estimator of <span class="math inline">\(\beta\)</span>. The two estimators have the same residuals.
<!--
In fact, if the fixed effect is ``fully unstructured then the only way to consistently estimate the coefficient $\beta$ is by an estimator which is invariant'' (Hansen Econometrics, p). 
--></p>
<p>Consistency is a great property, but only if the data generating process does in fact match the model. Many factor variables have effects that are not additively seperable.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="ordinary-least-squares.html#cb158-1" aria-hidden="true" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">feols</span>(y<span class="sc">~</span>x<span class="sc">|</span>fo<span class="sc">^</span>fu, dat_f)</span>
<span id="cb158-2"><a href="ordinary-least-squares.html#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg1)</span></code></pre></div>
<pre><code>## OLS estimation, Dep. Var.: y
## Observations: 1,000 
## Fixed-effects: fo^fu: 10
## Standard-errors: Clustered (fo^fu) 
##   Estimate Std. Error t value Pr(&gt;|t|)    
## x  1.09143   0.546591 1.99679  0.07695 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## RMSE: 3.51458     Adj. R2: 0.957433
##                 Within R2: 0.169022</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="ordinary-least-squares.html#cb160-1" aria-hidden="true" tabindex="-1"></a>reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">*</span>fo<span class="sc">*</span>fu, dat_f)</span>
<span id="cb160-2"><a href="ordinary-least-squares.html#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x * fo * fu, data = dat_f)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -8.485 -1.554 -0.011  1.478  9.891 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  13.4358     0.5936  22.633  &lt; 2e-16 ***
## x             2.7875     0.1037  26.877  &lt; 2e-16 ***
## fo.L         24.0508     1.6863  14.262  &lt; 2e-16 ***
## fo.Q          7.7904     1.4838   5.250 1.86e-07 ***
## fo.C          0.5784     1.1237   0.515 0.606871    
## fo^4         -0.6427     0.8600  -0.747 0.455053    
## fuB         -12.6559     0.8675 -14.589  &lt; 2e-16 ***
## x:fo.L        5.2906     0.2942  17.980  &lt; 2e-16 ***
## x:fo.Q        2.2462     0.2594   8.661  &lt; 2e-16 ***
## x:fo.C        0.7006     0.1959   3.576 0.000366 ***
## x:fo^4        0.2078     0.1513   1.373 0.169951    
## x:fuB        -2.9228     0.1488 -19.649  &lt; 2e-16 ***
## fo.L:fuB    -22.3283     2.4676  -9.049  &lt; 2e-16 ***
## fo.Q:fuB     -6.2700     2.1546  -2.910 0.003696 ** 
## fo.C:fuB     -0.1373     1.6750  -0.082 0.934707    
## fo^4:fuB      1.6039     1.2308   1.303 0.192814    
## x:fo.L:fuB   -5.5921     0.4212 -13.275  &lt; 2e-16 ***
## x:fo.Q:fuB   -2.4679     0.3688  -6.691 3.72e-11 ***
## x:fo.C:fuB   -0.7609     0.2879  -2.643 0.008341 ** 
## x:fo^4:fuB   -0.3485     0.2149  -1.622 0.105143    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.551 on 980 degrees of freedom
## Multiple R-squared:  0.9782, Adjusted R-squared:  0.9778 
## F-statistic:  2318 on 19 and 980 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="ordinary-least-squares.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reg2 &lt;- feols(y~x*fo*fu|fo^fu, dat_f)</span></span></code></pre></div>
<p>With <em>Random Effects</em>, the factor variable is modelled as coming from a distribution that is uncorrelated with the regressors. This is rarely used in economics today, and mostly included for historical reasons and a few cases where fixed effects cannot be estimates.</p>
<!-- 
> The labels "random effects" and "fixed effects" are misleading. These are labels which arose in the early literature and we are stuck with these labels today. In a previous era regressors were viewed as "fixed". Viewing the individual effect as an unobserved regressor leads to the label of the individual effect as "fixed". Today, we rarely refer to regressors as "fixed" when dealing with observational data. We view all variables as random. Consequently describing u i as "fixed" does not make much sense and it is hardly a contrast with the "random effect" label since under either assumption u i is treated as random. Once again, the labels are unfortunate but the key difference is whether u i is correlated with the regressors.
-->
</div>
<div id="more-literature" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> More Literature<a href="ordinary-least-squares.html#more-literature" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For OLS, see</p>
<ul>
<li><a href="https://bookdown.org/josiesmith/qrmbook/linear-estimation-and-minimizing-error.html" class="uri">https://bookdown.org/josiesmith/qrmbook/linear-estimation-and-minimizing-error.html</a></li>
<li><a href="https://www.econometrics-with-r.org/4-lrwor.html" class="uri">https://www.econometrics-with-r.org/4-lrwor.html</a></li>
<li><a href="https://www.econometrics-with-r.org/6-rmwmr.html" class="uri">https://www.econometrics-with-r.org/6-rmwmr.html</a></li>
<li><a href="https://www.econometrics-with-r.org/7-htaciimr.html" class="uri">https://www.econometrics-with-r.org/7-htaciimr.html</a></li>
<li><a href="https://bookdown.org/ripberjt/labbook/bivariate-linear-regression.html" class="uri">https://bookdown.org/ripberjt/labbook/bivariate-linear-regression.html</a></li>
<li><a href="https://bookdown.org/ripberjt/labbook/multivariable-linear-regression.html" class="uri">https://bookdown.org/ripberjt/labbook/multivariable-linear-regression.html</a></li>
<li><a href="https://online.stat.psu.edu/stat462/node/137/" class="uri">https://online.stat.psu.edu/stat462/node/137/</a></li>
<li><a href="https://book.stat420.org/" class="uri">https://book.stat420.org/</a></li>
<li>Hill, Griffiths &amp; Lim (2007), Principles of Econometrics, 3rd ed., Wiley, S. 86f.</li>
<li>Verbeek (2004), A Guide to Modern Econometrics, 2nd ed., Wiley, S. 51ff.</li>
<li>Asteriou &amp; Hall (2011), Applied Econometrics, 2nd ed., Palgrave MacMillan, S. 177ff.</li>
<li><a href="https://online.stat.psu.edu/stat485/lesson/11/" class="uri">https://online.stat.psu.edu/stat485/lesson/11/</a></li>
</ul>
<p>For fixed effects, see</p>
<ul>
<li><a href="https://www.econometrics-with-r.org/10-rwpd.html" class="uri">https://www.econometrics-with-r.org/10-rwpd.html</a></li>
<li><a href="https://bookdown.org/josiesmith/qrmbook/topics-in-multiple-regression.html" class="uri">https://bookdown.org/josiesmith/qrmbook/topics-in-multiple-regression.html</a></li>
<li><a href="https://bookdown.org/ripberjt/labbook/multivariable-linear-regression.html" class="uri">https://bookdown.org/ripberjt/labbook/multivariable-linear-regression.html</a></li>
<li><a href="https://www.princeton.edu/~otorres/Panel101.pdf" class="uri">https://www.princeton.edu/~otorres/Panel101.pdf</a></li>
<li><a href="https://www.stata.com/manuals13/xtxtreg.pdf" class="uri">https://www.stata.com/manuals13/xtxtreg.pdf</a></li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="moving-beyond-the-basics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ols-diagnostics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["index.pdf", "index.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
