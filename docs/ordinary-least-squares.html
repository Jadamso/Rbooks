<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 7 Ordinary Least Squares | index</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content=" 7 Ordinary Least Squares | index" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 7 Ordinary Least Squares | index" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="beyond-basics.html"/>
<link rel="next" href="ols-diagnostics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6.9000/profvis.js"></script>
<script src="libs/profvis-0.3.6.9000/scroll.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.8/profvis.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Primers</a></li>
<li class="toc-logo"><a href="./"><img src="Figures_Manual/Logo.png" width="140" height="100"></a></li>        

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="part"><span><b>I Programming in R</b></span></li>
<li class="chapter" data-level="2" data-path="first-steps.html"><a href="first-steps.html"><i class="fa fa-check"></i><b>2</b> First Steps</a>
<ul>
<li class="chapter" data-level="2.1" data-path="first-steps.html"><a href="first-steps.html#why-r"><i class="fa fa-check"></i><b>2.1</b> Why R</a></li>
<li class="chapter" data-level="2.2" data-path="first-steps.html"><a href="first-steps.html#install-r"><i class="fa fa-check"></i><b>2.2</b> Install R</a></li>
<li class="chapter" data-level="2.3" data-path="first-steps.html"><a href="first-steps.html#interfacing-with-r"><i class="fa fa-check"></i><b>2.3</b> Interfacing with R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>3</b> Mathematics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mathematics.html"><a href="mathematics.html#scalars"><i class="fa fa-check"></i><b>3.1</b> Scalars</a></li>
<li class="chapter" data-level="3.2" data-path="mathematics.html"><a href="mathematics.html#vectors"><i class="fa fa-check"></i><b>3.2</b> Vectors</a></li>
<li class="chapter" data-level="3.3" data-path="mathematics.html"><a href="mathematics.html#functions"><i class="fa fa-check"></i><b>3.3</b> Functions</a></li>
<li class="chapter" data-level="3.4" data-path="mathematics.html"><a href="mathematics.html#matrices"><i class="fa fa-check"></i><b>3.4</b> Matrices</a></li>
<li class="chapter" data-level="3.5" data-path="mathematics.html"><a href="mathematics.html#arrays"><i class="fa fa-check"></i><b>3.5</b> Arrays</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>4</b> Statistics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="statistics.html"><a href="statistics.html#random-variables"><i class="fa fa-check"></i><b>4.1</b> Random Variables</a></li>
<li class="chapter" data-level="4.2" data-path="statistics.html"><a href="statistics.html#functions-of-data"><i class="fa fa-check"></i><b>4.2</b> Functions of Data</a></li>
<li class="chapter" data-level="4.3" data-path="statistics.html"><a href="statistics.html#further-reading"><i class="fa fa-check"></i><b>4.3</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>5</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-analysis.html"><a href="data-analysis.html#data"><i class="fa fa-check"></i><b>5.1</b> Data</a></li>
<li class="chapter" data-level="5.2" data-path="data-analysis.html"><a href="data-analysis.html#plots"><i class="fa fa-check"></i><b>5.2</b> Plots</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="data-analysis.html"><a href="data-analysis.html#histograms"><i class="fa fa-check"></i><b>5.2.1</b> Histograms</a></li>
<li class="chapter" data-level="5.2.2" data-path="data-analysis.html"><a href="data-analysis.html#boxplots"><i class="fa fa-check"></i><b>5.2.2</b> Boxplots</a></li>
<li class="chapter" data-level="5.2.3" data-path="data-analysis.html"><a href="data-analysis.html#scatterplots"><i class="fa fa-check"></i><b>5.2.3</b> Scatterplots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="beyond-basics.html"><a href="beyond-basics.html"><i class="fa fa-check"></i><b>6</b> Beyond Basics</a>
<ul>
<li class="chapter" data-level="6.1" data-path="beyond-basics.html"><a href="beyond-basics.html#introductions-to-r"><i class="fa fa-check"></i><b>6.1</b> Introductions to R</a></li>
<li class="chapter" data-level="6.2" data-path="beyond-basics.html"><a href="beyond-basics.html#the-r-ecosystem"><i class="fa fa-check"></i><b>6.2</b> The R Ecosystem</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="beyond-basics.html"><a href="beyond-basics.html#packages"><i class="fa fa-check"></i><b>6.2.1</b> Packages</a></li>
<li class="chapter" data-level="6.2.2" data-path="beyond-basics.html"><a href="beyond-basics.html#task-views"><i class="fa fa-check"></i><b>6.2.2</b> Task Views</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="beyond-basics.html"><a href="beyond-basics.html#custom-figures"><i class="fa fa-check"></i><b>6.3</b> Custom figures</a></li>
</ul></li>
<li class="part"><span><b>II Linear Regression in R</b></span></li>
<li class="chapter" data-level="7" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html"><i class="fa fa-check"></i><b>7</b> Ordinary Least Squares</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#simple-ols-linear-regression"><i class="fa fa-check"></i><b>7.1</b> Simple OLS (linear regression)</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#variability-estimates"><i class="fa fa-check"></i><b>7.1.1</b> Variability Estimates</a></li>
<li class="chapter" data-level="7.1.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#hypothesis-tests"><i class="fa fa-check"></i><b>7.1.2</b> Hypothesis Tests</a></li>
<li class="chapter" data-level="7.1.3" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#prediction-intervals"><i class="fa fa-check"></i><b>7.1.3</b> Prediction Intervals</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#ols-multiple-linear-regression"><i class="fa fa-check"></i><b>7.2</b> OLS (multiple linear regression)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#variability-estimates-and-hypothesis-tests"><i class="fa fa-check"></i><b>7.2.1</b> Variability Estimates and Hypothesis Tests</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#coefficient-interpretation"><i class="fa fa-check"></i><b>7.3</b> Coefficient Interpretation</a></li>
<li class="chapter" data-level="7.4" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#factor-variables"><i class="fa fa-check"></i><b>7.4</b> Factor Variables</a></li>
<li class="chapter" data-level="7.5" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#more-literature"><i class="fa fa-check"></i><b>7.5</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html"><i class="fa fa-check"></i><b>8</b> OLS Diagnostics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#outliers"><i class="fa fa-check"></i><b>8.1</b> Outliers</a></li>
<li class="chapter" data-level="8.2" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#normality"><i class="fa fa-check"></i><b>8.2</b> Normality</a></li>
<li class="chapter" data-level="8.3" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#collinearity"><i class="fa fa-check"></i><b>8.3</b> Collinearity</a></li>
<li class="chapter" data-level="8.4" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#linear-in-parameters"><i class="fa fa-check"></i><b>8.4</b> Linear in Parameters</a></li>
<li class="chapter" data-level="8.5" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#more-literature-1"><i class="fa fa-check"></i><b>8.5</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="endogeneity-issues.html"><a href="endogeneity-issues.html"><i class="fa fa-check"></i><b>9</b> Endogeneity Issues</a>
<ul>
<li class="chapter" data-level="9.1" data-path="endogeneity-issues.html"><a href="endogeneity-issues.html#two-stage-least-squares-2sls"><i class="fa fa-check"></i><b>9.1</b> Two Stage Least Squares (2SLS)</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="endogeneity-issues.html"><a href="endogeneity-issues.html#competitive-market-equilibrium"><i class="fa fa-check"></i><b>9.1.1</b> Competitive Market Equilibrium</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="endogeneity-issues.html"><a href="endogeneity-issues.html#regression-discontinuitieskink-rdrk"><i class="fa fa-check"></i><b>9.2</b> Regression Discontinuities/Kink (RD/RK)</a></li>
<li class="chapter" data-level="9.3" data-path="endogeneity-issues.html"><a href="endogeneity-issues.html#difference-in-differences-did"><i class="fa fa-check"></i><b>9.3</b> Difference in Differences (DID)</a></li>
<li class="chapter" data-level="9.4" data-path="endogeneity-issues.html"><a href="endogeneity-issues.html#more-literature-2"><i class="fa fa-check"></i><b>9.4</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-scientism.html"><a href="data-scientism.html"><i class="fa fa-check"></i><b>10</b> Data Scientism</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-scientism.html"><a href="data-scientism.html#the-age-of-big-data"><i class="fa fa-check"></i><b>10.1</b> The age of big data</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="data-scientism.html"><a href="data-scientism.html#randomly-spurious-correlation"><i class="fa fa-check"></i><b>10.1.1</b> Randomly (Spurious Correlation)</a></li>
<li class="chapter" data-level="10.1.2" data-path="data-scientism.html"><a href="data-scientism.html#programming-errors"><i class="fa fa-check"></i><b>10.1.2</b> Programming Errors</a></li>
<li class="chapter" data-level="10.1.3" data-path="data-scientism.html"><a href="data-scientism.html#p-hacking"><i class="fa fa-check"></i><b>10.1.3</b> P-Hacking</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="data-scientism.html"><a href="data-scientism.html#random-causal-impacts"><i class="fa fa-check"></i><b>10.2</b> Random Causal Impacts</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="data-scientism.html"><a href="data-scientism.html#iv"><i class="fa fa-check"></i><b>10.2.1</b> IV</a></li>
<li class="chapter" data-level="10.2.2" data-path="data-scientism.html"><a href="data-scientism.html#rdd"><i class="fa fa-check"></i><b>10.2.2</b> RDD</a></li>
<li class="chapter" data-level="10.2.3" data-path="data-scientism.html"><a href="data-scientism.html#did"><i class="fa fa-check"></i><b>10.2.3</b> DID</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Reproducible Research in R</b></span></li>
<li class="chapter" data-level="11" data-path="why.html"><a href="why.html"><i class="fa fa-check"></i><b>11</b> Why?</a>
<ul>
<li class="chapter" data-level="11.1" data-path="why.html"><a href="why.html#an-example-workflow"><i class="fa fa-check"></i><b>11.1</b> An example workflow</a></li>
<li class="chapter" data-level="11.2" data-path="why.html"><a href="why.html#an-alternative-workflow"><i class="fa fa-check"></i><b>11.2</b> An alternative workflow</a></li>
<li class="chapter" data-level="11.3" data-path="why.html"><a href="why.html#r-and-r-markdown"><i class="fa fa-check"></i><b>11.3</b> R and R-Markdown</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="small-projects.html"><a href="small-projects.html"><i class="fa fa-check"></i><b>12</b> Small Projects</a>
<ul>
<li class="chapter" data-level="12.1" data-path="small-projects.html"><a href="small-projects.html#an-r-code-chunk"><i class="fa fa-check"></i><b>12.1</b> An R Code Chunk</a></li>
<li class="chapter" data-level="12.2" data-path="small-projects.html"><a href="small-projects.html#an-r-markdown-document"><i class="fa fa-check"></i><b>12.2</b> An R Markdown Document</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="small-projects.html"><a href="small-projects.html#copypaste-example"><i class="fa fa-check"></i><b>12.2.1</b> Copy/Paste Example</a></li>
<li class="chapter" data-level="12.2.2" data-path="small-projects.html"><a href="small-projects.html#a-homework-example"><i class="fa fa-check"></i><b>12.2.2</b> A Homework Example</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="small-projects.html"><a href="small-projects.html#posters-and-slides"><i class="fa fa-check"></i><b>12.3</b> Posters and Slides</a></li>
<li class="chapter" data-level="12.4" data-path="small-projects.html"><a href="small-projects.html#getting-help-w-r-markdown"><i class="fa fa-check"></i><b>12.4</b> Getting help w/ R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="large-projects.html"><a href="large-projects.html"><i class="fa fa-check"></i><b>13</b> Large Projects</a>
<ul>
<li class="chapter" data-level="13.1" data-path="large-projects.html"><a href="large-projects.html#makefile"><i class="fa fa-check"></i><b>13.1</b> MAKEFILE</a></li>
<li class="chapter" data-level="13.2" data-path="large-projects.html"><a href="large-projects.html#loggingsinking"><i class="fa fa-check"></i><b>13.2</b> Logging/Sinking</a></li>
<li class="chapter" data-level="13.3" data-path="large-projects.html"><a href="large-projects.html#class-projects"><i class="fa fa-check"></i><b>13.3</b> Class Projects</a></li>
<li class="chapter" data-level="13.4" data-path="large-projects.html"><a href="large-projects.html#debugging"><i class="fa fa-check"></i><b>13.4</b> Debugging</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="large-projects.html"><a href="large-projects.html#tracing-errors"><i class="fa fa-check"></i><b>13.4.1</b> Tracing Errors</a></li>
<li class="chapter" data-level="13.4.2" data-path="large-projects.html"><a href="large-projects.html#checking-problems"><i class="fa fa-check"></i><b>13.4.2</b> Checking problems</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="large-projects.html"><a href="large-projects.html#being-proactive"><i class="fa fa-check"></i><b>13.5</b> Being Proactive</a></li>
<li class="chapter" data-level="13.6" data-path="large-projects.html"><a href="large-projects.html#optimizing"><i class="fa fa-check"></i><b>13.6</b> Optimizing</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="large-projects.html"><a href="large-projects.html#benchmarking"><i class="fa fa-check"></i><b>13.6.1</b> Benchmarking</a></li>
<li class="chapter" data-level="13.6.2" data-path="large-projects.html"><a href="large-projects.html#bottlenecks"><i class="fa fa-check"></i><b>13.6.2</b> Bottlenecks</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="large-projects.html"><a href="large-projects.html#advanced-programming"><i class="fa fa-check"></i><b>13.7</b> Advanced Programming</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>14</b> Shiny</a>
<ul>
<li class="chapter" data-level="14.0.1" data-path="shiny.html"><a href="shiny.html#programming-guidance"><i class="fa fa-check"></i><b>14.0.1</b> Programming Guidance</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i><b>15</b> Software</a>
<ul>
<li class="chapter" data-level="15.1" data-path="software.html"><a href="software.html#latest-versions"><i class="fa fa-check"></i><b>15.1</b> Latest versions</a></li>
<li class="chapter" data-level="15.2" data-path="software.html"><a href="software.html#stata"><i class="fa fa-check"></i><b>15.2</b> Stata</a></li>
<li class="chapter" data-level="15.3" data-path="software.html"><a href="software.html#general-workflow"><i class="fa fa-check"></i><b>15.3</b> General Workflow</a></li>
<li class="chapter" data-level="15.4" data-path="software.html"><a href="software.html#sweave"><i class="fa fa-check"></i><b>15.4</b> Sweave</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://sites.google.com/view/jordan-adamson" target="blank">Jordan Adamson</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ordinary-least-squares" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number"> 7</span> Ordinary Least Squares<a href="ordinary-least-squares.html#ordinary-least-squares" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<hr />
<div id="simple-ols-linear-regression" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Simple OLS (linear regression)<a href="ordinary-least-squares.html#simple-ols-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Model and objective
<span class="math display">\[
y_i=\alpha+\beta x_i+\epsilon_{i} \\
\epsilon_{i} = y_i - [\alpha+\beta x_i]\\
min_{\beta} \sum_{i=1}^{n} (\epsilon_{i})^2
\]</span></p>
<p>Point Estimates
<span class="math display">\[
\hat{\alpha}=\bar{y}-\hat{\beta}\bar{x} = \widehat{\mathbb{E}}[Y] - \hat{\beta} \widehat{\mathbb{E}}[X] \\
\hat{\beta}=\frac{\sum_{i}^{}(x_i-\bar{x})(y_i-\bar{y})}{\sum_{i}^{}(x_i-\bar{x})^2} = \frac{\widehat{Cov}[X,Y]}{\widehat{\mathbb{V}}[X]}\\
\hat{y}_i=\hat{\alpha}+\hat{\beta}x_i\\
\hat{\epsilon}_i=y_i-\hat{y}_i\\
\]</span></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="ordinary-least-squares.html#cb184-1" tabindex="-1"></a><span class="do">## Generate Dataset</span></span>
<span id="cb184-2"><a href="ordinary-least-squares.html#cb184-2" tabindex="-1"></a>xy <span class="ot">&lt;-</span> USArrests[,<span class="fu">c</span>(<span class="st">&#39;Murder&#39;</span>,<span class="st">&#39;UrbanPop&#39;</span>)]</span>
<span id="cb184-3"><a href="ordinary-least-squares.html#cb184-3" tabindex="-1"></a><span class="fu">colnames</span>(xy) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;y&#39;</span>,<span class="st">&#39;x&#39;</span>)</span>
<span id="cb184-4"><a href="ordinary-least-squares.html#cb184-4" tabindex="-1"></a></span>
<span id="cb184-5"><a href="ordinary-least-squares.html#cb184-5" tabindex="-1"></a><span class="do">## Plot Data</span></span>
<span id="cb184-6"><a href="ordinary-least-squares.html#cb184-6" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x, xy, <span class="at">col=</span><span class="fu">grey</span>(.<span class="dv">5</span>,.<span class="dv">5</span>), <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb184-7"><a href="ordinary-least-squares.html#cb184-7" tabindex="-1"></a></span>
<span id="cb184-8"><a href="ordinary-least-squares.html#cb184-8" tabindex="-1"></a><span class="do">## Estimate Regression Coefficeints</span></span>
<span id="cb184-9"><a href="ordinary-least-squares.html#cb184-9" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">dat=</span>xy)</span>
<span id="cb184-10"><a href="ordinary-least-squares.html#cb184-10" tabindex="-1"></a>reg </span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = xy)
## 
## Coefficients:
## (Intercept)            x  
##     6.41594      0.02093</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="ordinary-least-squares.html#cb186-1" tabindex="-1"></a><span class="do">## Point Estimates</span></span>
<span id="cb186-2"><a href="ordinary-least-squares.html#cb186-2" tabindex="-1"></a><span class="fu">coef</span>(reg)</span></code></pre></div>
<pre><code>## (Intercept)           x 
##  6.41594246  0.02093466</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="ordinary-least-squares.html#cb188-1" tabindex="-1"></a><span class="do">## Add Predictions to Plot</span></span>
<span id="cb188-2"><a href="ordinary-least-squares.html#cb188-2" tabindex="-1"></a><span class="fu">abline</span>(reg, <span class="at">col=</span><span class="st">&#39;orange&#39;</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>To measure the ‘’Goodness of fit’’, we analyze sums of squared errors (Total, Explained, and Residual) as
<span class="math display">\[
\underbrace{\sum_{i}(y_i-\bar{y})^2}_\text{TSS}=\underbrace{\sum_{i}(\hat{y}_i-\bar{y})^2}_\text{ESS}+\underbrace{\sum_{i}\hat{\epsilon_{i}}^2}_\text{RSS}\\
R^2 = \frac{ESS}{TSS}=1-\frac{RSS}{TSS}
\]</span>
Note that <span class="math inline">\(R^2\)</span> is also called the coefficient of determination.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="ordinary-least-squares.html#cb189-1" tabindex="-1"></a><span class="do">## Manually Compute Goodness of Fit</span></span>
<span id="cb189-2"><a href="ordinary-least-squares.html#cb189-2" tabindex="-1"></a>Ehat <span class="ot">&lt;-</span> <span class="fu">resid</span>(reg)</span>
<span id="cb189-3"><a href="ordinary-least-squares.html#cb189-3" tabindex="-1"></a>RSS  <span class="ot">&lt;-</span> <span class="fu">sum</span>(Ehat<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb189-4"><a href="ordinary-least-squares.html#cb189-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> xy<span class="sc">$</span>y</span>
<span id="cb189-5"><a href="ordinary-least-squares.html#cb189-5" tabindex="-1"></a>TSS  <span class="ot">&lt;-</span> <span class="fu">sum</span>((Y<span class="sc">-</span><span class="fu">mean</span>(Y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb189-6"><a href="ordinary-least-squares.html#cb189-6" tabindex="-1"></a>R2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> RSS<span class="sc">/</span>TSS</span>
<span id="cb189-7"><a href="ordinary-least-squares.html#cb189-7" tabindex="-1"></a>R2</span></code></pre></div>
<pre><code>## [1] 0.00484035</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="ordinary-least-squares.html#cb191-1" tabindex="-1"></a><span class="do">## Check R2</span></span>
<span id="cb191-2"><a href="ordinary-least-squares.html#cb191-2" tabindex="-1"></a><span class="fu">summary</span>(reg)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.00484035</code></pre>
<div id="variability-estimates" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Variability Estimates<a href="ordinary-least-squares.html#variability-estimates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A regression coefficient is a statistic. And, just like all statistics, we can calculate</p>
<ul>
<li><em>standard deviation</em>: variability within a single sample.</li>
<li><em>standard error</em>: variability across different samples.</li>
<li><em>confidence interval:</em> range your statistic varies across different samples.</li>
<li><em>null distribution</em>: the sampling distribution of the statistic under the null hypothesis (assuming your null hypothesis was true).</li>
<li><em>p-value</em> the probability you would see something as extreme as your statistic when sampling from the null distribution.</li>
</ul>
<p>To calculate these variability statistics, we will estimate variabilty using <em>data-driven</em> methods.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>We first consider the simplest, the jackknife. In this procedure, we loop through each row of the dataset. And, in each iteration of the loop, we drop that observation from the dataset and reestimate the statistic of interest. We then calculate the standard deviation of the statistic across all ``resamples’’.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="ordinary-least-squares.html#cb193-1" tabindex="-1"></a><span class="do">## Example 1 Continued</span></span>
<span id="cb193-2"><a href="ordinary-least-squares.html#cb193-2" tabindex="-1"></a></span>
<span id="cb193-3"><a href="ordinary-least-squares.html#cb193-3" tabindex="-1"></a><span class="do">## Jackknife Standard Errors for Beta</span></span>
<span id="cb193-4"><a href="ordinary-least-squares.html#cb193-4" tabindex="-1"></a>jack_regs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(xy), <span class="cf">function</span>(i){</span>
<span id="cb193-5"><a href="ordinary-least-squares.html#cb193-5" tabindex="-1"></a>    xy_i <span class="ot">&lt;-</span> xy[<span class="sc">-</span>i,]</span>
<span id="cb193-6"><a href="ordinary-least-squares.html#cb193-6" tabindex="-1"></a>    reg_i <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">dat=</span>xy_i)</span>
<span id="cb193-7"><a href="ordinary-least-squares.html#cb193-7" tabindex="-1"></a>})</span>
<span id="cb193-8"><a href="ordinary-least-squares.html#cb193-8" tabindex="-1"></a>jack_coefs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(jack_regs, coef)[<span class="st">&#39;x&#39;</span>,]</span>
<span id="cb193-9"><a href="ordinary-least-squares.html#cb193-9" tabindex="-1"></a>jack_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(jack_coefs)</span>
<span id="cb193-10"><a href="ordinary-least-squares.html#cb193-10" tabindex="-1"></a>jack_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(jack_coefs)</span>
<span id="cb193-11"><a href="ordinary-least-squares.html#cb193-11" tabindex="-1"></a></span>
<span id="cb193-12"><a href="ordinary-least-squares.html#cb193-12" tabindex="-1"></a><span class="do">## Jackknife Confidence Intervals</span></span>
<span id="cb193-13"><a href="ordinary-least-squares.html#cb193-13" tabindex="-1"></a>jack_ci_percentile <span class="ot">&lt;-</span> <span class="fu">quantile</span>(jack_coefs, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>))</span>
<span id="cb193-14"><a href="ordinary-least-squares.html#cb193-14" tabindex="-1"></a><span class="fu">hist</span>(jack_coefs, <span class="at">breaks=</span><span class="dv">25</span>,</span>
<span id="cb193-15"><a href="ordinary-least-squares.html#cb193-15" tabindex="-1"></a>    <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&#39;SE est. = &#39;</span>, <span class="fu">round</span>(jack_se,<span class="dv">4</span>)),</span>
<span id="cb193-16"><a href="ordinary-least-squares.html#cb193-16" tabindex="-1"></a>    <span class="at">xlab=</span><span class="fu">expression</span>(beta[<span class="sc">-</span>i]))</span>
<span id="cb193-17"><a href="ordinary-least-squares.html#cb193-17" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>jack_mean, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb193-18"><a href="ordinary-least-squares.html#cb193-18" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>jack_ci_percentile, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="ordinary-least-squares.html#cb194-1" tabindex="-1"></a><span class="do">## Plot Full-Sample Estimate</span></span>
<span id="cb194-2"><a href="ordinary-least-squares.html#cb194-2" tabindex="-1"></a><span class="do">## abline(v=coef(reg)[&#39;x&#39;], lty=1, col=&#39;blue&#39;, lwd=2)</span></span>
<span id="cb194-3"><a href="ordinary-least-squares.html#cb194-3" tabindex="-1"></a></span>
<span id="cb194-4"><a href="ordinary-least-squares.html#cb194-4" tabindex="-1"></a><span class="do">## Plot Normal Approximation</span></span>
<span id="cb194-5"><a href="ordinary-least-squares.html#cb194-5" tabindex="-1"></a><span class="do">## jack_ci_normal &lt;- jack_mean+c(-1.96, +1.96)*jack_se</span></span>
<span id="cb194-6"><a href="ordinary-least-squares.html#cb194-6" tabindex="-1"></a><span class="do">## abline(v=jack_ci_normal, col=&quot;red&quot;, lty=3)</span></span></code></pre></div>
<p>There are several other resampling techniques. We consider the other main one, the bootstrap, which resamples with <em>replacement</em> for an <em>arbitrary</em> number of iterations. When bootstrapping a dataset with <span class="math inline">\(n\)</span> observations, you randomly resample all <span class="math inline">\(n\)</span> rows in your data set <span class="math inline">\(B\)</span> times.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>Sample Size per Iteration</th>
<th>Number of Iterations</th>
<th>Resample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bootstrap</td>
<td><span class="math inline">\(n\)</span></td>
<td><span class="math inline">\(B\)</span></td>
<td>With Replacement</td>
</tr>
<tr class="even">
<td>Jackknife</td>
<td><span class="math inline">\(n-1\)</span></td>
<td><span class="math inline">\(n\)</span></td>
<td>Without Replacement</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="ordinary-least-squares.html#cb195-1" tabindex="-1"></a><span class="do">## Bootstrap Standard Errors for Beta</span></span>
<span id="cb195-2"><a href="ordinary-least-squares.html#cb195-2" tabindex="-1"></a>boots <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">399</span></span>
<span id="cb195-3"><a href="ordinary-least-squares.html#cb195-3" tabindex="-1"></a>boot_regs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(boots, <span class="cf">function</span>(b){</span>
<span id="cb195-4"><a href="ordinary-least-squares.html#cb195-4" tabindex="-1"></a>    b_id <span class="ot">&lt;-</span> <span class="fu">sample</span>( <span class="fu">nrow</span>(xy), <span class="at">replace=</span>T)</span>
<span id="cb195-5"><a href="ordinary-least-squares.html#cb195-5" tabindex="-1"></a>    xy_b <span class="ot">&lt;-</span> xy[b_id,]</span>
<span id="cb195-6"><a href="ordinary-least-squares.html#cb195-6" tabindex="-1"></a>    reg_b <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">dat=</span>xy_b)</span>
<span id="cb195-7"><a href="ordinary-least-squares.html#cb195-7" tabindex="-1"></a>})</span>
<span id="cb195-8"><a href="ordinary-least-squares.html#cb195-8" tabindex="-1"></a>boot_coefs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(boot_regs, coef)[<span class="st">&#39;x&#39;</span>,]</span>
<span id="cb195-9"><a href="ordinary-least-squares.html#cb195-9" tabindex="-1"></a>boot_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_coefs)</span>
<span id="cb195-10"><a href="ordinary-least-squares.html#cb195-10" tabindex="-1"></a>boot_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(boot_coefs)</span>
<span id="cb195-11"><a href="ordinary-least-squares.html#cb195-11" tabindex="-1"></a></span>
<span id="cb195-12"><a href="ordinary-least-squares.html#cb195-12" tabindex="-1"></a><span class="do">## Bootstrap Confidence Intervals</span></span>
<span id="cb195-13"><a href="ordinary-least-squares.html#cb195-13" tabindex="-1"></a>boot_ci_percentile <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_coefs, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>))</span>
<span id="cb195-14"><a href="ordinary-least-squares.html#cb195-14" tabindex="-1"></a><span class="fu">hist</span>(boot_coefs, <span class="at">breaks=</span><span class="dv">25</span>,</span>
<span id="cb195-15"><a href="ordinary-least-squares.html#cb195-15" tabindex="-1"></a>    <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&#39;SE est. = &#39;</span>, <span class="fu">round</span>(boot_se,<span class="dv">4</span>)),</span>
<span id="cb195-16"><a href="ordinary-least-squares.html#cb195-16" tabindex="-1"></a>    <span class="at">xlab=</span><span class="fu">expression</span>(beta[b]))</span>
<span id="cb195-17"><a href="ordinary-least-squares.html#cb195-17" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>boot_mean, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb195-18"><a href="ordinary-least-squares.html#cb195-18" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>boot_ci_percentile, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="ordinary-least-squares.html#cb196-1" tabindex="-1"></a><span class="do">## Normal Approximation</span></span>
<span id="cb196-2"><a href="ordinary-least-squares.html#cb196-2" tabindex="-1"></a><span class="do">## boot_ci_normal &lt;- boot_mean+c(-1.96, +1.96)*boot</span></span>
<span id="cb196-3"><a href="ordinary-least-squares.html#cb196-3" tabindex="-1"></a></span>
<span id="cb196-4"><a href="ordinary-least-squares.html#cb196-4" tabindex="-1"></a><span class="do">## Parametric CI</span></span>
<span id="cb196-5"><a href="ordinary-least-squares.html#cb196-5" tabindex="-1"></a><span class="do">## x &lt;- data.frame(x=quantile(xy$x,probs=seq(0,1,by=.1)))</span></span>
<span id="cb196-6"><a href="ordinary-least-squares.html#cb196-6" tabindex="-1"></a><span class="do">## ci &lt;- predict(reg, interval=&#39;confidence&#39;, newdata=data.frame(x))</span></span>
<span id="cb196-7"><a href="ordinary-least-squares.html#cb196-7" tabindex="-1"></a><span class="do">## polygon( c(x, rev(x)), c(ci[,&#39;lwr&#39;], rev(ci[,&#39;upr&#39;])), col=grey(0,.2), border=0)</span></span></code></pre></div>
<p>We can also bootstrap other statistics, such as a t-statistic or <span class="math inline">\(R^2\)</span>. We do such things to test a null hypothesis, which is often ``no relationship’’. We are rarely interested in computing standard errrors and conducting hypothesis tests for two variables. However, we work through the ideas in the two-variable case to better understand the multi-variable case.</p>
</div>
<div id="hypothesis-tests" class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Hypothesis Tests<a href="ordinary-least-squares.html#hypothesis-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are two main ways to conduct a hypothesis test.</p>
<p><strong>Invert a CI</strong>
One main way to conduct hypothesis tests is to examine whether a confidence interval contains a hypothesized value. Often, this is <span class="math inline">\(0\)</span>.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="ordinary-least-squares.html#cb197-1" tabindex="-1"></a><span class="do">## Example 1 Continued Yet Again</span></span>
<span id="cb197-2"><a href="ordinary-least-squares.html#cb197-2" tabindex="-1"></a></span>
<span id="cb197-3"><a href="ordinary-least-squares.html#cb197-3" tabindex="-1"></a><span class="do">## Bootstrap Distribution</span></span>
<span id="cb197-4"><a href="ordinary-least-squares.html#cb197-4" tabindex="-1"></a>boot_ci_percentile <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_coefs, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>))</span>
<span id="cb197-5"><a href="ordinary-least-squares.html#cb197-5" tabindex="-1"></a><span class="fu">hist</span>(boot_coefs, <span class="at">breaks=</span><span class="dv">25</span>,</span>
<span id="cb197-6"><a href="ordinary-least-squares.html#cb197-6" tabindex="-1"></a>    <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&#39;SE est. = &#39;</span>, <span class="fu">round</span>(boot_se,<span class="dv">4</span>)),</span>
<span id="cb197-7"><a href="ordinary-least-squares.html#cb197-7" tabindex="-1"></a>    <span class="at">xlab=</span><span class="fu">expression</span>(beta[b]), </span>
<span id="cb197-8"><a href="ordinary-least-squares.html#cb197-8" tabindex="-1"></a>    <span class="at">xlim=</span><span class="fu">range</span>(<span class="fu">c</span>(<span class="dv">0</span>, boot_coefs)) )</span>
<span id="cb197-9"><a href="ordinary-least-squares.html#cb197-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>boot_ci_percentile, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb197-10"><a href="ordinary-least-squares.html#cb197-10" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p><strong>Impose the Null</strong>
We can also compute a null distribution using <em>data-driven</em> methods that assume much less about the data generating process. We focus on the simplest, the bootstrap, where loop through a large number of simulations. In each iteration of the loop, we drop impose the null hypothesis and reestimate the statistic of interest. We then calculate the standard deviation of the statistic across all ``resamples’’.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="ordinary-least-squares.html#cb198-1" tabindex="-1"></a><span class="do">## Example 1 Continued Again</span></span>
<span id="cb198-2"><a href="ordinary-least-squares.html#cb198-2" tabindex="-1"></a></span>
<span id="cb198-3"><a href="ordinary-least-squares.html#cb198-3" tabindex="-1"></a><span class="do">## Null Distribution for Beta</span></span>
<span id="cb198-4"><a href="ordinary-least-squares.html#cb198-4" tabindex="-1"></a>boots <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">399</span></span>
<span id="cb198-5"><a href="ordinary-least-squares.html#cb198-5" tabindex="-1"></a>boot_regs0 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(boots, <span class="cf">function</span>(b){</span>
<span id="cb198-6"><a href="ordinary-least-squares.html#cb198-6" tabindex="-1"></a>    xy_b <span class="ot">&lt;-</span> xy</span>
<span id="cb198-7"><a href="ordinary-least-squares.html#cb198-7" tabindex="-1"></a>    xy_b<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">sample</span>( xy_b<span class="sc">$</span>y, <span class="at">replace=</span>T)</span>
<span id="cb198-8"><a href="ordinary-least-squares.html#cb198-8" tabindex="-1"></a>    reg_b <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">dat=</span>xy_b)</span>
<span id="cb198-9"><a href="ordinary-least-squares.html#cb198-9" tabindex="-1"></a>})</span>
<span id="cb198-10"><a href="ordinary-least-squares.html#cb198-10" tabindex="-1"></a>boot_coefs0 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(boot_regs0, coef)[<span class="st">&#39;x&#39;</span>,]</span>
<span id="cb198-11"><a href="ordinary-least-squares.html#cb198-11" tabindex="-1"></a></span>
<span id="cb198-12"><a href="ordinary-least-squares.html#cb198-12" tabindex="-1"></a><span class="do">## Null Bootstrap Distribution</span></span>
<span id="cb198-13"><a href="ordinary-least-squares.html#cb198-13" tabindex="-1"></a>boot_ci_percentile0 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_coefs0, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>))</span>
<span id="cb198-14"><a href="ordinary-least-squares.html#cb198-14" tabindex="-1"></a><span class="fu">hist</span>(boot_coefs0, <span class="at">breaks=</span><span class="dv">25</span>, <span class="at">main=</span><span class="st">&#39;&#39;</span>,</span>
<span id="cb198-15"><a href="ordinary-least-squares.html#cb198-15" tabindex="-1"></a>    <span class="at">xlab=</span><span class="fu">expression</span>(beta[b]),</span>
<span id="cb198-16"><a href="ordinary-least-squares.html#cb198-16" tabindex="-1"></a>    <span class="at">xlim=</span><span class="fu">range</span>(<span class="fu">c</span>(boot_coefs0, <span class="fu">coef</span>(reg)[<span class="st">&#39;x&#39;</span>])))</span>
<span id="cb198-17"><a href="ordinary-least-squares.html#cb198-17" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>boot_ci_percentile0, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb198-18"><a href="ordinary-least-squares.html#cb198-18" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">coef</span>(reg)[<span class="st">&#39;x&#39;</span>], <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Regardless of how we calculate standard errors, we can use them to conduct a t-test. We also compute the distribution of t-values under the null hypothesis, and compare how extreme the oberved value is.
<span class="math display">\[ \hat{t} = \frac{\hat{\beta} - \beta_{0} }{\hat{\sigma}_{\hat{\beta}}} \]</span></p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="ordinary-least-squares.html#cb199-1" tabindex="-1"></a><span class="do">## T Test</span></span>
<span id="cb199-2"><a href="ordinary-least-squares.html#cb199-2" tabindex="-1"></a>B0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb199-3"><a href="ordinary-least-squares.html#cb199-3" tabindex="-1"></a>boot_t  <span class="ot">&lt;-</span> (<span class="fu">coef</span>(reg)[<span class="st">&#39;x&#39;</span>]<span class="sc">-</span>B0)<span class="sc">/</span>boot_se</span>
<span id="cb199-4"><a href="ordinary-least-squares.html#cb199-4" tabindex="-1"></a></span>
<span id="cb199-5"><a href="ordinary-least-squares.html#cb199-5" tabindex="-1"></a><span class="do">## Compute Bootstrap T-Values (without refinement)</span></span>
<span id="cb199-6"><a href="ordinary-least-squares.html#cb199-6" tabindex="-1"></a>boot_t_boot0 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(boot_regs0, <span class="cf">function</span>(reg_b){</span>
<span id="cb199-7"><a href="ordinary-least-squares.html#cb199-7" tabindex="-1"></a>    beta_b <span class="ot">&lt;-</span> <span class="fu">coef</span>(reg_b)[[<span class="st">&#39;x&#39;</span>]]</span>
<span id="cb199-8"><a href="ordinary-least-squares.html#cb199-8" tabindex="-1"></a>    t_hat_b <span class="ot">&lt;-</span> (beta_b)<span class="sc">/</span>boot_se</span>
<span id="cb199-9"><a href="ordinary-least-squares.html#cb199-9" tabindex="-1"></a>    <span class="fu">return</span>(t_hat_b)</span>
<span id="cb199-10"><a href="ordinary-least-squares.html#cb199-10" tabindex="-1"></a>})</span>
<span id="cb199-11"><a href="ordinary-least-squares.html#cb199-11" tabindex="-1"></a><span class="fu">hist</span>(boot_t_boot0, <span class="at">breaks=</span><span class="dv">100</span>,</span>
<span id="cb199-12"><a href="ordinary-least-squares.html#cb199-12" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;Bootstrapped t values&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;t&#39;</span>,</span>
<span id="cb199-13"><a href="ordinary-least-squares.html#cb199-13" tabindex="-1"></a>    <span class="at">xlim=</span><span class="fu">range</span>(<span class="fu">c</span>(boot_t_boot0, boot_t)) )</span>
<span id="cb199-14"><a href="ordinary-least-squares.html#cb199-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>boot_t, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>From this, we can calculate a <em>p-value</em>: the probability you would see something as extreme as your statistic under the null (assuming your null hypothesis was true). Note that the <span class="math inline">\(p\)</span> reported by your computer does not necessarily satisfy this definition. We can always calcuate a p-value from an explicit null distribution.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="ordinary-least-squares.html#cb200-1" tabindex="-1"></a><span class="do">## One Sided Test for P(t &gt; boot_t | Null)=1- P(t &lt; boot_t | Null)</span></span>
<span id="cb200-2"><a href="ordinary-least-squares.html#cb200-2" tabindex="-1"></a>That_NullDist1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(boot_t_boot0)</span>
<span id="cb200-3"><a href="ordinary-least-squares.html#cb200-3" tabindex="-1"></a>Phat1  <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">That_NullDist1</span>(boot_t)</span>
<span id="cb200-4"><a href="ordinary-least-squares.html#cb200-4" tabindex="-1"></a></span>
<span id="cb200-5"><a href="ordinary-least-squares.html#cb200-5" tabindex="-1"></a><span class="do">## Two Sided Test for P(t &gt; jack_t or  t &lt; -jack_t | Null)</span></span>
<span id="cb200-6"><a href="ordinary-least-squares.html#cb200-6" tabindex="-1"></a>That_NullDist2 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(<span class="fu">abs</span>(boot_t_boot0))</span>
<span id="cb200-7"><a href="ordinary-least-squares.html#cb200-7" tabindex="-1"></a><span class="fu">plot</span>(That_NullDist2, <span class="at">xlim=</span><span class="fu">range</span>(boot_t_boot0, boot_t))</span>
<span id="cb200-8"><a href="ordinary-least-squares.html#cb200-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">quantile</span>(That_NullDist2,<span class="at">probs=</span>.<span class="dv">95</span>), <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb200-9"><a href="ordinary-least-squares.html#cb200-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>boot_t, <span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="ordinary-least-squares.html#cb201-1" tabindex="-1"></a>Phat2  <span class="ot">&lt;-</span>  <span class="dv">1</span><span class="sc">-</span><span class="fu">That_NullDist2</span>(boot_t)</span>
<span id="cb201-2"><a href="ordinary-least-squares.html#cb201-2" tabindex="-1"></a>Phat2</span></code></pre></div>
<pre><code>## [1] 0.5964912</code></pre>
<p>Under some assumptions, the null distribution is distributed <span class="math inline">\(t_{n-2}\)</span>. (For more on parametric t-testing based on statistical theory, see <a href="https://www.econometrics-with-r.org/4-lrwor.html" class="uri">https://www.econometrics-with-r.org/4-lrwor.html</a>.)</p>
</div>
<div id="prediction-intervals" class="section level3 hasAnchor" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Prediction Intervals<a href="ordinary-least-squares.html#prediction-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In addition to confidence intervales, we can also compute a <em>prediction interval</em> which estimates the range of variability across different samples for the outcomes. These intervals also take into account the residuals— the variability of individuals around the mean.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="ordinary-least-squares.html#cb203-1" tabindex="-1"></a><span class="do">## Bootstrap Prediction Interval</span></span>
<span id="cb203-2"><a href="ordinary-least-squares.html#cb203-2" tabindex="-1"></a>boot_resids <span class="ot">&lt;-</span> <span class="fu">lapply</span>(boot_regs, <span class="cf">function</span>(reg_b){</span>
<span id="cb203-3"><a href="ordinary-least-squares.html#cb203-3" tabindex="-1"></a>    e_b <span class="ot">&lt;-</span> <span class="fu">resid</span>(reg_b)</span>
<span id="cb203-4"><a href="ordinary-least-squares.html#cb203-4" tabindex="-1"></a>    x_b <span class="ot">&lt;-</span> reg_b<span class="sc">$</span>model<span class="sc">$</span>x</span>
<span id="cb203-5"><a href="ordinary-least-squares.html#cb203-5" tabindex="-1"></a>    res_b <span class="ot">&lt;-</span> <span class="fu">cbind</span>(e_b, x_b)</span>
<span id="cb203-6"><a href="ordinary-least-squares.html#cb203-6" tabindex="-1"></a>})</span>
<span id="cb203-7"><a href="ordinary-least-squares.html#cb203-7" tabindex="-1"></a>boot_resids <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(rbind, boot_resids))</span>
<span id="cb203-8"><a href="ordinary-least-squares.html#cb203-8" tabindex="-1"></a><span class="do">## Homoskedastic</span></span>
<span id="cb203-9"><a href="ordinary-least-squares.html#cb203-9" tabindex="-1"></a>ehat <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_resids<span class="sc">$</span>e_b, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span>
<span id="cb203-10"><a href="ordinary-least-squares.html#cb203-10" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">quantile</span>(xy<span class="sc">$</span>x,<span class="at">probs=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">by=</span>.<span class="dv">1</span>))</span>
<span id="cb203-11"><a href="ordinary-least-squares.html#cb203-11" tabindex="-1"></a>boot_pi <span class="ot">&lt;-</span> <span class="fu">coef</span>(reg)[<span class="dv">1</span>] <span class="sc">+</span> x<span class="sc">*</span><span class="fu">coef</span>(reg)[<span class="st">&#39;x&#39;</span>]</span>
<span id="cb203-12"><a href="ordinary-least-squares.html#cb203-12" tabindex="-1"></a>boot_pi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(boot_pi <span class="sc">+</span> ehat[<span class="dv">1</span>], boot_pi <span class="sc">+</span> ehat[<span class="dv">2</span>])</span>
<span id="cb203-13"><a href="ordinary-least-squares.html#cb203-13" tabindex="-1"></a></span>
<span id="cb203-14"><a href="ordinary-least-squares.html#cb203-14" tabindex="-1"></a><span class="do">## Plot Bootstrap PI</span></span>
<span id="cb203-15"><a href="ordinary-least-squares.html#cb203-15" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x, <span class="at">dat=</span>xy, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">main=</span><span class="st">&#39;Prediction Intervals&#39;</span>,</span>
<span id="cb203-16"><a href="ordinary-least-squares.html#cb203-16" tabindex="-1"></a><span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">20</span>))</span>
<span id="cb203-17"><a href="ordinary-least-squares.html#cb203-17" tabindex="-1"></a><span class="fu">polygon</span>( <span class="fu">c</span>(x, <span class="fu">rev</span>(x)), <span class="fu">c</span>(boot_pi[,<span class="dv">1</span>], <span class="fu">rev</span>(boot_pi[,<span class="dv">2</span>])),</span>
<span id="cb203-18"><a href="ordinary-least-squares.html#cb203-18" tabindex="-1"></a>    <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">2</span>), <span class="at">border=</span><span class="cn">NA</span>)</span>
<span id="cb203-19"><a href="ordinary-least-squares.html#cb203-19" tabindex="-1"></a></span>
<span id="cb203-20"><a href="ordinary-least-squares.html#cb203-20" tabindex="-1"></a><span class="do">## Parametric PI (For Comparison)</span></span>
<span id="cb203-21"><a href="ordinary-least-squares.html#cb203-21" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">predict</span>(reg, <span class="at">interval=</span><span class="st">&#39;prediction&#39;</span>, <span class="at">newdata=</span><span class="fu">data.frame</span>(x))</span>
<span id="cb203-22"><a href="ordinary-least-squares.html#cb203-22" tabindex="-1"></a><span class="fu">lines</span>( x, pi[,<span class="st">&#39;lwr&#39;</span>], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb203-23"><a href="ordinary-least-squares.html#cb203-23" tabindex="-1"></a><span class="fu">lines</span>( x, pi[,<span class="st">&#39;upr&#39;</span>], <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>There are many ways to improve upon the prediction intervals you just created. Probably the most basic way is to allow the residuals to be heteroskedastic.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="ordinary-least-squares.html#cb204-1" tabindex="-1"></a><span class="do">## Estimate Residual Quantiles seperately around X points</span></span>
<span id="cb204-2"><a href="ordinary-least-squares.html#cb204-2" tabindex="-1"></a>boot_resid_list <span class="ot">&lt;-</span> <span class="fu">split</span>(boot_resids,</span>
<span id="cb204-3"><a href="ordinary-least-squares.html#cb204-3" tabindex="-1"></a>    <span class="fu">cut</span>(boot_resids<span class="sc">$</span>x_b, x) )</span>
<span id="cb204-4"><a href="ordinary-least-squares.html#cb204-4" tabindex="-1"></a>boot_resid_est <span class="ot">&lt;-</span> <span class="fu">lapply</span>(boot_resid_list, <span class="cf">function</span>(res_b) {</span>
<span id="cb204-5"><a href="ordinary-least-squares.html#cb204-5" tabindex="-1"></a>    <span class="cf">if</span>( <span class="fu">nrow</span>(res_b)<span class="sc">==</span><span class="dv">0</span>){ <span class="do">## If Empty, Return Nothing</span></span>
<span id="cb204-6"><a href="ordinary-least-squares.html#cb204-6" tabindex="-1"></a>        ehat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>)</span>
<span id="cb204-7"><a href="ordinary-least-squares.html#cb204-7" tabindex="-1"></a>    } <span class="cf">else</span>{ <span class="do">## Estimate Quantiles of Residuals</span></span>
<span id="cb204-8"><a href="ordinary-least-squares.html#cb204-8" tabindex="-1"></a>        ehat <span class="ot">&lt;-</span> <span class="fu">quantile</span>(res_b<span class="sc">$</span>e_b, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span>
<span id="cb204-9"><a href="ordinary-least-squares.html#cb204-9" tabindex="-1"></a>    }</span>
<span id="cb204-10"><a href="ordinary-least-squares.html#cb204-10" tabindex="-1"></a>    <span class="fu">return</span>(ehat)</span>
<span id="cb204-11"><a href="ordinary-least-squares.html#cb204-11" tabindex="-1"></a>    })</span>
<span id="cb204-12"><a href="ordinary-least-squares.html#cb204-12" tabindex="-1"></a>boot_resid_est <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, boot_resid_est)</span>
<span id="cb204-13"><a href="ordinary-least-squares.html#cb204-13" tabindex="-1"></a><span class="do">## Construct PI at x points</span></span>
<span id="cb204-14"><a href="ordinary-least-squares.html#cb204-14" tabindex="-1"></a>boot_x <span class="ot">&lt;-</span> x[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">diff</span>(x)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb204-15"><a href="ordinary-least-squares.html#cb204-15" tabindex="-1"></a>boot_pi <span class="ot">&lt;-</span> <span class="fu">coef</span>(reg)[<span class="dv">1</span>] <span class="sc">+</span> boot_x<span class="sc">*</span><span class="fu">coef</span>(reg)[<span class="st">&#39;x&#39;</span>]</span>
<span id="cb204-16"><a href="ordinary-least-squares.html#cb204-16" tabindex="-1"></a>boot_pi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(boot_pi <span class="sc">+</span> boot_resid_est[,<span class="dv">1</span>], boot_pi <span class="sc">+</span> boot_resid_est[,<span class="dv">2</span>])</span>
<span id="cb204-17"><a href="ordinary-least-squares.html#cb204-17" tabindex="-1"></a></span>
<span id="cb204-18"><a href="ordinary-least-squares.html#cb204-18" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x, <span class="at">dat=</span>xy, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">main=</span><span class="st">&#39;Heteroskedastic P.I.&#39;</span>)</span>
<span id="cb204-19"><a href="ordinary-least-squares.html#cb204-19" tabindex="-1"></a><span class="fu">polygon</span>( <span class="fu">c</span>(boot_x, <span class="fu">rev</span>(boot_x)), <span class="fu">c</span>(boot_pi[,<span class="dv">1</span>], <span class="fu">rev</span>(boot_pi[,<span class="dv">2</span>])),</span>
<span id="cb204-20"><a href="ordinary-least-squares.html#cb204-20" tabindex="-1"></a>    <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">2</span>), <span class="at">border=</span><span class="cn">NA</span>)</span>
<span id="cb204-21"><a href="ordinary-least-squares.html#cb204-21" tabindex="-1"></a><span class="fu">rug</span>(boot_x)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>For a nice overview of different types of intervals, see <a href="https://www.jstor.org/stable/2685212" class="uri">https://www.jstor.org/stable/2685212</a>. For an indepth view, see “Statistical Intervals: A Guide for Practitioners and Researchers” or “Statistical Tolerance Regions: Theory, Applications, and Computation”. See <a href="https://robjhyndman.com/hyndsight/intervals/" class="uri">https://robjhyndman.com/hyndsight/intervals/</a> for constructing intervals for future observations in a time-series context. See Davison and Hinkley, chapters 5 and 6 (also Efron and Tibshirani, or Wehrens et al.)</p>
</div>
</div>
<div id="ols-multiple-linear-regression" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> OLS (multiple linear regression)<a href="ordinary-least-squares.html#ols-multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Model and objective
<span class="math display">\[
y_i=\beta_0+\beta_1x_{i1}+\beta_2x_{i2}+\ldots+\beta_kx_{ik}+\epsilon_i = X_{i}\beta +\epsilon_i \\
min_{\beta} \sum_{i=1}^{n} (\epsilon_i)^2
\]</span>
Can also be written in matrix form
<span class="math display">\[
y=\textbf{X}\beta+\epsilon\\
min_{\beta} (\epsilon&#39; \epsilon)
\]</span></p>
<p>Point Estimates
<span class="math display">\[
\hat{\beta}=(\textbf{X}&#39;\textbf{X})^{-1}\textbf{X}&#39;y
\]</span></p>
<p><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>
Before fitting the model to your data, create a summary plot</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="ordinary-least-squares.html#cb205-1" tabindex="-1"></a><span class="do">## Example 2 (Empirical)</span></span>
<span id="cb205-2"><a href="ordinary-least-squares.html#cb205-2" tabindex="-1"></a><span class="do">## Inspect Dataset on police arrests for the USA in 1973</span></span>
<span id="cb205-3"><a href="ordinary-least-squares.html#cb205-3" tabindex="-1"></a><span class="fu">head</span>(USArrests)</span></code></pre></div>
<pre><code>##            Murder Assault UrbanPop Rape
## Alabama      13.2     236       58 21.2
## Alaska       10.0     263       48 44.5
## Arizona       8.1     294       80 31.0
## Arkansas      8.8     190       50 19.5
## California    9.0     276       91 40.6
## Colorado      7.9     204       78 38.7</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="ordinary-least-squares.html#cb207-1" tabindex="-1"></a><span class="do">## Simple Plot</span></span>
<span id="cb207-2"><a href="ordinary-least-squares.html#cb207-2" tabindex="-1"></a><span class="co">#plot(Assault~UrbanPop, USArrests, col=grey(0,.5), pch=16,</span></span>
<span id="cb207-3"><a href="ordinary-least-squares.html#cb207-3" tabindex="-1"></a><span class="co">#    cex=USArrests$Murder/diff(range(USArrests$Murder))*2,</span></span>
<span id="cb207-4"><a href="ordinary-least-squares.html#cb207-4" tabindex="-1"></a><span class="co">#    main=&#39;US Murder arrests (per 100,000)&#39;)</span></span>
<span id="cb207-5"><a href="ordinary-least-squares.html#cb207-5" tabindex="-1"></a></span>
<span id="cb207-6"><a href="ordinary-least-squares.html#cb207-6" tabindex="-1"></a><span class="co"># Superior Plot</span></span>
<span id="cb207-7"><a href="ordinary-least-squares.html#cb207-7" tabindex="-1"></a>USArrests<span class="sc">$</span>ID <span class="ot">&lt;-</span> <span class="fu">rownames</span>(USArrests)</span>
<span id="cb207-8"><a href="ordinary-least-squares.html#cb207-8" tabindex="-1"></a>fig <span class="ot">&lt;-</span> plotly<span class="sc">::</span><span class="fu">plot_ly</span>(</span>
<span id="cb207-9"><a href="ordinary-least-squares.html#cb207-9" tabindex="-1"></a>  USArrests, <span class="at">x =</span> <span class="sc">~</span>UrbanPop, <span class="at">y =</span> <span class="sc">~</span>Assault,</span>
<span id="cb207-10"><a href="ordinary-least-squares.html#cb207-10" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">&#39;&lt;b&gt;&#39;</span>, ID, <span class="st">&#39;&lt;/b&gt;&#39;</span>,</span>
<span id="cb207-11"><a href="ordinary-least-squares.html#cb207-11" tabindex="-1"></a>    <span class="st">&quot;&lt;br&gt;Urban  :&quot;</span>, UrbanPop,</span>
<span id="cb207-12"><a href="ordinary-least-squares.html#cb207-12" tabindex="-1"></a>    <span class="st">&quot;&lt;br&gt;Assault:&quot;</span>, Assault,</span>
<span id="cb207-13"><a href="ordinary-least-squares.html#cb207-13" tabindex="-1"></a>    <span class="st">&quot;&lt;br&gt;Murder :&quot;</span>, Murder),</span>
<span id="cb207-14"><a href="ordinary-least-squares.html#cb207-14" tabindex="-1"></a>  <span class="at">mode=</span><span class="st">&#39;markers&#39;</span>,</span>
<span id="cb207-15"><a href="ordinary-least-squares.html#cb207-15" tabindex="-1"></a>  <span class="at">type=</span><span class="st">&#39;scatter&#39;</span>,</span>
<span id="cb207-16"><a href="ordinary-least-squares.html#cb207-16" tabindex="-1"></a>  <span class="at">hoverinfo=</span><span class="st">&#39;text&#39;</span>,</span>
<span id="cb207-17"><a href="ordinary-least-squares.html#cb207-17" tabindex="-1"></a>  <span class="at">color=</span><span class="sc">~</span>Murder,</span>
<span id="cb207-18"><a href="ordinary-least-squares.html#cb207-18" tabindex="-1"></a>  <span class="at">showlegend=</span>F,</span>
<span id="cb207-19"><a href="ordinary-least-squares.html#cb207-19" tabindex="-1"></a>  <span class="at">marker=</span><span class="fu">list</span>(</span>
<span id="cb207-20"><a href="ordinary-least-squares.html#cb207-20" tabindex="-1"></a>    <span class="at">size=</span><span class="sc">~</span>Murder,</span>
<span id="cb207-21"><a href="ordinary-least-squares.html#cb207-21" tabindex="-1"></a>    <span class="at">opacity=</span><span class="fl">0.5</span>,</span>
<span id="cb207-22"><a href="ordinary-least-squares.html#cb207-22" tabindex="-1"></a>    <span class="at">showscale=</span>T,  </span>
<span id="cb207-23"><a href="ordinary-least-squares.html#cb207-23" tabindex="-1"></a>    <span class="at">colorbar =</span> <span class="fu">list</span>(<span class="at">title=</span><span class="st">&#39;Murder Arrests (per 100,000)&#39;</span>)))</span>
<span id="cb207-24"><a href="ordinary-least-squares.html#cb207-24" tabindex="-1"></a>fig <span class="ot">&lt;-</span> plotly<span class="sc">::</span><span class="fu">layout</span>(fig,</span>
<span id="cb207-25"><a href="ordinary-least-squares.html#cb207-25" tabindex="-1"></a>  <span class="at">title=</span><span class="st">&#39;Crime and Urbanization in America 1975&#39;</span>,</span>
<span id="cb207-26"><a href="ordinary-least-squares.html#cb207-26" tabindex="-1"></a>  <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&#39;Percent of People in an Urban Area&#39;</span>),</span>
<span id="cb207-27"><a href="ordinary-least-squares.html#cb207-27" tabindex="-1"></a>  <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&#39;Assault Arrests per 100,000 People&#39;</span>))</span>
<span id="cb207-28"><a href="ordinary-least-squares.html#cb207-28" tabindex="-1"></a>fig</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-0598a2926ed762576ac7" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-0598a2926ed762576ac7">{"x":{"visdat":{"35773dc3a38c":["function () ","plotlyVisDat"]},"cur_data":"35773dc3a38c","attrs":{"35773dc3a38c":{"x":{},"y":{},"text":{},"mode":"markers","hoverinfo":"text","showlegend":false,"marker":{"size":{},"opacity":0.5,"showscale":true,"colorbar":{"title":"Murder Arrests (per 100,000)"}},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Crime and Urbanization in America 1975","xaxis":{"domain":[0,1],"automargin":true,"title":"Percent of People in an Urban Area"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Assault Arrests per 100,000 People"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[58,48,80,50,91,78,77,72,80,60,83,54,83,65,57,66,52,66,51,67,85,74,66,44,70,53,62,81,56,89,70,86,45,44,75,68,67,72,87,48,45,59,80,80,32,63,73,39,66,60],"y":[236,263,294,190,276,204,110,238,335,211,46,120,249,113,56,115,109,249,83,300,149,255,72,259,178,109,102,252,57,159,285,254,337,45,120,151,159,106,174,279,86,188,201,120,48,156,145,81,53,161],"text":["<b> Alabama <\/b> <br>Urban  : 58 <br>Assault: 236 <br>Murder : 13.2","<b> Alaska <\/b> <br>Urban  : 48 <br>Assault: 263 <br>Murder : 10","<b> Arizona <\/b> <br>Urban  : 80 <br>Assault: 294 <br>Murder : 8.1","<b> Arkansas <\/b> <br>Urban  : 50 <br>Assault: 190 <br>Murder : 8.8","<b> California <\/b> <br>Urban  : 91 <br>Assault: 276 <br>Murder : 9","<b> Colorado <\/b> <br>Urban  : 78 <br>Assault: 204 <br>Murder : 7.9","<b> Connecticut <\/b> <br>Urban  : 77 <br>Assault: 110 <br>Murder : 3.3","<b> Delaware <\/b> <br>Urban  : 72 <br>Assault: 238 <br>Murder : 5.9","<b> Florida <\/b> <br>Urban  : 80 <br>Assault: 335 <br>Murder : 15.4","<b> Georgia <\/b> <br>Urban  : 60 <br>Assault: 211 <br>Murder : 17.4","<b> Hawaii <\/b> <br>Urban  : 83 <br>Assault: 46 <br>Murder : 5.3","<b> Idaho <\/b> <br>Urban  : 54 <br>Assault: 120 <br>Murder : 2.6","<b> Illinois <\/b> <br>Urban  : 83 <br>Assault: 249 <br>Murder : 10.4","<b> Indiana <\/b> <br>Urban  : 65 <br>Assault: 113 <br>Murder : 7.2","<b> Iowa <\/b> <br>Urban  : 57 <br>Assault: 56 <br>Murder : 2.2","<b> Kansas <\/b> <br>Urban  : 66 <br>Assault: 115 <br>Murder : 6","<b> Kentucky <\/b> <br>Urban  : 52 <br>Assault: 109 <br>Murder : 9.7","<b> Louisiana <\/b> <br>Urban  : 66 <br>Assault: 249 <br>Murder : 15.4","<b> Maine <\/b> <br>Urban  : 51 <br>Assault: 83 <br>Murder : 2.1","<b> Maryland <\/b> <br>Urban  : 67 <br>Assault: 300 <br>Murder : 11.3","<b> Massachusetts <\/b> <br>Urban  : 85 <br>Assault: 149 <br>Murder : 4.4","<b> Michigan <\/b> <br>Urban  : 74 <br>Assault: 255 <br>Murder : 12.1","<b> Minnesota <\/b> <br>Urban  : 66 <br>Assault: 72 <br>Murder : 2.7","<b> Mississippi <\/b> <br>Urban  : 44 <br>Assault: 259 <br>Murder : 16.1","<b> Missouri <\/b> <br>Urban  : 70 <br>Assault: 178 <br>Murder : 9","<b> Montana <\/b> <br>Urban  : 53 <br>Assault: 109 <br>Murder : 6","<b> Nebraska <\/b> <br>Urban  : 62 <br>Assault: 102 <br>Murder : 4.3","<b> Nevada <\/b> <br>Urban  : 81 <br>Assault: 252 <br>Murder : 12.2","<b> New Hampshire <\/b> <br>Urban  : 56 <br>Assault: 57 <br>Murder : 2.1","<b> New Jersey <\/b> <br>Urban  : 89 <br>Assault: 159 <br>Murder : 7.4","<b> New Mexico <\/b> <br>Urban  : 70 <br>Assault: 285 <br>Murder : 11.4","<b> New York <\/b> <br>Urban  : 86 <br>Assault: 254 <br>Murder : 11.1","<b> North Carolina <\/b> <br>Urban  : 45 <br>Assault: 337 <br>Murder : 13","<b> North Dakota <\/b> <br>Urban  : 44 <br>Assault: 45 <br>Murder : 0.8","<b> Ohio <\/b> <br>Urban  : 75 <br>Assault: 120 <br>Murder : 7.3","<b> Oklahoma <\/b> <br>Urban  : 68 <br>Assault: 151 <br>Murder : 6.6","<b> Oregon <\/b> <br>Urban  : 67 <br>Assault: 159 <br>Murder : 4.9","<b> Pennsylvania <\/b> <br>Urban  : 72 <br>Assault: 106 <br>Murder : 6.3","<b> Rhode Island <\/b> <br>Urban  : 87 <br>Assault: 174 <br>Murder : 3.4","<b> South Carolina <\/b> <br>Urban  : 48 <br>Assault: 279 <br>Murder : 14.4","<b> South Dakota <\/b> <br>Urban  : 45 <br>Assault: 86 <br>Murder : 3.8","<b> Tennessee <\/b> <br>Urban  : 59 <br>Assault: 188 <br>Murder : 13.2","<b> Texas <\/b> <br>Urban  : 80 <br>Assault: 201 <br>Murder : 12.7","<b> Utah <\/b> <br>Urban  : 80 <br>Assault: 120 <br>Murder : 3.2","<b> Vermont <\/b> <br>Urban  : 32 <br>Assault: 48 <br>Murder : 2.2","<b> Virginia <\/b> <br>Urban  : 63 <br>Assault: 156 <br>Murder : 8.5","<b> Washington <\/b> <br>Urban  : 73 <br>Assault: 145 <br>Murder : 4","<b> West Virginia <\/b> <br>Urban  : 39 <br>Assault: 81 <br>Murder : 5.7","<b> Wisconsin <\/b> <br>Urban  : 66 <br>Assault: 53 <br>Murder : 2.6","<b> Wyoming <\/b> <br>Urban  : 60 <br>Assault: 161 <br>Murder : 6.8"],"mode":"markers","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"showlegend":false,"marker":{"colorbar":{"title":"Murder Arrests (per 100,000)","ticklen":2},"cmin":0.80000000000000004,"cmax":17.399999999999999,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[13.199999999999999,10,8.0999999999999996,8.8000000000000007,9,7.9000000000000004,3.2999999999999998,5.9000000000000004,15.4,17.399999999999999,5.2999999999999998,2.6000000000000001,10.4,7.2000000000000002,2.2000000000000002,6,9.6999999999999993,15.4,2.1000000000000001,11.300000000000001,4.4000000000000004,12.1,2.7000000000000002,16.100000000000001,9,6,4.2999999999999998,12.199999999999999,2.1000000000000001,7.4000000000000004,11.4,11.1,13,0.80000000000000004,7.2999999999999998,6.5999999999999996,4.9000000000000004,6.2999999999999998,3.3999999999999999,14.4,3.7999999999999998,13.199999999999999,12.699999999999999,3.2000000000000002,2.2000000000000002,8.5,4,5.7000000000000002,2.6000000000000001,6.7999999999999998],"size":[13.199999999999999,10,8.0999999999999996,8.8000000000000007,9,7.9000000000000004,3.2999999999999998,5.9000000000000004,15.4,17.399999999999999,5.2999999999999998,2.6000000000000001,10.4,7.2000000000000002,2.2000000000000002,6,9.6999999999999993,15.4,2.1000000000000001,11.300000000000001,4.4000000000000004,12.1,2.7000000000000002,16.100000000000001,9,6,4.2999999999999998,12.199999999999999,2.1000000000000001,7.4000000000000004,11.4,11.1,13,0.80000000000000004,7.2999999999999998,6.5999999999999996,4.9000000000000004,6.2999999999999998,3.3999999999999999,14.4,3.7999999999999998,13.199999999999999,12.699999999999999,3.2000000000000002,2.2000000000000002,8.5,4,5.7000000000000002,2.6000000000000001,6.7999999999999998],"opacity":0.5,"line":{"colorbar":{"title":"","ticklen":2},"cmin":0.80000000000000004,"cmax":17.399999999999999,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[13.199999999999999,10,8.0999999999999996,8.8000000000000007,9,7.9000000000000004,3.2999999999999998,5.9000000000000004,15.4,17.399999999999999,5.2999999999999998,2.6000000000000001,10.4,7.2000000000000002,2.2000000000000002,6,9.6999999999999993,15.4,2.1000000000000001,11.300000000000001,4.4000000000000004,12.1,2.7000000000000002,16.100000000000001,9,6,4.2999999999999998,12.199999999999999,2.1000000000000001,7.4000000000000004,11.4,11.1,13,0.80000000000000004,7.2999999999999998,6.5999999999999996,4.9000000000000004,6.2999999999999998,3.3999999999999999,14.4,3.7999999999999998,13.199999999999999,12.699999999999999,3.2000000000000002,2.2000000000000002,8.5,4,5.7000000000000002,2.6000000000000001,6.7999999999999998]}},"type":"scatter","xaxis":"x","yaxis":"y","frame":null},{"x":[32,91],"y":[45,337],"type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"Murder","ticklen":2},"cmin":0.80000000000000004,"cmax":17.399999999999999,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[0.80000000000000004,17.399999999999999],"line":{"color":"rgba(255,127,14,1)"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="ordinary-least-squares.html#cb208-1" tabindex="-1"></a><span class="do">## For further exploratory plotting,</span></span>
<span id="cb208-2"><a href="ordinary-least-squares.html#cb208-2" tabindex="-1"></a><span class="do">## see https://plotly.com/r/bubble-charts/</span></span></code></pre></div>
<p>Now we can estimate the parameters</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="ordinary-least-squares.html#cb209-1" tabindex="-1"></a><span class="do">## Manually Compute</span></span>
<span id="cb209-2"><a href="ordinary-least-squares.html#cb209-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> USArrests[,<span class="st">&#39;Murder&#39;</span>]</span>
<span id="cb209-3"><a href="ordinary-least-squares.html#cb209-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> USArrests[,<span class="fu">c</span>(<span class="st">&#39;Assault&#39;</span>,<span class="st">&#39;UrbanPop&#39;</span>)]</span>
<span id="cb209-4"><a href="ordinary-least-squares.html#cb209-4" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">cbind</span>(<span class="dv">1</span>,X))</span>
<span id="cb209-5"><a href="ordinary-least-squares.html#cb209-5" tabindex="-1"></a></span>
<span id="cb209-6"><a href="ordinary-least-squares.html#cb209-6" tabindex="-1"></a>XtXi <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)</span>
<span id="cb209-7"><a href="ordinary-least-squares.html#cb209-7" tabindex="-1"></a>Bhat <span class="ot">&lt;-</span> XtXi <span class="sc">%*%</span> (<span class="fu">t</span>(X)<span class="sc">%*%</span>Y)</span>
<span id="cb209-8"><a href="ordinary-least-squares.html#cb209-8" tabindex="-1"></a><span class="fu">c</span>(Bhat)</span></code></pre></div>
<pre><code>## [1]  3.20715340  0.04390995 -0.04451047</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="ordinary-least-squares.html#cb211-1" tabindex="-1"></a><span class="do">## Check</span></span>
<span id="cb211-2"><a href="ordinary-least-squares.html#cb211-2" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder<span class="sc">~</span>Assault<span class="sc">+</span>UrbanPop, <span class="at">data=</span>USArrests)</span>
<span id="cb211-3"><a href="ordinary-least-squares.html#cb211-3" tabindex="-1"></a><span class="fu">coef</span>(reg)</span></code></pre></div>
<pre><code>## (Intercept)     Assault    UrbanPop 
##  3.20715340  0.04390995 -0.04451047</code></pre>
<p>To measure the ``Goodness of fit’’ of the model, we can again compute sums of squared srrors. Adding random data may sometimes improve the fit, however, so we adjust the <span class="math inline">\(R^2\)</span> by the number of covariates <span class="math inline">\(K\)</span>.
<span class="math display">\[
R^2 = \frac{ESS}{TSS}=1-\frac{RSS}{TSS}\\
R^2_{\text{adj.}} = 1-\frac{n-1}{n-K}(1-R^2)
\]</span></p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="ordinary-least-squares.html#cb213-1" tabindex="-1"></a>ksims <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb213-2"><a href="ordinary-least-squares.html#cb213-2" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> ksims){ </span>
<span id="cb213-3"><a href="ordinary-least-squares.html#cb213-3" tabindex="-1"></a>    USArrests[,<span class="fu">paste0</span>(<span class="st">&#39;R&#39;</span>,k)] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">nrow</span>(USArrests),<span class="dv">0</span>,<span class="dv">20</span>)</span>
<span id="cb213-4"><a href="ordinary-least-squares.html#cb213-4" tabindex="-1"></a>}</span>
<span id="cb213-5"><a href="ordinary-least-squares.html#cb213-5" tabindex="-1"></a>reg_sim <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ksims, <span class="cf">function</span>(k){</span>
<span id="cb213-6"><a href="ordinary-least-squares.html#cb213-6" tabindex="-1"></a>    rvars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Assault&#39;</span>,<span class="st">&#39;UrbanPop&#39;</span>, <span class="fu">paste0</span>(<span class="st">&#39;R&#39;</span>,<span class="dv">1</span><span class="sc">:</span>k))</span>
<span id="cb213-7"><a href="ordinary-least-squares.html#cb213-7" tabindex="-1"></a>    rvars2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(rvars, <span class="at">collapse=</span><span class="st">&#39;+&#39;</span>)</span>
<span id="cb213-8"><a href="ordinary-least-squares.html#cb213-8" tabindex="-1"></a>    reg_k <span class="ot">&lt;-</span> <span class="fu">lm</span>( <span class="fu">paste0</span>(<span class="st">&#39;Murder~&#39;</span>,rvars2), <span class="at">data=</span>USArrests)</span>
<span id="cb213-9"><a href="ordinary-least-squares.html#cb213-9" tabindex="-1"></a>})</span>
<span id="cb213-10"><a href="ordinary-least-squares.html#cb213-10" tabindex="-1"></a>R2_sim <span class="ot">&lt;-</span> <span class="fu">sapply</span>(reg_sim, <span class="cf">function</span>(reg_k){  <span class="fu">summary</span>(reg_k)<span class="sc">$</span>r.squared })</span>
<span id="cb213-11"><a href="ordinary-least-squares.html#cb213-11" tabindex="-1"></a>R2adj_sim <span class="ot">&lt;-</span> <span class="fu">sapply</span>(reg_sim, <span class="cf">function</span>(reg_k){  <span class="fu">summary</span>(reg_k)<span class="sc">$</span>adj.r.squared })</span>
<span id="cb213-12"><a href="ordinary-least-squares.html#cb213-12" tabindex="-1"></a></span>
<span id="cb213-13"><a href="ordinary-least-squares.html#cb213-13" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb213-14"><a href="ordinary-least-squares.html#cb213-14" tabindex="-1"></a><span class="fu">plot.window</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb213-15"><a href="ordinary-least-squares.html#cb213-15" tabindex="-1"></a><span class="fu">points</span>(ksims, R2_sim)</span>
<span id="cb213-16"><a href="ordinary-least-squares.html#cb213-16" tabindex="-1"></a><span class="fu">points</span>(ksims, R2adj_sim, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb213-17"><a href="ordinary-least-squares.html#cb213-17" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>)</span>
<span id="cb213-18"><a href="ordinary-least-squares.html#cb213-18" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb213-19"><a href="ordinary-least-squares.html#cb213-19" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(R<span class="sc">^</span><span class="dv">2</span>),<span class="dv">2</span>, <span class="at">line=</span><span class="dv">3</span>)</span>
<span id="cb213-20"><a href="ordinary-least-squares.html#cb213-20" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;Additional Random Covariates&#39;</span>, <span class="dv">1</span>, <span class="at">line=</span><span class="dv">3</span>)</span>
<span id="cb213-21"><a href="ordinary-least-squares.html#cb213-21" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="at">horiz=</span>T,</span>
<span id="cb213-22"><a href="ordinary-least-squares.html#cb213-22" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&#39;Undjusted&#39;</span>, <span class="st">&#39;Adjusted&#39;</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">16</span>))</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div id="variability-estimates-and-hypothesis-tests" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Variability Estimates and Hypothesis Tests<a href="ordinary-least-squares.html#variability-estimates-and-hypothesis-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To estimate the variability of our estimates, we can use the same <em>data-driven</em> methods introduced with simple OLS.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="ordinary-least-squares.html#cb214-1" tabindex="-1"></a><span class="do">## Bootstrap SE&#39;s</span></span>
<span id="cb214-2"><a href="ordinary-least-squares.html#cb214-2" tabindex="-1"></a>boots <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">399</span></span>
<span id="cb214-3"><a href="ordinary-least-squares.html#cb214-3" tabindex="-1"></a>boot_regs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(boots, <span class="cf">function</span>(b){</span>
<span id="cb214-4"><a href="ordinary-least-squares.html#cb214-4" tabindex="-1"></a>    b_id <span class="ot">&lt;-</span> <span class="fu">sample</span>( <span class="fu">nrow</span>(USArrests), <span class="at">replace=</span>T)</span>
<span id="cb214-5"><a href="ordinary-least-squares.html#cb214-5" tabindex="-1"></a>    xy_b <span class="ot">&lt;-</span> USArrests[b_id,]</span>
<span id="cb214-6"><a href="ordinary-least-squares.html#cb214-6" tabindex="-1"></a>    reg_b <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder<span class="sc">~</span>Assault<span class="sc">+</span>UrbanPop, <span class="at">dat=</span>xy_b)</span>
<span id="cb214-7"><a href="ordinary-least-squares.html#cb214-7" tabindex="-1"></a>})</span>
<span id="cb214-8"><a href="ordinary-least-squares.html#cb214-8" tabindex="-1"></a>boot_coefs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(boot_regs, coef)</span>
<span id="cb214-9"><a href="ordinary-least-squares.html#cb214-9" tabindex="-1"></a>boot_mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(boot_coefs,<span class="dv">1</span>, mean)</span>
<span id="cb214-10"><a href="ordinary-least-squares.html#cb214-10" tabindex="-1"></a>boot_se <span class="ot">&lt;-</span> <span class="fu">apply</span>(boot_coefs,<span class="dv">1</span>, sd)</span></code></pre></div>
<p>Also as before, we can conduct independant hypothesis tests.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> We can conduct joint tests, such as whether two coefficients are equal, by looking at the their joint distribution.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="ordinary-least-squares.html#cb215-1" tabindex="-1"></a>boot_coef_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(<span class="at">ID=</span>boots, <span class="fu">t</span>(boot_coefs)))</span>
<span id="cb215-2"><a href="ordinary-least-squares.html#cb215-2" tabindex="-1"></a>fig <span class="ot">&lt;-</span> plotly<span class="sc">::</span><span class="fu">plot_ly</span>(boot_coef_df,</span>
<span id="cb215-3"><a href="ordinary-least-squares.html#cb215-3" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;markers&#39;</span>,</span>
<span id="cb215-4"><a href="ordinary-least-squares.html#cb215-4" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>UrbanPop, <span class="at">y =</span> <span class="sc">~</span>Assault,</span>
<span id="cb215-5"><a href="ordinary-least-squares.html#cb215-5" tabindex="-1"></a>    <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">&#39;&lt;b&gt; boot: &#39;</span>, ID, <span class="st">&#39;&lt;/b&gt;&#39;</span>),</span>
<span id="cb215-6"><a href="ordinary-least-squares.html#cb215-6" tabindex="-1"></a>    <span class="at">hoverinfo=</span><span class="st">&#39;text&#39;</span>,</span>
<span id="cb215-7"><a href="ordinary-least-squares.html#cb215-7" tabindex="-1"></a>    <span class="at">showlegend=</span>F,</span>
<span id="cb215-8"><a href="ordinary-least-squares.html#cb215-8" tabindex="-1"></a>    <span class="at">marker=</span><span class="fu">list</span>( <span class="at">color=</span><span class="st">&#39;rgba(0, 0, 0, 0.5)&#39;</span>))</span>
<span id="cb215-9"><a href="ordinary-least-squares.html#cb215-9" tabindex="-1"></a>fig</span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-e5ee5d8935cc9d36b601" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-e5ee5d8935cc9d36b601">{"x":{"visdat":{"35776390f417":["function () ","plotlyVisDat"]},"cur_data":"35776390f417","attrs":{"35776390f417":{"mode":"markers","x":{},"y":{},"text":{},"hoverinfo":"text","showlegend":false,"marker":{"color":"rgba(0, 0, 0, 0.5)"},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"UrbanPop"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Assault"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"mode":"markers","x":[-0.054268053968995839,-0.09606955705523311,-0.047264223988495689,-0.04010130252157601,-0.077696791062127735,0.0013220677249995284,-0.06731185028908053,-0.038117065807810324,-0.031541428283666614,-0.060116821321359419,-0.065979548868434448,-0.051032522238625991,-0.034821607592717158,-0.080335295103606139,0.004513717554627544,-0.080952292014607505,-0.057870706258325501,-0.050792809894216411,-0.031597655598379286,-0.089175421767150931,-0.031663313928762912,-0.027668298984889286,-0.061594374110199052,-0.030854967107652332,-0.017387606033798537,-0.074597926136809489,-0.020630137883119088,-0.088855685613249843,-0.014195434736259173,-0.05524135438032314,0.0045285944942680253,-0.016365278468075315,-0.077804154013264626,-0.050181347125002315,-0.021178450760484802,-0.056969716894328067,-0.03175464787038336,-0.11370245350471307,-0.038771366833336283,-0.059861644220688411,-0.053762670524738258,-0.0395285144883269,-0.056993142668018942,-0.066235969721602325,-0.065586414934648299,-0.097747147670233098,-0.020364260397997214,-0.024255716181729284,-0.047063194291809579,0.010124295357281293,-0.025513894918683531,-0.020240641056583786,-0.04045642742670625,-0.033602987744968255,-0.018311600206132077,-0.04428016020172644,-0.11908887771287599,-0.088308783138250496,-0.023516096618834411,-0.028303369766810079,-0.0099494618613901083,-0.067122576861664743,-0.052754020556803075,-0.022058416452342956,-0.070368677343069327,-0.089500910603221462,-0.036798754813939148,-0.068306096646605113,-0.037490418540531506,-0.099308588097358874,-0.024778207847093791,0.018455841742383766,-0.038789747416128242,-0.054936004601463417,-0.07647957986325378,-0.026273408464214859,-0.054629641451540534,-0.042563487530506774,-0.093726862829419916,-0.067566699324526525,-0.056445308727184382,-0.041768739859734373,-0.06744691087086499,-0.024606702554270905,-0.016127221254102431,-0.041990079686463337,-0.050042640638471823,-0.058485188174226065,-0.030493463698343801,-0.044686746882289623,-0.10349270110579865,-0.017539545685490539,-0.050431629002280709,-0.080526990455298902,-0.056985259113861604,-0.0483874814388775,-0.052629020475884213,-0.019960695489205069,-0.061971530257324992,-0.053831273032393462,-0.017734661258386467,-0.0081681996882169722,0.0070053390000521876,-0.076641360694362434,-0.054585411189682201,-0.068197018216994976,-0.085640460255821449,-0.036203152952703314,-0.017344854345070018,-0.044759535840608315,0.018945543814128985,-0.049707128452413193,-0.023646895370172352,-0.052319234585880961,-0.053783890721473417,-0.057649141330547153,-0.051402379092394035,-0.067636550272566376,-0.074462569581015589,-0.033612317108727127,-0.046531369619450549,-0.032543235643136673,-0.077415216837404544,-0.061071533492163037,-0.063228286455746643,-0.084852269017027887,-0.0765885263417075,-0.05440889565465739,-0.053469735853593089,-0.051629372344110025,-0.048919413311257598,-0.078326019448516401,-0.058895890580584274,-0.0016667326640725515,-0.039222975667682437,-0.064881122090274079,-0.032085275610794092,-0.084871000158245766,-0.0065273967980107178,-0.068097879718966636,-0.13289618836438127,-0.046184843604895609,-0.0456975663405128,-0.10630942846811615,-0.052237224328414003,-0.049132328001668821,-0.049768057851047459,-0.010420879075415203,-0.070379770800313116,-0.029999751176581758,-0.073757813711105083,-0.056351253862352006,-0.077232723555110253,-0.053145176796933466,-0.03179281160313769,-0.02102101989097151,-0.049334002671331111,-0.044868640054397335,-0.00011184238582241052,-0.025415870994662523,-0.047105911646463605,-0.060384846135120428,-0.043114967469194444,-0.059086488082897085,-0.045687019831518468,-0.12271959430347755,-0.056734743972571194,-0.0072223205289421869,-0.070607379375842272,-0.059940611201972319,-0.015903670214725271,-0.091905620581159989,-0.078231505554251388,-0.044915230427114899,-0.066207111467276245,-0.046304197422888986,-0.045691688910997105,-0.043530979548949057,-0.054574362154044521,-0.0096834417730993771,-0.046319516292626262,-0.064601816667532799,-0.032665621324675341,-0.034333925844453148,-0.078831355437105274,-0.033545359764165096,-0.050142932891256056,-0.047650465834334764,-0.018924810367222093,-0.041398109533085724,-0.035067874759543871,-0.061173993990962586,-0.079056700780838915,-0.077255967671464768,-0.046531624470311457,-0.090544207393881401,-0.024273915302383795,-0.0532988878053548,-0.044175905906095776,-0.024685319169716242,-0.036077035385617906,-0.050455729584277804,-0.019913368384032411,-0.03225200824797133,-0.10372141378224418,-0.035898027002212216,-0.09797087242951534,0.020695444759183213,-0.0087604987930169301,-0.06808861340811205,-0.071377552711971534,-0.034409679171833345,-0.065502442909442418,0.023665915251089322,-0.040096870461470098,-0.034350353773058992,-0.052605104591577696,-0.083003340248471502,-0.053562960453564123,-0.059908268765739077,-0.049543252912313207,-0.017457108298829432,-0.053212394405121606,-0.01975937212739046,-0.032530521410424333,-0.034840133506127351,-0.062105876062350636,-0.066144947382850872,-0.030425856110767025,0.0060420071277792293,-0.058264397637300222,-0.0001982418375582756,-0.071751832036086344,-0.066074333407339828,-0.022590394805519269,-0.032621018653872229,-0.041879492636281906,-0.055060278587814211,-0.046268239847289595,-0.031877420879120252,-0.045866713242789403,-0.039663159362365183,-0.022143892103419712,-0.046735882909247836,-0.042894538893756926,-0.051176354683649269,-0.051207174423393356,-0.084559806455102249,-0.059753191500319158,-0.053984440083019079,-0.11249593567739159,-0.054660028661404708,-0.031608757863916731,-0.03201108394778774,-0.036389672783221527,-0.069601182414434276,-0.061336300455409894,-0.071659828957874108,-0.0032748751417228492,-0.061009427016124856,-0.081061656472547164,-0.020123244752350371,-0.0029780711466687523,-0.084021463976666655,-0.038035294220140951,-0.0090796034568317967,-0.02548453804868122,-0.022089010815772692,-0.10447635545359259,0.00026375203920783893,-0.03157639590688812,-0.086655786002174606,-0.037262955515525858,-0.043958458850740324,-0.082857472800261289,-0.048145751129286263,-0.050260247724166283,-0.0048148285962067777,-0.089838832705632365,-0.024555051716073643,-0.060704526231801857,-0.072650407286999771,-0.049937811110628033,-0.019188747304060498,-0.011092850226646253,-0.064209015246542406,-0.059576729562822117,-0.015974934159167582,-0.022507843503763836,-0.012969821833453694,-0.024596900182030288,-0.0042301891626909229,-0.019741712107072585,-0.02849473164627659,-0.074649679289747681,-0.072588433974848793,-0.020716981209880195,-0.073882441117519321,-0.032915162987130674,-0.052970890385699659,-0.047164865727741444,-0.076801891753114165,-0.052499795289051632,-0.018421732896213596,-0.077546669163450391,-0.058861799981904793,-0.060490966359825912,-0.062918525755332952,-0.05746846481993545,-0.078941115115528898,-0.0050614908947417946,-0.07415756353262859,-0.024792525645180998,-0.052184464192765796,-0.038734429921832729,0.0061138193693419333,-0.048043367580457734,-0.081748136969707591,-0.10300461311417336,-0.07625806192249443,-0.018255759525856299,-0.092121697954252638,-0.05265852597793632,-0.03016044606888349,-0.020346682838572362,-0.044056253929133579,-0.056377684175134078,-0.052417108888243989,-0.063178604190354662,-0.037593791397025546,-0.025599087385319394,-0.03314926995365345,-0.023292164391157999,-0.0458019362970494,-0.018537148537020449,-0.028820391700497272,-0.09254755557091203,-0.084003555116966389,-0.065900898130919899,-0.062150087495899162,-0.0091728650774580145,-0.073571041804940313,-0.048099623748692942,-0.061860285956141271,-0.072981745572846465,-0.012532981586146571,-0.037176564540497697,0.0063894026329776605,-0.040562621421080053,-0.013128809408951439,-0.055167292651778395,-0.10698525116126155,-0.051229566734011495,-0.059483210003711574,-0.00088297142786404018,-0.020234111600543371,-0.10225920546516905,-0.037117441461573496,-0.06095261492711989,-0.0817993408536936,-0.034163741884636757,-0.07636162464575609,-0.083023362747381743,-0.030110566768252578,-0.020503837193251835,-0.021032567302221968,-0.072878444299342648,-0.076164213087031321,-0.060952137977151419,-0.051981303350405128,-0.032065641253254368,-0.014463560402098069,-0.024974290009294998,-0.023426406078585583,-0.067584800070794579,-0.018860726798099695,-0.0063870367456475927,-0.01636374122659854,-0.0056397267016824954,-0.052981452374366411,-0.059134156401470808,-0.072029582143593895,-0.019917742380379494,-0.033486151829720631,-0.078844766717411002,-0.037600064323292749,-0.049340400540547953,-0.025290559147346507,-0.0042868483064168001,-0.057228869703976011,-0.035241105269125349,-0.071361989176605203,-0.061371853072906934,-0.029996586078778694,-0.063433309686096437,-0.052195279628340897,-0.054282630833853075,-0.052808924751707946,0.0030481500309799182],"y":[0.046184762402817395,0.038877043771909821,0.05250648793189211,0.034929811373931072,0.045214998864503447,0.041899723342223895,0.046817326945791889,0.037200297081610406,0.037659782232206729,0.047476221698771082,0.047938676464467068,0.040147494613907736,0.041088226778987373,0.046039245419482802,0.036559747659301929,0.047680845897155481,0.03838784689885507,0.048373094644962117,0.044747326726108483,0.041217647076800694,0.050136794090982269,0.043412761774439368,0.043864213212945341,0.046693824934411723,0.035282938348328463,0.037839388426413018,0.041855050164568725,0.044042271915934274,0.049171482197783639,0.038346990690496019,0.042769796958465889,0.039538437799928307,0.047857761852727207,0.048851501371893688,0.041217380229900485,0.041003202100292617,0.045126048644361337,0.052685349871900565,0.034502206846576851,0.044294058118886891,0.04465396466381414,0.046069362585148363,0.045752455530384338,0.046555395762162652,0.052550945565600318,0.052103608903777306,0.040168875643924219,0.042697058709761281,0.047416378843979368,0.038614215454787923,0.040370668303784892,0.045469179077841204,0.05215912000108739,0.037188213248342164,0.041944265879316253,0.04160164237947743,0.045189966349505374,0.053584325228139128,0.035875738699611429,0.045613789016650849,0.04200154340798639,0.047202813958708491,0.041026163547443269,0.043206718718052935,0.041766157778765113,0.046300046256160791,0.037160878855451808,0.040867972966687462,0.045685509056061342,0.052750220656392871,0.040546738349339202,0.042684751361892856,0.039363416392794837,0.051368843467515947,0.049191213688792042,0.040518592833449572,0.046972702572838976,0.049767550710038487,0.04803068790794289,0.041569785908452839,0.049700223724772702,0.042827168205059857,0.053488517386044154,0.038584114850103796,0.035584976204260786,0.048460967947202165,0.042256081687730464,0.047193105749585199,0.042041794665240495,0.037515846431370292,0.051062727692175666,0.042488113957440468,0.039689784833465074,0.049476135396206503,0.045905355979403602,0.046414618869197011,0.046570745857875046,0.037804171278287682,0.049630198711681346,0.046148802626943521,0.047913602770512348,0.046074467516311855,0.039856251546419044,0.045146244450315856,0.045690603939009679,0.042732837696186229,0.049536400365542826,0.03810026655772935,0.04091676425955653,0.037794987778584387,0.041026964665339817,0.04204185659664457,0.038304064649412432,0.047170002685831616,0.042073307216716052,0.047685128948467,0.049960166997164324,0.045868884769240587,0.055763493728188895,0.044128167240793298,0.04591013315135755,0.042448713463764283,0.040860622362826532,0.04340727976495206,0.043810844714280352,0.046676786733629558,0.048290487534757655,0.045036440634479341,0.049900548906792727,0.053821563495420173,0.048506465051887236,0.049419890348237898,0.0407580825852005,0.04232853841848707,0.042179353696463563,0.046561496054449966,0.040714451594540943,0.047132408517737027,0.041834836912880584,0.042121868670110987,0.048456399597583258,0.044854102419832537,0.044092212876658848,0.04580347917497913,0.050459123240611817,0.047202437785179165,0.04660283708355966,0.040732266867549431,0.051294358739428794,0.04193438540238819,0.048886913645379559,0.041132906926936247,0.043368682126747181,0.047062549510580858,0.037774475969636727,0.036114987782871338,0.040550616154777168,0.043710293797041458,0.041996922871400097,0.04553615173792519,0.042010395390432338,0.045710993680010505,0.04168425257546924,0.037159045486323164,0.04153776669315274,0.053238914184946425,0.039718196610024577,0.044724336478390844,0.043194325936627212,0.042128031396944952,0.037733528868069757,0.050796245508519841,0.043493181607218892,0.046409393028522011,0.051621255717323129,0.044684063237032223,0.040455611360232194,0.04263567816003639,0.048399403000397592,0.043198221747080032,0.047817898913254664,0.048749140268860187,0.041310786762319474,0.041253237722476944,0.054630911399776202,0.047688119385899744,0.039952812668112771,0.042479784091708578,0.037039954917013743,0.039505579095244124,0.040322950788878306,0.044817849144342753,0.041224597624072039,0.043037346636426353,0.041247596702445363,0.050441224458920769,0.040785862707940115,0.044458321377119345,0.041678678563061046,0.043086104363905288,0.039268669881954141,0.045151705914953627,0.04410139082771454,0.052467534503973866,0.052705980977303384,0.04086713312004428,0.060626157033115267,0.042131913605400376,0.04354364137771205,0.042687902311160764,0.044330463875811132,0.044220983225875705,0.055679419471470676,0.039564848424008835,0.045889383730747003,0.041333346411323017,0.046750282628236793,0.03984835106136974,0.039433764928399617,0.051279777604904715,0.045109885409529531,0.043916409036764033,0.042744449581945877,0.038100771973279657,0.042523403864934764,0.04060898761526345,0.052115750772991257,0.044028283683772526,0.042295705662229829,0.043029280436005075,0.048792829938056545,0.037995438909445352,0.046292917156028832,0.048669983174147752,0.047243814521432025,0.037450721644845836,0.043879543946714207,0.04703490692573202,0.039930837982458882,0.043306590281993525,0.038978872802645795,0.040758040159409488,0.039508138886834208,0.047509551900981328,0.049668856453239325,0.036829974603703831,0.047844744411629073,0.045222385947149828,0.041531143576088884,0.047740501790718572,0.054192564745769646,0.043294422866501606,0.046327580685701031,0.049581257362228195,0.041250524778471888,0.046533428333736006,0.044109807721025726,0.047227563174738599,0.044747208057064426,0.043138028437281685,0.052406525233501838,0.041351589677725967,0.039175929856387424,0.047251237878751344,0.043854008530744448,0.039936577378303043,0.041684924989444101,0.042368684088522741,0.044072337769341684,0.032042091432178413,0.043843411599764612,0.044030293155883596,0.041500287895846678,0.045488167370420746,0.054742003199686959,0.046425612931698335,0.047979504479383844,0.043073463842538483,0.055979894237341815,0.045326290113383141,0.039902428092157931,0.053490366792096095,0.042711714003110218,0.039338534767218346,0.039492175103300581,0.044823284419346562,0.044823396951728586,0.040942880896447167,0.04015865436402747,0.041066215647686651,0.042167154601206375,0.040109571725974853,0.040468539336280793,0.046825430445429854,0.041993148330206918,0.044519629084759302,0.048633688523612807,0.047927365292946798,0.042531588472893553,0.043457798722529847,0.041893019436396908,0.041030200512302877,0.042637675734955638,0.044971828514511404,0.056196633847190362,0.04830580422001219,0.046463855067942005,0.03812587857031155,0.05325309658581822,0.046540797798331368,0.039609222834338098,0.050243615710943532,0.038531066101276448,0.049688185242531303,0.037838519526661438,0.039938308615804656,0.043290106935974258,0.051133914051662087,0.055869953533074397,0.05124871889090718,0.04491342809808338,0.041835150853761188,0.038956694579061785,0.046279923876883552,0.043538780176635081,0.040126605835131876,0.044529991430224507,0.047412987691593265,0.044426383390266749,0.047573430410019109,0.043282501603343362,0.037750895342966294,0.051109366585948376,0.048370721073955375,0.03991857410299389,0.050404751204514528,0.050751800862391123,0.051255731866272254,0.041683128152837895,0.04722846523391077,0.040582864605991163,0.04938213799770514,0.041682668740745797,0.049504665299413046,0.044934867324165927,0.048208546660740224,0.043239948835248947,0.03453316216149302,0.037445250120553129,0.040910279957342158,0.042341824625165642,0.050794145159019845,0.04416903635590097,0.034897702309834258,0.044352849093825412,0.049712967747044513,0.04626523694782738,0.040407272452019451,0.0476434255616233,0.047613985819595972,0.044430931846713782,0.048803588483046841,0.047226279284745397,0.043307848373845277,0.039671081444548451,0.045683542977943387,0.04575411115677231,0.045547996819071616,0.040829897914568515,0.046875175306137502,0.044777597898602896,0.040865988071084179,0.038668032192380998,0.042900765907809883,0.043818954349077288,0.037949497624090431,0.044781363621711326,0.042680542176372391,0.046519015047723114,0.044304417133035609,0.038273099554424136,0.04785395378995002,0.039185432791692752,0.047795269802436834,0.046716211188676408,0.041836327954673347,0.042406199688900262,0.048109654705744832,0.039394731853778633,0.048609807197741259,0.042822767199113536,0.04709153246510922,0.041432796180829325,0.041251907413567691,0.043884460535129954,0.040379797551913503,0.044132906590145189,0.04564453605280637,0.035865931166277724],"text":["<b> boot:  1 <\/b>","<b> boot:  2 <\/b>","<b> boot:  3 <\/b>","<b> boot:  4 <\/b>","<b> boot:  5 <\/b>","<b> boot:  6 <\/b>","<b> boot:  7 <\/b>","<b> boot:  8 <\/b>","<b> boot:  9 <\/b>","<b> boot:  10 <\/b>","<b> boot:  11 <\/b>","<b> boot:  12 <\/b>","<b> boot:  13 <\/b>","<b> boot:  14 <\/b>","<b> boot:  15 <\/b>","<b> boot:  16 <\/b>","<b> boot:  17 <\/b>","<b> boot:  18 <\/b>","<b> boot:  19 <\/b>","<b> boot:  20 <\/b>","<b> boot:  21 <\/b>","<b> boot:  22 <\/b>","<b> boot:  23 <\/b>","<b> boot:  24 <\/b>","<b> boot:  25 <\/b>","<b> boot:  26 <\/b>","<b> boot:  27 <\/b>","<b> boot:  28 <\/b>","<b> boot:  29 <\/b>","<b> boot:  30 <\/b>","<b> boot:  31 <\/b>","<b> boot:  32 <\/b>","<b> boot:  33 <\/b>","<b> boot:  34 <\/b>","<b> boot:  35 <\/b>","<b> boot:  36 <\/b>","<b> boot:  37 <\/b>","<b> boot:  38 <\/b>","<b> boot:  39 <\/b>","<b> boot:  40 <\/b>","<b> boot:  41 <\/b>","<b> boot:  42 <\/b>","<b> boot:  43 <\/b>","<b> boot:  44 <\/b>","<b> boot:  45 <\/b>","<b> boot:  46 <\/b>","<b> boot:  47 <\/b>","<b> boot:  48 <\/b>","<b> boot:  49 <\/b>","<b> boot:  50 <\/b>","<b> boot:  51 <\/b>","<b> boot:  52 <\/b>","<b> boot:  53 <\/b>","<b> boot:  54 <\/b>","<b> boot:  55 <\/b>","<b> boot:  56 <\/b>","<b> boot:  57 <\/b>","<b> boot:  58 <\/b>","<b> boot:  59 <\/b>","<b> boot:  60 <\/b>","<b> boot:  61 <\/b>","<b> boot:  62 <\/b>","<b> boot:  63 <\/b>","<b> boot:  64 <\/b>","<b> boot:  65 <\/b>","<b> boot:  66 <\/b>","<b> boot:  67 <\/b>","<b> boot:  68 <\/b>","<b> boot:  69 <\/b>","<b> boot:  70 <\/b>","<b> boot:  71 <\/b>","<b> boot:  72 <\/b>","<b> boot:  73 <\/b>","<b> boot:  74 <\/b>","<b> boot:  75 <\/b>","<b> boot:  76 <\/b>","<b> boot:  77 <\/b>","<b> boot:  78 <\/b>","<b> boot:  79 <\/b>","<b> boot:  80 <\/b>","<b> boot:  81 <\/b>","<b> boot:  82 <\/b>","<b> boot:  83 <\/b>","<b> boot:  84 <\/b>","<b> boot:  85 <\/b>","<b> boot:  86 <\/b>","<b> boot:  87 <\/b>","<b> boot:  88 <\/b>","<b> boot:  89 <\/b>","<b> boot:  90 <\/b>","<b> boot:  91 <\/b>","<b> boot:  92 <\/b>","<b> boot:  93 <\/b>","<b> boot:  94 <\/b>","<b> boot:  95 <\/b>","<b> boot:  96 <\/b>","<b> boot:  97 <\/b>","<b> boot:  98 <\/b>","<b> boot:  99 <\/b>","<b> boot:  100 <\/b>","<b> boot:  101 <\/b>","<b> boot:  102 <\/b>","<b> boot:  103 <\/b>","<b> boot:  104 <\/b>","<b> boot:  105 <\/b>","<b> boot:  106 <\/b>","<b> boot:  107 <\/b>","<b> boot:  108 <\/b>","<b> boot:  109 <\/b>","<b> boot:  110 <\/b>","<b> boot:  111 <\/b>","<b> boot:  112 <\/b>","<b> boot:  113 <\/b>","<b> boot:  114 <\/b>","<b> boot:  115 <\/b>","<b> boot:  116 <\/b>","<b> boot:  117 <\/b>","<b> boot:  118 <\/b>","<b> boot:  119 <\/b>","<b> boot:  120 <\/b>","<b> boot:  121 <\/b>","<b> boot:  122 <\/b>","<b> boot:  123 <\/b>","<b> boot:  124 <\/b>","<b> boot:  125 <\/b>","<b> boot:  126 <\/b>","<b> boot:  127 <\/b>","<b> boot:  128 <\/b>","<b> boot:  129 <\/b>","<b> boot:  130 <\/b>","<b> boot:  131 <\/b>","<b> boot:  132 <\/b>","<b> boot:  133 <\/b>","<b> boot:  134 <\/b>","<b> boot:  135 <\/b>","<b> boot:  136 <\/b>","<b> boot:  137 <\/b>","<b> boot:  138 <\/b>","<b> boot:  139 <\/b>","<b> boot:  140 <\/b>","<b> boot:  141 <\/b>","<b> boot:  142 <\/b>","<b> boot:  143 <\/b>","<b> boot:  144 <\/b>","<b> boot:  145 <\/b>","<b> boot:  146 <\/b>","<b> boot:  147 <\/b>","<b> boot:  148 <\/b>","<b> boot:  149 <\/b>","<b> boot:  150 <\/b>","<b> boot:  151 <\/b>","<b> boot:  152 <\/b>","<b> boot:  153 <\/b>","<b> boot:  154 <\/b>","<b> boot:  155 <\/b>","<b> boot:  156 <\/b>","<b> boot:  157 <\/b>","<b> boot:  158 <\/b>","<b> boot:  159 <\/b>","<b> boot:  160 <\/b>","<b> boot:  161 <\/b>","<b> boot:  162 <\/b>","<b> boot:  163 <\/b>","<b> boot:  164 <\/b>","<b> boot:  165 <\/b>","<b> boot:  166 <\/b>","<b> boot:  167 <\/b>","<b> boot:  168 <\/b>","<b> boot:  169 <\/b>","<b> boot:  170 <\/b>","<b> boot:  171 <\/b>","<b> boot:  172 <\/b>","<b> boot:  173 <\/b>","<b> boot:  174 <\/b>","<b> boot:  175 <\/b>","<b> boot:  176 <\/b>","<b> boot:  177 <\/b>","<b> boot:  178 <\/b>","<b> boot:  179 <\/b>","<b> boot:  180 <\/b>","<b> boot:  181 <\/b>","<b> boot:  182 <\/b>","<b> boot:  183 <\/b>","<b> boot:  184 <\/b>","<b> boot:  185 <\/b>","<b> boot:  186 <\/b>","<b> boot:  187 <\/b>","<b> boot:  188 <\/b>","<b> boot:  189 <\/b>","<b> boot:  190 <\/b>","<b> boot:  191 <\/b>","<b> boot:  192 <\/b>","<b> boot:  193 <\/b>","<b> boot:  194 <\/b>","<b> boot:  195 <\/b>","<b> boot:  196 <\/b>","<b> boot:  197 <\/b>","<b> boot:  198 <\/b>","<b> boot:  199 <\/b>","<b> boot:  200 <\/b>","<b> boot:  201 <\/b>","<b> boot:  202 <\/b>","<b> boot:  203 <\/b>","<b> boot:  204 <\/b>","<b> boot:  205 <\/b>","<b> boot:  206 <\/b>","<b> boot:  207 <\/b>","<b> boot:  208 <\/b>","<b> boot:  209 <\/b>","<b> boot:  210 <\/b>","<b> boot:  211 <\/b>","<b> boot:  212 <\/b>","<b> boot:  213 <\/b>","<b> boot:  214 <\/b>","<b> boot:  215 <\/b>","<b> boot:  216 <\/b>","<b> boot:  217 <\/b>","<b> boot:  218 <\/b>","<b> boot:  219 <\/b>","<b> boot:  220 <\/b>","<b> boot:  221 <\/b>","<b> boot:  222 <\/b>","<b> boot:  223 <\/b>","<b> boot:  224 <\/b>","<b> boot:  225 <\/b>","<b> boot:  226 <\/b>","<b> boot:  227 <\/b>","<b> boot:  228 <\/b>","<b> boot:  229 <\/b>","<b> boot:  230 <\/b>","<b> boot:  231 <\/b>","<b> boot:  232 <\/b>","<b> boot:  233 <\/b>","<b> boot:  234 <\/b>","<b> boot:  235 <\/b>","<b> boot:  236 <\/b>","<b> boot:  237 <\/b>","<b> boot:  238 <\/b>","<b> boot:  239 <\/b>","<b> boot:  240 <\/b>","<b> boot:  241 <\/b>","<b> boot:  242 <\/b>","<b> boot:  243 <\/b>","<b> boot:  244 <\/b>","<b> boot:  245 <\/b>","<b> boot:  246 <\/b>","<b> boot:  247 <\/b>","<b> boot:  248 <\/b>","<b> boot:  249 <\/b>","<b> boot:  250 <\/b>","<b> boot:  251 <\/b>","<b> boot:  252 <\/b>","<b> boot:  253 <\/b>","<b> boot:  254 <\/b>","<b> boot:  255 <\/b>","<b> boot:  256 <\/b>","<b> boot:  257 <\/b>","<b> boot:  258 <\/b>","<b> boot:  259 <\/b>","<b> boot:  260 <\/b>","<b> boot:  261 <\/b>","<b> boot:  262 <\/b>","<b> boot:  263 <\/b>","<b> boot:  264 <\/b>","<b> boot:  265 <\/b>","<b> boot:  266 <\/b>","<b> boot:  267 <\/b>","<b> boot:  268 <\/b>","<b> boot:  269 <\/b>","<b> boot:  270 <\/b>","<b> boot:  271 <\/b>","<b> boot:  272 <\/b>","<b> boot:  273 <\/b>","<b> boot:  274 <\/b>","<b> boot:  275 <\/b>","<b> boot:  276 <\/b>","<b> boot:  277 <\/b>","<b> boot:  278 <\/b>","<b> boot:  279 <\/b>","<b> boot:  280 <\/b>","<b> boot:  281 <\/b>","<b> boot:  282 <\/b>","<b> boot:  283 <\/b>","<b> boot:  284 <\/b>","<b> boot:  285 <\/b>","<b> boot:  286 <\/b>","<b> boot:  287 <\/b>","<b> boot:  288 <\/b>","<b> boot:  289 <\/b>","<b> boot:  290 <\/b>","<b> boot:  291 <\/b>","<b> boot:  292 <\/b>","<b> boot:  293 <\/b>","<b> boot:  294 <\/b>","<b> boot:  295 <\/b>","<b> boot:  296 <\/b>","<b> boot:  297 <\/b>","<b> boot:  298 <\/b>","<b> boot:  299 <\/b>","<b> boot:  300 <\/b>","<b> boot:  301 <\/b>","<b> boot:  302 <\/b>","<b> boot:  303 <\/b>","<b> boot:  304 <\/b>","<b> boot:  305 <\/b>","<b> boot:  306 <\/b>","<b> boot:  307 <\/b>","<b> boot:  308 <\/b>","<b> boot:  309 <\/b>","<b> boot:  310 <\/b>","<b> boot:  311 <\/b>","<b> boot:  312 <\/b>","<b> boot:  313 <\/b>","<b> boot:  314 <\/b>","<b> boot:  315 <\/b>","<b> boot:  316 <\/b>","<b> boot:  317 <\/b>","<b> boot:  318 <\/b>","<b> boot:  319 <\/b>","<b> boot:  320 <\/b>","<b> boot:  321 <\/b>","<b> boot:  322 <\/b>","<b> boot:  323 <\/b>","<b> boot:  324 <\/b>","<b> boot:  325 <\/b>","<b> boot:  326 <\/b>","<b> boot:  327 <\/b>","<b> boot:  328 <\/b>","<b> boot:  329 <\/b>","<b> boot:  330 <\/b>","<b> boot:  331 <\/b>","<b> boot:  332 <\/b>","<b> boot:  333 <\/b>","<b> boot:  334 <\/b>","<b> boot:  335 <\/b>","<b> boot:  336 <\/b>","<b> boot:  337 <\/b>","<b> boot:  338 <\/b>","<b> boot:  339 <\/b>","<b> boot:  340 <\/b>","<b> boot:  341 <\/b>","<b> boot:  342 <\/b>","<b> boot:  343 <\/b>","<b> boot:  344 <\/b>","<b> boot:  345 <\/b>","<b> boot:  346 <\/b>","<b> boot:  347 <\/b>","<b> boot:  348 <\/b>","<b> boot:  349 <\/b>","<b> boot:  350 <\/b>","<b> boot:  351 <\/b>","<b> boot:  352 <\/b>","<b> boot:  353 <\/b>","<b> boot:  354 <\/b>","<b> boot:  355 <\/b>","<b> boot:  356 <\/b>","<b> boot:  357 <\/b>","<b> boot:  358 <\/b>","<b> boot:  359 <\/b>","<b> boot:  360 <\/b>","<b> boot:  361 <\/b>","<b> boot:  362 <\/b>","<b> boot:  363 <\/b>","<b> boot:  364 <\/b>","<b> boot:  365 <\/b>","<b> boot:  366 <\/b>","<b> boot:  367 <\/b>","<b> boot:  368 <\/b>","<b> boot:  369 <\/b>","<b> boot:  370 <\/b>","<b> boot:  371 <\/b>","<b> boot:  372 <\/b>","<b> boot:  373 <\/b>","<b> boot:  374 <\/b>","<b> boot:  375 <\/b>","<b> boot:  376 <\/b>","<b> boot:  377 <\/b>","<b> boot:  378 <\/b>","<b> boot:  379 <\/b>","<b> boot:  380 <\/b>","<b> boot:  381 <\/b>","<b> boot:  382 <\/b>","<b> boot:  383 <\/b>","<b> boot:  384 <\/b>","<b> boot:  385 <\/b>","<b> boot:  386 <\/b>","<b> boot:  387 <\/b>","<b> boot:  388 <\/b>","<b> boot:  389 <\/b>","<b> boot:  390 <\/b>","<b> boot:  391 <\/b>","<b> boot:  392 <\/b>","<b> boot:  393 <\/b>","<b> boot:  394 <\/b>","<b> boot:  395 <\/b>","<b> boot:  396 <\/b>","<b> boot:  397 <\/b>","<b> boot:  398 <\/b>","<b> boot:  399 <\/b>"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"showlegend":false,"marker":{"color":"rgba(0, 0, 0, 0.5)","line":{"color":"rgba(31,119,180,1)"}},"type":"scatter","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="ordinary-least-squares.html#cb216-1" tabindex="-1"></a><span class="do">## Show Histogram of Coefficients</span></span>
<span id="cb216-2"><a href="ordinary-least-squares.html#cb216-2" tabindex="-1"></a><span class="do">## plotly::add_histogram2d(fig, nbinsx=20, nbinsy=20)</span></span>
<span id="cb216-3"><a href="ordinary-least-squares.html#cb216-3" tabindex="-1"></a></span>
<span id="cb216-4"><a href="ordinary-least-squares.html#cb216-4" tabindex="-1"></a><span class="do">## Show 95% Contour</span></span>
<span id="cb216-5"><a href="ordinary-least-squares.html#cb216-5" tabindex="-1"></a><span class="do">## plotly::add_histogram2dcontour(fig)</span></span>
<span id="cb216-6"><a href="ordinary-least-squares.html#cb216-6" tabindex="-1"></a><span class="do">## fig &lt;- layout(fig,</span></span>
<span id="cb216-7"><a href="ordinary-least-squares.html#cb216-7" tabindex="-1"></a><span class="do">##    yaxis = list(title=expression(beta[3])),</span></span>
<span id="cb216-8"><a href="ordinary-least-squares.html#cb216-8" tabindex="-1"></a><span class="do">##    xaxis = list(title=expression(beta[2])))</span></span></code></pre></div>
<p>We can also use an <span class="math inline">\(F\)</span> test for <span class="math inline">\(q\)</span> hypotheses;
<span class="math display">\[
\hat{F}_{q} = \frac{(ESS_{restricted}-ESS_{unrestricted})/q}{ESS_{unrestricted}/(n-K)},
\]</span>
and <span class="math inline">\(\hat{F}\)</span> can be written in terms of unrestricted and restricted <span class="math inline">\(R^2\)</span>. Under some additional assumptions <span class="math inline">\(\hat{F}_{q} \sim F_{q,n-K}\)</span>. For some inuition, we will examine how the <span class="math inline">\(R^2\)</span> statistic varies with bootstrap samples. Specifically, compute a null <span class="math inline">\(R^2\)</span> distribution by randomly reshuffling the outcomes and compare it to the observed <span class="math inline">\(R^2\)</span>.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="ordinary-least-squares.html#cb217-1" tabindex="-1"></a><span class="do">## Bootstrap NULL</span></span>
<span id="cb217-2"><a href="ordinary-least-squares.html#cb217-2" tabindex="-1"></a>boots <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">399</span></span>
<span id="cb217-3"><a href="ordinary-least-squares.html#cb217-3" tabindex="-1"></a>boot_regs0 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(boots, <span class="cf">function</span>(b){</span>
<span id="cb217-4"><a href="ordinary-least-squares.html#cb217-4" tabindex="-1"></a>  xy_b <span class="ot">&lt;-</span> USArrests</span>
<span id="cb217-5"><a href="ordinary-least-squares.html#cb217-5" tabindex="-1"></a>  b_id <span class="ot">&lt;-</span> <span class="fu">sample</span>( <span class="fu">nrow</span>(USArrests), <span class="at">replace=</span>T)</span>
<span id="cb217-6"><a href="ordinary-least-squares.html#cb217-6" tabindex="-1"></a>  xy_b<span class="sc">$</span>Murder <span class="ot">&lt;-</span>  xy_b<span class="sc">$</span>Murder[b_id]</span>
<span id="cb217-7"><a href="ordinary-least-squares.html#cb217-7" tabindex="-1"></a>  reg_b <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder<span class="sc">~</span>Assault<span class="sc">+</span>UrbanPop, <span class="at">dat=</span>xy_b)</span>
<span id="cb217-8"><a href="ordinary-least-squares.html#cb217-8" tabindex="-1"></a>})</span>
<span id="cb217-9"><a href="ordinary-least-squares.html#cb217-9" tabindex="-1"></a></span>
<span id="cb217-10"><a href="ordinary-least-squares.html#cb217-10" tabindex="-1"></a>boot_coefs0 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(boot_regs0, <span class="cf">function</span>(reg_k){</span>
<span id="cb217-11"><a href="ordinary-least-squares.html#cb217-11" tabindex="-1"></a>    <span class="fu">coef</span>(reg_k) })</span>
<span id="cb217-12"><a href="ordinary-least-squares.html#cb217-12" tabindex="-1"></a>R2_sim0 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(boot_regs0, <span class="cf">function</span>(reg_k){</span>
<span id="cb217-13"><a href="ordinary-least-squares.html#cb217-13" tabindex="-1"></a>    <span class="fu">summary</span>(reg_k)<span class="sc">$</span>r.squared })</span>
<span id="cb217-14"><a href="ordinary-least-squares.html#cb217-14" tabindex="-1"></a>R2adj_sim0 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(boot_regs0, <span class="cf">function</span>(reg_k){</span>
<span id="cb217-15"><a href="ordinary-least-squares.html#cb217-15" tabindex="-1"></a>    <span class="fu">summary</span>(reg_k)<span class="sc">$</span>adj.r.squared })</span>
<span id="cb217-16"><a href="ordinary-least-squares.html#cb217-16" tabindex="-1"></a></span>
<span id="cb217-17"><a href="ordinary-least-squares.html#cb217-17" tabindex="-1"></a><span class="fu">hist</span>(R2adj_sim0, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">breaks=</span><span class="dv">25</span>,</span>
<span id="cb217-18"><a href="ordinary-least-squares.html#cb217-18" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;&#39;</span>, <span class="at">xlab=</span><span class="fu">expression</span>(<span class="st">&#39;adj.&#39;</span><span class="sc">~</span>R[b]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb217-19"><a href="ordinary-least-squares.html#cb217-19" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">summary</span>(reg)<span class="sc">$</span>adj.r.squared, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p><em>Hypothesis Testing is not to be done routinely</em> and additional complications arise when testing multiple hypothesis.</p>
</div>
</div>
<div id="coefficient-interpretation" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Coefficient Interpretation<a href="ordinary-least-squares.html#coefficient-interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Notice that we have gotten pretty far without actually trying to meaningfully interpret regression coefficients. That is because the above procedure will always give us number, regardless as to whether the true data generating process is linear or not. So, to be cautious, we have been interpretting the regression outputs while being agnostic as to how the data are generated. We now consider a special situation where we know the data are generated according to a linear process and are only uncertain about the parameter values.</p>
<p><em>If</em> the data generating process is
<span class="math display">\[
y=X\beta + \epsilon\\
\mathbb{E}[\epsilon | X]=0,
\]</span>
then we have a famous result that lets us attach a simple interpretation of OLS coefficients as unbiased estimates of the effect of X:
<span class="math display">\[
\hat{\beta} = (X&#39;X)^{-1}X&#39;y = (X&#39;X)^{-1}X&#39;(X\beta + \epsilon) = \beta + (X&#39;X)^{-1}X&#39;\epsilon\\
\mathbb{E}\left[ \hat{\beta} \right] = \mathbb{E}\left[ (X&#39;X)^{-1}X&#39;y \right] = \beta + (X&#39;X)^{-1}\mathbb{E}\left[ X&#39;\epsilon \right] = \beta
\]</span></p>
<p>Generate a simulated dataset with 30 observations and two exogenous variables. Assume the following relationship: <span class="math inline">\(y_{i} = \beta_0 + \beta_1 x_{1,i} + \beta_2 x_{2,i} + \epsilon_i\)</span> where the variables and the error term are realizations of the following data generating processes (DGP):</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="ordinary-least-squares.html#cb218-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb218-2"><a href="ordinary-least-squares.html#cb218-2" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb218-3"><a href="ordinary-least-squares.html#cb218-3" tabindex="-1"></a></span>
<span id="cb218-4"><a href="ordinary-least-squares.html#cb218-4" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb218-5"><a href="ordinary-least-squares.html#cb218-5" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,.<span class="dv">7</span>)</span>
<span id="cb218-6"><a href="ordinary-least-squares.html#cb218-6" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>,x1,x2)</span>
<span id="cb218-7"><a href="ordinary-least-squares.html#cb218-7" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">3</span>)</span>
<span id="cb218-8"><a href="ordinary-least-squares.html#cb218-8" tabindex="-1"></a>Y <span class="ot">&lt;-</span> X<span class="sc">%*%</span>B <span class="sc">+</span> e</span>
<span id="cb218-9"><a href="ordinary-least-squares.html#cb218-9" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Y,X)</span>
<span id="cb218-10"><a href="ordinary-least-squares.html#cb218-10" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>x1<span class="sc">+</span>x2, <span class="at">data=</span>dat))</span></code></pre></div>
<pre><code>## (Intercept)          x1          x2 
##    8.982196    1.903533    1.396919</code></pre>
<p>Simulate the distribution of coefficients under a correctly specified model. Interpret the average.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="ordinary-least-squares.html#cb220-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb220-2"><a href="ordinary-least-squares.html#cb220-2" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb220-3"><a href="ordinary-least-squares.html#cb220-3" tabindex="-1"></a></span>
<span id="cb220-4"><a href="ordinary-least-squares.html#cb220-4" tabindex="-1"></a>Coefs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">400</span>, <span class="cf">function</span>(sim){</span>
<span id="cb220-5"><a href="ordinary-least-squares.html#cb220-5" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb220-6"><a href="ordinary-least-squares.html#cb220-6" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,.<span class="dv">7</span>)</span>
<span id="cb220-7"><a href="ordinary-least-squares.html#cb220-7" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>,x1,x2)</span>
<span id="cb220-8"><a href="ordinary-least-squares.html#cb220-8" tabindex="-1"></a>    e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">3</span>)</span>
<span id="cb220-9"><a href="ordinary-least-squares.html#cb220-9" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> X<span class="sc">%*%</span>B <span class="sc">+</span> e</span>
<span id="cb220-10"><a href="ordinary-least-squares.html#cb220-10" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Y,x1,x2)</span>
<span id="cb220-11"><a href="ordinary-least-squares.html#cb220-11" tabindex="-1"></a>    <span class="fu">coef</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>x1<span class="sc">+</span>x2, <span class="at">data=</span>dat))</span>
<span id="cb220-12"><a href="ordinary-least-squares.html#cb220-12" tabindex="-1"></a>})</span>
<span id="cb220-13"><a href="ordinary-least-squares.html#cb220-13" tabindex="-1"></a></span>
<span id="cb220-14"><a href="ordinary-least-squares.html#cb220-14" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb220-15"><a href="ordinary-least-squares.html#cb220-15" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb220-16"><a href="ordinary-least-squares.html#cb220-16" tabindex="-1"></a>    <span class="fu">hist</span>(Coefs[i,], <span class="at">xlab=</span><span class="fu">bquote</span>(beta[.(i)]), <span class="at">main=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb220-17"><a href="ordinary-least-squares.html#cb220-17" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(Coefs[i,]), <span class="at">col=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb220-18"><a href="ordinary-least-squares.html#cb220-18" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v=</span>B[i], <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb220-19"><a href="ordinary-least-squares.html#cb220-19" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Many economic phenomena are nonlinear, even when including potential transforms of <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>. Sometimes the linear model may still be a good or even great approximation (how good depends on the research question). In any case, you are safe to interpret your OLS coefficients as “conditional correlations”. For example, examine the distribution of coefficients under this mispecified model. Interpret the average.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="ordinary-least-squares.html#cb221-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb221-2"><a href="ordinary-least-squares.html#cb221-2" tabindex="-1"></a></span>
<span id="cb221-3"><a href="ordinary-least-squares.html#cb221-3" tabindex="-1"></a>Coefs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">600</span>, <span class="cf">function</span>(sim){</span>
<span id="cb221-4"><a href="ordinary-least-squares.html#cb221-4" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb221-5"><a href="ordinary-least-squares.html#cb221-5" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,.<span class="dv">7</span>)</span>
<span id="cb221-6"><a href="ordinary-least-squares.html#cb221-6" tabindex="-1"></a>    e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">3</span>)</span>
<span id="cb221-7"><a href="ordinary-least-squares.html#cb221-7" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">*</span>x2 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(x1)<span class="sc">^</span>x2 <span class="sc">+</span> e</span>
<span id="cb221-8"><a href="ordinary-least-squares.html#cb221-8" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Y,x1,x2)</span>
<span id="cb221-9"><a href="ordinary-least-squares.html#cb221-9" tabindex="-1"></a>    <span class="fu">coef</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>x1<span class="sc">+</span>x2, <span class="at">data=</span>dat))</span>
<span id="cb221-10"><a href="ordinary-least-squares.html#cb221-10" tabindex="-1"></a>})</span>
<span id="cb221-11"><a href="ordinary-least-squares.html#cb221-11" tabindex="-1"></a></span>
<span id="cb221-12"><a href="ordinary-least-squares.html#cb221-12" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb221-13"><a href="ordinary-least-squares.html#cb221-13" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb221-14"><a href="ordinary-least-squares.html#cb221-14" tabindex="-1"></a>    <span class="fu">hist</span>(Coefs[i,],  <span class="at">xlab=</span><span class="fu">bquote</span>(beta[.(i)]), <span class="at">main=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb221-15"><a href="ordinary-least-squares.html#cb221-15" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(Coefs[i,]), <span class="at">col=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb221-16"><a href="ordinary-least-squares.html#cb221-16" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="factor-variables" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Factor Variables<a href="ordinary-least-squares.html#factor-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far, we have discussed cardinal data where the difference between units always means the same thing: e.g., <span class="math inline">\(4-3=2-1\)</span>. There are also factor variables</p>
<ul>
<li>Ordered: refers to Ordinal data. The difference between units means something, but not always the same thing. For example, <span class="math inline">\(4th - 3rd \neq 2nd - 1st\)</span>.</li>
<li>Unordered: refers to Categorical data. The difference between units is meaningless. For example, <span class="math inline">\(B-A=?\)</span></li>
</ul>
<p>To analyze either factor, we often convert them into indicator variables or dummies; <span class="math inline">\(D_{c}=\mathbf{1}( Factor = c)\)</span>. One common case is if you have observations of individuals over time periods, then you may have two factor variables. An unordered factor that indicates who an individual is; for example <span class="math inline">\(D_{i}=\mathbf{1}( Individual = i)\)</span>, and an order factor that indicates the time period; for example <span class="math inline">\(D_{t}=\mathbf{1}( Time \in [month~ t, month~ t+1) )\)</span>. There are many other cases you see factor variables, including spatial ID’s in purely cross sectional data.</p>
<p>Be careful not to handle categorical data as if they were cardinal. E.g., generate city data with Leipzig=1, Lausanne=2, LosAngeles=3, … and then include city as if it were a cardinal number (that’s a big no-no). The same applied to ordinal data; PopulationLeipzig=2, PopulationLausanne=3, PopulationLosAngeles=1.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="ordinary-least-squares.html#cb222-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb222-2"><a href="ordinary-least-squares.html#cb222-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="dv">3</span>,<span class="dv">8</span>)</span>
<span id="cb222-3"><a href="ordinary-least-squares.html#cb222-3" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="fl">0.4</span>)</span>
<span id="cb222-4"><a href="ordinary-least-squares.html#cb222-4" tabindex="-1"></a>fo <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rbinom</span>(N,<span class="dv">4</span>,.<span class="dv">5</span>), <span class="at">ordered=</span>T)</span>
<span id="cb222-5"><a href="ordinary-least-squares.html#cb222-5" tabindex="-1"></a>fu <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;A&#39;</span>,<span class="st">&#39;B&#39;</span>),N<span class="sc">/</span><span class="dv">2</span>), <span class="at">ordered=</span>F)</span>
<span id="cb222-6"><a href="ordinary-least-squares.html#cb222-6" tabindex="-1"></a>dA <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>(fu<span class="sc">==</span><span class="st">&#39;A&#39;</span>)</span>
<span id="cb222-7"><a href="ordinary-least-squares.html#cb222-7" tabindex="-1"></a>y <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">^</span><span class="fu">as.integer</span>(fo)<span class="sc">*</span>dA )<span class="sc">*</span><span class="fu">sqrt</span>(x)<span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">as.integer</span>(fo)<span class="sc">*</span>e</span>
<span id="cb222-8"><a href="ordinary-least-squares.html#cb222-8" tabindex="-1"></a>dat_f <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y,x,fo,fu)</span></code></pre></div>
<p>With factors, you can still include them in the design matrix of an OLS regression
<span class="math display">\[
y_{it} = x_{it} \beta_{x} + d_{c}\beta_{c}
\]</span>
When, as commonly done, the factors are modeled as being additively seperable, they are modelled as either “fixed” or “random” effects.</p>
<p>Simply including the factors into the OLS regression yields a “dummy variable” fixed effects estimator.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="ordinary-least-squares.html#cb223-1" tabindex="-1"></a>fe_reg0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span>fo<span class="sc">+</span>fu, dat_f)</span>
<span id="cb223-2"><a href="ordinary-least-squares.html#cb223-2" tabindex="-1"></a><span class="fu">summary</span>(fe_reg0)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + fo + fu, data = dat_f)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -29.621  -6.004  -0.443   5.678  43.213 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  20.6426     1.1734  17.592  &lt; 2e-16 ***
## x             0.9115     0.1918   4.753  2.3e-06 ***
## fo.L         26.8052     1.0462  25.621  &lt; 2e-16 ***
## fo.Q          9.3017     0.9182  10.131  &lt; 2e-16 ***
## fo.C          2.1871     0.7136   3.065  0.00224 ** 
## fo^4          0.4550     0.5393   0.844  0.39908    
## fuB         -23.1893     0.5638 -41.131  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.909 on 993 degrees of freedom
## Multiple R-squared:  0.7184, Adjusted R-squared:  0.7167 
## F-statistic: 422.3 on 6 and 993 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We can also compute averages for each group and construct a “between estimator”
<span class="math display">\[
\overline{y}_i = \alpha + \overline{x}_i \beta
\]</span>
Or we can subtract the average from each group to construct a “within estimator”,
<span class="math display">\[
(y_{it} - \overline{y}_i) = (x_{it}-\overline{x}_i)\beta\\
\]</span>
that tends to be more computationally efficient, has corrections for standard errors, and has additional summary statistics.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="ordinary-least-squares.html#cb225-1" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb225-2"><a href="ordinary-least-squares.html#cb225-2" tabindex="-1"></a>fe_reg1 <span class="ot">&lt;-</span> <span class="fu">feols</span>(y<span class="sc">~</span>x<span class="sc">|</span>fo<span class="sc">+</span>fu, dat_f)</span>
<span id="cb225-3"><a href="ordinary-least-squares.html#cb225-3" tabindex="-1"></a><span class="fu">summary</span>(fe_reg1)</span></code></pre></div>
<pre><code>## OLS estimation, Dep. Var.: y
## Observations: 1,000 
## Fixed-effects: fo: 5,  fu: 2
## Standard-errors: Clustered (fo) 
##   Estimate Std. Error t value Pr(&gt;|t|)    
## x 0.911502   0.313358 2.90882  0.04373 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## RMSE: 8.87789     Adj. R2: 0.716744
##                 Within R2: 0.022241</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="ordinary-least-squares.html#cb227-1" tabindex="-1"></a><span class="do">## Compare Coefficients</span></span>
<span id="cb227-2"><a href="ordinary-least-squares.html#cb227-2" tabindex="-1"></a><span class="fu">coef</span>( <span class="fu">lm</span>(y<span class="sc">~-</span><span class="dv">1</span><span class="sc">+</span>x<span class="sc">+</span>fo<span class="sc">+</span>fu, dat_f) )</span></code></pre></div>
<pre><code>##           x         fo0         fo1         fo2         fo3         fo4 
##   0.9115023   8.0242820  10.8457982  15.9969620  25.0324481  43.3136717 
##         fuB 
## -23.1892567</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="ordinary-least-squares.html#cb229-1" tabindex="-1"></a><span class="fu">fixef</span>(fe_reg1)</span></code></pre></div>
<pre><code>## $fo
##         0         1         2         3         4 
##  8.024282 10.845798 15.996962 25.032448 43.313672 
## 
## $fu
##         A         B 
##   0.00000 -23.18926 
## 
## attr(,&quot;class&quot;)
## [1] &quot;fixest.fixef&quot; &quot;list&quot;        
## attr(,&quot;references&quot;)
## fo fu 
##  0  1 
## attr(,&quot;exponential&quot;)
## [1] FALSE</code></pre>
<p><strong>Hansen Econometrics, Theorem 17.1:</strong> The fixed effects estimator of <span class="math inline">\(\beta\)</span> algebraically equals the dummy
variable estimator of <span class="math inline">\(\beta\)</span>. The two estimators have the same residuals.
<!--
In fact, if the fixed effect is ``fully unstructured then the only way to consistently estimate the coefficient $\beta$ is by an estimator which is invariant'' (Hansen Econometrics, p). 
--></p>
<p>Consistency is a great property, but only if the data generating process does in fact match the model. Many factor variables have effects that are not additively seperable.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="ordinary-least-squares.html#cb231-1" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">feols</span>(y<span class="sc">~</span>x<span class="sc">|</span>fo<span class="sc">^</span>fu, dat_f)</span>
<span id="cb231-2"><a href="ordinary-least-squares.html#cb231-2" tabindex="-1"></a><span class="fu">summary</span>(reg1)</span></code></pre></div>
<pre><code>## OLS estimation, Dep. Var.: y
## Observations: 1,000 
## Fixed-effects: fo^fu: 10
## Standard-errors: Clustered (fo^fu) 
##   Estimate Std. Error t value Pr(&gt;|t|)    
## x  1.09162   0.519239 2.10235  0.06487 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## RMSE: 3.55634     Adj. R2: 0.954363
##                 Within R2: 0.167972</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="ordinary-least-squares.html#cb233-1" tabindex="-1"></a>reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">*</span>fo<span class="sc">*</span>fu, dat_f)</span>
<span id="cb233-2"><a href="ordinary-least-squares.html#cb233-2" tabindex="-1"></a><span class="fu">summary</span>(reg2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x * fo * fu, data = dat_f)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.7115 -1.4422 -0.0338  1.5147  9.2071 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  13.46980    0.58999  22.831  &lt; 2e-16 ***
## x             2.81506    0.10274  27.399  &lt; 2e-16 ***
## fo.L         23.20518    1.66556  13.932  &lt; 2e-16 ***
## fo.Q          7.16491    1.46276   4.898 1.13e-06 ***
## fo.C          1.77969    1.14024   1.561  0.11889    
## fo^4          1.02796    0.86474   1.189  0.23482    
## fuB         -13.04882    0.88896 -14.679  &lt; 2e-16 ***
## x:fo.L        5.46056    0.29047  18.799  &lt; 2e-16 ***
## x:fo.Q        2.38400    0.25464   9.362  &lt; 2e-16 ***
## x:fo.C        0.51263    0.19892   2.577  0.01011 *  
## x:fo^4       -0.04466    0.14946  -0.299  0.76513    
## x:fuB        -2.85145    0.15228 -18.725  &lt; 2e-16 ***
## fo.L:fuB    -22.46530    2.53951  -8.846  &lt; 2e-16 ***
## fo.Q:fuB     -6.53022    2.21948  -2.942  0.00334 ** 
## fo.C:fuB     -0.98544    1.69400  -0.582  0.56089    
## fo^4:fuB      0.29917    1.24902   0.240  0.81075    
## x:fo.L:fuB   -5.45389    0.43408 -12.564  &lt; 2e-16 ***
## x:fo.Q:fuB   -2.36943    0.37984  -6.238 6.59e-10 ***
## x:fo.C:fuB   -0.58644    0.29067  -2.018  0.04391 *  
## x:fo^4:fuB   -0.18416    0.21587  -0.853  0.39380    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.606 on 980 degrees of freedom
## Multiple R-squared:  0.9762, Adjusted R-squared:  0.9758 
## F-statistic:  2118 on 19 and 980 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="ordinary-least-squares.html#cb235-1" tabindex="-1"></a><span class="co">#reg2 &lt;- feols(y~x*fo*fu|fo^fu, dat_f)</span></span></code></pre></div>
<p>With <em>Random Effects</em>, the factor variable is modelled as coming from a distribution that is uncorrelated with the regressors. This is rarely used in economics today, and mostly included for historical reasons and a few cases where fixed effects cannot be estimates.</p>
<!-- 
> The labels "random effects" and "fixed effects" are misleading. These are labels which arose in the early literature and we are stuck with these labels today. In a previous era regressors were viewed as "fixed". Viewing the individual effect as an unobserved regressor leads to the label of the individual effect as "fixed". Today, we rarely refer to regressors as "fixed" when dealing with observational data. We view all variables as random. Consequently describing u i as "fixed" does not make much sense and it is hardly a contrast with the "random effect" label since under either assumption u i is treated as random. Once again, the labels are unfortunate but the key difference is whether u i is correlated with the regressors.
-->
</div>
<div id="more-literature" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> More Literature<a href="ordinary-least-squares.html#more-literature" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For OLS, see</p>
<ul>
<li><a href="https://bookdown.org/josiesmith/qrmbook/linear-estimation-and-minimizing-error.html" class="uri">https://bookdown.org/josiesmith/qrmbook/linear-estimation-and-minimizing-error.html</a></li>
<li><a href="https://www.econometrics-with-r.org/4-lrwor.html" class="uri">https://www.econometrics-with-r.org/4-lrwor.html</a></li>
<li><a href="https://www.econometrics-with-r.org/6-rmwmr.html" class="uri">https://www.econometrics-with-r.org/6-rmwmr.html</a></li>
<li><a href="https://www.econometrics-with-r.org/7-htaciimr.html" class="uri">https://www.econometrics-with-r.org/7-htaciimr.html</a></li>
<li><a href="https://bookdown.org/ripberjt/labbook/bivariate-linear-regression.html" class="uri">https://bookdown.org/ripberjt/labbook/bivariate-linear-regression.html</a></li>
<li><a href="https://bookdown.org/ripberjt/labbook/multivariable-linear-regression.html" class="uri">https://bookdown.org/ripberjt/labbook/multivariable-linear-regression.html</a></li>
<li><a href="https://online.stat.psu.edu/stat462/node/137/" class="uri">https://online.stat.psu.edu/stat462/node/137/</a></li>
<li><a href="https://book.stat420.org/" class="uri">https://book.stat420.org/</a></li>
<li>Hill, Griffiths &amp; Lim (2007), Principles of Econometrics, 3rd ed., Wiley, S. 86f.</li>
<li>Verbeek (2004), A Guide to Modern Econometrics, 2nd ed., Wiley, S. 51ff.</li>
<li>Asteriou &amp; Hall (2011), Applied Econometrics, 2nd ed., Palgrave MacMillan, S. 177ff.</li>
<li><a href="https://online.stat.psu.edu/stat485/lesson/11/" class="uri">https://online.stat.psu.edu/stat485/lesson/11/</a></li>
</ul>
<p>For fixed effects, see</p>
<ul>
<li><a href="https://www.econometrics-with-r.org/10-rwpd.html" class="uri">https://www.econometrics-with-r.org/10-rwpd.html</a></li>
<li><a href="https://bookdown.org/josiesmith/qrmbook/topics-in-multiple-regression.html" class="uri">https://bookdown.org/josiesmith/qrmbook/topics-in-multiple-regression.html</a></li>
<li><a href="https://bookdown.org/ripberjt/labbook/multivariable-linear-regression.html" class="uri">https://bookdown.org/ripberjt/labbook/multivariable-linear-regression.html</a></li>
<li><a href="https://www.princeton.edu/~otorres/Panel101.pdf" class="uri">https://www.princeton.edu/~otorres/Panel101.pdf</a></li>
<li><a href="https://www.stata.com/manuals13/xtxtreg.pdf" class="uri">https://www.stata.com/manuals13/xtxtreg.pdf</a></li>
</ul>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>For some technical background, see, e.g., <a href="https://www.sagepub.com/sites/default/files/upm-binaries/21122_Chapter_21.pdf" class="uri">https://www.sagepub.com/sites/default/files/upm-binaries/21122_Chapter_21.pdf</a>. Also note that we can compute classic estimates for variability: denoting the Standard Error of the Regression as <span class="math inline">\(\hat{\sigma}\)</span>, and the Standard Error of the Coefficient Estimates as <span class="math inline">\(\hat{\sigma}_{\hat{\alpha}}\)</span> and <span class="math inline">\(\hat{\sigma}_{\hat{\beta}}~~\)</span> (or simply Standard Errors).
<span class="math display">\[
\hat{\sigma}^2 = \frac{1}{n-2}\sum_{i}\hat{\epsilon_{i}}^2\\
\hat{\sigma}^2_{\hat{\alpha}}=\hat{\sigma}^2\left[\frac{1}{n}+\frac{\bar{x}^2}{\sum_{i}(x_i-\bar{x})^2}\right]\\
\hat{\sigma}^2_{\hat{\beta}}=\frac{\hat{\sigma}^2}{\sum_{i}(x_i-\bar{x})^2}.
\]</span>
These equations are motivated by particular data generating proceses, which you can read more about this at <a href="https://www.econometrics-with-r.org/4-lrwor.html" class="uri">https://www.econometrics-with-r.org/4-lrwor.html</a>.<a href="ordinary-least-squares.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>
To derive OLS coefficients in Matrix form, see
* <a href="https://jrnold.github.io/intro-methods-notes/ols-in-matrix-form.html" class="uri">https://jrnold.github.io/intro-methods-notes/ols-in-matrix-form.html</a>
* <a href="https://www.fsb.miamioh.edu/lij14/411_note_matrix.pdf" class="uri">https://www.fsb.miamioh.edu/lij14/411_note_matrix.pdf</a>
* <a href="https://web.stanford.edu/~mrosenfe/soc_meth_proj3/matrix_OLS_NYU_notes.pdf" class="uri">https://web.stanford.edu/~mrosenfe/soc_meth_proj3/matrix_OLS_NYU_notes.pdf</a><a href="ordinary-least-squares.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>This is done using t-values <span class="math display">\[\hat{t}_{j} = \frac{\hat{\beta}_j - \beta_{0} }{\hat{\sigma}_{\hat{\beta}_j}}\]</span>. Under some additional assumptions <span class="math inline">\(\hat{t}_{j} \sim t_{n-K}\)</span>.<a href="ordinary-least-squares.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="beyond-basics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ols-diagnostics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["index.pdf", "index.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
