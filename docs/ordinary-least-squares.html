<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 6 Ordinary Least Squares | index</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content=" 6 Ordinary Least Squares | index" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 6 Ordinary Least Squares | index" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="moving-beyond-the-basics.html"/>
<link rel="next" href="ols-diagnostics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6.9000/profvis.js"></script>
<script src="libs/profvis-0.3.6.9000/scroll.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.7/profvis.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Primers</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="part"><span><b>I Introduction to R</b></span></li>
<li class="chapter" data-level="2" data-path="first-steps-on-programming-in-r.html"><a href="first-steps-on-programming-in-r.html"><i class="fa fa-check"></i><b>2</b> First steps on Programming in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="first-steps-on-programming-in-r.html"><a href="first-steps-on-programming-in-r.html#install-r"><i class="fa fa-check"></i><b>2.1</b> Install R</a></li>
<li class="chapter" data-level="2.2" data-path="first-steps-on-programming-in-r.html"><a href="first-steps-on-programming-in-r.html#interfacing-with-the-gui."><i class="fa fa-check"></i><b>2.2</b> Interfacing with the GUI.</a></li>
<li class="chapter" data-level="2.3" data-path="first-steps-on-programming-in-r.html"><a href="first-steps-on-programming-in-r.html#introductions-to-r"><i class="fa fa-check"></i><b>2.3</b> Introductions to R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mathematical-objects.html"><a href="mathematical-objects.html"><i class="fa fa-check"></i><b>3</b> Mathematical Objects</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mathematical-objects.html"><a href="mathematical-objects.html#scalars-and-vectors"><i class="fa fa-check"></i><b>3.1</b> Scalars and Vectors</a></li>
<li class="chapter" data-level="3.2" data-path="mathematical-objects.html"><a href="mathematical-objects.html#functions-of-scalars-and-vectors"><i class="fa fa-check"></i><b>3.2</b> Functions of Scalars and Vectors</a></li>
<li class="chapter" data-level="3.3" data-path="mathematical-objects.html"><a href="mathematical-objects.html#functionals"><i class="fa fa-check"></i><b>3.3</b> Functionals</a></li>
<li class="chapter" data-level="3.4" data-path="mathematical-objects.html"><a href="mathematical-objects.html#matrices-and-matrix-functions"><i class="fa fa-check"></i><b>3.4</b> Matrices and Matrix-Functions</a></li>
<li class="chapter" data-level="3.5" data-path="mathematical-objects.html"><a href="mathematical-objects.html#arrays-and-array-functions"><i class="fa fa-check"></i><b>3.5</b> Arrays and Array Functions</a></li>
<li class="chapter" data-level="3.6" data-path="mathematical-objects.html"><a href="mathematical-objects.html#other-commom-types-of-data"><i class="fa fa-check"></i><b>3.6</b> Other Commom Types of Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plots.html"><a href="plots.html"><i class="fa fa-check"></i><b>4</b> Plots</a>
<ul>
<li class="chapter" data-level="4.1" data-path="plots.html"><a href="plots.html#basics"><i class="fa fa-check"></i><b>4.1</b> Basics</a></li>
<li class="chapter" data-level="4.2" data-path="plots.html"><a href="plots.html#equation-fitting-example"><i class="fa fa-check"></i><b>4.2</b> Equation Fitting Example</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="moving-beyond-the-basics.html"><a href="moving-beyond-the-basics.html"><i class="fa fa-check"></i><b>5</b> Moving beyond the basics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="moving-beyond-the-basics.html"><a href="moving-beyond-the-basics.html#task-views"><i class="fa fa-check"></i><b>5.1</b> Task Views</a></li>
<li class="chapter" data-level="5.2" data-path="moving-beyond-the-basics.html"><a href="moving-beyond-the-basics.html#custom-figures"><i class="fa fa-check"></i><b>5.2</b> Custom figures</a></li>
</ul></li>
<li class="part"><span><b>II Introduction to Linear Regression in R</b></span></li>
<li class="chapter" data-level="6" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html"><i class="fa fa-check"></i><b>6</b> Ordinary Least Squares</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#simple-ols-bivariate-linear-regression"><i class="fa fa-check"></i><b>6.1</b> Simple OLS (bivariate linear regression)</a></li>
<li class="chapter" data-level="6.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#ols-multiple-linear-regression"><i class="fa fa-check"></i><b>6.2</b> OLS (multiple linear regression)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#coefficient-variability"><i class="fa fa-check"></i><b>6.2.1</b> Coefficient Variability</a></li>
<li class="chapter" data-level="6.2.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#hypothesis-testing"><i class="fa fa-check"></i><b>6.2.2</b> Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#coefficient-interpretation"><i class="fa fa-check"></i><b>6.3</b> Coefficient Interpretation</a></li>
<li class="chapter" data-level="6.4" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#factor-variables"><i class="fa fa-check"></i><b>6.4</b> Factor Variables</a></li>
<li class="chapter" data-level="6.5" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#more-literature"><i class="fa fa-check"></i><b>6.5</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html"><i class="fa fa-check"></i><b>7</b> OLS Diagnostics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#assessing-outlier-y"><i class="fa fa-check"></i><b>7.1</b> Assessing Outlier <span class="math inline">\(Y\)</span></a></li>
<li class="chapter" data-level="7.2" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#assessing-normality"><i class="fa fa-check"></i><b>7.2</b> Assessing Normality</a></li>
<li class="chapter" data-level="7.3" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#assessing-outlier-x"><i class="fa fa-check"></i><b>7.3</b> Assessing Outlier <span class="math inline">\(X\)</span></a></li>
<li class="chapter" data-level="7.4" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#collinearity"><i class="fa fa-check"></i><b>7.4</b> Collinearity</a></li>
<li class="chapter" data-level="7.5" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#transformations"><i class="fa fa-check"></i><b>7.5</b> Transformations</a></li>
<li class="chapter" data-level="7.6" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#more-literature-1"><i class="fa fa-check"></i><b>7.6</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html"><i class="fa fa-check"></i><b>8</b> OLS and Endogeneity</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html#two-stage-least-squares-2sls"><i class="fa fa-check"></i><b>8.1</b> Two Stage Least Squares (2SLS)</a></li>
<li class="chapter" data-level="8.2" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html#regression-discontinuity-rd"><i class="fa fa-check"></i><b>8.2</b> Regression Discontinuity (RD)</a></li>
<li class="chapter" data-level="8.3" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html#difference-in-differences-did"><i class="fa fa-check"></i><b>8.3</b> Difference in Differences (DID)</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-scientism.html"><a href="data-scientism.html"><i class="fa fa-check"></i><b>9</b> Data scientism</a>
<ul>
<li class="chapter" data-level="9.1" data-path="data-scientism.html"><a href="data-scientism.html#us-govt-spending-on-science"><i class="fa fa-check"></i><b>9.1</b> US Gov’t Spending on Science</a></li>
<li class="chapter" data-level="9.2" data-path="data-scientism.html"><a href="data-scientism.html#ols-in-the-age-of-big-data"><i class="fa fa-check"></i><b>9.2</b> OLS in the age of big data</a></li>
<li class="chapter" data-level="9.3" data-path="data-scientism.html"><a href="data-scientism.html#causal-effects-sans-theory"><i class="fa fa-check"></i><b>9.3</b> Causal effects <em>sans theory</em></a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="data-scientism.html"><a href="data-scientism.html#rdd"><i class="fa fa-check"></i><b>9.3.1</b> RDD</a></li>
<li class="chapter" data-level="9.3.2" data-path="data-scientism.html"><a href="data-scientism.html#did"><i class="fa fa-check"></i><b>9.3.2</b> DID</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Introduction to Reproducible R</b></span></li>
<li class="chapter" data-level="10" data-path="why-be-reproducible.html"><a href="why-be-reproducible.html"><i class="fa fa-check"></i><b>10</b> Why be reproducible</a>
<ul>
<li class="chapter" data-level="10.1" data-path="why-be-reproducible.html"><a href="why-be-reproducible.html#an-example-workflow"><i class="fa fa-check"></i><b>10.1</b> An example workflow</a></li>
<li class="chapter" data-level="10.2" data-path="why-be-reproducible.html"><a href="why-be-reproducible.html#an-alternative-workflow"><i class="fa fa-check"></i><b>10.2</b> An alternative workflow</a></li>
<li class="chapter" data-level="10.3" data-path="why-be-reproducible.html"><a href="why-be-reproducible.html#why-r-and-r-markdown"><i class="fa fa-check"></i><b>10.3</b> Why R and R-Markdown</a></li>
<li class="chapter" data-level="10.4" data-path="why-be-reproducible.html"><a href="why-be-reproducible.html#types-of-projects"><i class="fa fa-check"></i><b>10.4</b> Types of Projects</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="small-scale-projects.html"><a href="small-scale-projects.html"><i class="fa fa-check"></i><b>11</b> Small Scale Projects</a>
<ul>
<li class="chapter" data-level="11.1" data-path="small-scale-projects.html"><a href="small-scale-projects.html#an-r-code-chunk"><i class="fa fa-check"></i><b>11.1</b> An R Code Chunk</a></li>
<li class="chapter" data-level="11.2" data-path="small-scale-projects.html"><a href="small-scale-projects.html#an-r-markdown-document"><i class="fa fa-check"></i><b>11.2</b> An R Markdown Document</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="small-scale-projects.html"><a href="small-scale-projects.html#copypaste-example"><i class="fa fa-check"></i><b>11.2.1</b> Copy/Paste Example</a></li>
<li class="chapter" data-level="11.2.2" data-path="small-scale-projects.html"><a href="small-scale-projects.html#a-homework-example"><i class="fa fa-check"></i><b>11.2.2</b> A Homework Example</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="small-scale-projects.html"><a href="small-scale-projects.html#posters-and-slides"><i class="fa fa-check"></i><b>11.3</b> Posters and Slides</a></li>
<li class="chapter" data-level="11.4" data-path="small-scale-projects.html"><a href="small-scale-projects.html#getting-help-w-r-markdown"><i class="fa fa-check"></i><b>11.4</b> Getting help w/ R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="medium-scale-projects.html"><a href="medium-scale-projects.html"><i class="fa fa-check"></i><b>12</b> Medium Scale Projects</a>
<ul>
<li class="chapter" data-level="12.1" data-path="medium-scale-projects.html"><a href="medium-scale-projects.html#makefile"><i class="fa fa-check"></i><b>12.1</b> MAKEFILE</a></li>
<li class="chapter" data-level="12.2" data-path="medium-scale-projects.html"><a href="medium-scale-projects.html#loggingsinking"><i class="fa fa-check"></i><b>12.2</b> Logging/Sinking</a></li>
<li class="chapter" data-level="12.3" data-path="medium-scale-projects.html"><a href="medium-scale-projects.html#final-step"><i class="fa fa-check"></i><b>12.3</b> Final Step</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="other-software.html"><a href="other-software.html"><i class="fa fa-check"></i><b>13</b> Other Software</a>
<ul>
<li class="chapter" data-level="13.1" data-path="other-software.html"><a href="other-software.html#stata"><i class="fa fa-check"></i><b>13.1</b> Stata</a></li>
<li class="chapter" data-level="13.2" data-path="other-software.html"><a href="other-software.html#general-workflow"><i class="fa fa-check"></i><b>13.2</b> General Workflow</a></li>
<li class="chapter" data-level="13.3" data-path="other-software.html"><a href="other-software.html#r-workflow"><i class="fa fa-check"></i><b>13.3</b> R Workflow</a></li>
</ul></li>
<li class="part"><span><b>IV Intermediate R</b></span></li>
<li class="chapter" data-level="14" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>14</b> Debugging</a>
<ul>
<li class="chapter" data-level="14.1" data-path="debugging.html"><a href="debugging.html#memory-leaks"><i class="fa fa-check"></i><b>14.1</b> Memory Leaks</a></li>
<li class="chapter" data-level="14.2" data-path="debugging.html"><a href="debugging.html#tracing-errors"><i class="fa fa-check"></i><b>14.2</b> Tracing Errors</a></li>
<li class="chapter" data-level="14.3" data-path="debugging.html"><a href="debugging.html#checking-problems"><i class="fa fa-check"></i><b>14.3</b> Checking problems</a></li>
<li class="chapter" data-level="14.4" data-path="debugging.html"><a href="debugging.html#being-proactive"><i class="fa fa-check"></i><b>14.4</b> Being Proactive</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="optimizing.html"><a href="optimizing.html"><i class="fa fa-check"></i><b>15</b> Optimizing</a>
<ul>
<li class="chapter" data-level="15.1" data-path="optimizing.html"><a href="optimizing.html#benchmarking"><i class="fa fa-check"></i><b>15.1</b> Benchmarking</a></li>
<li class="chapter" data-level="15.2" data-path="optimizing.html"><a href="optimizing.html#bottlenecks"><i class="fa fa-check"></i><b>15.2</b> Bottlenecks</a></li>
<li class="chapter" data-level="15.3" data-path="optimizing.html"><a href="optimizing.html#further-programming-guidance"><i class="fa fa-check"></i><b>15.3</b> Further Programming Guidance</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="latest-versions.html"><a href="latest-versions.html"><i class="fa fa-check"></i><b>16</b> Latest versions</a></li>
<li class="divider"></li>
<li><a href="https://sites.google.com/view/jordan-adamson" target="blank">Jordan Adamson</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ordinary-least-squares" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number"> 6</span> Ordinary Least Squares<a href="ordinary-least-squares.html#ordinary-least-squares" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<hr />
<div id="simple-ols-bivariate-linear-regression" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Simple OLS (bivariate linear regression)<a href="ordinary-least-squares.html#simple-ols-bivariate-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Model and objective
<span class="math display">\[
y_i=\alpha+\beta x_i+\epsilon_{i} \\
\epsilon_{i} = y_i - [\alpha+\beta x_i]\\
min_{\beta} \sum_{i=1}^{n} (\epsilon_{i})^2
\]</span></p>
<p>Point Estimates
<span class="math display">\[
\hat{\alpha}=\bar{y}-\hat{\beta}\bar{x} = \widehat{\mathbb{E}}[Y] - \hat{\beta} \widehat{\mathbb{E}}[X] \\
\hat{\beta}=\frac{\sum_{i}^{}(x_i-\bar{x})(y_i-\bar{y})}{\sum_{i}^{}(x_i-\bar{x})^2} = \frac{\widehat{Cov}[X,Y]}{\widehat{\mathbb{V}}[X]}\\
\hat{y}_i=\hat{\alpha}+\hat{\beta}x_i\\
\hat{\epsilon}_i=y_i-\hat{y}_i\\
\]</span></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="ordinary-least-squares.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Example 1 (Theoretical)</span></span>
<span id="cb115-2"><a href="ordinary-least-squares.html#cb115-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>)</span>
<span id="cb115-3"><a href="ordinary-least-squares.html#cb115-3" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x))</span>
<span id="cb115-4"><a href="ordinary-least-squares.html#cb115-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> .<span class="dv">02</span><span class="sc">*</span>x <span class="sc">+</span> e</span>
<span id="cb115-5"><a href="ordinary-least-squares.html#cb115-5" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x,y)</span>
<span id="cb115-6"><a href="ordinary-least-squares.html#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x, xy, <span class="at">col=</span><span class="fu">grey</span>(.<span class="dv">5</span>,.<span class="dv">5</span>), <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb115-7"><a href="ordinary-least-squares.html#cb115-7" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">dat=</span>xy)</span>
<span id="cb115-8"><a href="ordinary-least-squares.html#cb115-8" aria-hidden="true" tabindex="-1"></a>reg</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = xy)
## 
## Coefficients:
## (Intercept)            x  
##    -0.10715      0.02473</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="ordinary-least-squares.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(reg, <span class="at">col=</span><span class="st">&#39;orange&#39;</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="ordinary-least-squares.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Example 2 (Theoretical)</span></span>
<span id="cb118-2"><a href="ordinary-least-squares.html#cb118-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb118-3"><a href="ordinary-least-squares.html#cb118-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,.<span class="dv">5</span>)</span>
<span id="cb118-4"><a href="ordinary-least-squares.html#cb118-4" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">sapply</span>(z, <span class="cf">function</span>(zi){</span>
<span id="cb118-5"><a href="ordinary-least-squares.html#cb118-5" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,zi<span class="sc">*</span><span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb118-6"><a href="ordinary-least-squares.html#cb118-6" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,zi<span class="sc">*</span><span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb118-7"><a href="ordinary-least-squares.html#cb118-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(x,y)</span>
<span id="cb118-8"><a href="ordinary-least-squares.html#cb118-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb118-9"><a href="ordinary-least-squares.html#cb118-9" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>xy[<span class="dv">1</span>,],<span class="at">y=</span>xy[<span class="dv">2</span>,])</span>
<span id="cb118-10"><a href="ordinary-least-squares.html#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x, xy, <span class="at">col=</span><span class="fu">grey</span>(.<span class="dv">5</span>,.<span class="dv">5</span>), <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb118-11"><a href="ordinary-least-squares.html#cb118-11" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, <span class="at">dat=</span>xy)</span>
<span id="cb118-12"><a href="ordinary-least-squares.html#cb118-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(reg, <span class="at">col=</span><span class="st">&#39;orange&#39;</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="ordinary-least-squares.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Example 3 (Empirical)</span></span>
<span id="cb119-2"><a href="ordinary-least-squares.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="do">## head(USArrests)</span></span>
<span id="cb119-3"><a href="ordinary-least-squares.html#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Murder<span class="sc">~</span>UrbanPop, USArrests, <span class="at">col=</span><span class="fu">grey</span>(.<span class="dv">5</span>,.<span class="dv">5</span>), <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb119-4"><a href="ordinary-least-squares.html#cb119-4" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder<span class="sc">~</span>UrbanPop, <span class="at">dat=</span>USArrests)</span>
<span id="cb119-5"><a href="ordinary-least-squares.html#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(reg, <span class="at">col=</span><span class="st">&#39;orange&#39;</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Sums of Squared Errors
<span class="math display">\[
\underbrace{\sum\nolimits_{i}(y_i-\bar{y})^2}_\text{TSS}=\underbrace{\sum\nolimits_{i}(\hat{y}_i-\bar{y})^2}_\text{RSS}+\underbrace{\sum\nolimits_{i}\hat{\epsilon}^2}_\text{ESS}\\
R^2=\frac{RSS}{TSS}=1-\frac{ESS}{TSS}
\]</span></p>
<p>Variability Estimates
<span class="math display">\[
\hat{\sigma}^2=\frac{1}{n-2}\sum_{i}\hat{\epsilon}^2\\
\hat{\sigma}^2_{\hat{\alpha}}=\hat{\sigma}^2\left[\frac{1}{n}+\frac{\bar{x}^2}{\sum_{i}(x_i-\bar{x})^2}\right]\\
\hat{\sigma}^2_{\hat{\beta}}=\frac{\hat{\sigma}^2}{\sum_{i}(x_i-\bar{x})^2}\\
\hat{\sigma}^2_{\hat{y}_j}=\hat{\sigma}^2\left[\frac{1}{n}+\frac{(x_j-\bar{x})^2}{\sum_{i}(x_i-\bar{x})^2}\right]\\
\]</span></p>
<p>For more details, see <a href="https://www.econometrics-with-r.org/4-lrwor.html" class="uri">https://www.econometrics-with-r.org/4-lrwor.html</a></p>
</div>
<div id="ols-multiple-linear-regression" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> OLS (multiple linear regression)<a href="ordinary-least-squares.html#ols-multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Model and objective
<span class="math display">\[
y_i=\beta_0+\beta_1x_{i1}+\beta_2x_{i2}+\ldots+\beta_kx_{ik}+\epsilon_i\\
y=\textbf{X}\beta+\epsilon\\
min_{\beta} \sum_{i=1}^{n} (\epsilon_i)^2
\]</span></p>
<p>Point Estimates
<span class="math display">\[
\hat{\beta}=(\textbf{X}&#39;\textbf{X})^{-1}\textbf{X}&#39;y\\
\]</span></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="ordinary-least-squares.html#cb120-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> USArrests[,<span class="fu">c</span>(<span class="st">&#39;Assault&#39;</span>,<span class="st">&#39;UrbanPop&#39;</span>)]</span>
<span id="cb120-2"><a href="ordinary-least-squares.html#cb120-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">cbind</span>(<span class="dv">1</span>,X))</span>
<span id="cb120-3"><a href="ordinary-least-squares.html#cb120-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> USArrests[,<span class="st">&#39;Murder&#39;</span>]</span>
<span id="cb120-4"><a href="ordinary-least-squares.html#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="ordinary-least-squares.html#cb120-5" aria-hidden="true" tabindex="-1"></a>XtXi <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X)<span class="sc">%*%</span>X)</span>
<span id="cb120-6"><a href="ordinary-least-squares.html#cb120-6" aria-hidden="true" tabindex="-1"></a>Bhat <span class="ot">&lt;-</span> XtXi <span class="sc">%*%</span> (<span class="fu">t</span>(X)<span class="sc">%*%</span>Y)</span>
<span id="cb120-7"><a href="ordinary-least-squares.html#cb120-7" aria-hidden="true" tabindex="-1"></a>Bhat</span></code></pre></div>
<pre><code>##                 [,1]
## 1         3.20715340
## Assault   0.04390995
## UrbanPop -0.04451047</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="ordinary-least-squares.html#cb122-1" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder<span class="sc">~</span>Assault<span class="sc">+</span>UrbanPop, <span class="at">data=</span>USArrests)</span>
<span id="cb122-2"><a href="ordinary-least-squares.html#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(reg)</span></code></pre></div>
<pre><code>## (Intercept)     Assault    UrbanPop 
##  3.20715340  0.04390995 -0.04451047</code></pre>
<p>Predictions and Projection Matrix
<span class="math display">\[
\hat{\epsilon}=y-X\hat{\beta}=y-X(X&#39;X)^{-1}X&#39;y\\
\hat{P}=X(X&#39;X)^{-1}X&#39;\\
\hat{P}y=X(X&#39;X)^{-1}X&#39;y=y-(y-X(X&#39;X)^{-1}X&#39;y)=y-\hat{\epsilon}=\hat{y}\\
\]</span></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="ordinary-least-squares.html#cb124-1" aria-hidden="true" tabindex="-1"></a>Ehat <span class="ot">&lt;-</span> Y <span class="sc">-</span> X<span class="sc">%*%</span> Bhat</span>
<span id="cb124-2"><a href="ordinary-least-squares.html#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Ehat</span></span>
<span id="cb124-3"><a href="ordinary-least-squares.html#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="do">## resid(reg)</span></span>
<span id="cb124-4"><a href="ordinary-least-squares.html#cb124-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-5"><a href="ordinary-least-squares.html#cb124-5" aria-hidden="true" tabindex="-1"></a>Pmat <span class="ot">&lt;-</span> X<span class="sc">%*%</span>XtXi<span class="sc">%*%</span><span class="fu">t</span>(X)</span>
<span id="cb124-6"><a href="ordinary-least-squares.html#cb124-6" aria-hidden="true" tabindex="-1"></a>Yhat <span class="ot">&lt;-</span> Pmat<span class="sc">%*%</span>Y</span>
<span id="cb124-7"><a href="ordinary-least-squares.html#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Yhat</span></span>
<span id="cb124-8"><a href="ordinary-least-squares.html#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="do">## predict(reg)</span></span></code></pre></div>
<p>Sums of Squared Errors
<span class="math display">\[
R^2_{\text{adj.}} = 1-\frac{n-1}{n-K}(1-R^2)\\
R^2 = \frac{RSS}{TSS}=1-\frac{ESS}{TSS}
\]</span></p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="ordinary-least-squares.html#cb125-1" aria-hidden="true" tabindex="-1"></a>ESS <span class="ot">&lt;-</span> <span class="fu">sum</span>(Ehat<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb125-2"><a href="ordinary-least-squares.html#cb125-2" aria-hidden="true" tabindex="-1"></a>TSS <span class="ot">&lt;-</span> <span class="fu">sum</span>((Y<span class="sc">-</span><span class="fu">mean</span>(Y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb125-3"><a href="ordinary-least-squares.html#cb125-3" aria-hidden="true" tabindex="-1"></a>R2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ESS<span class="sc">/</span>TSS</span>
<span id="cb125-4"><a href="ordinary-least-squares.html#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="ordinary-least-squares.html#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.6634156</code></pre>
<div id="coefficient-variability" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Coefficient Variability<a href="ordinary-least-squares.html#coefficient-variability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In general, note that the linear model has
<span class="math display">\[
\hat{\Sigma}_{\beta} = (X&#39;X)^{-1} X&#39; \widehat{\Omega} X (X&#39;X)^{-1}.\\
\widehat{\Omega} = \begin{pmatrix}
\hat{\sigma}_{1,1} &amp; ... &amp; \hat{\sigma}_{1,n}\\
&amp; ... &amp;  \\
\hat{\sigma}_{n,1} &amp; ... &amp; \hat{\sigma}_{n,n}
\end{pmatrix}
\]</span>
Standard Errors are the diagonal: <span class="math inline">\(diag( \hat{\Sigma}_{\beta} )\)</span></p>
<p><strong>Classical Linear Model (CLM)</strong>
Independance: <span class="math inline">\(\hat{\sigma_{i,j}}=0\)</span>
Homoskedasticity:
<span class="math display">\[
diag( \widehat{\Omega} ) = [\hat{\sigma}^2, \hat{\sigma}^2, ..., \hat{\sigma}^2] \\
\hat{\sigma}^2=\frac{1}{n-K}\sum_{i}\hat{\epsilon}_i^2\\
\]</span>
IID Variability Estimates
<span class="math display">\[
\hat{\Sigma}_{\beta} = \hat{\sigma}^2 (X&#39;X)^{-1}\\
\]</span></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="ordinary-least-squares.html#cb127-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb127-2"><a href="ordinary-least-squares.html#cb127-2" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X)</span>
<span id="cb127-3"><a href="ordinary-least-squares.html#cb127-3" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sum</span>( Ehat<span class="sc">^</span><span class="dv">2</span> )<span class="sc">/</span>(n<span class="sc">-</span>K)</span>
<span id="cb127-4"><a href="ordinary-least-squares.html#cb127-4" aria-hidden="true" tabindex="-1"></a>Vhat <span class="ot">&lt;-</span> s <span class="sc">*</span> XtXi</span>
<span id="cb127-5"><a href="ordinary-least-squares.html#cb127-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-6"><a href="ordinary-least-squares.html#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(reg)</span></code></pre></div>
<pre><code>##              (Intercept)       Assault      UrbanPop
## (Intercept)  3.030349406 -1.532127e-03 -4.021339e-02
## Assault     -0.001532127  2.096605e-05 -3.124864e-05
## UrbanPop    -0.040213394 -3.124864e-05  6.949864e-04</code></pre>
<p><strong>Reality</strong>
There are common violations to the iid case.
Heteroskedasticity:
<span class="math display">\[
diag( \widehat{\Omega} ) = [\widehat{\sigma^2_{1}}, \widehat{\sigma^2_{1}}, ..., \widehat{\sigma^2_{n}}]\\
\widehat{\sigma^2_{i}} = \hat{\epsilon_{i}}^2
\]</span></p>
<p>Autocorrelation Dependance: <span class="math inline">\(\sigma_{i,j}=f( dist(i,j) )\)</span>.</p>
<p>Cluster Dependance:
<span class="math display">\[\sigma_{i,j}=
\begin{cases}
\hat{\sigma}_{group1} &amp; i,j \in \text{group } 1\\
...\\
\hat{\sigma}_{groupG} &amp; i,j \in \text{group } G \\
0 &amp; \text{otherwise} \\ 
\end{cases}
\]</span></p>
<p>This is for a later course. (See <a href="https://cran.r-project.org/web/packages/sandwich/vignettes/sandwich.pdf" class="uri">https://cran.r-project.org/web/packages/sandwich/vignettes/sandwich.pdf</a> and then <a href="https://cran.r-project.org/web/packages/sandwich/vignettes/sandwich-CL.pdf" class="uri">https://cran.r-project.org/web/packages/sandwich/vignettes/sandwich-CL.pdf</a>)</p>
</div>
<div id="hypothesis-testing" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Hypothesis Testing<a href="ordinary-least-squares.html#hypothesis-testing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Is not to be done routinely. For one hypothesis, we can use a <span class="math inline">\(t\)</span> test. For multiple, we can use an <span class="math inline">\(F\)</span> test.
<span class="math display">\[
\hat{t}_{j} = \frac{\hat{\beta}_j- \beta_{0} }{\hat{\sigma}_{\
\hat{\beta}_j}}\sim t_{n-K}\\
\hat{F}_{q} = \frac{(ESS_{restricted}-ESS_{unrestricted})/q}{ESS_{unrestricted}/(n-K)} \sim F_{q,n-K}
\]</span></p>
<p>Note that <span class="math inline">\(\hat{F}\)</span> can be written in terms of unrestricted and restricted <span class="math inline">\(R^2\)</span></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="ordinary-least-squares.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Seperate tests each coef is 0</span></span>
<span id="cb129-2"><a href="ordinary-least-squares.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate standard errors, t–statistics, p-values</span></span>
<span id="cb129-3"><a href="ordinary-least-squares.html#cb129-3" aria-hidden="true" tabindex="-1"></a>SEhat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(Vhat))</span>
<span id="cb129-4"><a href="ordinary-least-squares.html#cb129-4" aria-hidden="true" tabindex="-1"></a>That  <span class="ot">&lt;-</span> Bhat<span class="sc">/</span>SEhat</span>
<span id="cb129-5"><a href="ordinary-least-squares.html#cb129-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-6"><a href="ordinary-least-squares.html#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="do">## One Sided Test for P(t &gt; That | Null)</span></span>
<span id="cb129-7"><a href="ordinary-least-squares.html#cb129-7" aria-hidden="true" tabindex="-1"></a>Phat1  <span class="ot">&lt;-</span> <span class="fu">pt</span>(That, n<span class="sc">-</span>K)</span>
<span id="cb129-8"><a href="ordinary-least-squares.html#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Two Sided Test for P(t &gt; That or  t &lt; -That | Null)</span></span>
<span id="cb129-9"><a href="ordinary-least-squares.html#cb129-9" aria-hidden="true" tabindex="-1"></a>Phat2  <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>( <span class="fu">abs</span>(That), n<span class="sc">-</span>K) <span class="sc">+</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(That), n<span class="sc">-</span>K)</span>
<span id="cb129-10"><a href="ordinary-least-squares.html#cb129-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-11"><a href="ordinary-least-squares.html#cb129-11" aria-hidden="true" tabindex="-1"></a>Phat2</span></code></pre></div>
<pre><code>##                  [,1]
## 1        7.173654e-02
## Assault  1.216319e-12
## UrbanPop 9.796088e-02</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="ordinary-least-squares.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Murder ~ Assault + UrbanPop, data = USArrests)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.5530 -1.7093 -0.3677  1.2284  7.5985 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.207153   1.740790   1.842   0.0717 .  
## Assault      0.043910   0.004579   9.590 1.22e-12 ***
## UrbanPop    -0.044510   0.026363  -1.688   0.0980 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.58 on 47 degrees of freedom
## Multiple R-squared:  0.6634, Adjusted R-squared:  0.6491 
## F-statistic: 46.32 on 2 and 47 DF,  p-value: 7.704e-12</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="ordinary-least-squares.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Joint test all 3 coefs are 0</span></span>
<span id="cb133-2"><a href="ordinary-least-squares.html#cb133-2" aria-hidden="true" tabindex="-1"></a>Fhat <span class="ot">&lt;-</span> (TSS <span class="sc">-</span> ESS)<span class="sc">/</span>ESS <span class="sc">*</span> (n<span class="sc">-</span>K)<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb133-3"><a href="ordinary-least-squares.html#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pf</span>(Fhat, <span class="dv">3</span>, n<span class="sc">-</span>K)</span></code></pre></div>
<pre><code>## [1] 3.522538e-11</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="ordinary-least-squares.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg)<span class="sc">$</span>fstatistic</span></code></pre></div>
<pre><code>##    value    numdf    dendf 
## 46.31903  2.00000 47.00000</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="ordinary-least-squares.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Murder ~ Assault + UrbanPop, data = USArrests)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.5530 -1.7093 -0.3677  1.2284  7.5985 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.207153   1.740790   1.842   0.0717 .  
## Assault      0.043910   0.004579   9.590 1.22e-12 ***
## UrbanPop    -0.044510   0.026363  -1.688   0.0980 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.58 on 47 degrees of freedom
## Multiple R-squared:  0.6634, Adjusted R-squared:  0.6491 
## F-statistic: 46.32 on 2 and 47 DF,  p-value: 7.704e-12</code></pre>
</div>
</div>
<div id="coefficient-interpretation" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Coefficient Interpretation<a href="ordinary-least-squares.html#coefficient-interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The above procedure will always give us number, the question is how to interpret them.</p>
<p><em>If</em> the data generating process is
<span class="math display">\[
y=X\beta + \epsilon\\
\mathbb{E}[\epsilon | X]=0,
\]</span>
then we have a famous result that lets us attach a simple interpretation of OLS coefficients as unbiased estimates of the effect of X:
<span class="math display">\[
\hat{\beta} = (X&#39;X)^{-1}X&#39;y = (X&#39;X)^{-1}X&#39;(X\beta + \epsilon) = \beta + (X&#39;X)^{-1}X&#39;\epsilon\\
\mathbb{E}\left[ \hat{\beta} \right] = \mathbb{E}\left[ (X&#39;X)^{-1}X&#39;y \right] = \beta + (X&#39;X)^{-1}\mathbb{E}\left[ X&#39;\epsilon \right] = \beta
\]</span></p>
<p>Generate a simulated dataset with 30 observations and two exogenous variables. Assume the following relationship: <span class="math inline">\(yi = \beta_0 + \beta_1 x_{1,i} + \beta_2 x_{2,i} + \epsilon_i\)</span> where the variables and the error term are realizations of the following data generating processes (DGP):</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="ordinary-least-squares.html#cb139-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb139-2"><a href="ordinary-least-squares.html#cb139-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb139-3"><a href="ordinary-least-squares.html#cb139-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-4"><a href="ordinary-least-squares.html#cb139-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb139-5"><a href="ordinary-least-squares.html#cb139-5" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,.<span class="dv">7</span>)</span>
<span id="cb139-6"><a href="ordinary-least-squares.html#cb139-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>,x1,x2)</span>
<span id="cb139-7"><a href="ordinary-least-squares.html#cb139-7" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">3</span>)</span>
<span id="cb139-8"><a href="ordinary-least-squares.html#cb139-8" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> X<span class="sc">%*%</span>B <span class="sc">+</span> e</span>
<span id="cb139-9"><a href="ordinary-least-squares.html#cb139-9" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Y,X)</span>
<span id="cb139-10"><a href="ordinary-least-squares.html#cb139-10" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>x1<span class="sc">+</span>x2, <span class="at">data=</span>dat))</span></code></pre></div>
<pre><code>## (Intercept)          x1          x2 
##    9.514278    2.008898   -1.071302</code></pre>
<p>Simulate the distribution of coefficients under a correctly specified model. Interpret the average.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="ordinary-least-squares.html#cb141-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb141-2"><a href="ordinary-least-squares.html#cb141-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb141-3"><a href="ordinary-least-squares.html#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="ordinary-least-squares.html#cb141-4" aria-hidden="true" tabindex="-1"></a>Coefs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">400</span>, <span class="cf">function</span>(sim){</span>
<span id="cb141-5"><a href="ordinary-least-squares.html#cb141-5" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb141-6"><a href="ordinary-least-squares.html#cb141-6" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,.<span class="dv">7</span>)</span>
<span id="cb141-7"><a href="ordinary-least-squares.html#cb141-7" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>,x1,x2)</span>
<span id="cb141-8"><a href="ordinary-least-squares.html#cb141-8" aria-hidden="true" tabindex="-1"></a>    e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">3</span>)</span>
<span id="cb141-9"><a href="ordinary-least-squares.html#cb141-9" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> X<span class="sc">%*%</span>B <span class="sc">+</span> e</span>
<span id="cb141-10"><a href="ordinary-least-squares.html#cb141-10" aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Y,x1,x2)</span>
<span id="cb141-11"><a href="ordinary-least-squares.html#cb141-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>x1<span class="sc">+</span>x2, <span class="at">data=</span>dat))</span>
<span id="cb141-12"><a href="ordinary-least-squares.html#cb141-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb141-13"><a href="ordinary-least-squares.html#cb141-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-14"><a href="ordinary-least-squares.html#cb141-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb141-15"><a href="ordinary-least-squares.html#cb141-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb141-16"><a href="ordinary-least-squares.html#cb141-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(Coefs[i,])</span>
<span id="cb141-17"><a href="ordinary-least-squares.html#cb141-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(Coefs[i,]), <span class="at">col=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb141-18"><a href="ordinary-least-squares.html#cb141-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v=</span>B[i], <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb141-19"><a href="ordinary-least-squares.html#cb141-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Note that for joint tests, we look at the joint distribution of coefficients</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="ordinary-least-squares.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ks)</span>
<span id="cb142-2"><a href="ordinary-least-squares.html#cb142-2" aria-hidden="true" tabindex="-1"></a>Bjoint <span class="ot">&lt;-</span> <span class="fu">t</span>(Coefs[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,])</span>
<span id="cb142-3"><a href="ordinary-least-squares.html#cb142-3" aria-hidden="true" tabindex="-1"></a>fBjoint <span class="ot">&lt;-</span> <span class="fu">histde</span>(Bjoint, <span class="at">binw=</span><span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">5</span>))</span>
<span id="cb142-4"><a href="ordinary-least-squares.html#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fBjoint, <span class="at">xlab=</span><span class="st">&#39;B2&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;B3&#39;</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Many economic phenomena are nonlinear, even when including potential transforms of <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>. Sometimes the OLS model may still be a good or even great approximation (how good depends on the research question). In any case, you are safe to interpret your OLS coefficients as “conditional correlations”. For example, examine the distribution of coefficients under this mispecified model. Interpret the average.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="ordinary-least-squares.html#cb143-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb143-2"><a href="ordinary-least-squares.html#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="ordinary-least-squares.html#cb143-3" aria-hidden="true" tabindex="-1"></a>Coefs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">600</span>, <span class="cf">function</span>(sim){</span>
<span id="cb143-4"><a href="ordinary-least-squares.html#cb143-4" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb143-5"><a href="ordinary-least-squares.html#cb143-5" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,.<span class="dv">7</span>)</span>
<span id="cb143-6"><a href="ordinary-least-squares.html#cb143-6" aria-hidden="true" tabindex="-1"></a>    e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">3</span>)</span>
<span id="cb143-7"><a href="ordinary-least-squares.html#cb143-7" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">*</span>x2 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(x1)<span class="sc">^</span>x2 <span class="sc">+</span> e</span>
<span id="cb143-8"><a href="ordinary-least-squares.html#cb143-8" aria-hidden="true" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Y,x1,x2)</span>
<span id="cb143-9"><a href="ordinary-least-squares.html#cb143-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>x1<span class="sc">+</span>x2, <span class="at">data=</span>dat))</span>
<span id="cb143-10"><a href="ordinary-least-squares.html#cb143-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb143-11"><a href="ordinary-least-squares.html#cb143-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-12"><a href="ordinary-least-squares.html#cb143-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb143-13"><a href="ordinary-least-squares.html#cb143-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb143-14"><a href="ordinary-least-squares.html#cb143-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hist</span>(Coefs[i,])</span>
<span id="cb143-15"><a href="ordinary-least-squares.html#cb143-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(Coefs[i,]), <span class="at">col=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb143-16"><a href="ordinary-least-squares.html#cb143-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="factor-variables" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Factor Variables<a href="ordinary-least-squares.html#factor-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far, we have discussed cardinal data where the difference between units always means the same thing: e.g., <span class="math inline">\(4 -3=3-2\)</span>. There are also factor variables</p>
<ul>
<li>Ordered: The difference between units means something, but not always the same thing. E.g., <span class="math inline">\(1st - 2nd \neq 2nd - 3rd\)</span>.</li>
<li>Unordered: The difference between units does not mean something <span class="math inline">\(B-A =??\)</span></li>
</ul>
<p>Sometimes Ordinal and Categorical data are called Ordinal and Categorical variables.</p>
<p>To analyze either factor, we often convert them into indicator variables or dummies; <span class="math inline">\(D_{c}=\mathbf{1}( Factor = c)\)</span>. One common case is if you have observations of individuals over time periods, then you may have two factor variables. An unordered factor that indicates who an individual is; for example <span class="math inline">\(D_{i}=\mathbf{1}( Individual = i)\)</span>, and an order factor that indicates the time period; for example <span class="math inline">\(D_{t}=\mathbf{1}( Time \in [month~ t, month~ t+1) )\)</span>. There are many other cases you see factor variables, including spatial ID’s in purely cross sectional data.</p>
<p>Be careful not to handle categorical data as if they were cardinal. E.g., generate city data with Leipzig=1, Lausanne=2, LosAngeles=3, … and then include city as if it were a cardinal number (that’s a big no-no). The same applied to ordinal data; PopulationLeipzig=2, PopulationLausanne=3, PopulationLosAngeles=1.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="ordinary-least-squares.html#cb144-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb144-2"><a href="ordinary-least-squares.html#cb144-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(N,<span class="dv">3</span>,<span class="dv">8</span>)</span>
<span id="cb144-3"><a href="ordinary-least-squares.html#cb144-3" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="fl">0.4</span>)</span>
<span id="cb144-4"><a href="ordinary-least-squares.html#cb144-4" aria-hidden="true" tabindex="-1"></a>fo <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rbinom</span>(N,<span class="dv">4</span>,.<span class="dv">5</span>), <span class="at">ordered=</span>T)</span>
<span id="cb144-5"><a href="ordinary-least-squares.html#cb144-5" aria-hidden="true" tabindex="-1"></a>fu <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;A&#39;</span>,<span class="st">&#39;B&#39;</span>),N<span class="sc">/</span><span class="dv">2</span>), <span class="at">ordered=</span>F)</span>
<span id="cb144-6"><a href="ordinary-least-squares.html#cb144-6" aria-hidden="true" tabindex="-1"></a>dA <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>(fu<span class="sc">==</span><span class="st">&#39;A&#39;</span>)</span>
<span id="cb144-7"><a href="ordinary-least-squares.html#cb144-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> (<span class="dv">2</span><span class="sc">^</span><span class="fu">as.integer</span>(fo)<span class="sc">*</span>dA )<span class="sc">*</span><span class="fu">sqrt</span>(x)<span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">as.integer</span>(fo)<span class="sc">*</span>e</span>
<span id="cb144-8"><a href="ordinary-least-squares.html#cb144-8" aria-hidden="true" tabindex="-1"></a>dat_f <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y,x,fo,fu)</span></code></pre></div>
<p>With factors, you can still include them in the design matrix of an OLS regression
<span class="math display">\[
y_{it} = x_{it} \beta_{x} + d_{c}\beta_{c}
\]</span>
When, as commonly done, the factors are modeled as being additively seperable, they are modelled as either “fixed” or “random” effects.</p>
<p>Simply including the factors into the OLS regression yields a “dummy variable” fixed effects estimator.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="ordinary-least-squares.html#cb145-1" aria-hidden="true" tabindex="-1"></a>fe_reg0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span>fo<span class="sc">+</span>fu, dat_f)</span>
<span id="cb145-2"><a href="ordinary-least-squares.html#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fe_reg0)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + fo + fu, data = dat_f)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -40.226  -5.808  -0.387   5.868  37.415 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  20.9744     1.2463  16.829  &lt; 2e-16 ***
## x             1.1489     0.2026   5.672 1.85e-08 ***
## fo.L         30.7334     1.1375  27.019  &lt; 2e-16 ***
## fo.Q         12.5182     0.9986  12.535  &lt; 2e-16 ***
## fo.C          3.9573     0.7510   5.269 1.68e-07 ***
## fo^4          1.0801     0.5518   1.957   0.0506 .  
## fuB         -23.6523     0.5768 -41.008  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 9.101 on 993 degrees of freedom
## Multiple R-squared:  0.7426, Adjusted R-squared:  0.7411 
## F-statistic: 477.6 on 6 and 993 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We can also compute averages for each group and construct a “between estimator”
<span class="math display">\[
\overline{y}_i = \alpha + \overline{x}_i \beta
\]</span>
Or we can subtract the average from each group to construct a “within estimator”,
<span class="math display">\[
(y_{it} - \overline{y}_i) = (x_{it}-\overline{x}_i)\beta\\
\]</span>
that tends to be more computationally efficient, has corrections for standard errors, and has additional summary statistics.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="ordinary-least-squares.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb147-2"><a href="ordinary-least-squares.html#cb147-2" aria-hidden="true" tabindex="-1"></a>fe_reg1 <span class="ot">&lt;-</span> <span class="fu">feols</span>(y<span class="sc">~</span>x<span class="sc">|</span>fo<span class="sc">+</span>fu, dat_f)</span>
<span id="cb147-3"><a href="ordinary-least-squares.html#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fe_reg1)</span></code></pre></div>
<pre><code>## OLS estimation, Dep. Var.: y
## Observations: 1,000 
## Fixed-effects: fo: 5,  fu: 2
## Standard-errors: Clustered (fo) 
##   Estimate Std. Error t value Pr(&gt;|t|)    
## x  1.14892   0.418653 2.74433 0.051675 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## RMSE: 9.06864     Adj. R2: 0.741095
##                 Within R2: 0.031384</code></pre>
<p><strong>Hansen Econometrics, Theorem 17.1:</strong> The fixed effects estimator of <span class="math inline">\(\beta\)</span> algebraically equals the dummy
variable estimator of <span class="math inline">\(\beta\)</span>. The two estimators have the same residuals.
<!--
In fact, if the fixed effect is ``fully unstructured then the only way to consistently estimate the coefficient $\beta$ is by an estimator which is invariant'' (Hansen Econometrics, p). 
--></p>
<p>Consistency is a great property, but only if the data generating process does in fact match the model. Many factor variables have effects that are not additively seperable.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="ordinary-least-squares.html#cb149-1" aria-hidden="true" tabindex="-1"></a>reg1 <span class="ot">&lt;-</span> <span class="fu">feols</span>(y<span class="sc">~</span>x<span class="sc">|</span>fo<span class="sc">^</span>fu, dat_f)</span>
<span id="cb149-2"><a href="ordinary-least-squares.html#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg1)</span></code></pre></div>
<pre><code>## OLS estimation, Dep. Var.: y
## Observations: 1,000 
## Fixed-effects: fo^fu: 10
## Standard-errors: Clustered (fo^fu) 
##   Estimate Std. Error t value Pr(&gt;|t|)    
## x  1.27096   0.567874  2.2381 0.052004 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## RMSE: 3.6686     Adj. R2: 0.957459
##                Within R2: 0.194625</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="ordinary-least-squares.html#cb151-1" aria-hidden="true" tabindex="-1"></a>reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">*</span>fo<span class="sc">*</span>fu, dat_f)</span>
<span id="cb151-2"><a href="ordinary-least-squares.html#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x * fo * fu, data = dat_f)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.3517  -1.4383   0.0133   1.5181  10.1531 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  12.7092     0.7911  16.066  &lt; 2e-16 ***
## x             2.9514     0.1308  22.563  &lt; 2e-16 ***
## fo.L         22.2574     2.3467   9.484  &lt; 2e-16 ***
## fo.Q          6.4010     2.0269   3.158  0.00164 ** 
## fo.C          0.5691     1.4176   0.401  0.68815    
## fo^4         -0.2009     0.9436  -0.213  0.83143    
## fuB         -12.3489     1.1644 -10.606  &lt; 2e-16 ***
## x:fo.L        5.6451     0.3847  14.674  &lt; 2e-16 ***
## x:fo.Q        2.4730     0.3339   7.407 2.78e-13 ***
## x:fo.C        0.7191     0.2363   3.044  0.00240 ** 
## x:fo^4        0.2180     0.1641   1.328  0.18434    
## x:fuB        -3.0068     0.1914 -15.711  &lt; 2e-16 ***
## fo.L:fuB    -21.2313     3.4724  -6.114 1.40e-09 ***
## fo.Q:fuB     -4.0395     2.9925  -1.350  0.17736    
## fo.C:fuB      0.8604     2.0715   0.415  0.67798    
## fo^4:fuB      1.1858     1.3464   0.881  0.37871    
## x:fo.L:fuB   -5.7984     0.5659 -10.246  &lt; 2e-16 ***
## x:fo.Q:fuB   -2.8296     0.4897  -5.778 1.01e-08 ***
## x:fo.C:fuB   -0.9292     0.3438  -2.702  0.00700 ** 
## x:fo^4:fuB   -0.3896     0.2329  -1.673  0.09474 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.65 on 980 degrees of freedom
## Multiple R-squared:  0.9785, Adjusted R-squared:  0.978 
## F-statistic:  2343 on 19 and 980 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="ordinary-least-squares.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reg2 &lt;- feols(y~x*fo*fu|fo^fu, dat_f)</span></span></code></pre></div>
<p>With <em>Random Effects</em>, the factor variable is modelled as coming from a distribution that is uncorrelated with the regressors. This is rarely used in economics today, and mostly included for historical reasons and a few cases where fixed effects cannot be estimates.</p>
<!-- 
> The labels "random effects" and "fixed effects" are misleading. These are labels which arose in the early literature and we are stuck with these labels today. In a previous era regressors were viewed as "fixed". Viewing the individual effect as an unobserved regressor leads to the label of the individual effect as "fixed". Today, we rarely refer to regressors as "fixed" when dealing with observational data. We view all variables as random. Consequently describing u i as "fixed" does not make much sense and it is hardly a contrast with the "random effect" label since under either assumption u i is treated as random. Once again, the labels are unfortunate but the key difference is whether u i is correlated with the regressors.
-->
</div>
<div id="more-literature" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> More Literature<a href="ordinary-least-squares.html#more-literature" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><a href="https://www.econometrics-with-r.org/6-rmwmr.html" class="uri">https://www.econometrics-with-r.org/6-rmwmr.html</a></li>
<li><a href="https://www.econometrics-with-r.org/7-htaciimr.html" class="uri">https://www.econometrics-with-r.org/7-htaciimr.html</a></li>
<li><a href="https://bookdown.org/ripberjt/labbook/multivariable-linear-regression.html" class="uri">https://bookdown.org/ripberjt/labbook/multivariable-linear-regression.html</a></li>
<li><a href="https://online.stat.psu.edu/stat462/node/137/" class="uri">https://online.stat.psu.edu/stat462/node/137/</a></li>
<li><a href="https://book.stat420.org/" class="uri">https://book.stat420.org/</a></li>
<li>Hill, Griffiths &amp; Lim (2007), Principles of Econometrics, 3rd ed., Wiley, S. 86f.</li>
<li>Verbeek (2004), A Guide to Modern Econometrics, 2nd ed., Wiley, S. 51ff.</li>
<li>Asteriou &amp; Hall (2011), Applied Econometrics, 2nd ed., Palgrave MacMillan, S. 177ff.</li>
<li><a href="https://online.stat.psu.edu/stat485/lesson/11/" class="uri">https://online.stat.psu.edu/stat485/lesson/11/</a></li>
</ul>
<p>For fixed effects, see</p>
<ul>
<li><a href="https://www.princeton.edu/~otorres/Panel101.pdf" class="uri">https://www.princeton.edu/~otorres/Panel101.pdf</a></li>
<li><a href="https://www.stata.com/manuals13/xtxtreg.pdf" class="uri">https://www.stata.com/manuals13/xtxtreg.pdf</a></li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="moving-beyond-the-basics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ols-diagnostics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["index.pdf", "index.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
