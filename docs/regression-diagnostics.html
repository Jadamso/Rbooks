<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 8 Regression Diagnostics | index</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content=" 8 Regression Diagnostics | index" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 8 Regression Diagnostics | index" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="structural-interpretation.html"/>
<link rel="next" href="sls-rdd-did.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6.9000/profvis.js"></script>
<script src="libs/profvis-0.3.6.9000/scroll.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.7/profvis.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Primers</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="part"><span><b>I Introduction to R</b></span></li>
<li class="chapter" data-level="2" data-path="first-steps-on-programming-in-r.html"><a href="first-steps-on-programming-in-r.html"><i class="fa fa-check"></i><b>2</b> First steps on Programming in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="first-steps-on-programming-in-r.html"><a href="first-steps-on-programming-in-r.html#install-r"><i class="fa fa-check"></i><b>2.1</b> Install R</a></li>
<li class="chapter" data-level="2.2" data-path="first-steps-on-programming-in-r.html"><a href="first-steps-on-programming-in-r.html#interfacing-with-the-gui."><i class="fa fa-check"></i><b>2.2</b> Interfacing with the GUI.</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mathematical-objects.html"><a href="mathematical-objects.html"><i class="fa fa-check"></i><b>3</b> Mathematical Objects</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mathematical-objects.html"><a href="mathematical-objects.html#scalars-and-vectors"><i class="fa fa-check"></i><b>3.1</b> Scalars and Vectors</a></li>
<li class="chapter" data-level="3.2" data-path="mathematical-objects.html"><a href="mathematical-objects.html#functions-of-scalars-and-vectors"><i class="fa fa-check"></i><b>3.2</b> Functions of Scalars and Vectors</a></li>
<li class="chapter" data-level="3.3" data-path="mathematical-objects.html"><a href="mathematical-objects.html#functionals"><i class="fa fa-check"></i><b>3.3</b> Functionals</a></li>
<li class="chapter" data-level="3.4" data-path="mathematical-objects.html"><a href="mathematical-objects.html#matrices-and-matrix-functions"><i class="fa fa-check"></i><b>3.4</b> Matrices and Matrix-Functions</a></li>
<li class="chapter" data-level="3.5" data-path="mathematical-objects.html"><a href="mathematical-objects.html#arrays-and-array-functions"><i class="fa fa-check"></i><b>3.5</b> Arrays and Array Functions</a></li>
<li class="chapter" data-level="3.6" data-path="mathematical-objects.html"><a href="mathematical-objects.html#other-commom-types-of-data"><i class="fa fa-check"></i><b>3.6</b> Other Commom Types of Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plots.html"><a href="plots.html"><i class="fa fa-check"></i><b>4</b> Plots</a>
<ul>
<li class="chapter" data-level="4.1" data-path="plots.html"><a href="plots.html#basics"><i class="fa fa-check"></i><b>4.1</b> Basics</a></li>
<li class="chapter" data-level="4.2" data-path="plots.html"><a href="plots.html#equation-fitting-example"><i class="fa fa-check"></i><b>4.2</b> Equation Fitting Example</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="moving-beyond-the-basics.html"><a href="moving-beyond-the-basics.html"><i class="fa fa-check"></i><b>5</b> Moving beyond the basics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="moving-beyond-the-basics.html"><a href="moving-beyond-the-basics.html#task-views"><i class="fa fa-check"></i><b>5.1</b> Task Views</a></li>
<li class="chapter" data-level="5.2" data-path="moving-beyond-the-basics.html"><a href="moving-beyond-the-basics.html#introductions-to-r"><i class="fa fa-check"></i><b>5.2</b> Introductions to R</a></li>
<li class="chapter" data-level="5.3" data-path="moving-beyond-the-basics.html"><a href="moving-beyond-the-basics.html#custom-figures"><i class="fa fa-check"></i><b>5.3</b> Custom figures</a></li>
</ul></li>
<li class="part"><span><b>II Introduction to Regression Analysis in R</b></span></li>
<li class="chapter" data-level="6" data-path="simple-ols-bivariate-linear-regression.html"><a href="simple-ols-bivariate-linear-regression.html"><i class="fa fa-check"></i><b>6</b> Simple OLS (bivariate linear regression)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="simple-ols-bivariate-linear-regression.html"><a href="simple-ols-bivariate-linear-regression.html#ols-multiple-linear-regression"><i class="fa fa-check"></i><b>6.1</b> OLS (multiple linear regression)</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="simple-ols-bivariate-linear-regression.html"><a href="simple-ols-bivariate-linear-regression.html#variability-estimates"><i class="fa fa-check"></i><b>6.1.1</b> Variability Estimates</a></li>
<li class="chapter" data-level="6.1.2" data-path="simple-ols-bivariate-linear-regression.html"><a href="simple-ols-bivariate-linear-regression.html#hypothesis-testing"><i class="fa fa-check"></i><b>6.1.2</b> Hypothesis Testing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="structural-interpretation.html"><a href="structural-interpretation.html"><i class="fa fa-check"></i><b>7</b> Structural Interpretation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="structural-interpretation.html"><a href="structural-interpretation.html#simulation-excercise"><i class="fa fa-check"></i><b>7.1</b> Simulation Excercise</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html"><i class="fa fa-check"></i><b>8</b> Regression Diagnostics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#first-plot-assessing-outlier-y"><i class="fa fa-check"></i><b>8.1</b> First Plot: Assessing Outlier <span class="math inline">\(Y\)</span></a></li>
<li class="chapter" data-level="8.2" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#second-plot-violations-of-normality"><i class="fa fa-check"></i><b>8.2</b> Second Plot: Violations of Normality</a></li>
<li class="chapter" data-level="8.3" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#third-plot-assessing-outlier-x-leverage"><i class="fa fa-check"></i><b>8.3</b> Third Plot: Assessing Outlier <span class="math inline">\(X\)</span>, “Leverage”</a></li>
<li class="chapter" data-level="8.4" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#fourth-plot-further-assessing-outlier-x-cooks-distance"><i class="fa fa-check"></i><b>8.4</b> Fourth Plot: Further Assessing Outlier <span class="math inline">\(X\)</span>, Cook’s Distance</a></li>
<li class="chapter" data-level="8.5" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#collinearity-variance-inflation-factor"><i class="fa fa-check"></i><b>8.5</b> Collinearity: Variance Inflation Factor</a></li>
<li class="chapter" data-level="8.6" data-path="regression-diagnostics.html"><a href="regression-diagnostics.html#more-literature"><i class="fa fa-check"></i><b>8.6</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sls-rdd-did.html"><a href="sls-rdd-did.html"><i class="fa fa-check"></i><b>9</b> 2SLS, RDD, DID</a></li>
<li class="chapter" data-level="10" data-path="data-scientism.html"><a href="data-scientism.html"><i class="fa fa-check"></i><b>10</b> Data scientism</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-scientism.html"><a href="data-scientism.html#us-govt-spending-on-science"><i class="fa fa-check"></i><b>10.1</b> US Gov’t Spending on Science</a></li>
<li class="chapter" data-level="10.2" data-path="data-scientism.html"><a href="data-scientism.html#ols-in-the-age-of-big-data"><i class="fa fa-check"></i><b>10.2</b> OLS in the age of big data</a></li>
<li class="chapter" data-level="10.3" data-path="data-scientism.html"><a href="data-scientism.html#causal-effects-sans-theory"><i class="fa fa-check"></i><b>10.3</b> Causal effects <em>sans theory</em></a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="data-scientism.html"><a href="data-scientism.html#rdd"><i class="fa fa-check"></i><b>10.3.1</b> RDD</a></li>
<li class="chapter" data-level="10.3.2" data-path="data-scientism.html"><a href="data-scientism.html#did"><i class="fa fa-check"></i><b>10.3.2</b> DID</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Introduction to Reproducible R</b></span></li>
<li class="chapter" data-level="11" data-path="why-be-reproducible.html"><a href="why-be-reproducible.html"><i class="fa fa-check"></i><b>11</b> Why be reproducible</a>
<ul>
<li class="chapter" data-level="11.1" data-path="why-be-reproducible.html"><a href="why-be-reproducible.html#an-example-workflow"><i class="fa fa-check"></i><b>11.1</b> An example workflow</a></li>
<li class="chapter" data-level="11.2" data-path="why-be-reproducible.html"><a href="why-be-reproducible.html#an-alternative-workflow"><i class="fa fa-check"></i><b>11.2</b> An alternative workflow</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="small-scale-projects.html"><a href="small-scale-projects.html"><i class="fa fa-check"></i><b>12</b> Small Scale Projects</a>
<ul>
<li class="chapter" data-level="12.1" data-path="small-scale-projects.html"><a href="small-scale-projects.html#types-of-projects"><i class="fa fa-check"></i><b>12.1</b> Types of Projects</a></li>
<li class="chapter" data-level="12.2" data-path="small-scale-projects.html"><a href="small-scale-projects.html#why-r-and-r-markdown"><i class="fa fa-check"></i><b>12.2</b> Why R and R-Markdown</a></li>
<li class="chapter" data-level="12.3" data-path="small-scale-projects.html"><a href="small-scale-projects.html#hw-example"><i class="fa fa-check"></i><b>12.3</b> HW Example</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="small-scale-projects.html"><a href="small-scale-projects.html#question1"><i class="fa fa-check"></i><b>12.3.1</b> Question1</a></li>
<li class="chapter" data-level="12.3.2" data-path="small-scale-projects.html"><a href="small-scale-projects.html#question-2"><i class="fa fa-check"></i><b>12.3.2</b> Question 2</a></li>
<li class="chapter" data-level="12.3.3" data-path="small-scale-projects.html"><a href="small-scale-projects.html#question-3"><i class="fa fa-check"></i><b>12.3.3</b> Question 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="medium-scale-projects.html"><a href="medium-scale-projects.html"><i class="fa fa-check"></i><b>13</b> Medium Scale Projects</a>
<ul>
<li class="chapter" data-level="13.1" data-path="medium-scale-projects.html"><a href="medium-scale-projects.html#makefile"><i class="fa fa-check"></i><b>13.1</b> MAKEFILE</a></li>
<li class="chapter" data-level="13.2" data-path="medium-scale-projects.html"><a href="medium-scale-projects.html#loggingsinking"><i class="fa fa-check"></i><b>13.2</b> Logging/Sinking</a></li>
<li class="chapter" data-level="13.3" data-path="medium-scale-projects.html"><a href="medium-scale-projects.html#final-step"><i class="fa fa-check"></i><b>13.3</b> Final Step</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="replication.html"><a href="replication.html"><i class="fa fa-check"></i><b>14</b> Replication</a>
<ul>
<li class="chapter" data-level="14.1" data-path="replication.html"><a href="replication.html#an-r-code-chunk"><i class="fa fa-check"></i><b>14.1</b> An R Code Chunk</a></li>
<li class="chapter" data-level="14.2" data-path="replication.html"><a href="replication.html#an-r-markdown-document"><i class="fa fa-check"></i><b>14.2</b> An R Markdown Document</a></li>
<li class="chapter" data-level="14.3" data-path="replication.html"><a href="replication.html#getting-help"><i class="fa fa-check"></i><b>14.3</b> Getting help</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="other-software.html"><a href="other-software.html"><i class="fa fa-check"></i><b>15</b> Other Software</a>
<ul>
<li class="chapter" data-level="15.1" data-path="other-software.html"><a href="other-software.html#stata"><i class="fa fa-check"></i><b>15.1</b> Stata</a></li>
<li class="chapter" data-level="15.2" data-path="other-software.html"><a href="other-software.html#general-workflow"><i class="fa fa-check"></i><b>15.2</b> General Workflow</a></li>
<li class="chapter" data-level="15.3" data-path="other-software.html"><a href="other-software.html#r-workflow"><i class="fa fa-check"></i><b>15.3</b> R Workflow</a></li>
</ul></li>
<li class="part"><span><b>IV Intermediate R</b></span></li>
<li class="chapter" data-level="16" data-path="latest-versions.html"><a href="latest-versions.html"><i class="fa fa-check"></i><b>16</b> Latest versions</a></li>
<li class="chapter" data-level="17" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>17</b> Debugging</a>
<ul>
<li class="chapter" data-level="17.1" data-path="debugging.html"><a href="debugging.html#memory-leaks"><i class="fa fa-check"></i><b>17.1</b> Memory Leaks</a></li>
<li class="chapter" data-level="17.2" data-path="debugging.html"><a href="debugging.html#tracing-errors"><i class="fa fa-check"></i><b>17.2</b> Tracing Errors</a></li>
<li class="chapter" data-level="17.3" data-path="debugging.html"><a href="debugging.html#checking-problems"><i class="fa fa-check"></i><b>17.3</b> Checking problems</a></li>
<li class="chapter" data-level="17.4" data-path="debugging.html"><a href="debugging.html#being-proactive"><i class="fa fa-check"></i><b>17.4</b> Being Proactive</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="optimizing.html"><a href="optimizing.html"><i class="fa fa-check"></i><b>18</b> Optimizing</a>
<ul>
<li class="chapter" data-level="18.1" data-path="optimizing.html"><a href="optimizing.html#benchmarking"><i class="fa fa-check"></i><b>18.1</b> Benchmarking</a></li>
<li class="chapter" data-level="18.2" data-path="optimizing.html"><a href="optimizing.html#bottlenecks"><i class="fa fa-check"></i><b>18.2</b> Bottlenecks</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="further-programming-guidance.html"><a href="further-programming-guidance.html"><i class="fa fa-check"></i><b>19</b> Further Programming Guidance</a></li>
<li class="divider"></li>
<li><a href="https://sites.google.com/view/jordan-adamson" target="blank">Jordan Adamson</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression-diagnostics" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number"> 8</span> Regression Diagnostics<a href="regression-diagnostics.html#regression-diagnostics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<hr />
<p>Simply plotting your regression object is a simple and easy step. Do this.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="regression-diagnostics.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb143-2"><a href="regression-diagnostics.html#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>We’ll now explain what we are looking at and why.</p>
<div id="first-plot-assessing-outlier-y" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> First Plot: Assessing Outlier <span class="math inline">\(Y\)</span><a href="regression-diagnostics.html#first-plot-assessing-outlier-y" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>``In our <span class="math inline">\(y_i = a + b x_i + e_i\)</span> regression, the residuals are, of course, <span class="math inline">\(e_i\)</span> – they reveal how much our fitted value <span class="math inline">\(\hat{y}_i = a + b x_i\)</span> differs from the observed <span class="math inline">\(y_i\)</span>. A point <span class="math inline">\((x_i ,y_i)\)</span> with a corresponding large residual is called an <em>outlier</em>. Say that you are interested in outliers because you somehow think that such points will exert undue <em>influence</em> on your estimates. Your feelings are generally right, but there are exceptions. A point might have a huge residual and yet not affect the estimated <span class="math inline">\(b\)</span> at all’’
Stata Press (2015) Base Reference Manual, Release 14, p. 2138.</p>
</blockquote>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="regression-diagnostics.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(reg), <span class="fu">resid</span>(reg),<span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb144-2"><a href="regression-diagnostics.html#cb144-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Fitted&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residual&quot;</span>,</span>
<span id="cb144-3"><a href="regression-diagnostics.html#cb144-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Fitted versus Residuals&quot;</span>)</span>
<span id="cb144-4"><a href="regression-diagnostics.html#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="regression-diagnostics.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># car::outlierTest(reg)</span></span></code></pre></div>
</div>
<div id="second-plot-violations-of-normality" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Second Plot: Violations of Normality<a href="regression-diagnostics.html#second-plot-violations-of-normality" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>OLS point estimates do not depend on the Normality of the residuals. Good thing, because there’s no reason the residuals of economic phenomena should be so well behaved. The variability of the point estimates are, however, affected by the distribution of the residuals. For these reasons, you may be interested in</p>
<p>Assessing Normality</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="regression-diagnostics.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb146-2"><a href="regression-diagnostics.html#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">resid</span>(reg), <span class="at">main=</span><span class="st">&#39;Histogram of Residuals&#39;</span>)</span>
<span id="cb146-3"><a href="regression-diagnostics.html#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="regression-diagnostics.html#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(reg), <span class="at">main =</span> <span class="st">&quot;Normal Q-Q Plot of Residuals&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>)</span>
<span id="cb146-5"><a href="regression-diagnostics.html#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(reg), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="regression-diagnostics.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(reg))</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  resid(reg)
## W = 0.94794, p-value = 0.02809</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="regression-diagnostics.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># car::qqPlot(reg)</span></span></code></pre></div>
<p>Assessing Heterskedasticity may also matter for variance estimates. This is not shown in the plot, but you can run a simple test</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="regression-diagnostics.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code></pre></div>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="regression-diagnostics.html#cb154-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">bptest</span>(reg)</span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  reg
## BP = 8.9049, df = 3, p-value = 0.03058</code></pre>
</div>
<div id="third-plot-assessing-outlier-x-leverage" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Third Plot: Assessing Outlier <span class="math inline">\(X\)</span>, “Leverage”<a href="regression-diagnostics.html#third-plot-assessing-outlier-x-leverage" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>“<span class="math inline">\((x_i ,y_i)\)</span> can be an outlier in another way – just as <span class="math inline">\(y_i\)</span> can be far from <span class="math inline">\(\hat{y}_i\)</span>, <span class="math inline">\(x_i\)</span> can be far from the center of mass of the other <span class="math inline">\(x\)</span>’s. Such an `outlier’ should interest you just as much as the more traditional outliers. Picture a scatterplot of <span class="math inline">\(y\)</span> against <span class="math inline">\(x\)</span> with thousands of points in some sort of mass at the lower left of the graph and one point at the upper right of the graph. Now run a regression line through the points—the regression line will come close to the point at the upper right of the graph and may in fact, go through it. That is, this isolated point will not appear as an outlier as measured by residuals because its residual will be small. Yet this point might have a dramatic effect on our resulting estimates in the sense that, were you to delete the point, the estimates would change markedly. Such a point is said to have high <em>leverage</em>’’
Stata Press (2015) Base Reference Manual, Release 14, pp. 2138-39.</p>
</blockquote>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="regression-diagnostics.html#cb156-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb156-2"><a href="regression-diagnostics.html#cb156-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="fu">runif</span>(N<span class="dv">-1</span>,<span class="dv">3</span>,<span class="dv">8</span>))</span>
<span id="cb156-3"><a href="regression-diagnostics.html#cb156-3" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="fl">0.4</span>)</span>
<span id="cb156-4"><a href="regression-diagnostics.html#cb156-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">+</span> <span class="fl">0.6</span><span class="sc">*</span><span class="fu">sqrt</span>(x) <span class="sc">+</span> e</span>
<span id="cb156-5"><a href="regression-diagnostics.html#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">grey</span>(.<span class="dv">5</span>,.<span class="dv">5</span>))</span>
<span id="cb156-6"><a href="regression-diagnostics.html#cb156-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x[<span class="dv">1</span>],y[<span class="dv">1</span>], <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>))</span>
<span id="cb156-7"><a href="regression-diagnostics.html#cb156-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-8"><a href="regression-diagnostics.html#cb156-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x), <span class="at">col=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb156-9"><a href="regression-diagnostics.html#cb156-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y[<span class="sc">-</span><span class="dv">1</span>]<span class="sc">~</span>x[<span class="sc">-</span><span class="dv">1</span>]))</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>See <a href="https://www.r-bloggers.com/2016/06/leverage-and-influence-in-a-nutshell/" class="uri">https://www.r-bloggers.com/2016/06/leverage-and-influence-in-a-nutshell/</a> for a good interactive explaination.</p>
<p>Leverage Vector: Distance within explanatory variables
<span class="math display">\[
H = diag(\hat{P}) = [h_{1}, h_{2}, ...., h_{N}]
\]</span>
<span class="math inline">\(h_i\)</span> is the leverage of residual <span class="math inline">\(\hat{\epsilon_i}\)</span></p>
<p>Studentized residuals
<span class="math display">\[
r_i=\frac{\hat{\epsilon}_i}{s_{[i]}\sqrt{1-h_i}}
\]</span>
and <span class="math inline">\(s_{(i)}\)</span> the root mean squared error of a regression with the <span class="math inline">\(i\)</span>th observation removed.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="regression-diagnostics.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which.max</span>(<span class="fu">hatvalues</span>(reg))</span></code></pre></div>
<pre><code>## Georgia 
##      10</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="regression-diagnostics.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which.max</span>(<span class="fu">rstandard</span>(reg))</span></code></pre></div>
<pre><code>## Alaska 
##      2</code></pre>
</div>
<div id="fourth-plot-further-assessing-outlier-x-cooks-distance" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Fourth Plot: Further Assessing Outlier <span class="math inline">\(X\)</span>, Cook’s Distance<a href="regression-diagnostics.html#fourth-plot-further-assessing-outlier-x-cooks-distance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Cook’s Distance is defined as the sum of all the changes in the regression model when observation i is removed from.
<span class="math display">\[
D_{i} = \frac{\sum_{j} \left( \hat{y_j} - \hat{y_j}_{[i]} \right)^2 }{ p s^2 }
= \frac{[e_{i}]^2}{p s^2 } \frac{h_i}{(1-h_i)^2}\\
s^2 = \frac{\sum_{i} (e_{i})^2 }{n-K}
\]</span></p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="regression-diagnostics.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which.max</span>(<span class="fu">cooks.distance</span>(reg))</span></code></pre></div>
<pre><code>## Alaska 
##      2</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="regression-diagnostics.html#cb163-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">influencePlot</span>(reg)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<pre><code>##                    StudRes        Hat        CookD
## Alaska          3.78570999 0.11602814 0.3646123432
## Georgia        -0.06679825 0.21493470 0.0003121571
## Nevada          2.62517777 0.06145855 0.1000109235
## North Carolina -2.01817190 0.21194394 0.2567055530</code></pre>
<p>There are many other diagnostics (which can often be written in terms of Cooks Distance or Vice Versa)</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="regression-diagnostics.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sall, J. (1990) Leverage plots for general linear hypotheses. American Statistician *44*, 308-315.</span></span>
<span id="cb165-2"><a href="regression-diagnostics.html#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="co"># car::leveragePlots(reg)</span></span></code></pre></div>
<p>(Welsch and Kuh. 1977; Belsley, Kuh, and Welsch. 1980) attempt to summarize the information in the leverage versus residual-squared plot into one DFITS statistic where <span class="math inline">\(DFITS &gt; 2\sqrt{{k}/{n}}\)</span> should be examined.
<span class="math display">\[
\text{DFITS}_i=r_i\sqrt{\frac{h_i}{1-h_i}}\\
\]</span></p>
<p>See also “dfbetas” and “covratio”</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="regression-diagnostics.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dfbetas(reg)</span></span>
<span id="cb166-2"><a href="regression-diagnostics.html#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dffits(reg)</span></span>
<span id="cb166-3"><a href="regression-diagnostics.html#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="co">#covratio(reg)</span></span>
<span id="cb166-4"><a href="regression-diagnostics.html#cb166-4" aria-hidden="true" tabindex="-1"></a><span class="co">#hatvalues(reg)</span></span>
<span id="cb166-5"><a href="regression-diagnostics.html#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">influence.measures</span>(reg)<span class="sc">$</span>infmat)</span></code></pre></div>
<pre><code>##                  dfb.1_    dfb.Mrdr     dfb.Assl     dfb.UrbP        dffit
## Alabama    -0.025686940 -0.08053898  0.014676264  0.047669803 -0.157239638
## Alaska      0.758304736 -0.59617559  0.976957649 -1.008931529  1.371544155
## Arizona    -0.011470229 -0.04034123  0.049624809  0.004523264  0.059142496
## Arkansas   -0.005860294  0.00105735 -0.002420583  0.006056285 -0.007978192
## California -0.295223556 -0.19702231  0.266630954  0.267792657  0.516921957
## Colorado   -0.169794005 -0.09705845  0.111735442  0.212324868  0.420983022
##                cov.r       cook.d        hat
## Alabama    1.1216797 6.264122e-03 0.05959345
## Alaska     0.4087414 3.646123e-01 0.11602814
## Arizona    1.2618576 8.934514e-04 0.13639303
## Arkansas   1.1493186 1.626607e-05 0.05006430
## California 1.0287684 6.527294e-02 0.11395594
## Colorado   0.7744530 4.116548e-02 0.03780975</code></pre>
</div>
<div id="collinearity-variance-inflation-factor" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Collinearity: Variance Inflation Factor<a href="regression-diagnostics.html#collinearity-variance-inflation-factor" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One explanatory variable in a multiple regression model can be linearly predicted from the others with a substantial degree of accuracy. Coefficient estimates may change erratically in response to small changes in the model or the data. (In the extreme case where there are more variables than observations <span class="math inline">\(K&gt;\geq N\)</span>, <span class="math inline">\(X&#39;X\)</span> has an infinite number of solutions and is not invertible.)</p>
<p>To diagnose this, we can use
<span class="math display">\[
VIF_{k}=\frac{1}{1-R^2_k},
\]</span>
where <span class="math inline">\(R^2_k\)</span> is the <span class="math inline">\(R^2\)</span> for the regression of <span class="math inline">\(X_k\)</span> on the other covariates <span class="math inline">\(X_{-k}\)</span> (a regression that does not involve the response variable Y)</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="regression-diagnostics.html#cb168-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(reg) </span></code></pre></div>
<pre><code>##   Murder  Assault UrbanPop 
## 2.971023 3.169012 1.136837</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="regression-diagnostics.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(car<span class="sc">::</span><span class="fu">vif</span>(reg)) <span class="sc">&gt;</span> <span class="dv">2</span> <span class="co"># problem?</span></span></code></pre></div>
<pre><code>##   Murder  Assault UrbanPop 
##    FALSE    FALSE    FALSE</code></pre>
</div>
<div id="more-literature" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> More Literature<a href="regression-diagnostics.html#more-literature" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>OLS</p>
<ul>
<li><a href="https://bookdown.org/ripberjt/labbook/multivariable-linear-regression.html" class="uri">https://bookdown.org/ripberjt/labbook/multivariable-linear-regression.html</a></li>
<li><a href="https://online.stat.psu.edu/stat462/node/137/" class="uri">https://online.stat.psu.edu/stat462/node/137/</a></li>
<li><a href="https://book.stat420.org/" class="uri">https://book.stat420.org/</a></li>
<li>Hill, Griffiths &amp; Lim (2007), Principles of Econometrics, 3rd ed., Wiley, S. 86f.</li>
<li>Verbeek (2004), A Guide to Modern Econometrics, 2nd ed., Wiley, S. 51ff.</li>
<li>Asteriou &amp; Hall (2011), Applied Econometrics, 2nd ed., Palgrave MacMillan, S. 177ff.</li>
<li><a href="https://online.stat.psu.edu/stat485/lesson/11/" class="uri">https://online.stat.psu.edu/stat485/lesson/11/</a></li>
</ul>
<p>OLS Diagnostics</p>
<ul>
<li><a href="https://book.stat420.org/model-diagnostics.html#leverage" class="uri">https://book.stat420.org/model-diagnostics.html#leverage</a></li>
<li><a href="https://socialsciences.mcmaster.ca/jfox/Books/RegressionDiagnostics/index.html" class="uri">https://socialsciences.mcmaster.ca/jfox/Books/RegressionDiagnostics/index.html</a></li>
<li><a href="https://bookdown.org/ripberjt/labbook/diagnosing-and-addressing-problems-in-linear-regression.html" class="uri">https://bookdown.org/ripberjt/labbook/diagnosing-and-addressing-problems-in-linear-regression.html</a></li>
<li>Belsley, D. A., Kuh, E., and Welsch, R. E. (1980). Regression Diagnostics: Identifying influential data and sources of collinearity. Wiley. <a href="https://doi.org/10.1002/0471725153" class="uri">https://doi.org/10.1002/0471725153</a></li>
<li>Fox, J. D. (2020). Regression diagnostics: An introduction (2nd ed.). SAGE. <a href="https://dx.doi.org/10.4135/9781071878651" class="uri">https://dx.doi.org/10.4135/9781071878651</a></li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="structural-interpretation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sls-rdd-did.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["index.pdf", "index.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
