<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 7 Hypothesis Tests | index</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content=" 7 Hypothesis Tests | index" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 7 Hypothesis Tests | index" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="resampling.html"/>
<link rel="next" href="data-analysis.html"/>
<script src="libs/jquery-3.7.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/core-js-2.5.3/shim.min.js"></script>
<script src="libs/react-18.2.0/react.min.js"></script>
<script src="libs/react-18.2.0/react-dom.min.js"></script>
<script src="libs/reactwidget-2.0.0/react-tools.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/reactable-0.4.4/reactable.css" rel="stylesheet" />
<script src="libs/reactable-binding-0.4.4/reactable.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6.9000/profvis.js"></script>
<script src="libs/profvis-0.3.6.9000/scroll.js"></script>
<link href="libs/highlight-11.10.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-11.10.0/highlight.min.js"></script>
<script src="libs/profvis-binding-0.4.0/profvis.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Rbooks</a></li>
<li class="toc-logo"><a href="./"><img src="Figures_Manual/Logo.png" width="140" height="100"></a></li>        

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="part"><span><b>I Data Analysis in R</b></span></li>
<li class="chapter" data-level="2" data-path="first-steps.html"><a href="first-steps.html"><i class="fa fa-check"></i><b>2</b> First Steps</a>
<ul>
<li class="chapter" data-level="2.1" data-path="first-steps.html"><a href="first-steps.html#why-r"><i class="fa fa-check"></i><b>2.1</b> Why R</a></li>
<li class="chapter" data-level="2.2" data-path="first-steps.html"><a href="first-steps.html#install-r"><i class="fa fa-check"></i><b>2.2</b> Install R</a></li>
<li class="chapter" data-level="2.3" data-path="first-steps.html"><a href="first-steps.html#interfacing-with-r"><i class="fa fa-check"></i><b>2.3</b> Interfacing with R</a></li>
<li class="chapter" data-level="2.4" data-path="first-steps.html"><a href="first-steps.html#introductions-to-r"><i class="fa fa-check"></i><b>2.4</b> Introductions to R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>3</b> Mathematics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mathematics.html"><a href="mathematics.html#scalars"><i class="fa fa-check"></i><b>3.1</b> Scalars</a></li>
<li class="chapter" data-level="3.2" data-path="mathematics.html"><a href="mathematics.html#vectors"><i class="fa fa-check"></i><b>3.2</b> Vectors</a></li>
<li class="chapter" data-level="3.3" data-path="mathematics.html"><a href="mathematics.html#functions"><i class="fa fa-check"></i><b>3.3</b> Functions</a></li>
<li class="chapter" data-level="3.4" data-path="mathematics.html"><a href="mathematics.html#logic"><i class="fa fa-check"></i><b>3.4</b> Logic</a></li>
<li class="chapter" data-level="3.5" data-path="mathematics.html"><a href="mathematics.html#matrices"><i class="fa fa-check"></i><b>3.5</b> Matrices</a></li>
<li class="chapter" data-level="3.6" data-path="mathematics.html"><a href="mathematics.html#arrays"><i class="fa fa-check"></i><b>3.6</b> Arrays</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>4</b> Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data.html"><a href="data.html#types"><i class="fa fa-check"></i><b>4.1</b> Types</a></li>
<li class="chapter" data-level="4.2" data-path="data.html"><a href="data.html#empirical-distributions"><i class="fa fa-check"></i><b>4.2</b> Empirical Distributions</a></li>
<li class="chapter" data-level="4.3" data-path="data.html"><a href="data.html#joint-distributions"><i class="fa fa-check"></i><b>4.3</b> Joint Distributions</a></li>
<li class="chapter" data-level="4.4" data-path="data.html"><a href="data.html#conditional-distributions"><i class="fa fa-check"></i><b>4.4</b> Conditional Distributions</a></li>
<li class="chapter" data-level="4.5" data-path="data.html"><a href="data.html#random-variables"><i class="fa fa-check"></i><b>4.5</b> Random Variables</a></li>
<li class="chapter" data-level="4.6" data-path="data.html"><a href="data.html#further-reading"><i class="fa fa-check"></i><b>4.6</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>5</b> Statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="statistics.html"><a href="statistics.html#mean-and-variance"><i class="fa fa-check"></i><b>5.1</b> Mean and Variance</a></li>
<li class="chapter" data-level="5.2" data-path="statistics.html"><a href="statistics.html#shape-statistics"><i class="fa fa-check"></i><b>5.2</b> Shape Statistics</a></li>
<li class="chapter" data-level="5.3" data-path="statistics.html"><a href="statistics.html#other-centerspread-statistics"><i class="fa fa-check"></i><b>5.3</b> Other Center/Spread Statistics</a></li>
<li class="chapter" data-level="5.4" data-path="statistics.html"><a href="statistics.html#associations"><i class="fa fa-check"></i><b>5.4</b> Associations</a></li>
<li class="chapter" data-level="5.5" data-path="statistics.html"><a href="statistics.html#beyond-basics"><i class="fa fa-check"></i><b>5.5</b> Beyond Basics</a></li>
<li class="chapter" data-level="5.6" data-path="statistics.html"><a href="statistics.html#further-reading-1"><i class="fa fa-check"></i><b>5.6</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="resampling.html"><a href="resampling.html"><i class="fa fa-check"></i><b>6</b> (Re)Sampling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="resampling.html"><a href="resampling.html#sample-distributions"><i class="fa fa-check"></i><b>6.1</b> Sample Distributions</a></li>
<li class="chapter" data-level="6.2" data-path="resampling.html"><a href="resampling.html#intervals"><i class="fa fa-check"></i><b>6.2</b> Intervals</a></li>
<li class="chapter" data-level="6.3" data-path="resampling.html"><a href="resampling.html#resampling-1"><i class="fa fa-check"></i><b>6.3</b> Resampling</a></li>
<li class="chapter" data-level="6.4" data-path="resampling.html"><a href="resampling.html#value-of-more-data"><i class="fa fa-check"></i><b>6.4</b> Value of More Data</a></li>
<li class="chapter" data-level="6.5" data-path="resampling.html"><a href="resampling.html#further-reading-2"><i class="fa fa-check"></i><b>6.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html"><i class="fa fa-check"></i><b>7</b> Hypothesis Tests</a>
<ul>
<li class="chapter" data-level="7.1" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#basic-ideas"><i class="fa fa-check"></i><b>7.1</b> Basic Ideas</a></li>
<li class="chapter" data-level="7.2" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#default-statistics"><i class="fa fa-check"></i><b>7.2</b> Default Statistics</a></li>
<li class="chapter" data-level="7.3" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#two-sample-differences"><i class="fa fa-check"></i><b>7.3</b> Two-Sample Differences</a></li>
<li class="chapter" data-level="7.4" data-path="hypothesis-tests.html"><a href="hypothesis-tests.html#distributional-tests"><i class="fa fa-check"></i><b>7.4</b> Distributional Tests</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>8</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-analysis.html"><a href="data-analysis.html#reading-in"><i class="fa fa-check"></i><b>8.1</b> Reading In</a></li>
<li class="chapter" data-level="8.2" data-path="data-analysis.html"><a href="data-analysis.html#cleaning-data"><i class="fa fa-check"></i><b>8.2</b> Cleaning Data</a></li>
<li class="chapter" data-level="8.3" data-path="data-analysis.html"><a href="data-analysis.html#polishing"><i class="fa fa-check"></i><b>8.3</b> Polishing</a></li>
<li class="chapter" data-level="8.4" data-path="data-analysis.html"><a href="data-analysis.html#interactive"><i class="fa fa-check"></i><b>8.4</b> Interactive</a></li>
<li class="chapter" data-level="8.5" data-path="data-analysis.html"><a href="data-analysis.html#custom-figures"><i class="fa fa-check"></i><b>8.5</b> Custom Figures</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="reporting.html"><a href="reporting.html"><i class="fa fa-check"></i><b>9</b> Reporting</a>
<ul>
<li class="chapter" data-level="9.1" data-path="reporting.html"><a href="reporting.html#r-and-r-markdown"><i class="fa fa-check"></i><b>9.1</b> R and R-Markdown</a></li>
<li class="chapter" data-level="9.2" data-path="reporting.html"><a href="reporting.html#simple-reports"><i class="fa fa-check"></i><b>9.2</b> Simple Reports</a></li>
<li class="chapter" data-level="9.3" data-path="reporting.html"><a href="reporting.html#posters-and-slides"><i class="fa fa-check"></i><b>9.3</b> Posters and Slides</a></li>
<li class="chapter" data-level="9.4" data-path="reporting.html"><a href="reporting.html#more-literature"><i class="fa fa-check"></i><b>9.4</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="probability-theory.html"><a href="probability-theory.html"><i class="fa fa-check"></i><b>10</b> Probability Theory</a>
<ul>
<li class="chapter" data-level="10.1" data-path="probability-theory.html"><a href="probability-theory.html#mean-and-variance-1"><i class="fa fa-check"></i><b>10.1</b> Mean and Variance</a></li>
<li class="chapter" data-level="10.2" data-path="probability-theory.html"><a href="probability-theory.html#bivariate-distributions"><i class="fa fa-check"></i><b>10.2</b> Bivariate Distributions</a></li>
<li class="chapter" data-level="10.3" data-path="probability-theory.html"><a href="probability-theory.html#further-reading-3"><i class="fa fa-check"></i><b>10.3</b> Further Reading</a></li>
</ul></li>
<li class="part"><span><b>II Linear Regression in R</b></span></li>
<li class="chapter" data-level="11" data-path="bivariate-data.html"><a href="bivariate-data.html"><i class="fa fa-check"></i><b>11</b> Bivariate Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="bivariate-data.html"><a href="bivariate-data.html#simple-linear-regression"><i class="fa fa-check"></i><b>11.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="11.2" data-path="bivariate-data.html"><a href="bivariate-data.html#variability-estimates"><i class="fa fa-check"></i><b>11.2</b> Variability Estimates</a></li>
<li class="chapter" data-level="11.3" data-path="bivariate-data.html"><a href="bivariate-data.html#hypothesis-tests-1"><i class="fa fa-check"></i><b>11.3</b> Hypothesis Tests</a></li>
<li class="chapter" data-level="11.4" data-path="bivariate-data.html"><a href="bivariate-data.html#prediction-intervals"><i class="fa fa-check"></i><b>11.4</b> Prediction Intervals</a></li>
<li class="chapter" data-level="11.5" data-path="bivariate-data.html"><a href="bivariate-data.html#locally-linear"><i class="fa fa-check"></i><b>11.5</b> Locally Linear</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="multivariate-data.html"><a href="multivariate-data.html"><i class="fa fa-check"></i><b>12</b> Multivariate Data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="multivariate-data.html"><a href="multivariate-data.html#multiple-linear-regression"><i class="fa fa-check"></i><b>12.1</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="12.2" data-path="multivariate-data.html"><a href="multivariate-data.html#variability-and-hypothesis-tests"><i class="fa fa-check"></i><b>12.2</b> Variability and Hypothesis Tests</a></li>
<li class="chapter" data-level="12.3" data-path="multivariate-data.html"><a href="multivariate-data.html#factor-variables"><i class="fa fa-check"></i><b>12.3</b> Factor Variables</a></li>
<li class="chapter" data-level="12.4" data-path="multivariate-data.html"><a href="multivariate-data.html#coefficient-interpretation"><i class="fa fa-check"></i><b>12.4</b> Coefficient Interpretation</a></li>
<li class="chapter" data-level="12.5" data-path="multivariate-data.html"><a href="multivariate-data.html#transformations"><i class="fa fa-check"></i><b>12.5</b> Transformations</a></li>
<li class="chapter" data-level="12.6" data-path="multivariate-data.html"><a href="multivariate-data.html#diagnostics"><i class="fa fa-check"></i><b>12.6</b> Diagnostics</a></li>
<li class="chapter" data-level="12.7" data-path="multivariate-data.html"><a href="multivariate-data.html#more-literature-1"><i class="fa fa-check"></i><b>12.7</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="endogeneity-issues.html"><a href="endogeneity-issues.html"><i class="fa fa-check"></i><b>13</b> Endogeneity Issues</a>
<ul>
<li class="chapter" data-level="13.1" data-path="endogeneity-issues.html"><a href="endogeneity-issues.html#two-stage-least-squares-2sls"><i class="fa fa-check"></i><b>13.1</b> Two Stage Least Squares (2SLS)</a></li>
<li class="chapter" data-level="13.2" data-path="endogeneity-issues.html"><a href="endogeneity-issues.html#regression-discontinuitieskink-rdrk"><i class="fa fa-check"></i><b>13.2</b> Regression Discontinuities/Kink (RD/RK)</a></li>
<li class="chapter" data-level="13.3" data-path="endogeneity-issues.html"><a href="endogeneity-issues.html#difference-in-differences-did"><i class="fa fa-check"></i><b>13.3</b> Difference in Differences (DID)</a></li>
<li class="chapter" data-level="13.4" data-path="endogeneity-issues.html"><a href="endogeneity-issues.html#more-literature-2"><i class="fa fa-check"></i><b>13.4</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="data-scientism.html"><a href="data-scientism.html"><i class="fa fa-check"></i><b>14</b> Data Scientism</a>
<ul>
<li class="chapter" data-level="14.1" data-path="data-scientism.html"><a href="data-scientism.html#data-errors"><i class="fa fa-check"></i><b>14.1</b> Data Errors</a></li>
<li class="chapter" data-level="14.2" data-path="data-scientism.html"><a href="data-scientism.html#p-hacking"><i class="fa fa-check"></i><b>14.2</b> P-Hacking</a></li>
<li class="chapter" data-level="14.3" data-path="data-scientism.html"><a href="data-scientism.html#spurious-regression"><i class="fa fa-check"></i><b>14.3</b> Spurious Regression</a></li>
<li class="chapter" data-level="14.4" data-path="data-scientism.html"><a href="data-scientism.html#spurious-causal-impacts"><i class="fa fa-check"></i><b>14.4</b> Spurious Causal Impacts</a></li>
</ul></li>
<li class="part"><span><b>III Reproducible Research in R</b></span></li>
<li class="chapter" data-level="15" data-path="why.html"><a href="why.html"><i class="fa fa-check"></i><b>15</b> Why?</a>
<ul>
<li class="chapter" data-level="15.1" data-path="why.html"><a href="why.html#an-example-workflow"><i class="fa fa-check"></i><b>15.1</b> An example workflow</a></li>
<li class="chapter" data-level="15.2" data-path="why.html"><a href="why.html#an-alternative-workflow"><i class="fa fa-check"></i><b>15.2</b> An alternative workflow</a></li>
<li class="chapter" data-level="15.3" data-path="why.html"><a href="why.html#task-views"><i class="fa fa-check"></i><b>15.3</b> Task Views</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="large-projects.html"><a href="large-projects.html"><i class="fa fa-check"></i><b>16</b> Large Projects</a>
<ul>
<li class="chapter" data-level="16.1" data-path="large-projects.html"><a href="large-projects.html#scripting"><i class="fa fa-check"></i><b>16.1</b> Scripting</a></li>
<li class="chapter" data-level="16.2" data-path="large-projects.html"><a href="large-projects.html#organization"><i class="fa fa-check"></i><b>16.2</b> Organization</a></li>
<li class="chapter" data-level="16.3" data-path="large-projects.html"><a href="large-projects.html#loggingsinking"><i class="fa fa-check"></i><b>16.3</b> Logging/Sinking</a></li>
<li class="chapter" data-level="16.4" data-path="large-projects.html"><a href="large-projects.html#class-projects"><i class="fa fa-check"></i><b>16.4</b> Class Projects</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="performance.html"><a href="performance.html"><i class="fa fa-check"></i><b>17</b> Performance</a>
<ul>
<li class="chapter" data-level="17.1" data-path="performance.html"><a href="performance.html#debugging"><i class="fa fa-check"></i><b>17.1</b> Debugging</a></li>
<li class="chapter" data-level="17.2" data-path="performance.html"><a href="performance.html#optimizing"><i class="fa fa-check"></i><b>17.2</b> Optimizing</a></li>
<li class="chapter" data-level="17.3" data-path="performance.html"><a href="performance.html#advanced-optimizing"><i class="fa fa-check"></i><b>17.3</b> Advanced Optimizing</a></li>
<li class="chapter" data-level="17.4" data-path="performance.html"><a href="performance.html#more-literature-3"><i class="fa fa-check"></i><b>17.4</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>18</b> Applications</a>
<ul>
<li class="chapter" data-level="18.1" data-path="applications.html"><a href="applications.html#more-literature-4"><i class="fa fa-check"></i><b>18.1</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i><b>19</b> Software</a>
<ul>
<li class="chapter" data-level="19.1" data-path="software.html"><a href="software.html#latest-versions"><i class="fa fa-check"></i><b>19.1</b> Latest versions</a></li>
<li class="chapter" data-level="19.2" data-path="software.html"><a href="software.html#general-workflow"><i class="fa fa-check"></i><b>19.2</b> General Workflow</a></li>
<li class="chapter" data-level="19.3" data-path="software.html"><a href="software.html#sweave"><i class="fa fa-check"></i><b>19.3</b> Sweave</a></li>
<li class="chapter" data-level="19.4" data-path="software.html"><a href="software.html#stata"><i class="fa fa-check"></i><b>19.4</b> Stata</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://sites.google.com/view/jordan-adamson" target="blank">Jordan Adamson</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hypothesis-tests" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number"> 7</span> Hypothesis Tests<a href="hypothesis-tests.html#hypothesis-tests" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<hr />
<div id="basic-ideas" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Basic Ideas<a href="hypothesis-tests.html#basic-ideas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section, we test hypotheses using <em>data-driven</em> methods that assume much less about the data generating process. There are two main ways to conduct a hypothesis test to do so: inverting a confidence interval and imposing the null.</p>
<p><strong>Invert a CI</strong>.
One main way to conduct hypothesis tests is to examine whether a confidence interval contains a hypothesized value. We then have this decision rule</p>
<ul>
<li>reject the null if value falls outside of the interval</li>
<li>fail to reject the null if value falls inside of the interval</li>
</ul>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="hypothesis-tests.html#cb328-1" tabindex="-1"></a>sample_dat <span class="ot">&lt;-</span> USArrests<span class="sc">$</span>Murder</span>
<span id="cb328-2"><a href="hypothesis-tests.html#cb328-2" tabindex="-1"></a>sample_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample_dat)</span>
<span id="cb328-3"><a href="hypothesis-tests.html#cb328-3" tabindex="-1"></a></span>
<span id="cb328-4"><a href="hypothesis-tests.html#cb328-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(sample_dat)</span>
<span id="cb328-5"><a href="hypothesis-tests.html#cb328-5" tabindex="-1"></a>Jmeans <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i){</span>
<span id="cb328-6"><a href="hypothesis-tests.html#cb328-6" tabindex="-1"></a>    dati <span class="ot">&lt;-</span> sample_dat[<span class="sc">-</span>i]</span>
<span id="cb328-7"><a href="hypothesis-tests.html#cb328-7" tabindex="-1"></a>    <span class="fu">mean</span>(dati)</span>
<span id="cb328-8"><a href="hypothesis-tests.html#cb328-8" tabindex="-1"></a>})</span>
<span id="cb328-9"><a href="hypothesis-tests.html#cb328-9" tabindex="-1"></a><span class="fu">hist</span>(Jmeans, <span class="at">breaks=</span><span class="dv">25</span>,</span>
<span id="cb328-10"><a href="hypothesis-tests.html#cb328-10" tabindex="-1"></a>    <span class="at">border=</span><span class="cn">NA</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">7.5</span>,<span class="fl">8.1</span>),</span>
<span id="cb328-11"><a href="hypothesis-tests.html#cb328-11" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;&#39;</span>, <span class="at">xlab=</span><span class="fu">expression</span>( <span class="fu">bar</span>(X)[<span class="sc">-</span>i]))</span>
<span id="cb328-12"><a href="hypothesis-tests.html#cb328-12" tabindex="-1"></a><span class="co"># CI</span></span>
<span id="cb328-13"><a href="hypothesis-tests.html#cb328-13" tabindex="-1"></a>ci_95 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Jmeans, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span>
<span id="cb328-14"><a href="hypothesis-tests.html#cb328-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>ci_95, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb328-15"><a href="hypothesis-tests.html#cb328-15" tabindex="-1"></a><span class="co"># H0: mean=8</span></span>
<span id="cb328-16"><a href="hypothesis-tests.html#cb328-16" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">8</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
<p><strong>Impose the Null</strong>.
We can also compute a <em>null distribution</em>: the sampling distribution of the statistic under the null hypothesis (assuming your null hypothesis was true). We focus on the simplest, the bootstrap, where loop through a large number of simulations. In each iteration of the loop, we drop impose the null hypothesis and reestimate the statistic of interest. We then calculate the standard deviation of the statistic across all ``resamples’’. Specifically, we compute the distribution of t-values on data with randomly reshuffled outcomes (imposing the null), and compare how extreme the observed value is.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="hypothesis-tests.html#cb329-1" tabindex="-1"></a>sample_dat <span class="ot">&lt;-</span> USArrests<span class="sc">$</span>Murder</span>
<span id="cb329-2"><a href="hypothesis-tests.html#cb329-2" tabindex="-1"></a>sample_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample_dat)</span>
<span id="cb329-3"><a href="hypothesis-tests.html#cb329-3" tabindex="-1"></a></span>
<span id="cb329-4"><a href="hypothesis-tests.html#cb329-4" tabindex="-1"></a><span class="co"># Bootstrap estimates</span></span>
<span id="cb329-5"><a href="hypothesis-tests.html#cb329-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb329-6"><a href="hypothesis-tests.html#cb329-6" tabindex="-1"></a>Bmeans0 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="cf">function</span>(i) {</span>
<span id="cb329-7"><a href="hypothesis-tests.html#cb329-7" tabindex="-1"></a>    dat_b <span class="ot">&lt;-</span> <span class="fu">sample</span>(sample_dat, <span class="at">replace=</span>T) </span>
<span id="cb329-8"><a href="hypothesis-tests.html#cb329-8" tabindex="-1"></a>    mean_b <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat_b) <span class="sc">+</span> (<span class="dv">8</span> <span class="sc">-</span> sample_mean) <span class="co"># impose the null by recentering</span></span>
<span id="cb329-9"><a href="hypothesis-tests.html#cb329-9" tabindex="-1"></a>    <span class="fu">return</span>(mean_b)</span>
<span id="cb329-10"><a href="hypothesis-tests.html#cb329-10" tabindex="-1"></a>})</span>
<span id="cb329-11"><a href="hypothesis-tests.html#cb329-11" tabindex="-1"></a><span class="fu">hist</span>(Bmeans0, <span class="at">breaks=</span><span class="dv">25</span>, <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb329-12"><a href="hypothesis-tests.html#cb329-12" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;&#39;</span>, <span class="at">xlab=</span><span class="fu">expression</span>( <span class="fu">bar</span>(X)[b]) )</span>
<span id="cb329-13"><a href="hypothesis-tests.html#cb329-13" tabindex="-1"></a>ci_95 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Bmeans0, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span>
<span id="cb329-14"><a href="hypothesis-tests.html#cb329-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>ci_95, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb329-15"><a href="hypothesis-tests.html#cb329-15" tabindex="-1"></a></span>
<span id="cb329-16"><a href="hypothesis-tests.html#cb329-16" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>sample_mean, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
</div>
<div id="default-statistics" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Default Statistics<a href="hypothesis-tests.html#default-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>p-values</strong>. A <em>p-value</em> is the frequency you would see something as extreme as your statistic when sampling from the null distribution.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="hypothesis-tests.html#cb330-1" tabindex="-1"></a><span class="co"># P( boot0_means &gt; sample_mean) </span></span>
<span id="cb330-2"><a href="hypothesis-tests.html#cb330-2" tabindex="-1"></a><span class="co"># NULL: mean=8</span></span>
<span id="cb330-3"><a href="hypothesis-tests.html#cb330-3" tabindex="-1"></a>That_NullDist1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(Bmeans0)</span>
<span id="cb330-4"><a href="hypothesis-tests.html#cb330-4" tabindex="-1"></a><span class="fu">plot</span>(That_NullDist1,</span>
<span id="cb330-5"><a href="hypothesis-tests.html#cb330-5" tabindex="-1"></a>    <span class="at">xlab=</span><span class="fu">expression</span>( beta[b] ),</span>
<span id="cb330-6"><a href="hypothesis-tests.html#cb330-6" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;Null Bootstrap Distribution for means&#39;</span>, <span class="at">font.main=</span><span class="dv">1</span>)</span>
<span id="cb330-7"><a href="hypothesis-tests.html#cb330-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>sample_mean, <span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="hypothesis-tests.html#cb331-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">That_NullDist1</span>(sample_mean)</span>
<span id="cb331-2"><a href="hypothesis-tests.html#cb331-2" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.3751</code></pre>
<p>There are three associated tests: the two-sided test (observed statistic is extremely high or low) or one of the one-sided tests (observed statistic is extremely low, observed statistic is extremely high). In either case, typically “p&lt;.05: statistically significant” and “p&gt;.05: statistically insignificant”.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="hypothesis-tests.html#cb333-1" tabindex="-1"></a><span class="co"># One-Sided Test, ALTERNATIVE: mean &lt; 8</span></span>
<span id="cb333-2"><a href="hypothesis-tests.html#cb333-2" tabindex="-1"></a><span class="cf">if</span>(p <span class="sc">&gt;</span>.<span class="dv">05</span>){</span>
<span id="cb333-3"><a href="hypothesis-tests.html#cb333-3" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">&#39;fail to reject the null that sample_mean=8 at the 5% level&#39;</span>)</span>
<span id="cb333-4"><a href="hypothesis-tests.html#cb333-4" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb333-5"><a href="hypothesis-tests.html#cb333-5" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">&#39;reject the null that sample_mean=8 in favor of &lt;8 at the 5% level&#39;</span>)</span>
<span id="cb333-6"><a href="hypothesis-tests.html#cb333-6" tabindex="-1"></a>}</span>
<span id="cb333-7"><a href="hypothesis-tests.html#cb333-7" tabindex="-1"></a></span>
<span id="cb333-8"><a href="hypothesis-tests.html#cb333-8" tabindex="-1"></a><span class="co"># Two-Sided Test, ALTERNATIVE: mean &lt; 8 or mean &gt;8</span></span>
<span id="cb333-9"><a href="hypothesis-tests.html#cb333-9" tabindex="-1"></a><span class="cf">if</span>( p <span class="sc">&gt;</span>.<span class="dv">025</span> <span class="sc">|</span> p <span class="sc">&gt;</span>.<span class="dv">975</span>){</span>
<span id="cb333-10"><a href="hypothesis-tests.html#cb333-10" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">&#39;fail to reject the null that sample_mean=8 at the 5% level&#39;</span>)</span>
<span id="cb333-11"><a href="hypothesis-tests.html#cb333-11" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb333-12"><a href="hypothesis-tests.html#cb333-12" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">&#39;reject the null that sample_mean=8 in favor of either &lt;8 or &gt;8 at the 5% level&#39;</span>)</span>
<span id="cb333-13"><a href="hypothesis-tests.html#cb333-13" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>t-values</strong>. A t-value standardizes the statistic you are using for hypothesis testing.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="hypothesis-tests.html#cb334-1" tabindex="-1"></a>jack_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(Jmeans)</span>
<span id="cb334-2"><a href="hypothesis-tests.html#cb334-2" tabindex="-1"></a>mean0 <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb334-3"><a href="hypothesis-tests.html#cb334-3" tabindex="-1"></a>jack_t <span class="ot">&lt;-</span> (sample_mean <span class="sc">-</span> mean0)<span class="sc">/</span>jack_se</span></code></pre></div>
<p>There are several benefits to this:</p>
<ul>
<li>makes the statistic comparable across different studies</li>
<li>makes the null distribution theoretically known (at least approximately)</li>
<li>makes the null distribution not depend on theoretical parameters (<span class="math inline">\(\sigma\)</span>)</li>
</ul>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="hypothesis-tests.html#cb335-1" tabindex="-1"></a><span class="co"># Two-Sided Test, based on theory</span></span>
<span id="cb335-2"><a href="hypothesis-tests.html#cb335-2" tabindex="-1"></a><span class="co"># 1-pt( abs(jack_t), n-1) + pt(-abs(jack_t), n-1)</span></span></code></pre></div>
<p>In another statistics class, you will learn the math behind the null t-distribution. In this class, we skip this because we can simply bootstrap the t-statistic too.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="hypothesis-tests.html#cb336-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb336-2"><a href="hypothesis-tests.html#cb336-2" tabindex="-1"></a>boot_t0 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="cf">function</span>(i) {</span>
<span id="cb336-3"><a href="hypothesis-tests.html#cb336-3" tabindex="-1"></a>    dat_b <span class="ot">&lt;-</span> <span class="fu">sample</span>(sample_dat, <span class="at">replace=</span>T) </span>
<span id="cb336-4"><a href="hypothesis-tests.html#cb336-4" tabindex="-1"></a>    mean_b <span class="ot">&lt;-</span> <span class="fu">mean</span>(dat_b) <span class="sc">+</span> (<span class="dv">8</span> <span class="sc">-</span> sample_mean) <span class="co"># impose the null by recentering</span></span>
<span id="cb336-5"><a href="hypothesis-tests.html#cb336-5" tabindex="-1"></a>    jack_t <span class="ot">&lt;-</span> (mean_b <span class="sc">-</span> mean0)<span class="sc">/</span>jack_se</span>
<span id="cb336-6"><a href="hypothesis-tests.html#cb336-6" tabindex="-1"></a>})</span>
<span id="cb336-7"><a href="hypothesis-tests.html#cb336-7" tabindex="-1"></a></span>
<span id="cb336-8"><a href="hypothesis-tests.html#cb336-8" tabindex="-1"></a><span class="co"># Two Sided Test for P(t &gt; jack_t or  t &lt; -jack_t | Null)</span></span>
<span id="cb336-9"><a href="hypothesis-tests.html#cb336-9" tabindex="-1"></a>That_NullDist2 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(<span class="fu">abs</span>(boot_t0))</span>
<span id="cb336-10"><a href="hypothesis-tests.html#cb336-10" tabindex="-1"></a><span class="fu">plot</span>(That_NullDist2, <span class="at">xlim=</span><span class="fu">range</span>(boot_t0, jack_t),</span>
<span id="cb336-11"><a href="hypothesis-tests.html#cb336-11" tabindex="-1"></a>    <span class="at">xlab=</span><span class="fu">expression</span>( <span class="fu">abs</span>(<span class="fu">hat</span>(t)[b]) ),</span>
<span id="cb336-12"><a href="hypothesis-tests.html#cb336-12" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;Null Bootstrap Distribution for t&#39;</span>, <span class="at">font.main=</span><span class="dv">1</span>)</span>
<span id="cb336-13"><a href="hypothesis-tests.html#cb336-13" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">abs</span>(jack_t), <span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="hypothesis-tests.html#cb337-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">That_NullDist2</span>( <span class="fu">abs</span>(jack_t) ) </span>
<span id="cb337-2"><a href="hypothesis-tests.html#cb337-2" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.2659</code></pre>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="hypothesis-tests.html#cb339-1" tabindex="-1"></a><span class="cf">if</span>(p <span class="sc">&gt;</span>.<span class="dv">05</span>){</span>
<span id="cb339-2"><a href="hypothesis-tests.html#cb339-2" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">&#39;fail to reject the null that sample_mean=8 at the 5% level&#39;</span>)</span>
<span id="cb339-3"><a href="hypothesis-tests.html#cb339-3" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb339-4"><a href="hypothesis-tests.html#cb339-4" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">&#39;reject the null that sample_mean=8 in favor of either &lt;8 or &gt;8 at the 5% level&#39;</span>)</span>
<span id="cb339-5"><a href="hypothesis-tests.html#cb339-5" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="two-sample-differences" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Two-Sample Differences<a href="hypothesis-tests.html#two-sample-differences" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose we have 2 samples of data.</p>
<p>Each <span class="math inline">\(X_{is}\)</span> is an individual observation <span class="math inline">\(i\)</span> from the sample <span class="math inline">\(s=1,2\)</span>. (For example, the wages for men and women in Canada. For another example, homicide rates in two different American states.)</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="hypothesis-tests.html#cb340-1" tabindex="-1"></a><span class="fu">library</span>(wooldridge)</span>
<span id="cb340-2"><a href="hypothesis-tests.html#cb340-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> wage1[wage1<span class="sc">$</span>educ <span class="sc">==</span> <span class="dv">15</span>, <span class="st">&#39;wage&#39;</span>]</span>
<span id="cb340-3"><a href="hypothesis-tests.html#cb340-3" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> wage1[wage1<span class="sc">$</span>educ <span class="sc">==</span> <span class="dv">16</span>, <span class="st">&#39;wage&#39;</span>]</span></code></pre></div>
<p>Although it not necessary, we will assume that each <span class="math inline">\(X_{is}\)</span> is an independent observation for simplicity.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="hypothesis-tests.html#cb341-1" tabindex="-1"></a><span class="co"># Sample 1</span></span>
<span id="cb341-2"><a href="hypothesis-tests.html#cb341-2" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb341-3"><a href="hypothesis-tests.html#cb341-3" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb341-4"><a href="hypothesis-tests.html#cb341-4" tabindex="-1"></a><span class="co"># Sample 2</span></span>
<span id="cb341-5"><a href="hypothesis-tests.html#cb341-5" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">80</span></span>
<span id="cb341-6"><a href="hypothesis-tests.html#cb341-6" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb341-7"><a href="hypothesis-tests.html#cb341-7" tabindex="-1"></a></span>
<span id="cb341-8"><a href="hypothesis-tests.html#cb341-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb341-9"><a href="hypothesis-tests.html#cb341-9" tabindex="-1"></a>bks <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">7</span>,<span class="dv">7</span>, <span class="at">by=</span>.<span class="dv">5</span>)</span>
<span id="cb341-10"><a href="hypothesis-tests.html#cb341-10" tabindex="-1"></a><span class="fu">hist</span>(x1, <span class="at">border=</span><span class="cn">NA</span>, <span class="at">breaks=</span>bks,</span>
<span id="cb341-11"><a href="hypothesis-tests.html#cb341-11" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;Sample 1&#39;</span>, <span class="at">font.main=</span><span class="dv">1</span>)</span>
<span id="cb341-12"><a href="hypothesis-tests.html#cb341-12" tabindex="-1"></a></span>
<span id="cb341-13"><a href="hypothesis-tests.html#cb341-13" tabindex="-1"></a><span class="fu">hist</span>(x2, <span class="at">border=</span><span class="cn">NA</span>, <span class="at">breaks=</span>bks, </span>
<span id="cb341-14"><a href="hypothesis-tests.html#cb341-14" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;Sample 2&#39;</span>, <span class="at">font.main=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<p>There may be several differences between these samples. Often, the first summary statistic we investigate is the difference in means.</p>
<p><strong>Equal Means</strong>. The sample mean <span class="math inline">\(\overline{X}_{s}\)</span> is the average value of all the observations in the sample. We want to know if the means are different. To test this hypothesis, we examine the differences term
<span class="math display">\[\begin{eqnarray}
D = \overline{X}_{1} - \overline{X}_{2},
\end{eqnarray}\]</span>
with a null hypothesis of <span class="math inline">\(D=0\)</span>.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="hypothesis-tests.html#cb342-1" tabindex="-1"></a><span class="co"># Differences between means</span></span>
<span id="cb342-2"><a href="hypothesis-tests.html#cb342-2" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(x1)</span>
<span id="cb342-3"><a href="hypothesis-tests.html#cb342-3" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(x2)</span>
<span id="cb342-4"><a href="hypothesis-tests.html#cb342-4" tabindex="-1"></a>d <span class="ot">&lt;-</span> m1<span class="sc">-</span>m2</span>
<span id="cb342-5"><a href="hypothesis-tests.html#cb342-5" tabindex="-1"></a>    </span>
<span id="cb342-6"><a href="hypothesis-tests.html#cb342-6" tabindex="-1"></a><span class="co"># Bootstrap Distribution</span></span>
<span id="cb342-7"><a href="hypothesis-tests.html#cb342-7" tabindex="-1"></a>boot_d <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="cf">function</span>(b){</span>
<span id="cb342-8"><a href="hypothesis-tests.html#cb342-8" tabindex="-1"></a>    x1_b <span class="ot">&lt;-</span> <span class="fu">sample</span>(x1, <span class="at">replace=</span>T)</span>
<span id="cb342-9"><a href="hypothesis-tests.html#cb342-9" tabindex="-1"></a>    x2_b <span class="ot">&lt;-</span> <span class="fu">sample</span>(x2, <span class="at">replace=</span>T)</span>
<span id="cb342-10"><a href="hypothesis-tests.html#cb342-10" tabindex="-1"></a>    m1_b <span class="ot">&lt;-</span> <span class="fu">mean</span>(x1_b)</span>
<span id="cb342-11"><a href="hypothesis-tests.html#cb342-11" tabindex="-1"></a>    m2_b <span class="ot">&lt;-</span> <span class="fu">mean</span>(x2_b)</span>
<span id="cb342-12"><a href="hypothesis-tests.html#cb342-12" tabindex="-1"></a>    d_b <span class="ot">&lt;-</span> m1_b <span class="sc">-</span> m2_b</span>
<span id="cb342-13"><a href="hypothesis-tests.html#cb342-13" tabindex="-1"></a>    <span class="fu">return</span>(d_b)</span>
<span id="cb342-14"><a href="hypothesis-tests.html#cb342-14" tabindex="-1"></a>})</span>
<span id="cb342-15"><a href="hypothesis-tests.html#cb342-15" tabindex="-1"></a><span class="fu">hist</span>(boot_d, <span class="at">border=</span><span class="cn">NA</span>, <span class="at">font.main=</span><span class="dv">1</span>,</span>
<span id="cb342-16"><a href="hypothesis-tests.html#cb342-16" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;Difference in Means&#39;</span>)</span>
<span id="cb342-17"><a href="hypothesis-tests.html#cb342-17" tabindex="-1"></a></span>
<span id="cb342-18"><a href="hypothesis-tests.html#cb342-18" tabindex="-1"></a><span class="co"># 2-Sided Test</span></span>
<span id="cb342-19"><a href="hypothesis-tests.html#cb342-19" tabindex="-1"></a>boot_ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_d, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span>
<span id="cb342-20"><a href="hypothesis-tests.html#cb342-20" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>boot_ci, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb342-21"><a href="hypothesis-tests.html#cb342-21" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="hypothesis-tests.html#cb343-1" tabindex="-1"></a><span class="fu">ecdf</span>(boot_d)(<span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Just as with one sample tests, we can standardize <span class="math inline">\(D\)</span> into a <span class="math inline">\(t\)</span> statistic. (In which case we also theoretically know the distribution.) Similarly, we can also compute one or two sided hypothesis tests.</p>
<p><strong>Equal Quantiles or Variances</strong>.</p>
<p>The above procedure generalized from “means” to other statistics like “variances” or “quantiles”.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="hypothesis-tests.html#cb345-1" tabindex="-1"></a><span class="co"># Bootstrap Distribution Function</span></span>
<span id="cb345-2"><a href="hypothesis-tests.html#cb345-2" tabindex="-1"></a>boot_fun <span class="ot">&lt;-</span> <span class="cf">function</span>( fun, <span class="at">B=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, ...){</span>
<span id="cb345-3"><a href="hypothesis-tests.html#cb345-3" tabindex="-1"></a>    boot_d <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>B, <span class="cf">function</span>(b){</span>
<span id="cb345-4"><a href="hypothesis-tests.html#cb345-4" tabindex="-1"></a>        x1_b <span class="ot">&lt;-</span> <span class="fu">sample</span>(x1, <span class="at">replace=</span>T)</span>
<span id="cb345-5"><a href="hypothesis-tests.html#cb345-5" tabindex="-1"></a>        x2_b <span class="ot">&lt;-</span> <span class="fu">sample</span>(x2, <span class="at">replace=</span>T)</span>
<span id="cb345-6"><a href="hypothesis-tests.html#cb345-6" tabindex="-1"></a>        f1_b <span class="ot">&lt;-</span> <span class="fu">fun</span>(x1_b, ...)</span>
<span id="cb345-7"><a href="hypothesis-tests.html#cb345-7" tabindex="-1"></a>        f2_b <span class="ot">&lt;-</span> <span class="fu">fun</span>(x2_b, ...)</span>
<span id="cb345-8"><a href="hypothesis-tests.html#cb345-8" tabindex="-1"></a>        d_b <span class="ot">&lt;-</span> f1_b <span class="sc">-</span> f2_b</span>
<span id="cb345-9"><a href="hypothesis-tests.html#cb345-9" tabindex="-1"></a>        <span class="fu">return</span>(d_b)</span>
<span id="cb345-10"><a href="hypothesis-tests.html#cb345-10" tabindex="-1"></a>    })</span>
<span id="cb345-11"><a href="hypothesis-tests.html#cb345-11" tabindex="-1"></a>    <span class="fu">return</span>(boot_d)</span>
<span id="cb345-12"><a href="hypothesis-tests.html#cb345-12" tabindex="-1"></a>}</span>
<span id="cb345-13"><a href="hypothesis-tests.html#cb345-13" tabindex="-1"></a></span>
<span id="cb345-14"><a href="hypothesis-tests.html#cb345-14" tabindex="-1"></a><span class="co"># 2-Sided Test for Median Differences</span></span>
<span id="cb345-15"><a href="hypothesis-tests.html#cb345-15" tabindex="-1"></a><span class="co"># d &lt;- median(x2) - median(x1)</span></span>
<span id="cb345-16"><a href="hypothesis-tests.html#cb345-16" tabindex="-1"></a>boot_d <span class="ot">&lt;-</span> <span class="fu">boot_fun</span>(median)</span>
<span id="cb345-17"><a href="hypothesis-tests.html#cb345-17" tabindex="-1"></a><span class="fu">hist</span>(boot_d, <span class="at">border=</span><span class="cn">NA</span>, <span class="at">font.main=</span><span class="dv">1</span>,</span>
<span id="cb345-18"><a href="hypothesis-tests.html#cb345-18" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;Difference in Medians&#39;</span>)</span>
<span id="cb345-19"><a href="hypothesis-tests.html#cb345-19" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">quantile</span>(boot_d, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>)), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb345-20"><a href="hypothesis-tests.html#cb345-20" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="hypothesis-tests.html#cb346-1" tabindex="-1"></a><span class="fu">ecdf</span>(boot_d)(<span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0.9995</code></pre>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="hypothesis-tests.html#cb348-1" tabindex="-1"></a><span class="co"># 2-Sided Test for SD Differences</span></span>
<span id="cb348-2"><a href="hypothesis-tests.html#cb348-2" tabindex="-1"></a><span class="co">#d &lt;- sd(x2) - sd(x1)</span></span>
<span id="cb348-3"><a href="hypothesis-tests.html#cb348-3" tabindex="-1"></a>boot_d <span class="ot">&lt;-</span> <span class="fu">boot_fun</span>(sd)</span>
<span id="cb348-4"><a href="hypothesis-tests.html#cb348-4" tabindex="-1"></a><span class="fu">hist</span>(boot_d, <span class="at">border=</span><span class="cn">NA</span>, <span class="at">font.main=</span><span class="dv">1</span>,</span>
<span id="cb348-5"><a href="hypothesis-tests.html#cb348-5" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;Difference in Standard Deviations&#39;</span>)</span>
<span id="cb348-6"><a href="hypothesis-tests.html#cb348-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">quantile</span>(boot_d, <span class="at">probs=</span><span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>)), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb348-7"><a href="hypothesis-tests.html#cb348-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-95-2.png" width="672" /></p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="hypothesis-tests.html#cb349-1" tabindex="-1"></a><span class="fu">ecdf</span>(boot_d)(<span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="hypothesis-tests.html#cb351-1" tabindex="-1"></a><span class="co"># Try any function!</span></span>
<span id="cb351-2"><a href="hypothesis-tests.html#cb351-2" tabindex="-1"></a><span class="co"># boot_fun( function(xs) { IQR(xs)/median(xs) } )</span></span></code></pre></div>
</div>
<div id="distributional-tests" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Distributional Tests<a href="hypothesis-tests.html#distributional-tests" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can also examine whether there are any differences between the entire <em>distributions</em></p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="hypothesis-tests.html#cb352-1" tabindex="-1"></a><span class="co"># Compute Quantiles</span></span>
<span id="cb352-2"><a href="hypothesis-tests.html#cb352-2" tabindex="-1"></a>quants <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">101</span>)</span>
<span id="cb352-3"><a href="hypothesis-tests.html#cb352-3" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x1, <span class="at">probs=</span>quants)</span>
<span id="cb352-4"><a href="hypothesis-tests.html#cb352-4" tabindex="-1"></a>Q2 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x2, <span class="at">probs=</span>quants)</span>
<span id="cb352-5"><a href="hypothesis-tests.html#cb352-5" tabindex="-1"></a></span>
<span id="cb352-6"><a href="hypothesis-tests.html#cb352-6" tabindex="-1"></a><span class="co"># Compare Distributions via Quantiles</span></span>
<span id="cb352-7"><a href="hypothesis-tests.html#cb352-7" tabindex="-1"></a>rx <span class="ot">&lt;-</span> <span class="fu">range</span>(<span class="fu">c</span>(x1, x2))</span>
<span id="cb352-8"><a href="hypothesis-tests.html#cb352-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb352-9"><a href="hypothesis-tests.html#cb352-9" tabindex="-1"></a><span class="fu">plot</span>(rx, <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">type=</span><span class="st">&#39;n&#39;</span>, <span class="at">font.main=</span><span class="dv">1</span>,</span>
<span id="cb352-10"><a href="hypothesis-tests.html#cb352-10" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;Distributional Comparison&#39;</span>,</span>
<span id="cb352-11"><a href="hypothesis-tests.html#cb352-11" tabindex="-1"></a>    <span class="at">xlab=</span><span class="fu">expression</span>(Q[s]),</span>
<span id="cb352-12"><a href="hypothesis-tests.html#cb352-12" tabindex="-1"></a>    <span class="at">ylab=</span><span class="fu">expression</span>(F[s]))</span>
<span id="cb352-13"><a href="hypothesis-tests.html#cb352-13" tabindex="-1"></a><span class="fu">lines</span>(Q1, quants, <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb352-14"><a href="hypothesis-tests.html#cb352-14" tabindex="-1"></a><span class="fu">lines</span>(Q2, quants, <span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb352-15"><a href="hypothesis-tests.html#cb352-15" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">lty=</span><span class="dv">1</span>,</span>
<span id="cb352-16"><a href="hypothesis-tests.html#cb352-16" tabindex="-1"></a><span class="at">legend=</span><span class="fu">c</span>(<span class="st">&#39;F1&#39;</span>, <span class="st">&#39;F2&#39;</span>))</span>
<span id="cb352-17"><a href="hypothesis-tests.html#cb352-17" tabindex="-1"></a></span>
<span id="cb352-18"><a href="hypothesis-tests.html#cb352-18" tabindex="-1"></a><span class="co"># Compare Quantiles</span></span>
<span id="cb352-19"><a href="hypothesis-tests.html#cb352-19" tabindex="-1"></a><span class="fu">plot</span>(Q1, Q2, <span class="at">xlim=</span>rx, <span class="at">ylim=</span>rx,</span>
<span id="cb352-20"><a href="hypothesis-tests.html#cb352-20" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&#39;Quantile-Quantile Plot&#39;</span>, <span class="at">font.main=</span><span class="dv">1</span>,</span>
<span id="cb352-21"><a href="hypothesis-tests.html#cb352-21" tabindex="-1"></a><span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">25</span>))</span>
<span id="cb352-22"><a href="hypothesis-tests.html#cb352-22" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-96-1.png" width="672" /></p>
<p>We can also test for a differences in entire <em>distributions</em>, using all sample data <span class="math inline">\(x \in \{X_1\} \cup \{X_2\}\)</span>.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="hypothesis-tests.html#cb353-1" tabindex="-1"></a><span class="co"># Sorted Sample Data</span></span>
<span id="cb353-2"><a href="hypothesis-tests.html#cb353-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">sort</span>(x1)</span>
<span id="cb353-3"><a href="hypothesis-tests.html#cb353-3" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">sort</span>(x2)</span>
<span id="cb353-4"><a href="hypothesis-tests.html#cb353-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(x1, x2))</span>
<span id="cb353-5"><a href="hypothesis-tests.html#cb353-5" tabindex="-1"></a></span>
<span id="cb353-6"><a href="hypothesis-tests.html#cb353-6" tabindex="-1"></a><span class="co"># Distributions</span></span>
<span id="cb353-7"><a href="hypothesis-tests.html#cb353-7" tabindex="-1"></a>F1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x1)(x)</span>
<span id="cb353-8"><a href="hypothesis-tests.html#cb353-8" tabindex="-1"></a>F2 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x2)(x)</span>
<span id="cb353-9"><a href="hypothesis-tests.html#cb353-9" tabindex="-1"></a></span>
<span id="cb353-10"><a href="hypothesis-tests.html#cb353-10" tabindex="-1"></a><span class="fu">library</span>(twosamples)</span></code></pre></div>
<p>The starting point is the Kolmogorov-Smirnov Statistic: the maximum absolute difference between two CDF’s.
<span class="math display">\[\begin{eqnarray}
KS &amp;=&amp; \max_{x} |F_{1}(x)- F_{2}(x)|^{p}.
\end{eqnarray}\]</span></p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="hypothesis-tests.html#cb354-1" tabindex="-1"></a><span class="co"># Kolmogorov-Smirnov</span></span>
<span id="cb354-2"><a href="hypothesis-tests.html#cb354-2" tabindex="-1"></a>KSq <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">abs</span>(F2 <span class="sc">-</span> F1))</span>
<span id="cb354-3"><a href="hypothesis-tests.html#cb354-3" tabindex="-1"></a>KSqv <span class="ot">&lt;-</span> <span class="fu">round</span>(twosamples<span class="sc">::</span><span class="fu">ks_stat</span>(x1, x2),<span class="dv">2</span>)</span>
<span id="cb354-4"><a href="hypothesis-tests.html#cb354-4" tabindex="-1"></a></span>
<span id="cb354-5"><a href="hypothesis-tests.html#cb354-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">range</span>(x), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">xlab=</span><span class="st">&#39;x&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;ECDF&#39;</span>)</span>
<span id="cb354-6"><a href="hypothesis-tests.html#cb354-6" tabindex="-1"></a><span class="fu">title</span>(<span class="fu">paste0</span>(<span class="st">&#39;KS = &#39;</span>, KSqv), <span class="at">font.main=</span><span class="dv">1</span>)</span>
<span id="cb354-7"><a href="hypothesis-tests.html#cb354-7" tabindex="-1"></a><span class="fu">segments</span>(x[KSq], F1[KSq], x[KSq], F2[KSq], <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">5</span>))</span>
<span id="cb354-8"><a href="hypothesis-tests.html#cb354-8" tabindex="-1"></a><span class="fu">lines</span>(x, F1, <span class="at">col=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb354-9"><a href="hypothesis-tests.html#cb354-9" tabindex="-1"></a><span class="fu">lines</span>(x, F2, <span class="at">col=</span><span class="dv">4</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb354-10"><a href="hypothesis-tests.html#cb354-10" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;bottomright&#39;</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">lty=</span><span class="dv">1</span>,</span>
<span id="cb354-11"><a href="hypothesis-tests.html#cb354-11" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(<span class="fu">expression</span>(F[<span class="dv">1</span>]), <span class="fu">expression</span>(F[<span class="dv">2</span>])))</span></code></pre></div>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
<p>An intuitive alternative is the Cramer-von Mises Statistic: the sum of absolute distances (raised to a power) between two CDF’s.
<span class="math display">\[\begin{eqnarray}
CVM=\sum_{x} |F_{1}(x)- F_{2}(x)|^{p}.
\end{eqnarray}\]</span></p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="hypothesis-tests.html#cb355-1" tabindex="-1"></a><span class="co"># Cramer-von Mises Statistic (p=2)</span></span>
<span id="cb355-2"><a href="hypothesis-tests.html#cb355-2" tabindex="-1"></a>CVMqv <span class="ot">&lt;-</span> <span class="fu">round</span>(twosamples<span class="sc">::</span><span class="fu">cvm_stat</span>(x1, x2, <span class="at">power=</span><span class="dv">2</span>), <span class="dv">2</span>) </span>
<span id="cb355-3"><a href="hypothesis-tests.html#cb355-3" tabindex="-1"></a></span>
<span id="cb355-4"><a href="hypothesis-tests.html#cb355-4" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">range</span>(x), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">xlab=</span><span class="st">&#39;x&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;ECDF&#39;</span>)</span>
<span id="cb355-5"><a href="hypothesis-tests.html#cb355-5" tabindex="-1"></a><span class="fu">segments</span>(x, F1, x, F2, <span class="at">lwd=</span>.<span class="dv">5</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="dv">0</span>,.<span class="dv">1</span>))</span>
<span id="cb355-6"><a href="hypothesis-tests.html#cb355-6" tabindex="-1"></a><span class="fu">lines</span>(x, F1, <span class="at">col=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb355-7"><a href="hypothesis-tests.html#cb355-7" tabindex="-1"></a><span class="fu">lines</span>(x, F2, <span class="at">col=</span><span class="dv">4</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb355-8"><a href="hypothesis-tests.html#cb355-8" tabindex="-1"></a><span class="fu">title</span>(<span class="fu">paste0</span>(<span class="st">&#39;CVM = &#39;</span>,CVMqv), <span class="at">font.main=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="02-BasicStats_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<p>Just as before, you use bootstrapping for hypothesis testing.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="hypothesis-tests.html#cb356-1" tabindex="-1"></a>twosamples<span class="sc">::</span><span class="fu">cvm_test</span>(x1, x2)</span></code></pre></div>
<pre><code>## Test Stat   P-Value 
##  11.30520   0.00025</code></pre>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>Note that the p-value is not the ``probability that we reject the null based on the data we have and given the null is true’’. This is called the statistical power of the test.<a href="hypothesis-tests.html#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="resampling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["index.pdf", "index.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
