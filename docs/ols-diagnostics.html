<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 8 OLS Diagnostics | index</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content=" 8 OLS Diagnostics | index" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 8 OLS Diagnostics | index" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ordinary-least-squares.html"/>
<link rel="next" href="ols-and-endogeneity.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="libs/d3-3.5.6/d3.min.js"></script>
<link href="libs/profvis-0.3.6.9000/profvis.css" rel="stylesheet" />
<script src="libs/profvis-0.3.6.9000/profvis.js"></script>
<script src="libs/profvis-0.3.6.9000/scroll.js"></script>
<link href="libs/highlight-6.2.0/textmate.css" rel="stylesheet" />
<script src="libs/highlight-6.2.0/highlight.js"></script>
<script src="libs/profvis-binding-0.3.8/profvis.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Primers</a></li>
<li class="toc-logo"><a href="./"><img src="Figures_Manual/Logo.png" width="140" height="100"></a></li>        

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="part"><span><b>I Programming in R</b></span></li>
<li class="chapter" data-level="2" data-path="first-steps.html"><a href="first-steps.html"><i class="fa fa-check"></i><b>2</b> First Steps</a>
<ul>
<li class="chapter" data-level="2.1" data-path="first-steps.html"><a href="first-steps.html#why-r"><i class="fa fa-check"></i><b>2.1</b> Why R</a></li>
<li class="chapter" data-level="2.2" data-path="first-steps.html"><a href="first-steps.html#install-r"><i class="fa fa-check"></i><b>2.2</b> Install R</a></li>
<li class="chapter" data-level="2.3" data-path="first-steps.html"><a href="first-steps.html#interfacing-with-r"><i class="fa fa-check"></i><b>2.3</b> Interfacing with R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mathematics.html"><a href="mathematics.html"><i class="fa fa-check"></i><b>3</b> Mathematics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mathematics.html"><a href="mathematics.html#scalars"><i class="fa fa-check"></i><b>3.1</b> Scalars</a></li>
<li class="chapter" data-level="3.2" data-path="mathematics.html"><a href="mathematics.html#vectors"><i class="fa fa-check"></i><b>3.2</b> Vectors</a></li>
<li class="chapter" data-level="3.3" data-path="mathematics.html"><a href="mathematics.html#functions"><i class="fa fa-check"></i><b>3.3</b> Functions</a></li>
<li class="chapter" data-level="3.4" data-path="mathematics.html"><a href="mathematics.html#matrices"><i class="fa fa-check"></i><b>3.4</b> Matrices</a></li>
<li class="chapter" data-level="3.5" data-path="mathematics.html"><a href="mathematics.html#arrays"><i class="fa fa-check"></i><b>3.5</b> Arrays</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>4</b> Statistics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="statistics.html"><a href="statistics.html#random-variables"><i class="fa fa-check"></i><b>4.1</b> Random Variables</a></li>
<li class="chapter" data-level="4.2" data-path="statistics.html"><a href="statistics.html#functions-of-data"><i class="fa fa-check"></i><b>4.2</b> Functions of Data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>5</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-analysis.html"><a href="data-analysis.html#data"><i class="fa fa-check"></i><b>5.1</b> Data</a></li>
<li class="chapter" data-level="5.2" data-path="data-analysis.html"><a href="data-analysis.html#plots"><i class="fa fa-check"></i><b>5.2</b> Plots</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="data-analysis.html"><a href="data-analysis.html#histograms"><i class="fa fa-check"></i><b>5.2.1</b> Histograms</a></li>
<li class="chapter" data-level="5.2.2" data-path="data-analysis.html"><a href="data-analysis.html#boxplots"><i class="fa fa-check"></i><b>5.2.2</b> Boxplots</a></li>
<li class="chapter" data-level="5.2.3" data-path="data-analysis.html"><a href="data-analysis.html#scatterplots"><i class="fa fa-check"></i><b>5.2.3</b> Scatterplots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="beyond-basics.html"><a href="beyond-basics.html"><i class="fa fa-check"></i><b>6</b> Beyond Basics</a>
<ul>
<li class="chapter" data-level="6.1" data-path="beyond-basics.html"><a href="beyond-basics.html#introductions-to-r"><i class="fa fa-check"></i><b>6.1</b> Introductions to R</a></li>
<li class="chapter" data-level="6.2" data-path="beyond-basics.html"><a href="beyond-basics.html#the-r-ecosystem"><i class="fa fa-check"></i><b>6.2</b> The R Ecosystem</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="beyond-basics.html"><a href="beyond-basics.html#packages"><i class="fa fa-check"></i><b>6.2.1</b> Packages</a></li>
<li class="chapter" data-level="6.2.2" data-path="beyond-basics.html"><a href="beyond-basics.html#task-views"><i class="fa fa-check"></i><b>6.2.2</b> Task Views</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="beyond-basics.html"><a href="beyond-basics.html#custom-figures"><i class="fa fa-check"></i><b>6.3</b> Custom figures</a></li>
</ul></li>
<li class="part"><span><b>II Linear Regression in R</b></span></li>
<li class="chapter" data-level="7" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html"><i class="fa fa-check"></i><b>7</b> Ordinary Least Squares</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#simple-ols-linear-regression"><i class="fa fa-check"></i><b>7.1</b> Simple OLS (linear regression)</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#variability-estimates"><i class="fa fa-check"></i><b>7.1.1</b> Variability Estimates</a></li>
<li class="chapter" data-level="7.1.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#hypothesis-tests"><i class="fa fa-check"></i><b>7.1.2</b> Hypothesis Tests</a></li>
<li class="chapter" data-level="7.1.3" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#prediction-intervals"><i class="fa fa-check"></i><b>7.1.3</b> Prediction Intervals</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#ols-multiple-linear-regression"><i class="fa fa-check"></i><b>7.2</b> OLS (multiple linear regression)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#variability-estimates-and-hypothesis-tests"><i class="fa fa-check"></i><b>7.2.1</b> Variability Estimates and Hypothesis Tests</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#coefficient-interpretation"><i class="fa fa-check"></i><b>7.3</b> Coefficient Interpretation</a></li>
<li class="chapter" data-level="7.4" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#factor-variables"><i class="fa fa-check"></i><b>7.4</b> Factor Variables</a></li>
<li class="chapter" data-level="7.5" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#more-literature"><i class="fa fa-check"></i><b>7.5</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html"><i class="fa fa-check"></i><b>8</b> OLS Diagnostics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#outliers"><i class="fa fa-check"></i><b>8.1</b> Outliers</a></li>
<li class="chapter" data-level="8.2" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#normality"><i class="fa fa-check"></i><b>8.2</b> Normality</a></li>
<li class="chapter" data-level="8.3" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#collinearity"><i class="fa fa-check"></i><b>8.3</b> Collinearity</a></li>
<li class="chapter" data-level="8.4" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#linear-in-parameters"><i class="fa fa-check"></i><b>8.4</b> Linear in Parameters</a></li>
<li class="chapter" data-level="8.5" data-path="ols-diagnostics.html"><a href="ols-diagnostics.html#more-literature-1"><i class="fa fa-check"></i><b>8.5</b> More Literature</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html"><i class="fa fa-check"></i><b>9</b> OLS and Endogeneity</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html#two-stage-least-squares-2sls"><i class="fa fa-check"></i><b>9.1</b> Two Stage Least Squares (2SLS)</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html#competitive-market-equilibrium"><i class="fa fa-check"></i><b>9.1.1</b> Competitive Market Equilibrium</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html#regression-discontinuitieskink-rdrk"><i class="fa fa-check"></i><b>9.2</b> Regression Discontinuities/Kink (RD/RK)</a></li>
<li class="chapter" data-level="9.3" data-path="ols-and-endogeneity.html"><a href="ols-and-endogeneity.html#difference-in-differences-did"><i class="fa fa-check"></i><b>9.3</b> Difference in Differences (DID)</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-scientism.html"><a href="data-scientism.html"><i class="fa fa-check"></i><b>10</b> Data Scientism</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-scientism.html"><a href="data-scientism.html#ols-in-the-age-of-big-data"><i class="fa fa-check"></i><b>10.1</b> OLS in the age of big data</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="data-scientism.html"><a href="data-scientism.html#us-govt-spending-on-science"><i class="fa fa-check"></i><b>10.1.1</b> US Gov’t Spending on Science</a></li>
<li class="chapter" data-level="10.1.2" data-path="data-scientism.html"><a href="data-scientism.html#false-positives-arise-from-errors"><i class="fa fa-check"></i><b>10.1.2</b> False Positives arise from errors</a></li>
<li class="chapter" data-level="10.1.3" data-path="data-scientism.html"><a href="data-scientism.html#false-positives-arise-from-regression-machines"><i class="fa fa-check"></i><b>10.1.3</b> False Positives arise from Regression Machines</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="data-scientism.html"><a href="data-scientism.html#causal-effects-sans-theory"><i class="fa fa-check"></i><b>10.2</b> Causal effects <em>sans theory</em></a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="data-scientism.html"><a href="data-scientism.html#rdd"><i class="fa fa-check"></i><b>10.2.1</b> RDD</a></li>
<li class="chapter" data-level="10.2.2" data-path="data-scientism.html"><a href="data-scientism.html#did"><i class="fa fa-check"></i><b>10.2.2</b> DID</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Reproducible Research in R</b></span></li>
<li class="chapter" data-level="11" data-path="why.html"><a href="why.html"><i class="fa fa-check"></i><b>11</b> Why?</a>
<ul>
<li class="chapter" data-level="11.1" data-path="why.html"><a href="why.html#an-example-workflow"><i class="fa fa-check"></i><b>11.1</b> An example workflow</a></li>
<li class="chapter" data-level="11.2" data-path="why.html"><a href="why.html#an-alternative-workflow"><i class="fa fa-check"></i><b>11.2</b> An alternative workflow</a></li>
<li class="chapter" data-level="11.3" data-path="why.html"><a href="why.html#r-and-r-markdown"><i class="fa fa-check"></i><b>11.3</b> R and R-Markdown</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="small-projects.html"><a href="small-projects.html"><i class="fa fa-check"></i><b>12</b> Small Projects</a>
<ul>
<li class="chapter" data-level="12.1" data-path="small-projects.html"><a href="small-projects.html#an-r-code-chunk"><i class="fa fa-check"></i><b>12.1</b> An R Code Chunk</a></li>
<li class="chapter" data-level="12.2" data-path="small-projects.html"><a href="small-projects.html#an-r-markdown-document"><i class="fa fa-check"></i><b>12.2</b> An R Markdown Document</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="small-projects.html"><a href="small-projects.html#copypaste-example"><i class="fa fa-check"></i><b>12.2.1</b> Copy/Paste Example</a></li>
<li class="chapter" data-level="12.2.2" data-path="small-projects.html"><a href="small-projects.html#a-homework-example"><i class="fa fa-check"></i><b>12.2.2</b> A Homework Example</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="small-projects.html"><a href="small-projects.html#posters-and-slides"><i class="fa fa-check"></i><b>12.3</b> Posters and Slides</a></li>
<li class="chapter" data-level="12.4" data-path="small-projects.html"><a href="small-projects.html#getting-help-w-r-markdown"><i class="fa fa-check"></i><b>12.4</b> Getting help w/ R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="large-projects.html"><a href="large-projects.html"><i class="fa fa-check"></i><b>13</b> Large Projects</a>
<ul>
<li class="chapter" data-level="13.1" data-path="large-projects.html"><a href="large-projects.html#makefile"><i class="fa fa-check"></i><b>13.1</b> MAKEFILE</a></li>
<li class="chapter" data-level="13.2" data-path="large-projects.html"><a href="large-projects.html#loggingsinking"><i class="fa fa-check"></i><b>13.2</b> Logging/Sinking</a></li>
<li class="chapter" data-level="13.3" data-path="large-projects.html"><a href="large-projects.html#class-projects"><i class="fa fa-check"></i><b>13.3</b> Class Projects</a></li>
<li class="chapter" data-level="13.4" data-path="large-projects.html"><a href="large-projects.html#debugging"><i class="fa fa-check"></i><b>13.4</b> Debugging</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="large-projects.html"><a href="large-projects.html#tracing-errors"><i class="fa fa-check"></i><b>13.4.1</b> Tracing Errors</a></li>
<li class="chapter" data-level="13.4.2" data-path="large-projects.html"><a href="large-projects.html#checking-problems"><i class="fa fa-check"></i><b>13.4.2</b> Checking problems</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="large-projects.html"><a href="large-projects.html#being-proactive"><i class="fa fa-check"></i><b>13.5</b> Being Proactive</a></li>
<li class="chapter" data-level="13.6" data-path="large-projects.html"><a href="large-projects.html#optimizing"><i class="fa fa-check"></i><b>13.6</b> Optimizing</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="large-projects.html"><a href="large-projects.html#benchmarking"><i class="fa fa-check"></i><b>13.6.1</b> Benchmarking</a></li>
<li class="chapter" data-level="13.6.2" data-path="large-projects.html"><a href="large-projects.html#bottlenecks"><i class="fa fa-check"></i><b>13.6.2</b> Bottlenecks</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="large-projects.html"><a href="large-projects.html#advanced-programming"><i class="fa fa-check"></i><b>13.7</b> Advanced Programming</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>14</b> Shiny</a>
<ul>
<li class="chapter" data-level="14.0.1" data-path="shiny.html"><a href="shiny.html#programming-guidance"><i class="fa fa-check"></i><b>14.0.1</b> Programming Guidance</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i><b>15</b> Software</a>
<ul>
<li class="chapter" data-level="15.1" data-path="software.html"><a href="software.html#latest-versions"><i class="fa fa-check"></i><b>15.1</b> Latest versions</a></li>
<li class="chapter" data-level="15.2" data-path="software.html"><a href="software.html#stata"><i class="fa fa-check"></i><b>15.2</b> Stata</a></li>
<li class="chapter" data-level="15.3" data-path="software.html"><a href="software.html#general-workflow"><i class="fa fa-check"></i><b>15.3</b> General Workflow</a></li>
<li class="chapter" data-level="15.4" data-path="software.html"><a href="software.html#sweave"><i class="fa fa-check"></i><b>15.4</b> Sweave</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://sites.google.com/view/jordan-adamson" target="blank">Jordan Adamson</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ols-diagnostics" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number"> 8</span> OLS Diagnostics<a href="ols-diagnostics.html#ols-diagnostics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<hr />
<p>There’s little sense in getting great standard errors for a bad model. Plotting your regression object a simple and easy step to help diagnose whether your model is in some way bad.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="ols-diagnostics.html#cb234-1" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder<span class="sc">~</span>Assault<span class="sc">+</span>UrbanPop, <span class="at">data=</span>USArrests)</span>
<span id="cb234-2"><a href="ols-diagnostics.html#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb234-3"><a href="ols-diagnostics.html#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-25-1.png" width="672" />
We now go through what these figures show, and then some additional</p>
<div id="outliers" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Outliers<a href="ols-diagnostics.html#outliers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first plot examines outlier <span class="math inline">\(Y\)</span> and <span class="math inline">\(\hat{Y}\)</span>.</p>
<blockquote>
<p>``In our <span class="math inline">\(y_i = a + b x_i + e_i\)</span> regression, the residuals are, of course, <span class="math inline">\(e_i\)</span> – they reveal how much our fitted value <span class="math inline">\(\hat{y}_i = a + b x_i\)</span> differs from the observed <span class="math inline">\(y_i\)</span>. A point <span class="math inline">\((x_i ,y_i)\)</span> with a corresponding large residual is called an <em>outlier</em>. Say that you are interested in outliers because you somehow think that such points will exert undue <em>influence</em> on your estimates. Your feelings are generally right, but there are exceptions. A point might have a huge residual and yet not affect the estimated <span class="math inline">\(b\)</span> at all’’
Stata Press (2015) Base Reference Manual, Release 14, p. 2138.</p>
</blockquote>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="ols-diagnostics.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(reg), <span class="fu">resid</span>(reg),<span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb235-2"><a href="ols-diagnostics.html#cb235-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Fitted&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Residual&quot;</span>,</span>
<span id="cb235-3"><a href="ols-diagnostics.html#cb235-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Fitted versus Residuals&quot;</span>)</span>
<span id="cb235-4"><a href="ols-diagnostics.html#cb235-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="ols-diagnostics.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># car::outlierTest(reg)</span></span></code></pre></div>
<p>The third plot examines outlier <span class="math inline">\(X\)</span> via ``leverage’’</p>
<blockquote>
<p>“<span class="math inline">\((x_i ,y_i)\)</span> can be an outlier in another way – just as <span class="math inline">\(y_i\)</span> can be far from <span class="math inline">\(\hat{y}_i\)</span>, <span class="math inline">\(x_i\)</span> can be far from the center of mass of the other <span class="math inline">\(x\)</span>’s. Such an `outlier’ should interest you just as much as the more traditional outliers. Picture a scatterplot of <span class="math inline">\(y\)</span> against <span class="math inline">\(x\)</span> with thousands of points in some sort of mass at the lower left of the graph and one point at the upper right of the graph. Now run a regression line through the points—the regression line will come close to the point at the upper right of the graph and may in fact, go through it. That is, this isolated point will not appear as an outlier as measured by residuals because its residual will be small. Yet this point might have a dramatic effect on our resulting estimates in the sense that, were you to delete the point, the estimates would change markedly. Such a point is said to have high <em>leverage</em>’’
Stata Press (2015) Base Reference Manual, Release 14, pp. 2138-39.</p>
</blockquote>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="ols-diagnostics.html#cb237-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb237-2"><a href="ols-diagnostics.html#cb237-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="fu">runif</span>(N<span class="dv">-1</span>,<span class="dv">3</span>,<span class="dv">8</span>))</span>
<span id="cb237-3"><a href="ols-diagnostics.html#cb237-3" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="fl">0.4</span>)</span>
<span id="cb237-4"><a href="ols-diagnostics.html#cb237-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">+</span> <span class="fl">0.6</span><span class="sc">*</span><span class="fu">sqrt</span>(x) <span class="sc">+</span> e</span>
<span id="cb237-5"><a href="ols-diagnostics.html#cb237-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">grey</span>(.<span class="dv">5</span>,.<span class="dv">5</span>))</span>
<span id="cb237-6"><a href="ols-diagnostics.html#cb237-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x[<span class="dv">1</span>],y[<span class="dv">1</span>], <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>))</span>
<span id="cb237-7"><a href="ols-diagnostics.html#cb237-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-8"><a href="ols-diagnostics.html#cb237-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x), <span class="at">col=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb237-9"><a href="ols-diagnostics.html#cb237-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y[<span class="sc">-</span><span class="dv">1</span>]<span class="sc">~</span>x[<span class="sc">-</span><span class="dv">1</span>]))</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>See <a href="https://www.r-bloggers.com/2016/06/leverage-and-influence-in-a-nutshell/" class="uri">https://www.r-bloggers.com/2016/06/leverage-and-influence-in-a-nutshell/</a> for a good interactive explaination.</p>
<p>Leverage Vector: Distance within explanatory variables
<span class="math display">\[
H = [h_{1}, h_{2}, ...., h_{N}]
\]</span>
<span class="math inline">\(h_i\)</span> is the leverage of residual <span class="math inline">\(\hat{\epsilon_i}\)</span>.</p>
<p>Studentized residuals
<span class="math display">\[
r_i=\frac{\hat{\epsilon}_i}{s_{[i]}\sqrt{1-h_i}}
\]</span>
and <span class="math inline">\(s_{(i)}\)</span> the root mean squared error of a regression with the <span class="math inline">\(i\)</span>th observation removed.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="ols-diagnostics.html#cb238-1" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb238-2"><a href="ols-diagnostics.html#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which.max</span>(<span class="fu">hatvalues</span>(reg))</span></code></pre></div>
<pre><code>## 1 
## 1</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="ols-diagnostics.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which.max</span>(<span class="fu">rstandard</span>(reg))</span></code></pre></div>
<pre><code>## 5 
## 5</code></pre>
<p>The fourth plot further assesses outlier <span class="math inline">\(X\)</span> using “Cook’s Distance”. Cook’s Distance is defined as the sum of all the changes in the regression model when observation i is removed from.
<span class="math display">\[
D_{i} = \frac{\sum_{j} \left( \hat{y_j} - \hat{y_j}_{[i]} \right)^2 }{ p s^2 }
= \frac{[e_{i}]^2}{p s^2 } \frac{h_i}{(1-h_i)^2}\\
s^2 = \frac{\sum_{i} (e_{i})^2 }{n-K}
\]</span></p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="ols-diagnostics.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which.max</span>(<span class="fu">cooks.distance</span>(reg))</span></code></pre></div>
<pre><code>## 1 
## 1</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="ols-diagnostics.html#cb244-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">influencePlot</span>(reg)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<pre><code>##       StudRes        Hat      CookD
## 1  -0.3626401 0.82668111 0.32096292
## 4   2.1657617 0.02595004 0.05695009
## 5   2.3647830 0.03562233 0.09214702
## 32 -0.9627519 0.04243545 0.02057766</code></pre>
<p>Note that we can also calculate <span class="math inline">\(H\)</span> directly from our OLS projection matrix <span class="math inline">\(\hat{P}\)</span>, since <span class="math inline">\(H=diag(\hat{P})\)</span> and
<span class="math display">\[
\hat{P}=X(X&#39;X)^{-1}X&#39;\\
\hat{\epsilon}=y-X\hat{\beta}=y-X(X&#39;X)^{-1}X&#39;y=y-\hat{P}y\\
\hat{P}y=X(X&#39;X)^{-1}X&#39;y=y-(y-X(X&#39;X)^{-1}X&#39;y)=y-\hat{\epsilon}=\hat{y}\\
\]</span></p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="ols-diagnostics.html#cb246-1" aria-hidden="true" tabindex="-1"></a>Ehat <span class="ot">&lt;-</span> Y <span class="sc">-</span> X<span class="sc">%*%</span> Bhat</span>
<span id="cb246-2"><a href="ols-diagnostics.html#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Ehat</span></span>
<span id="cb246-3"><a href="ols-diagnostics.html#cb246-3" aria-hidden="true" tabindex="-1"></a><span class="do">## resid(reg)</span></span>
<span id="cb246-4"><a href="ols-diagnostics.html#cb246-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-5"><a href="ols-diagnostics.html#cb246-5" aria-hidden="true" tabindex="-1"></a>Pmat <span class="ot">&lt;-</span> X<span class="sc">%*%</span>XtXi<span class="sc">%*%</span><span class="fu">t</span>(X)</span>
<span id="cb246-6"><a href="ols-diagnostics.html#cb246-6" aria-hidden="true" tabindex="-1"></a>Yhat <span class="ot">&lt;-</span> Pmat<span class="sc">%*%</span>Y</span>
<span id="cb246-7"><a href="ols-diagnostics.html#cb246-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Yhat</span></span>
<span id="cb246-8"><a href="ols-diagnostics.html#cb246-8" aria-hidden="true" tabindex="-1"></a><span class="do">## predict(reg)</span></span></code></pre></div>
<p>There are many other diagnostics (which can often be written in terms of Cooks Distance or Vice Versa).</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="ols-diagnostics.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sall, J. (1990) Leverage plots for general linear hypotheses. American Statistician *44*, 308-315.</span></span>
<span id="cb247-2"><a href="ols-diagnostics.html#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="co"># car::leveragePlots(reg)</span></span></code></pre></div>
<p>(Welsch and Kuh. 1977; Belsley, Kuh, and Welsch. 1980) attempt to summarize the information in the leverage versus residual-squared plot into one DFITS statistic where <span class="math inline">\(DFITS &gt; 2\sqrt{{k}/{n}}\)</span> should be examined.
<span class="math display">\[
\text{DFITS}_i=r_i\sqrt{\frac{h_i}{1-h_i}}\\
\]</span></p>
<p>See also “dfbetas” and “covratio”</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="ols-diagnostics.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dfbetas(reg)</span></span>
<span id="cb248-2"><a href="ols-diagnostics.html#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dffits(reg)</span></span>
<span id="cb248-3"><a href="ols-diagnostics.html#cb248-3" aria-hidden="true" tabindex="-1"></a><span class="co">#covratio(reg)</span></span>
<span id="cb248-4"><a href="ols-diagnostics.html#cb248-4" aria-hidden="true" tabindex="-1"></a><span class="co">#hatvalues(reg)</span></span>
<span id="cb248-5"><a href="ols-diagnostics.html#cb248-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">influence.measures</span>(reg)<span class="sc">$</span>infmat)</span></code></pre></div>
<pre><code>##          dfb.1_       dfb.x       dffit     cov.r      cook.d        hat
## 1  0.6092623245 -0.77992661 -0.79199406 6.0427706 0.320962917 0.82668111
## 2 -0.0002090314 -0.03650165 -0.07404746 1.0814037 0.002803444 0.03302506
## 3 -0.1662379408  0.07227492 -0.22098386 0.9921467 0.023978025 0.02799452
## 4  0.2306440685 -0.06763802  0.35349972 0.8529258 0.056950087 0.02595004
## 5  0.4042140646 -0.24818615  0.45449475 0.8253914 0.092147016 0.03562233
## 6  0.0553334807 -0.00979343  0.09502751 1.0620366 0.004593894 0.02526838</code></pre>
</div>
<div id="normality" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Normality<a href="ols-diagnostics.html#normality" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The second plot examines whether the residuals are normally distributed. OLS point estimates do not depend on the normality of the residuals. (Good thing, because there’s no reason the residuals of economic phenomena should be so well behaved.) Many hypothesis tests of the regression estimates are, however, affected by the distribution of the residuals. For these reasons, you may be interested in assessing normality</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="ols-diagnostics.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb250-2"><a href="ols-diagnostics.html#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">resid</span>(reg), <span class="at">main=</span><span class="st">&#39;Histogram of Residuals&#39;</span>)</span>
<span id="cb250-3"><a href="ols-diagnostics.html#cb250-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-4"><a href="ols-diagnostics.html#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(reg), <span class="at">main=</span><span class="st">&quot;Normal Q-Q Plot of Residuals&quot;</span>, <span class="at">col=</span><span class="st">&quot;darkgrey&quot;</span>)</span>
<span id="cb250-5"><a href="ols-diagnostics.html#cb250-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(reg), <span class="at">col=</span><span class="st">&quot;dodgerblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="ols-diagnostics.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(reg))</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  resid(reg)
## W = 0.96892, p-value = 0.3325</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="ols-diagnostics.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="co"># car::qqPlot(reg)</span></span></code></pre></div>
<p>Heterskedasticity may also matters for variance estimates. This is not shown in the plot, but you can run a simple test</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="ols-diagnostics.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code></pre></div>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="ols-diagnostics.html#cb258-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">bptest</span>(reg)</span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  reg
## BP = 0.56132, df = 1, p-value = 0.4537</code></pre>
</div>
<div id="collinearity" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Collinearity<a href="ols-diagnostics.html#collinearity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This is when one explanatory variable in a multiple linear regression model can be linearly predicted from the others with a substantial degree of accuracy. Coefficient estimates may change erratically in response to small changes in the model or the data. (In the extreme case where there are more variables than observations <span class="math inline">\(K&gt;\geq N\)</span>, <span class="math inline">\(X&#39;X\)</span> has an infinite number of solutions and is not invertible.)</p>
<p>To diagnose this, we can use the Variance Inflation Factor
<span class="math display">\[
VIF_{k}=\frac{1}{1-R^2_k},
\]</span>
where <span class="math inline">\(R^2_k\)</span> is the <span class="math inline">\(R^2\)</span> for the regression of <span class="math inline">\(X_k\)</span> on the other covariates <span class="math inline">\(X_{-k}\)</span> (a regression that does not involve the response variable Y)</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="ols-diagnostics.html#cb260-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(reg) </span>
<span id="cb260-2"><a href="ols-diagnostics.html#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(car<span class="sc">::</span><span class="fu">vif</span>(reg)) <span class="sc">&gt;</span> <span class="dv">2</span> <span class="co"># problem?</span></span></code></pre></div>
</div>
<div id="linear-in-parameters" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Linear in Parameters<a href="ols-diagnostics.html#linear-in-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data transformations can often improve model fit and still be estimated via OLS. This is because OLS only requires the model to be linear in the parameters. Under the assumptions of the model is correctly specified, the following table is how we can interpret the coefficients of the transformed data. (Note for small changes, <span class="math inline">\(\Delta ln(x) \approx \Delta x / x = \Delta x \% \cdot 100\)</span>.)</p>
<table>
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th><em>Specification</em></th>
<th><em>Regressand</em></th>
<th><em>Regressor</em></th>
<th><em>Derivative</em></th>
<th><em>Interpretation (If True)</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear–linear</td>
<td><span class="math inline">\(y\)</span></td>
<td><span class="math inline">\(x\)</span></td>
<td><span class="math inline">\(\Delta y = \beta_1\cdot\Delta x\)</span></td>
<td>Change <span class="math inline">\(x\)</span> by one unit <span class="math inline">\(\rightarrow\)</span> change <span class="math inline">\(y\)</span> by <span class="math inline">\(\beta_1\)</span> units.</td>
</tr>
<tr class="even">
<td>log–linear</td>
<td><span class="math inline">\(ln(y)\)</span></td>
<td><span class="math inline">\(x\)</span></td>
<td><span class="math inline">\(\Delta y \% \cdot 100 \approx \beta_1 \cdot \Delta x\)</span></td>
<td>Change <span class="math inline">\(x\)</span> by one unit <span class="math inline">\(\rightarrow\)</span> change <span class="math inline">\(y\)</span> by <span class="math inline">\(100 \cdot \beta_1\)</span> percent.</td>
</tr>
<tr class="odd">
<td>linear–log</td>
<td><span class="math inline">\(y\)</span></td>
<td><span class="math inline">\(ln(x)\)</span></td>
<td><span class="math inline">\(\Delta y \approx \frac{\beta_1}{100}\cdot \Delta x \%\)</span></td>
<td>Change <span class="math inline">\(x\)</span> by one percent <span class="math inline">\(\rightarrow\)</span> change <span class="math inline">\(y\)</span> by <span class="math inline">\(\frac{\beta_1}{100}\)</span> units</td>
</tr>
<tr class="even">
<td>log–log</td>
<td><span class="math inline">\(ln(y)\)</span></td>
<td><span class="math inline">\(ln(x)\)</span></td>
<td><span class="math inline">\(\Delta y \% \approx \beta_1\cdot \Delta x \%\)</span></td>
<td>Change <span class="math inline">\(x\)</span> by one percent <span class="math inline">\(\rightarrow\)</span> change <span class="math inline">\(y\)</span> by <span class="math inline">\(\beta_1\)</span> percent</td>
</tr>
</tbody>
</table>
<p>Now recall from micro theory that an additively seperable and linear production function is referred to as ``perfect substitutes’‘. With a linear model and untranformed data, you have implicitly modelled the different regressors <span class="math inline">\(X\)</span> as perfect substitutes. Further recall that the’‘perfect substitutes’’ model is a special case of the constant elasticity of substitution production function. Here, we will build on <a href="http://dx.doi.org/10.2139/ssrn.3917397" class="uri">http://dx.doi.org/10.2139/ssrn.3917397</a>, and consider box-cox transforming both <span class="math inline">\(X\)</span> and <span class="math inline">\(y\)</span>. Specifically, apply the box-cox transform of <span class="math inline">\(y\)</span> using parameter <span class="math inline">\(\lambda\)</span> and apply another box-cox transform to each <span class="math inline">\(x\)</span> using the same parameter <span class="math inline">\(\rho\)</span> so that
<span class="math display">\[
y^{(\lambda)}_{i} = \sum_{k}\beta_{k} x^{(\rho)}_{k,i} + \epsilon_{i}\\
y^{(\lambda)}_{i} =
\begin{cases}
\lambda^{-1}[ (y_i+1)^{\lambda}- 1] &amp; \lambda \neq 0 \\
log(y_i+1) &amp;  \lambda=0
\end{cases}.\\
x^{(\rho)}_{i} =
\begin{cases}
\rho^{-1}[ (x_i)^{\rho}- 1] &amp; \rho \neq 0 \\
log(x_{i}+1) &amp;  \rho=0
\end{cases}.
\]</span></p>
<p>Notice that this nests:</p>
<ul>
<li>linear-linear <span class="math inline">\((\rho=\lambda=1)\)</span>.</li>
<li>linear-log <span class="math inline">\((\rho=1, \lambda=0)\)</span>.</li>
<li>log-linear <span class="math inline">\((\rho=0, \lambda=1)\)</span>.</li>
<li>log-log <span class="math inline">\((\rho=\lambda=0)\)</span>.</li>
</ul>
<p>If <span class="math inline">\(\rho=\lambda\)</span>, we get the CES production function. This nests the ‘’perfect substitutes’’ linear-linear model (<span class="math inline">\(\rho=\lambda=1\)</span>) , the ‘’cobb-douglas’’ log-log model (<span class="math inline">\(\rho=\lambda=0\)</span>), and many others. We can define <span class="math inline">\(\lambda=\rho/\lambda&#39;\)</span> to be clear that this is indeed a CES-type transformation where</p>
<ul>
<li><span class="math inline">\(\rho \in (-\infty,1]\)</span> controls the “substitutability” of explanatory variables. E.g., <span class="math inline">\(\rho &lt;0\)</span> is ‘’complementary’’.</li>
<li><span class="math inline">\(\lambda\)</span> determines ‘’returns to scale’‘. E.g., <span class="math inline">\(\lambda&lt;1\)</span> is’‘decreasing returns’’.</li>
</ul>
<p>We compute the mean squared error in the original scale by inverting the predictions;
<span class="math display">\[
\widehat{y}_{i} =
\begin{cases}
[ \widehat{y^{(\lambda)}}_{i} \cdot \lambda ]^{1/\lambda} -1 &amp; \lambda  \neq 0 \\
exp( \widehat{y^{(\lambda)}}_{i}) -1 &amp;  \lambda=0
\end{cases}.
\]</span></p>
<p>It is easiest to optimize parameters in a 2-step procedure called `concentrated optimization’. We first solve for <span class="math inline">\(\widehat{\beta}(\rho,\lambda)\)</span> and compute the mean squared error <span class="math inline">\(MSE(\rho,\lambda)\)</span>. We then find the <span class="math inline">\((\rho,\lambda)\)</span> which minimizes <span class="math inline">\(MSE\)</span>.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="ols-diagnostics.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Box-Cox Transformation Function</span></span>
<span id="cb261-2"><a href="ols-diagnostics.html#cb261-2" aria-hidden="true" tabindex="-1"></a>bxcx <span class="ot">&lt;-</span> <span class="cf">function</span>( xy, rho){</span>
<span id="cb261-3"><a href="ols-diagnostics.html#cb261-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (rho <span class="sc">==</span> 0L) {</span>
<span id="cb261-4"><a href="ols-diagnostics.html#cb261-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">log</span>(xy<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb261-5"><a href="ols-diagnostics.html#cb261-5" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(rho <span class="sc">==</span> 1L){</span>
<span id="cb261-6"><a href="ols-diagnostics.html#cb261-6" aria-hidden="true" tabindex="-1"></a>      xy</span>
<span id="cb261-7"><a href="ols-diagnostics.html#cb261-7" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb261-8"><a href="ols-diagnostics.html#cb261-8" aria-hidden="true" tabindex="-1"></a>      ((xy<span class="sc">+</span><span class="dv">1</span>)<span class="sc">^</span>rho <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>rho</span>
<span id="cb261-9"><a href="ols-diagnostics.html#cb261-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb261-10"><a href="ols-diagnostics.html#cb261-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb261-11"><a href="ols-diagnostics.html#cb261-11" aria-hidden="true" tabindex="-1"></a>bxcx_inv <span class="ot">&lt;-</span> <span class="cf">function</span>( xy, rho){</span>
<span id="cb261-12"><a href="ols-diagnostics.html#cb261-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (rho <span class="sc">==</span> 0L) {</span>
<span id="cb261-13"><a href="ols-diagnostics.html#cb261-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">exp</span>(xy) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb261-14"><a href="ols-diagnostics.html#cb261-14" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(rho <span class="sc">==</span> 1L){</span>
<span id="cb261-15"><a href="ols-diagnostics.html#cb261-15" aria-hidden="true" tabindex="-1"></a>      xy</span>
<span id="cb261-16"><a href="ols-diagnostics.html#cb261-16" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb261-17"><a href="ols-diagnostics.html#cb261-17" aria-hidden="true" tabindex="-1"></a>     (xy <span class="sc">*</span> rho <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>rho) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb261-18"><a href="ols-diagnostics.html#cb261-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb261-19"><a href="ols-diagnostics.html#cb261-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb261-20"><a href="ols-diagnostics.html#cb261-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-21"><a href="ols-diagnostics.html#cb261-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Which Variables</span></span>
<span id="cb261-22"><a href="ols-diagnostics.html#cb261-22" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder<span class="sc">~</span>Assault<span class="sc">+</span>UrbanPop, <span class="at">data=</span>USArrests)</span>
<span id="cb261-23"><a href="ols-diagnostics.html#cb261-23" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> USArrests[,<span class="fu">c</span>(<span class="st">&#39;Assault&#39;</span>,<span class="st">&#39;UrbanPop&#39;</span>)]</span>
<span id="cb261-24"><a href="ols-diagnostics.html#cb261-24" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> USArrests[,<span class="st">&#39;Murder&#39;</span>]</span>
<span id="cb261-25"><a href="ols-diagnostics.html#cb261-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-26"><a href="ols-diagnostics.html#cb261-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Simple Grid Search</span></span>
<span id="cb261-27"><a href="ols-diagnostics.html#cb261-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Which potential (Rho,Lambda) </span></span>
<span id="cb261-28"><a href="ols-diagnostics.html#cb261-28" aria-hidden="true" tabindex="-1"></a>rl_df <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">rho=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="at">by=</span>.<span class="dv">5</span>),<span class="at">lambda=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="at">by=</span>.<span class="dv">5</span>))</span>
<span id="cb261-29"><a href="ols-diagnostics.html#cb261-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-30"><a href="ols-diagnostics.html#cb261-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute Mean Squared Error</span></span>
<span id="cb261-31"><a href="ols-diagnostics.html#cb261-31" aria-hidden="true" tabindex="-1"></a><span class="do">## from OLS on Transformed Data</span></span>
<span id="cb261-32"><a href="ols-diagnostics.html#cb261-32" aria-hidden="true" tabindex="-1"></a>errors <span class="ot">&lt;-</span> <span class="fu">apply</span>(rl_df,<span class="dv">1</span>,<span class="cf">function</span>(rl){</span>
<span id="cb261-33"><a href="ols-diagnostics.html#cb261-33" aria-hidden="true" tabindex="-1"></a>    Xr <span class="ot">&lt;-</span> <span class="fu">bxcx</span>(X,rl[[<span class="dv">1</span>]])</span>
<span id="cb261-34"><a href="ols-diagnostics.html#cb261-34" aria-hidden="true" tabindex="-1"></a>    Yr <span class="ot">&lt;-</span> <span class="fu">bxcx</span>(Y,rl[[<span class="dv">2</span>]])</span>
<span id="cb261-35"><a href="ols-diagnostics.html#cb261-35" aria-hidden="true" tabindex="-1"></a>    Datr <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Murder=</span>Yr,Xr)</span>
<span id="cb261-36"><a href="ols-diagnostics.html#cb261-36" aria-hidden="true" tabindex="-1"></a>    Regr <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder<span class="sc">~</span>Assault<span class="sc">+</span>UrbanPop, <span class="at">data=</span>Datr)</span>
<span id="cb261-37"><a href="ols-diagnostics.html#cb261-37" aria-hidden="true" tabindex="-1"></a>    Predr <span class="ot">&lt;-</span> <span class="fu">bxcx_inv</span>(<span class="fu">predict</span>(Regr),rl[[<span class="dv">2</span>]])</span>
<span id="cb261-38"><a href="ols-diagnostics.html#cb261-38" aria-hidden="true" tabindex="-1"></a>    Resr  <span class="ot">&lt;-</span> (Y <span class="sc">-</span> Predr)</span>
<span id="cb261-39"><a href="ols-diagnostics.html#cb261-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(Resr)</span>
<span id="cb261-40"><a href="ols-diagnostics.html#cb261-40" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb261-41"><a href="ols-diagnostics.html#cb261-41" aria-hidden="true" tabindex="-1"></a>rl_df<span class="sc">$</span>mse <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(errors<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb261-42"><a href="ols-diagnostics.html#cb261-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-43"><a href="ols-diagnostics.html#cb261-43" aria-hidden="true" tabindex="-1"></a><span class="do">## Want Small MSE and Interpretable</span></span>
<span id="cb261-44"><a href="ols-diagnostics.html#cb261-44" aria-hidden="true" tabindex="-1"></a><span class="do">## (-1,0,1,2 are Easy to interpretable)</span></span>
<span id="cb261-45"><a href="ols-diagnostics.html#cb261-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb261-46"><a href="ols-diagnostics.html#cb261-46" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rl_df, <span class="fu">aes</span>(rho, lambda, <span class="at">fill=</span>mse )) <span class="sc">+</span></span>
<span id="cb261-47"><a href="ols-diagnostics.html#cb261-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&#39;Mean Squared Error&#39;</span>) </span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="ols-diagnostics.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Which min</span></span>
<span id="cb262-2"><a href="ols-diagnostics.html#cb262-2" aria-hidden="true" tabindex="-1"></a>rl0 <span class="ot">&lt;-</span> rl_df[<span class="fu">which.min</span>(rl_df<span class="sc">$</span>mse),<span class="fu">c</span>(<span class="st">&#39;rho&#39;</span>,<span class="st">&#39;lambda&#39;</span>)]</span>
<span id="cb262-3"><a href="ols-diagnostics.html#cb262-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-4"><a href="ols-diagnostics.html#cb262-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Which give NA?</span></span>
<span id="cb262-5"><a href="ols-diagnostics.html#cb262-5" aria-hidden="true" tabindex="-1"></a><span class="do">## which(is.na(errors), arr.ind=T)</span></span>
<span id="cb262-6"><a href="ols-diagnostics.html#cb262-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-7"><a href="ols-diagnostics.html#cb262-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot</span></span>
<span id="cb262-8"><a href="ols-diagnostics.html#cb262-8" aria-hidden="true" tabindex="-1"></a>Xr <span class="ot">&lt;-</span> <span class="fu">bxcx</span>(X,rl0[[<span class="dv">1</span>]])</span>
<span id="cb262-9"><a href="ols-diagnostics.html#cb262-9" aria-hidden="true" tabindex="-1"></a>Yr <span class="ot">&lt;-</span> <span class="fu">bxcx</span>(Y,rl0[[<span class="dv">2</span>]])</span>
<span id="cb262-10"><a href="ols-diagnostics.html#cb262-10" aria-hidden="true" tabindex="-1"></a>Datr <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Murder=</span>Yr,Xr)</span>
<span id="cb262-11"><a href="ols-diagnostics.html#cb262-11" aria-hidden="true" tabindex="-1"></a>Regr <span class="ot">&lt;-</span> <span class="fu">lm</span>(Murder<span class="sc">~</span>Assault<span class="sc">+</span>UrbanPop, <span class="at">data=</span>Datr)</span>
<span id="cb262-12"><a href="ols-diagnostics.html#cb262-12" aria-hidden="true" tabindex="-1"></a>Predr <span class="ot">&lt;-</span> <span class="fu">bxcx_inv</span>(<span class="fu">predict</span>(Regr),rl0[[<span class="dv">2</span>]])</span>
<span id="cb262-13"><a href="ols-diagnostics.html#cb262-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-14"><a href="ols-diagnostics.html#cb262-14" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,.<span class="dv">5</span>), <span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">5</span>))</span>
<span id="cb262-15"><a href="ols-diagnostics.html#cb262-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Y, Predr, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols[<span class="dv">1</span>], <span class="at">ylab=</span><span class="st">&#39;Prediction&#39;</span>)</span>
<span id="cb262-16"><a href="ols-diagnostics.html#cb262-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Y, <span class="fu">predict</span>(reg), <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span>cols[<span class="dv">2</span>])</span>
<span id="cb262-17"><a href="ols-diagnostics.html#cb262-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">16</span>), <span class="at">col=</span>cols, <span class="at">title=</span><span class="st">&#39;Rho,Lambda&#39;</span>,</span>
<span id="cb262-18"><a href="ols-diagnostics.html#cb262-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend=</span><span class="fu">c</span>(  <span class="fu">paste0</span>(rl0, <span class="at">collapse=</span><span class="st">&#39;,&#39;</span>),<span class="st">&#39;1,1&#39;</span>) )</span></code></pre></div>
<p><img src="03-ROLS_files/figure-html/unnamed-chunk-36-2.png" width="672" /></p>
<p>Note that the default hypothesis testing procedures do not account for you trying out different transformations. Specification searches deflate standard errors and are a major source for false discoveries.</p>
</div>
<div id="more-literature-1" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> More Literature<a href="ols-diagnostics.html#more-literature-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><a href="https://book.stat420.org/model-diagnostics.html#leverage" class="uri">https://book.stat420.org/model-diagnostics.html#leverage</a></li>
<li><a href="https://socialsciences.mcmaster.ca/jfox/Books/RegressionDiagnostics/index.html" class="uri">https://socialsciences.mcmaster.ca/jfox/Books/RegressionDiagnostics/index.html</a></li>
<li><a href="https://bookdown.org/ripberjt/labbook/diagnosing-and-addressing-problems-in-linear-regression.html" class="uri">https://bookdown.org/ripberjt/labbook/diagnosing-and-addressing-problems-in-linear-regression.html</a></li>
<li>Belsley, D. A., Kuh, E., and Welsch, R. E. (1980). Regression Diagnostics: Identifying influential data and sources of collinearity. Wiley. <a href="https://doi.org/10.1002/0471725153" class="uri">https://doi.org/10.1002/0471725153</a></li>
<li>Fox, J. D. (2020). Regression diagnostics: An introduction (2nd ed.). SAGE. <a href="https://dx.doi.org/10.4135/9781071878651" class="uri">https://dx.doi.org/10.4135/9781071878651</a></li>
</ul>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ordinary-least-squares.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ols-and-endogeneity.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["index.pdf", "index.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
